/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 Socket.IO v4.4.1
 (c) 2014-2022 Guillermo Rauch
 Released under the MIT License.
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
var $jscomp$templatelit$1=['\n    <ul class="','">\n      ',"\n    </ul>\n  "];$jscomp$templatelit$1.raw=$jscomp$templatelit$1.slice();var $jscomp$templatelit$0=['\n        <li class="','">',"</li>\n      "];$jscomp$templatelit$0.raw=$jscomp$templatelit$0.slice();var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(l){var r=0;return function(){return r<l.length?{done:!1,value:l[r++]}:{done:!0}}};$jscomp.arrayIterator=function(l){return{next:$jscomp.arrayIteratorImpl(l)}};
$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(l,r,p){l!=Array.prototype&&l!=Object.prototype&&(l[r]=p.value)};$jscomp.getGlobal=function(l){return"undefined"!=typeof window&&window===l?l:"undefined"!=typeof global&&null!=global?global:l};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(l,r){this.$jscomp$symbol$id_=l;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:r})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function l(p){if(this instanceof l)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(p||"")+"_"+r++,p)}var r=0;return l}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var l=$jscomp.global.Symbol.iterator;l||(l=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[l]&&$jscomp.defineProperty(Array.prototype,l,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var l=$jscomp.global.Symbol.asyncIterator;l||(l=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(l){$jscomp.initSymbolIterator();l={next:l};l[$jscomp.global.Symbol.iterator]=function(){return this};return l};
$jscomp.makeIterator=function(l){var r="undefined"!=typeof Symbol&&Symbol.iterator&&l[Symbol.iterator];return r?r.call(l):$jscomp.arrayIterator(l)};$jscomp.arrayFromIterator=function(l){for(var r,p=[];!(r=l.next()).done;)p.push(r.value);return p};$jscomp.arrayFromIterable=function(l){return l instanceof Array?l:$jscomp.arrayFromIterator($jscomp.makeIterator(l))};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(l){var r=function(){};r.prototype=l;return new r};
$jscomp.underscoreProtoCanBeSet=function(){var l={a:!0},r={};try{return r.__proto__=l,r.a}catch(p){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(l,r){l.__proto__=r;if(l.__proto__!==r)throw new TypeError(l+" is not extensible");return l}:null;
$jscomp.inherits=function(l,r){l.prototype=$jscomp.objectCreate(r.prototype);l.prototype.constructor=l;if($jscomp.setPrototypeOf){var p=$jscomp.setPrototypeOf;p(l,r)}else for(p in r)if("prototype"!=p)if(Object.defineProperties){var f=Object.getOwnPropertyDescriptor(r,p);f&&Object.defineProperty(l,p,f)}else l[p]=r[p];l.superClass_=r.prototype};
$jscomp.polyfill=function(l,r,p,f){if(r){p=$jscomp.global;l=l.split(".");for(f=0;f<l.length-1;f++){var q=l[f];q in p||(p[q]={});p=p[q]}l=l[l.length-1];f=p[l];r=r(f);r!=f&&null!=r&&$jscomp.defineProperty(p,l,{configurable:!0,writable:!0,value:r})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(l){function r(){this.batch_=null}function p(e){return e instanceof q?e:new q(function(a,b){a(e)})}if(l&&!$jscomp.FORCE_POLYFILL_PROMISE)return l;r.prototype.asyncExecute=function(e){if(null==this.batch_){this.batch_=[];var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})}this.batch_.push(e)};var f=$jscomp.global.setTimeout;r.prototype.asyncExecuteFunction=function(e){f(e,0)};r.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=
this.batch_;this.batch_=[];for(var a=0;a<e.length;++a){var b=e[a];e[a]=null;try{b()}catch(h){this.asyncThrow_(h)}}}this.batch_=null};r.prototype.asyncThrow_=function(e){this.asyncExecuteFunction(function(){throw e;})};var q=function(e){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{e(a.resolve,a.reject)}catch(b){a.reject(b)}};q.prototype.createResolveAndReject_=function(){function e(h){return function(e){b||(b=!0,h.call(a,e))}}var a=this,b=!1;
return{resolve:e(this.resolveTo_),reject:e(this.reject_)}};q.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof q)this.settleSameAsPromise_(e);else{a:switch(typeof e){case "object":var a=null!=e;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}};q.prototype.resolveToNonPromiseObj_=function(e){var a=void 0;try{a=e.then}catch(b){this.reject_(b);return}"function"==typeof a?
this.settleSameAsThenable_(a,e):this.fulfill_(e)};q.prototype.reject_=function(e){this.settle_(2,e)};q.prototype.fulfill_=function(e){this.settle_(1,e)};q.prototype.settle_=function(e,a){if(0!=this.state_)throw Error("Cannot settle("+e+", "+a+"): Promise already settled in state"+this.state_);this.state_=e;this.result_=a;this.executeOnSettledCallbacks_()};q.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=0;e<this.onSettledCallbacks_.length;++e)k.asyncExecute(this.onSettledCallbacks_[e]);
this.onSettledCallbacks_=null}};var k=new r;q.prototype.settleSameAsPromise_=function(e){var a=this.createResolveAndReject_();e.callWhenSettled_(a.resolve,a.reject)};q.prototype.settleSameAsThenable_=function(e,a){var b=this.createResolveAndReject_();try{e.call(a,b.resolve,b.reject)}catch(h){b.reject(h)}};q.prototype.then=function(e,a){function b(d,a){return"function"==typeof d?function(a){try{h(d(a))}catch(w){f(w)}}:a}var h,f,d=new q(function(d,a){h=d;f=a});this.callWhenSettled_(b(e,h),b(a,f));return d};
q.prototype.catch=function(e){return this.then(void 0,e)};q.prototype.callWhenSettled_=function(e,a){function b(){switch(h.state_){case 1:e(h.result_);break;case 2:a(h.result_);break;default:throw Error("Unexpected state: "+h.state_);}}var h=this;null==this.onSettledCallbacks_?k.asyncExecute(b):this.onSettledCallbacks_.push(b)};q.resolve=p;q.reject=function(e){return new q(function(a,b){b(e)})};q.race=function(e){return new q(function(a,b){for(var h=$jscomp.makeIterator(e),f=h.next();!f.done;f=h.next())p(f.value).callWhenSettled_(a,
b)})};q.all=function(e){var a=$jscomp.makeIterator(e),b=a.next();return b.done?p([]):new q(function(h,e){function d(d){return function(a){f[d]=a;n--;0==n&&h(f)}}var f=[],n=0;do f.push(void 0),n++,p(b.value).callWhenSettled_(d(f.length-1),e),b=a.next();while(!b.done)})};return q},"es6","es3");$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(l){if(!(l instanceof Object))throw new TypeError("Iterator result "+l+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(l){this.yieldResult=l};$jscomp.generator.Context.prototype.throw_=function(l){this.abruptCompletion_={exception:l,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(l){this.abruptCompletion_={return:l};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(l){this.abruptCompletion_={jumpTo:l};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(l,r){this.nextAddress=r;return{value:l}};$jscomp.generator.Context.prototype.yieldAll=function(l,r){l=$jscomp.makeIterator(l);var p=l.next();$jscomp.generator.ensureIteratorResultIsObject_(p);if(p.done)this.yieldResult=p.value,this.nextAddress=r;else return this.yieldAllIterator_=l,this.yield(p.value,r)};
$jscomp.generator.Context.prototype.jumpTo=function(l){this.nextAddress=l};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(l,r){this.catchAddress_=l;void 0!=r&&(this.finallyAddress_=r)};$jscomp.generator.Context.prototype.setFinallyBlock=function(l){this.catchAddress_=0;this.finallyAddress_=l||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(l,r){this.nextAddress=l;this.catchAddress_=r||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(l){this.catchAddress_=l||0;l=this.abruptCompletion_.exception;this.abruptCompletion_=null;return l};$jscomp.generator.Context.prototype.enterFinallyBlock=function(l,r,p){p?this.finallyContexts_[p]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=l||0;this.finallyAddress_=r||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(l,r){r=this.finallyContexts_.splice(r||0)[0];if(r=this.abruptCompletion_=this.abruptCompletion_||r){if(r.isException)return this.jumpToErrorHandler_();void 0!=r.jumpTo&&this.finallyAddress_<r.jumpTo?(this.nextAddress=r.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=l};$jscomp.generator.Context.prototype.forIn=function(l){return new $jscomp.generator.Context.PropertyIterator(l)};
$jscomp.generator.Context.PropertyIterator=function(l){this.object_=l;this.properties_=[];for(var r in l)this.properties_.push(r);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var l=this.properties_.pop();if(l in this.object_)return l}return null};$jscomp.generator.Engine_=function(l){this.context_=new $jscomp.generator.Context;this.program_=l};
$jscomp.generator.Engine_.prototype.next_=function(l){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,l,this.context_.next_);this.context_.next_(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(l){this.context_.start_();var r=this.context_.yieldAllIterator_;if(r)return this.yieldAllStep_("return"in r?r["return"]:function(l){return{value:l,done:!0}},l,this.context_.return);this.context_.return(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(l){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],l,this.context_.next_);this.context_.throw_(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(l,r,p){try{var f=l.call(this.context_.yieldAllIterator_,r);$jscomp.generator.ensureIteratorResultIsObject_(f);if(!f.done)return this.context_.stop_(),f;var q=f.value}catch(k){return this.context_.yieldAllIterator_=null,this.context_.throw_(k),this.nextStep_()}this.context_.yieldAllIterator_=null;p.call(this.context_,q);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var l=this.program_(this.context_);if(l)return this.context_.stop_(),{value:l.value,done:!1}}catch(r){this.context_.yieldResult=void 0,this.context_.throw_(r)}this.context_.stop_();if(this.context_.abruptCompletion_){l=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(l.isException)throw l.exception;return{value:l.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(l){this.next=function(r){return l.next_(r)};this.throw=function(r){return l.throw_(r)};this.return=function(r){return l.return_(r)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(l,r){r=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(r));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(r,l.prototype);return r};
$jscomp.asyncExecutePromiseGenerator=function(l){function r(f){return l.next(f)}function p(f){return l.throw(f)}return new Promise(function(f,q){function k(e){e.done?f(e.value):Promise.resolve(e.value).then(r,p).then(k,q)}k(l.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(l){return $jscomp.asyncExecutePromiseGenerator(l())};$jscomp.asyncExecutePromiseGeneratorProgram=function(l){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(l)))};
$jscomp.iteratorFromArray=function(l,r){$jscomp.initSymbolIterator();l instanceof String&&(l+="");var p=0,f={next:function(){if(p<l.length){var q=p++;return{value:r(q,l[q]),done:!1}}f.next=function(){return{done:!0,value:void 0}};return f.next()}};f[Symbol.iterator]=function(){return f};return f};$jscomp.polyfill("Array.prototype.keys",function(l){return l?l:function(){return $jscomp.iteratorFromArray(this,function(l){return l})}},"es6","es3");
$jscomp.polyfill("Object.is",function(l){return l?l:function(l,p){return l===p?0!==l||1/l===1/p:l!==l&&p!==p}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(l){return l?l:function(l,p){var f=this;f instanceof String&&(f=String(f));var q=f.length;p=p||0;for(0>p&&(p=Math.max(p+q,0));p<q;p++){var k=f[p];if(k===l||Object.is(k,l))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(l,r,p){if(null==l)throw new TypeError("The 'this' value for String.prototype."+p+" must not be null or undefined");if(r instanceof RegExp)throw new TypeError("First argument to String.prototype."+p+" must not be a regular expression");return l+""};$jscomp.polyfill("String.prototype.includes",function(l){return l?l:function(l,p){return-1!==$jscomp.checkStringArgs(this,l,"includes").indexOf(l,p||0)}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var l={},r=Object.create(new $jscomp.global.Proxy(l,{get:function(p,f,q){return p==l&&"q"==f&&q==r}}));return!0===r.q}catch(p){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(l,r){return Object.prototype.hasOwnProperty.call(l,r)};
$jscomp.polyfill("WeakMap",function(l){function r(){if(!l||!Object.seal)return!1;try{var a=Object.seal({}),b=Object.seal({}),d=new l([[a,2],[b,3]]);if(2!=d.get(a)||3!=d.get(b))return!1;d.delete(a);d.set(b,4);return!d.has(a)&&4==d.get(b)}catch(u){return!1}}function p(){}function f(a){var b=typeof a;return"object"===b&&null!==a||"function"===b}function q(a){if(!$jscomp.owns(a,e)){var b=new p;$jscomp.defineProperty(a,e,{value:b})}}function k(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof
p)return a;q(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(r())return l;var e="$jscomp_hidden_"+Math.random();k("freeze");k("preventExtensions");k("seal");var a=0,b=function(b){this.id_=(a+=Math.random()+1).toString();if(b){b=$jscomp.makeIterator(b);for(var h;!(h=b.next()).done;)h=h.value,this.set(h[0],h[1])}};b.prototype.set=function(a,b){if(!f(a))throw Error("Invalid WeakMap key");q(a);if(!$jscomp.owns(a,e))throw Error("WeakMap key fail: "+
a);a[e][this.id_]=b;return this};b.prototype.get=function(a){return f(a)&&$jscomp.owns(a,e)?a[e][this.id_]:void 0};b.prototype.has=function(a){return f(a)&&$jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};b.prototype.delete=function(a){return f(a)&&$jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return b},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(l){function r(){if($jscomp.ASSUME_NO_NATIVE_MAP||!l||"function"!=typeof l||!l.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),h=new l($jscomp.makeIterator([[a,"s"]]));if("s"!=h.get(a)||1!=h.size||h.get({x:4})||h.set({x:4},"t")!=h||2!=h.size)return!1;var e=h.entries(),d=e.next();if(d.done||d.value[0]!=a||"s"!=d.value[1])return!1;d=e.next();return d.done||4!=d.value[0].x||"t"!=d.value[1]||!e.next().done?!1:!0}catch(u){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(r())return l;$jscomp.initSymbolIterator();var p=new WeakMap,f=function(a){this.data_={};this.head_=e();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};f.prototype.set=function(a,h){a=0===a?0:a;var b=q(this,a);b.list||(b.list=this.data_[b.id]=[]);b.entry?b.entry.value=h:(b.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:h},b.list.push(b.entry),this.head_.previous.next=b.entry,this.head_.previous=b.entry,this.size++);return this};f.prototype.delete=function(a){a=q(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};f.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=e();this.size=0};f.prototype.has=function(a){return!!q(this,a).entry};
f.prototype.get=function(a){return(a=q(this,a).entry)&&a.value};f.prototype.entries=function(){return k(this,function(a){return[a.key,a.value]})};f.prototype.keys=function(){return k(this,function(a){return a.key})};f.prototype.values=function(){return k(this,function(a){return a.value})};f.prototype.forEach=function(a,h){for(var b=this.entries(),d;!(d=b.next()).done;)d=d.value,a.call(h,d[1],d[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var q=function(b,h){var e=h&&typeof h;"object"==
e||"function"==e?p.has(h)?e=p.get(h):(e=""+ ++a,p.set(h,e)):e="p_"+h;var d=b.data_[e];if(d&&$jscomp.owns(b.data_,e))for(b=0;b<d.length;b++){var f=d[b];if(h!==h&&f.key!==f.key||h===f.key)return{id:e,list:d,index:b,entry:f}}return{id:e,list:d,index:-1,entry:void 0}},k=function(a,h){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:h(b)};b=null}return{done:!0,value:void 0}})},e=function(){var a={};return a.previous=
a.next=a.head=a},a=0;return f},"es6","es3");$jscomp.assign="function"==typeof Object.assign?Object.assign:function(l,r){for(var p=1;p<arguments.length;p++){var f=arguments[p];if(f)for(var q in f)$jscomp.owns(f,q)&&(l[q]=f[q])}return l};$jscomp.polyfill("Object.assign",function(l){return l||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.values",function(l){return l?l:function(l){var p=[],f;for(f in l)$jscomp.owns(l,f)&&p.push(l[f]);return p}},"es8","es3");
$jscomp.polyfill("Math.log10",function(l){return l?l:function(l){return Math.log(l)/Math.LN10}},"es6","es3");$jscomp.polyfill("Array.from",function(l){return l?l:function(l,p,f){p=null!=p?p:function(a){return a};var q=[],k="undefined"!=typeof Symbol&&Symbol.iterator&&l[Symbol.iterator];if("function"==typeof k){l=k.call(l);for(var e=0;!(k=l.next()).done;)q.push(p.call(f,k.value,e++))}else for(k=l.length,e=0;e<k;e++)q.push(p.call(f,l[e],e));return q}},"es6","es3");
$jscomp.findInternal=function(l,r,p){l instanceof String&&(l=String(l));for(var f=l.length,q=0;q<f;q++){var k=l[q];if(r.call(p,k,q,l))return{i:q,v:k}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(l){return l?l:function(l,p){return $jscomp.findInternal(this,l,p).v}},"es6","es3");$jscomp.polyfill("Array.prototype.entries",function(l){return l?l:function(){return $jscomp.iteratorFromArray(this,function(l,p){return[l,p]})}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(l){return l?l:function(l,p,f){var q=this.length||0;0>p&&(p=Math.max(0,q+p));if(null==f||f>q)f=q;f=Number(f);0>f&&(f=Math.max(0,q+f));for(p=Number(p||0);p<f;p++)this[p]=l;return this}},"es6","es3");
$jscomp.polyfill("Array.prototype.copyWithin",function(l){function r(l){l=Number(l);return Infinity===l||-Infinity===l?l:l|0}return l?l:function(l,f,q){var k=this.length;l=r(l);f=r(f);q=void 0===q?k:r(q);l=0>l?Math.max(k+l,0):Math.min(l,k);f=0>f?Math.max(k+f,0):Math.min(f,k);q=0>q?Math.max(k+q,0):Math.min(q,k);if(l<f)for(;f<q;)f in this?this[l++]=this[f++]:(delete this[l++],f++);else for(q=Math.min(q,k+f-l),l+=q-f;q>f;)--q in this?this[--l]=this[q]:delete this[--l];return this}},"es6","es3");
$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");
$jscomp.polyfill("Set",function(l){function r(){if($jscomp.ASSUME_NO_NATIVE_SET||!l||"function"!=typeof l||!l.prototype.entries||"function"!=typeof Object.seal)return!1;try{var f=Object.seal({x:4}),q=new l($jscomp.makeIterator([f]));if(!q.has(f)||1!=q.size||q.add(f)!=q||1!=q.size||q.add({x:4})!=q||2!=q.size)return!1;var k=q.entries(),e=k.next();if(e.done||e.value[0]!=f||e.value[1]!=f)return!1;e=k.next();return e.done||e.value[0]==f||4!=e.value[0].x||e.value[1]!=e.value[0]?!1:k.next().done}catch(a){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(r())return l;$jscomp.initSymbolIterator();var p=function(f){this.map_=new Map;if(f){f=$jscomp.makeIterator(f);for(var q;!(q=f.next()).done;)this.add(q.value)}this.size=this.map_.size};p.prototype.add=function(f){f=0===f?0:f;this.map_.set(f,f);this.size=this.map_.size;return this};p.prototype.delete=function(f){f=this.map_.delete(f);this.size=this.map_.size;return f};p.prototype.clear=function(){this.map_.clear();
this.size=0};p.prototype.has=function(f){return this.map_.has(f)};p.prototype.entries=function(){return this.map_.entries()};p.prototype.values=function(){return this.map_.values()};p.prototype.keys=p.prototype.values;p.prototype[Symbol.iterator]=p.prototype.values;p.prototype.forEach=function(f,q){var k=this;this.map_.forEach(function(e){return f.call(q,e,e,k)})};return p},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(l){return l?l:function(l,p){var f=$jscomp.checkStringArgs(this,l,"startsWith");l+="";var q=f.length,k=l.length;p=Math.max(0,Math.min(p|0,f.length));for(var e=0;e<k&&p<q;)if(f[p++]!=l[e++])return!1;return e>=k}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(l){return l?l:function(l,p){var f=$jscomp.checkStringArgs(this,l,"endsWith");l+="";void 0===p&&(p=f.length);p=Math.max(0,Math.min(p|0,f.length));for(var q=l.length;0<q&&0<p;)if(f[--p]!=l[--q])return!1;return 0>=q}},"es6","es3");
var EnxRtc=function(l){function r(f){if(p[f])return p[f].exports;var q=p[f]={i:f,l:!1,exports:{}};l[f].call(q.exports,q,q.exports,r);q.l=!0;return q.exports}var p={};r.m=l;r.c=p;r.d=function(f,q,k){r.o(f,q)||Object.defineProperty(f,q,{configurable:!1,enumerable:!0,get:k})};r.n=function(f){var q=f&&f.__esModule?function(){return f["default"]}:function(){return f};r.d(q,"a",q);return q};r.o=function(f,q){return Object.prototype.hasOwnProperty.call(f,q)};r.p="";return r(r.s=33)}([function(l,r,p){l=p(1);
var f=p.n(l),q=p(34),k=function(){var e=q().format("YYMMDDHHmmss")+"::";var a=function(a){console.log.apply(console,$jscomp.arrayFromIterable(a))};return{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(a){console.log("setting log level:  old: "+k.logLevel+" new: "+a);if("string"===typeof a||"number"===typeof a){var b=a;"number"===typeof b?(b=Math.round(a),a>k.NONE?b=k.NONE:a<k.DEBUG&&(b=k.DEBUG),k.logLevel=b):-1<"DEBUG TRACE INFO WARNING ERROR NONE".split(" ").indexOf(b)?k.logLevel=
b:k.error("setLogLevel() invalid param");k.logLevel>k.INFO&&(k.logLevel=k.INFO)}else k.error("setLogLevel() invalid param type")},getLogLevel:function(a){return k.logLevel},setOutputFunction:function(b){a=b},setLogPrefix:function(a){e=a},log:function(b,h){for(var x=[],d=1;d<arguments.length;++d)x[d-1]=arguments[d];var u=e;if(!(b<k.logLevel)){b===k.DEBUG?u+="D":b===k.TRACE?u+="T":b===k.INFO?u+="I":b===k.WARNING?u+="W":b===k.ERROR&&(u+="E");u+="::WB::";d=f.a.getLocalStorageItem("logID");u+=null!=d?
d:"";d=[u].concat(x);if(null!=f.a.getLocalStorageItem("vcxRTCLib-log")){var n=JSON.parse(f.a.getLocalStorageItem("vcxRTCLib-log"));500<Object.keys(n).length&&delete Object.keys(n)[0];var q="",w;for(w in x)q="object"===typeof x[w]?q+JSON.stringify(x[w],null,2):q+x[w];n[u]=q;f.a.removeLocalStorageItem("vcxRTCLib-log");f.a.setLocalStorageItem("vcxRTCLib-log",JSON.stringify(n,null,2))}if(void 0!==k.panel){x="";for(w=0;w<d.length;w+=1)x+=d[w];k.panel.value=k.panel.value+"\n"+x}else a.apply(k,[d])}},debug:function(a){for(var b=
[],e=0;e<arguments.length;++e)b[e-0]=arguments[e];k.log.apply(k,[k.DEBUG].concat($jscomp.arrayFromIterable(b)))},trace:function(a){for(var b=[],e=0;e<arguments.length;++e)b[e-0]=arguments[e];k.log.apply(k,[k.TRACE].concat($jscomp.arrayFromIterable(b)))},info:function(a){for(var b=[],e=0;e<arguments.length;++e)b[e-0]=arguments[e];k.log.apply(k,[k.INFO].concat($jscomp.arrayFromIterable(b)))},warning:function(a){for(var b=[],e=0;e<arguments.length;++e)b[e-0]=arguments[e];k.log.apply(k,[k.WARNING].concat($jscomp.arrayFromIterable(b)))},
error:function(a){for(var b=[],e=0;e<arguments.length;++e)b[e-0]=arguments[e];k.log.apply(k,[k.ERROR].concat($jscomp.arrayFromIterable(b)))}}}();k.logLevel=k.INFO;r.a=k},function(l,r,p){p(35);var f={};f.browser_info=function(){var e="none",a,b=window.navigator.userAgent;if(-1!=(a=b.indexOf("OPR")))var h="opera";else-1!=(a=b.indexOf("Firefox"))?h="mozilla":-1!=(a=b.indexOf("Edg"))?h="edge":-1!=(a=b.indexOf("Chrome"))?h="chrome-stable":-1!=b.indexOf("Safari")?(h="safari",-1!=(a=b.indexOf("Version"))&&
(e=b.substring(a+8))):-1!=(a=b.indexOf("MSIE"))||-1!=(a=b.indexOf("Windows NT"))?h="IE":(b.includes("iPhone")||b.includes("iPad"))&&b.includes("Mobile")&&-1!=(a=b.indexOf("OS"))?((h=b.substring(a+3))&&(e=h.substring(0,h.indexOf(" "))),e?(e.replace(/_/g,"."),h="safari"):(h="none",a=-1)):h="none";if("none"==e&&-1!=a){var f=b.substring(a);-1!=(a=f.indexOf("/"))&&(e=f.substring(a+1))}var d;-1!=(d=e.indexOf(";"))&&(e=e.substring(0,d));-1!=(d=e.indexOf(" "))&&(e=e.substring(0,d));a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(b)?
"mobile":"desktop";return{name:h,version:e,device_type:a}}();f.is_supported=!(void 0===RTCPeerConnection||!/chrome-stable|mozilla|safari|opera|edge/i.test(f.browser_info.name));f.browser_type=window.navigator.userAgent.match("Chrome")?"chrome-stable":window.navigator.userAgent.match("Firefox")?"mozilla":window.navigator.userAgent.match(/Safari|AppleWebKit/g)?"safari":window.navigator.userAgent.match("Edge")?"edge":window.navigator.userAgent.match("Electron")?"electron":window.navigator.userAgent.match(".NET")?
"IE":"none";f.device_type=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(window.navigator.userAgent)?"mobile":"desktop";f.videoBitrateQualityMap;f.cameraResolutionTable;var q=function(e,a,b,h){var f=b;switch(a){case "get":f=e.getItem(b);break;case "set":e.setItem(b,h);break;case "remove":e.removeItem(b)}return f},k=function(e,a,b){try{return q(localStorage,e,a,b)}catch(h){if(void 0!=h.SecurityError)try{return q(sessionStorage,e,a,b)}catch(x){}return null}};
l.exports={product:{company:"Paytm Payments Bank",product:"Video KYC Web SDK",version:"2.1.3.10",release:"2.1.3.10"},default_region:["IN"],data_throughput_duration:2,video_bandwidth_duration:10,audio_bandwidth_duration:10,video_layer_bitrates:{0:3E5,1:8E5,2:15E5},video_resolution_range:{HD:{min:{width:320,height:180},max:{width:1280,height:720}},SD:{min:{width:320,height:180},max:{width:960,height:540}},LD:{min:{width:80,height:45},max:{width:640,height:360}}},video_bandwidth_range:{HD:{0:{min:100,
max:1200},1:{min:100,max:800},2:{min:100,max:400}},SD:{0:{min:100,max:700},1:{min:100,max:400},2:{min:100,max:250}},LD:{0:{min:80,max:400},1:{min:80,max:250},2:{min:80,max:150}},ND:{0:{min:0,max:0},1:{min:40,max:200},2:{min:40,max:100}},share:{min:100,max:400},canvas:{min:1024,max:4096}},proxy_api_url:"",proxy_api_port:443,ice_servers:{IN:{turnURI:"turns:enablex-turn.paytmbank.com:443",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"}},browser_info:f.browser_info,
browser_type:f.browser_type,device_type:f.device_type,user_agent:window.navigator.userAgent,is_supported:function(){return f.is_supported},setVideoBwQualityMapper:function(e){e.minBwKbpsToCheck&&(f.videoBitrateQualityMap=e.bpsQualityMapTable.slice(),f.cameraResolutionTable=e.camResTable.slice());f.videoQualityMapMinBwKbps=e.minBwKbpsToCheck},getBitrateMapTable:function(){return f.videoBitrateQualityMap},getCamResolutionTable:function(){return f.cameraResolutionTable},getCamResTableToCheck:function(e){if(void 0!==
f.videoBitrateQualityMap&&e<=f.videoQualityMapMinBwKbps)for(var a=0;a<f.videoBitrateQualityMap.length;a++)if(f.videoBitrateQualityMap[a].kbps<=e)return{resTable:f.cameraResolutionTable.slice(f.videoBitrateQualityMap[a].resTable.index),fps:f.videoBitrateQualityMap[a].fps.max}},internetDetectionUrl:"https://enablex-signalling.paytmbank.com/status",getLocalStorageItem:function(e){return k("get",e)},setLocalStorageItem:function(e,a){return k("set",e,a)},removeLocalStorageItem:function(e){return k("remove",
e)},noise_analysis:!1,csp_enabled:!0}},function(l,r,p){var f=p(4);r.a=function(){var q=Object(f.c)({});q.url="";return q}},function(l,r,p){var f=function(q){var k=q.name;var e=q.src;var a=q.srcObject;var b=q.href;var h=q.rel;var x=q.type;var d=q.target;var u=q.autoplay;var n=q.playsinline;var l=q.alt;var w=q.title;var t=q.id;var v=q.class;q=f.getStyle(q.style);var p=null;k&&""!=k&&null!=k&&(p=document.createElement(k),e&&""!=e&&null!=e&&p.setAttribute("src",e),a&&""!=a&&null!=a&&p.setAttribute("srcObject",
a),b&&""!=b&&null!=b&&p.setAttribute("href",b),d&&""!=d&&null!=d&&p.setAttribute("target",d),l&&""!=l&&null!=l&&p.setAttribute("alt",l),w&&""!=w&&null!=w&&p.setAttribute("title",w),h&&""!=h&&null!=h&&p.setAttribute("rel",h),x&&""!=x&&null!=x&&p.setAttribute("type",x),u&&""!=u&&null!=u&&p.setAttribute("autoplay",u),n&&""!=n&&null!=n&&p.setAttribute("playsinline",n),t&&""!=t&&null!=t&&p.setAttribute("id",t),v&&""!=v&&null!=v&&p.setAttribute("class",v),q&&""!=q&&null!=q&&p.setAttribute("style",q));return p};
f.getStyle=function(f){var k="",e;for(e in f)k+=e+":"+f[e]+";";return k};f.getById=function(f){return document.getElementById(f)};f.getByClass=function(f){return document.getElementsByClassName(f)[0]};f.getByTag=function(f){return document.getElementsByTagName(f)[0]};f.getTagByDOM=function(f,k){return k.getElementsByTagName(f)[0]};f.getByClass=function(f,k){return k.getElementsByClassName(f)[0]};f.append=function(f,k){return k.appendChild(f)};f.setStyle=function(f,k,e){f.style[k]=e};f.addCssFile=
function(q){f.getByTag("head").appendChild(q)};f.checkParam=function(f){var k=!1;f&&null!=f&&""!=f&&(k=!0);return k};r.a=f},function(l,r,p){p.d(r,"c",function(){return k});p.d(r,"b",function(){return e});p.d(r,"e",function(){return a});p.d(r,"f",function(){return b});p.d(r,"d",function(){return h});p.d(r,"g",function(){return x});p.d(r,"a",function(){return d});var f=p(0),q=p(7),k=function(){var a={},d={};a.addEventListener=function(a,b){void 0===d[a]&&(d[a]=[]);d[a].push(b)};a.removeEventListener=
function(a,b){d[a]&&(b=d[a].indexOf(b),-1!==b&&d[a].splice(b,1))};if("IE"!==q.a.browserEngineCheck())a.dispatchEvent=function(a){if(!a||!a.type)throw Error("Undefined event");"onStatSubscription"!=a.type&&"genericEvents"!=a.type&&"talker-notification"!=a.type&&f.a.debug("Event: "+a.type);for(var b=d[a.type]||[],e=0;e<b.length;e+=1)b[e](a)};else{var b=function(a,d){d=d||{bubbles:!1,cancelable:!1,detail:void 0};var b=document.createEvent("CustomEvent");b.initCustomEvent(a,d.bubbles,d.cancelable,d.detail);
b.data=d.detail;return b};b.prototype=window.Event.prototype;window.CustomEvent=b;a.dispatchEvent=function(a){"onStatSubscription"!=a.type&&"genericEvents"!=a.type&&"talker-notification"!=a.type&&f.a.debug("Event: "+a.type);a=b(a.type,{bubbles:!1,cancelable:!1,detail:a});document.getElementById("WebrtcEverywherePluginId").dispatchEvent(a)}}a.on=a.addEventListener;a.off=a.removeEventListener;a.emit=a.dispatchEvent;a.eventsList=d;return a},e=function(a){var d={};d.type=a.type;return d},a=function(a){var d=
e(a);d.streams=a.streams;d.message=a.message;d.room=a.room;d.users=a.users;d.type=a.type;d.bandwidth=a.bandwidth;d.TalkerCount=a.TalkerCount;d.me=a.me;d.mediaRecord=a.mediaRecord;d.error=a.error;return d},b=function(a){var d=e(a);d.stream=a.stream;d.msg=a.msg;d.bandwidth=a.bandwidth;d.attrs=a.attrs;return d},h=function(a){return e(a)},x=function(a){var d=e(a);d.name=a.name;d.role=a.role;d.clientId=a.clientId;d.permissions=a.permission;return d},d=function(a){var d=e(a);d.message=a.message;return d}},
function(l,r,p){l={SocketEvent:{},RoomEvent:{},UserEvent:{},StreamEvent:{}};l.SocketEvent.onAddStream="onAddStream";l.SocketEvent.onRemoveTrack="onRemoveTrack";l.SocketEvent.media_engine_connecting="media_engine_connecting";l.SocketEvent.signaling_message_peer="signaling_message_peer";l.SocketEvent.publish_me="publish_me";l.SocketEvent.unpublish_me="unpublish_me";l.SocketEvent.onBandwidthAlert="onBandwidthAlert";l.SocketEvent.onBandwidthEvents="bandwidthEvents";l.SocketEvent.onSelfBandwidthAlert=
"onSelfBandwidthAlert";l.SocketEvent.onDataStream="onDataStream";l.SocketEvent.onUpdateAttributeStream="onUpdateAttributeStream";l.SocketEvent.onRemoveStream="onRemoveStream";l.SocketEvent.disconnect="disconnect";l.SocketEvent.connection_failed="connection_failed";l.SocketEvent.error="error";l.SocketEvent.connect_error="connect_error";l.SocketEvent.connect_timeout="connect_timeout";l.SocketEvent.reconnecting="reconnecting";l.SocketEvent.reconnect="reconnect";l.SocketEvent.reconnected="reconnected";
l.SocketEvent.reconnect_attempt="reconnect_attempt";l.SocketEvent.reconnect_error="reconnect_error";l.SocketEvent.reconnect_failed="reconnect_failed";l.SocketEvent.user_connected="user-connected";l.SocketEvent.user_updated="user-updated";l.SocketEvent.user_disconnected="user-disconnected";l.SocketEvent.user_subscribed="user-subscribed";l.SocketEvent.user_unsubscribed="user-unsubscribed";l.SocketEvent.dial_state_events="dialStateEvents";l.RoomEvent.user_role_changed="userRoleChanged";l.SocketEvent.onStatSubscription=
"onStatSubscription";l.SocketEvent.onStreamingNotification="onStreamingNotification";l.SocketEvent.onHlsStreamingNotification="onHlsStreamingNotification";l.SocketEvent.onHlsStreamingNotificationToPublisher="onHlsStreamingNotificationToPublisher";l.SocketEvent.onLiveRecordingNotification="onLiveRecordingNotification";l.SocketEvent.onRoomLiveRecordingOn="room-live-recording-on";l.SocketEvent.onRoomLiveRecordingOff="room-live-recording-off";l.SocketEvent.onRoomLiveRecordingFailed="room-live-recording-failed";
l.SocketEvent.data_stream_room="onDataStreamToRoom";l.RoomEvent.onStreamingNotification="onStreamingNotification";l.RoomEvent.onHlsStreamingNotification="onHlsStreamingNotification";l.RoomEvent.onHlsStreamingNotificationToPublisher="onHlsStreamingNotificationToPublisher";l.RoomEvent.onLiveRecordingNotification="onLiveRecordingNotification";l.UserEvent.user_awaited="user-awaited";l.UserEvent.user_joined="user-joined";l.RoomEvent.room_connected="room-connected";l.RoomEvent.room_disconnected="room-disconnected";
l.RoomEvent.room_awaited="room-awaited";l.RoomEvent.room_record_on="room-record-on";l.RoomEvent.room_record_off="room-record-off";l.RoomEvent.onRoomLiveRecordingOn="room-live-recording-on";l.RoomEvent.onRoomLiveRecordingOff="room-live-recording-off";l.RoomEvent.onRoomLiveRecordingFailed="room-live-recording-failed";l.RoomEvent.update_layout="update-layout";l.RoomEvent.change_layout="change-layout";l.RoomEvent.new_active_talker="active-talkers-updated";l.RoomEvent.hard_mute_audio="hardmute-user-audio";
l.RoomEvent.hard_unmute_audio="hardunmute-user-audio";l.RoomEvent.hard_mute_video="hardmute-user-video";l.RoomEvent.get_active_talker="getNumberOfTalker";l.RoomEvent.set_active_talker="setNumberOfTalker";l.RoomEvent.get_active_max_talker="getMaxNumberOfTalker";l.RoomEvent.set_adavanced_options="setAdvancedOptions";l.RoomEvent.get_adavanced_options="getAdvancedOptions";l.RoomEvent.client_stats="clientStats";l.RoomEvent.switch_user_role="switchUserRole";l.RoomEvent.hard_unmute_video="hardunmute-user-video";
l.RoomEvent.share_started="shareStarted";l.RoomEvent.share_stopped="shareStopped";l.RoomEvent.screen_share_override="shareOverride";l.RoomEvent.streaming_uri="streamingUri";l.RoomEvent.stop_sharing="stopSharing";l.RoomEvent.share_state_events="shareStateEvents";l.RoomEvent.extend_conference_duration="extendConferenceDuration";l.RoomEvent.lock_room="lockRoom";l.RoomEvent.drop="drop";l.RoomEvent.subscriber_video_mute="subscriber-video-mute";l.RoomEvent.switch_codec="switch-publish-media-codec";l.RoomEvent.canvas_started=
"canvasStarted";l.RoomEvent.canvas_stopped="canvasStopped";l.RoomEvent.canvas_state_events="canvasStateEvents";l.RoomEvent.custom_data_saved="CustomDataSaved";l.RoomEvent.custom_data_updated="CustomDataUpdated";l.RoomEvent.transcription_events="transcription-events";l.RoomEvent.invite_breakout_room="invite-breakout-room";l.RoomEvent.user_joined_breakout_room="user-joined-breakout-room";l.RoomEvent.user_left_breakout_room="breakout-user-disconnected";l.RoomEvent.breakout_room_destroyed="breakout-room-destroyed";
l.RoomEvent.generic_events="genericEvents";l.RoomEvent.network_reconnected="network-reconnected";l.RoomEvent.network_disconnected="network-disconnected";l.RoomEvent.network_reconnectiontimeout="network-reconnect-timeout";l.RoomEvent.network_reconnectfailed="network-reconnect-failed";l.RoomEvent.fs_upload_started="fs-upload-started";l.RoomEvent.fs_file_uploaded="fs-file-available";l.RoomEvent.fs_download_started="fs-download-started";l.RoomEvent.fs_file_downloaded="fs-upload-success";l.RoomEvent.fs_file_upload_result=
"fs-upload-result";l.RoomEvent.fs_file_download_result="fs-download-result";l.SocketEvent.floor_management_events="floorManagementEvents";l.SocketEvent.room_management_events="roomManagementEvents";l.UserEvent.user_audio_muted="user-audio-muted";l.UserEvent.user_audio_unmuted="user-audio-unmuted";l.UserEvent.user_video_muted="user-video-muted";l.UserEvent.user_video_unmuted="user-video-unmuted";l.SocketEvent.hard_mute="hardMute";l.SocketEvent.hard_mute_room="room-muted";l.SocketEvent.hard_unmute_room=
"room-unmuted";l.SocketEvent.switched_room="roomSwitched";l.RoomEvent.room_transcription_on="room-transcription-on";l.RoomEvent.room_transcription_off="room-transcription-off";l.RoomEvent.self_transcription_on="self-transcription-on";l.RoomEvent.self_transcription_off="self-transcription-off";l.constant={};l.constant.H264_CODEC="H264_AND_OPUS";l.constant.default="default";l.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8="12.0";l.constant.SAFARI_VERSION_SUPPORTING_VP8="12.1";l.constant.FIREFOX_VERSION_VIDEO_MUTE_SUPPORT=
"60.0";l.constant.CHROME_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT="72.0";l.constant.FIREFOX_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT="66.0";l.constant.SAFARI_VERSION_SCREEN_SHARE_SUPPORT="13.0.0";l.constant.FIREFOX_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT="64.0";l.constant.SAFARI_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT="13.1.0";l.constant.SAFARI_VERSION_DEVICE_CHANGE_EVENT_SUPPORT="11.0.0";r.a=l},function(l,r,p){r.a={error_000:{result:0,msg:"success"},error_1000:{result:1E3,msg:"Non supported browser"},
error_1130:{result:1130,error:"Moderator not present/ wait for Moderator",desc:""},error_1140:{result:1140,error:"Previous similar request in process",desc:""},error_1141:{result:1141,error:"Remote streams can't be muted",desc:""},error_1142:{result:1142,error:"Invalid Device Id",desc:"OverconstrainedError: Invalid device id provided"},error_1143:{result:1143,error:"Requested device not found",desc:"NotFoundError: Requested device was not found"},error_1144:{result:1144,error:"Permission denied",
desc:"NotAllowedError: The request is not allowed by the user agent or the platform in the current context"},error_1145:{result:1145,error:"Could not start video source",desc:"NotReadableError: Could not start video source"},error_1146:{result:1146,error:"Failed to execute getUserMedia on MediaDevices",desc:"TypeError: At least one of audio and video must be requested"},error_1147:{result:1147,error:"Constraints could be not satisfied",desc:"OverconstrainedError: Video width constraint could not be satisfied"},
error_1148:{result:1148,error:"Constraints could be not satisfied",desc:"OverconstrainedError: Video height constraint could not be satisfied"},error_1149:{result:1149,error:"Constraints could be not satisfied",desc:"One of the constraints (Height, Width, DeviceId) is not satisfied."},error_1150:{result:1150,error:"Reason unknown",desc:"Reason unknown"},error_1151:{result:1151,error:"A screen share is already running",desc:""},error_1152:{result:1152,error:"Audio only calls are allowed with your current browser version",
desc:""},error_1153:{result:1153,error:"Unsupported browser",desc:""},error_1154:{result:1154,error:"Given frame rate is not supported",desc:"Frame rate might be negative or not a number which is not accepted by captureStream method"},error_1155:{result:1155,error:"Invalid options/parameters /values",desc:"Invalid options parameters/values "},error_1156:{result:1156,error:"Invalid streamType",desc:" streamType  should be set as canvas for canvas streams and talker for talker streams"},error_1157:{result:1157,
error:"The given canvas element does not exist in the DOM",desc:"The canvas element you have provided does not exist in the DOM"},error_1158:{result:1158,error:"This browser does not support canvas",desc:"This browser does not support canvas"},error_1159:{result:1159,error:"Stream not found",desc:"Stream not found"},error_1160:{result:1160,error:"Media connection failure",desc:"Media connection failure"},error_1161:{result:1161,error:"Server connection failure",desc:"Server connection failure"},error_1162:{result:1162,
error:"The DOM element does not exist",desc:"The element with DOM reference provided does not exist"},error_1163:{result:1163,error:"Network disconnected",desc:"Socket or media connection has failed due to network error"},error_1164:{result:1164,error:"Network reconnected",desc:"Network reconnected"},error_1165:{result:1165,error:"Reconnect attempt exceeded",desc:"Reconnection failed"},error_1166:{result:1166,error:"Reconnection timed out",desc:"Reconnection failed"},error_1167:{result:1167,error:"Publish or subscribe failed",
desc:"After reconnection publish or subscibe failed"},error_1168:{result:1168,error:"Not allowed",desc:"Only moderator has rights to excercise this transaction"},error_1169:{result:1169,msg:"No listener for event",desc:""},error_1170:{result:1170,error:"Not supported",desc:"Feature is not enabled because of room config or no licence "},error_1171:{result:1171,error:"Room not connected",desc:"Room not connected"},error_1172:{result:1172,error:"Room connect failed",desc:"Room connect failed"},error_1173:{result:1173,
error:"Floor not granted for participant",desc:"Floor not granted"},error_1174:{result:1174,error:"Local Recording started already",desc:""},error_1175:{result:1175,error:"Local Recording not started /stream not having media",desc:""},error_1176:{result:1176,error:"Moderator declined right to control media devices ",desc:""},error_1177:{result:1177,error:"MediaDevice state is already in same state",desc:""},error_1178:{result:1178,error:"Reconnection for a single participant in the room is not allowed",
desc:"Reconnection not allowed"},error_1179:{result:1179,error:" files to upload input array size is 0",desc:" empty file transfer is not allowed"},error_1180:{result:1180,error:" room is disconected",desc:" file sharing is not allowed on disconnected rooms"},error_1181:{result:1181,error:" Recieve file operation is not permitted.",desc:" File which you are trying to receive  does not exist."},error_1182:{result:1182,error:"file upload failed",desc:"file upload failed "},error_1183:{result:1183,error:" file download failed ",
desc:" file download failed"},error_1184:{result:1184,error:"user video resolution inavlid range",desc:"user video resolution inavlid range"},error_1185:{result:1185,error:"file upload failed ",desc:"file upload failed because provided file list is empty"},error_1186:{result:1186,error:"file upload failed ",desc:"file size is zero bytes"},error_1187:{result:1187,error:"file upload failed ",desc:"file upload failed because it exceeded max upload limit"},error_1188:{result:1188,error:"current and requested state / value are same",
desc:"current and requested state / value are same"},error_1189:{result:1189,error:"Media operation not allowed in mute state",desc:""},error_4121:{result:4121,error:"room already locked / unlocked",desc:" room is already locked/unlocked"},error_7000:{result:7E3,error:"streaming error",desc:" streaming error"},error_7008:{result:7008,error:"streaming error",desc:"only moderator can start streaming"},error_7009:{result:7009,error:"streaming error",desc:"invalid or undefined streaming configuration"},
error_7101:{result:7101,error:"streaming error",desc:"rtmpUrl should not exceed more than 3 values"},error_7102:{result:7102,error:"streaming error",desc:"invalid rtmp or url format"},error_7103:{result:7103,error:"streaming error",desc:"room is disconnecting, cannot start streaming"},error_7044:{result:7044,error:"streaming error",desc:"only moderator can stop streaming"},error_7045:{result:7045,error:"streaming error",desc:"room is disconnecting, streaming will be stopped"},error_7072:{result:7072,
error:"streaming params change error",desc:"only moderator can change streaming params"},error_7078:{result:7078,error:"streaming params change error",desc:"room is disconnecting, cannot change streaming params"},error_7201:{result:7201,error:"live recording error",desc:"only moderator can start live recording"},error_7202:{result:7202,error:"live recording error",desc:"invalid url format"},error_7203:{result:7203,error:"live recording error",desc:"room is disconnecting, cannot start live recording"},
error_7204:{result:7204,error:"live recording error",desc:"live recording error"},error_7036:{result:7036,error:"live recording error",desc:"only moderator can stop live recording"},error_7037:{result:7037,error:"live recording error",desc:"room is disconnecting, live recording will be stopped"},error_7079:{result:7079,error:"room is disconected",desc:"Layout update is not allowed on disconnected rooms"},error_7071:{result:7071,error:"live recording error",desc:"only moderator can change live recording params"},
error_8000:{result:8E3,error:"invalidate transcoding error",desc:"Room is disconnecting, invalidate transcoding cannot be performed now"},error_8001:{result:8001,error:"Live transcription is already in progress",desc:"Live transcription is already in progress"},error_8002:{result:8002,error:"Live transcription is not running",desc:"Live transcription is not started"},CC002:{cause:2002,msg:"unexpected-disconnection"},CC006:{cause:2006,msg:"normal-disconnect"},error_1190:{result:1190,error:"Exception found",
desc:"Could not fetch video size"},error_1191:{result:1191,error:"Stream track ended state ",desc:"Stream track is already ended"},error_1192:{result:1192,error:"Invalid parameters",desc:"Invalid value for layout parameter"},error_1193:{result:1193,error:"Invalid parameters",desc:"Invalid value for service parameter"},error_1194:{result:1194,error:"Invalid parameters",desc:"Invalid value for clients parameter"},error_1195:{result:1195,error:"Large text Data",desc:"Failed to handle larger text-data"},
error_1196:{result:1196,error:"content-length value exceeded.",desc:"Entered value of content-length exceeded the maximum allowed value."},error_1197:{result:1197,error:"stream Invalid state .",desc:"room not published or already stream in published."}}},function(l,r,p){(function(f){var q=p(37),k=p(38),e=p(39),a=p(0),b=p(27),h=p(6),x=p(5),d=p(8),u=p(9),n=103,l,w=!1,t={deviceList:void 0},v=function(){var a="none";"undefined"!==typeof f&&f.exports?a="fake":null!==window.navigator.userAgent.match("Firefox")?
a="mozilla":null!==window.navigator.userAgent.match("Chrome")?(a="chrome-stable",null!==window.navigator.userAgent.match("Electron")?a="electron":null!==window.navigator.userAgent.match("Edge")&&(a="edge")):null!==window.navigator.userAgent.match("Safari")?a="safari":null!==window.navigator.userAgent.match("AppleWebKit")?a="safari":null!==window.navigator.userAgent.match(".NET")&&(a="IE");return a},D=function(){var a=navigator.userAgent,d=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||
[];if(/trident/i.test(d[1])){var c=/\brv[ :]+(\d+)/g.exec(a)||[];return"IE "+(c[1]||"")}if("Chrome"===d[1]&&(c=a.match(/\b(OPR|Edge)\/(\d+)/),null!=c))return c.slice(1).join(" ").replace("OPR","Opera");d=d[2]?d[2]:navigator.appVersion;null!=(c=a.match(/version\/([^\s]+)/i))&&(d=c[1]);return d},G=function(a){var d=D();if("string"!==typeof a)return!1;d=d.split(".");a=a.split(".");for(var c=Math.min(d.length,a.length),g=0;g<c;++g){d[g]=parseInt(d[g],10);a[g]=parseInt(a[g],10);if(d[g]>a[g])return!1;if(d[g]<
a[g])return!0}return d.length==a.length?!1:!(d.length<a.length)},A=function(a,d){for(var c={cam:[],mic:[],speaker:[]},g=0;g<a.length;g++)switch(a[g].kind){case "audioinput":d.mic&&c.mic.push(a[g]);break;case "videoinput":d.cam&&c.cam.push(a[g]);break;case "audiooutput":d.speaker&&c.speaker.push(a[g])}return c},F=function(a){var d={cam:[],mic:[],speaker:[]},c={cam:[],mic:[],speaker:[]},g={cam:[],mic:[],speaker:[]};if(void 0!==t.deviceList){c=JSON.parse(JSON.stringify(t.deviceList));for(var b in a.cam){var e=
!1,h;for(h in c.cam)a.cam[b].deviceId===c.cam[h].deviceId&&(g.cam.push(c.cam.splice(h,1)[0]),e=!0);!1===e&&d.cam.push(a.cam[b])}for(var f in a.mic){e=!1;for(var n in c.mic)a.mic[f].groupId===c.mic[n].groupId&&(g.mic.push(c.mic.splice(n,1)[0]),e=!0);!1===e&&d.mic.push(a.mic[f])}for(var k in a.speaker){e=!1;for(var u in c.speaker)a.speaker[k].groupId===c.speaker[u].groupId&&(g.speaker.push(c.speaker.splice(u,1)[0]),e=!0);!1===e&&d.speaker.push(a.speaker[k])}t.deviceList=a}return{current:g,added:d,removed:c}},
c=function(e,f,n){n=void 0===n?!0:n;"IE"===v()||"edge"===v()?(u.a.error("agent-event",d.a.event_incompatible_browser,{error:h.a.error_1153}),f(null,h.a.error_1153)):w&&"safari"===v()?f("success",null):navigator.mediaDevices.getUserMedia(e).then(function(a){w=!0;f(a,null)}).catch(function(g){g=Object(b.a)(g);u.a.error("agent-event",d.a.event_gum_failed,{error:g});if(!n||g.result!==h.a.error_1143.result&&g.result!==h.a.error_1144.result)a.a.error("Failed to get media devices : "+JSON.stringify(g)),
f(null,g);else if(e.video&&e.audio){var k=JSON.parse(JSON.stringify(e));k.video=!1;k.videoConfigured=e.video;a.a.warning("getUserMedia() failed with error: "+JSON.stringify(g)+" retry with audio-only");c(k,f)}else e.video||void 0==e.videoConfigured?(a.a.error("Failed to get media devices permission: "+JSON.stringify(g)),f(null,g)):(k=JSON.parse(JSON.stringify(e)),k.video=e.videoConfigured,k.audio=!1,console.log("getUserMedia() failed with error: "+JSON.stringify(g)+" retry with video-only"),c(k,f))})},
Q=function(a){navigator.mediaDevices.enumerateDevices().then(function(d){a(d)})},z=function(d,b){var e={};void 0!==d?(e.mic=void 0!=d.mic?d.mic:!1,e.cam=void 0!=d.cam?d.cam:!1,e.speaker=void 0!=d.speaker?d.speaker:!1):e={mic:!0,cam:!0,speaker:!0};a.a.debug("getDeviceList ops: "+JSON.stringify(d)+" media ops: "+JSON.stringify(e));e.mic||e.cam?c({audio:e.mic,video:e.cam},function(a,d){a||d&&d.result===h.a.error_1145.result?Q(function(a,g){a?(a=A(a,e),b({result:0,devices:a})):b(d&&d.result===h.a.error_1145.result?
d:g)}):b(d)}):e.speaker?Q(function(a,d){a&&(a=A(a,e),b({result:0,devices:a}))}):b(h.a.error_1155)},J=function(){return document.getElementById("WebrtcEverywherePluginId")},M=function(a,d,c,g){a.addEventListener(d,c,g)};r.a={GetUserMedia:function(c,b,e){b=void 0===b?function(){}:b;e=void 0===e?function(){}:e;var g,h=v();if("chrome-stable"===h||"electron"===h||"mozilla"===h||"safari"===h){var n=function(a,d,g){navigator.mediaDevices.getUserMedia(a).then(d).catch(g)};var k=function(a,d,g){navigator.getDisplayMedia?
navigator.getDisplayMedia({video:!0}).then(d).catch(g):navigator.mediaDevices.getDisplayMedia(a).then(d).catch(g)}}else n=navigator.getUserMedia=function(a,d,g){"complete"!==document.readyState?l||(l=!0,M(document,"readystatechange",function(){l&&"complete"==document.readyState&&(l=!1,J().getUserMedia(a,d,g))})):J().getUserMedia(a,d,g)};h=function(){a.a.debug("Screen access requested");switch(v()){case "electron":a.a.debug("Screen sharing in Electron");g={};g.video=c.video||{};g.video.mandatory=c.video.mandatory||
{};g.video.mandatory.chromeMediaSource="screen";n(g,b,e);break;case "mozilla":a.a.debug("Screen sharing in Firefox max fps: 5");g={};void 0!==c.video?(g.video={},g.video.mediaSource="window"):g={audio:c.audio,video:{mediaSource:"window"}};G(x.a.constant.FIREFOX_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT)?n(g,b,e):(g.video={framerate:{max:c.fps}},k(g,b,e));break;case "safari":G(x.a.constant.SAFARI_VERSION_SCREEN_SHARE_SUPPORT)?(a.a.error("Screen Sharing not supported for safari version: "+D()),u.a.error("agent-event",
d.a.event_incompatible_browser,{error:"This safari version does not support ScreenSharing"})):(a.a.debug("Screen sharing  Safari "),k({video:!0},b,e));break;case "chrome-stable":a.a.debug("Screen sharing in Chrome");g={};if(c.desktopStreamId)g.video=c.video||{mandatory:{}},g.video.mandatory=g.video.mandatory||{},g.video.mandatory.chromeMediaSource="desktop",g.video.mandatory.chromeMediaSourceId=c.desktopStreamId,g.video.mandatory.chromeMediaSourceId=c.desktopStreamId,n(g,b,e);else if(G(x.a.constant.CHROME_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT)){var h=
"apedaiecomcfkjdjbnkfcdafaikkdkeo";c.extensionId&&(a.a.debug("extensionId supplied, using "+c.extensionId),h=c.extensionId);a.a.debug("Screen access on chrome stable, looking for extension");try{chrome.runtime.sendMessage(h,{getStream:!0},function(d){void 0===d?(a.a.error("Access to screen denied"),e({code:"Access to screen denied"})):(d=d.streamId,void 0!==c.video.mandatory?(g.video=c.video,g.video.mandatory.chromeMediaSource="desktop",g.video.mandatory.chromeMediaSourceId=d):g={video:{mandatory:{maxFrameRate:c.fps,
chromeMediaSource:"desktop",chromeMediaSourceId:d}}},n(g,b,e))})}catch(K){a.a.debug("Screensharing plugin is not accessible "),u.a.error("agent-event",d.a.event_incompatible_browser,{error:"Screensharing plugin is not accessible"}),e({code:"no_plugin_present"})}}else a.a.debug("Screen sharing in Chrome without extension max Fps:: 3"),g.video={frameRate:{max:c.fps}},void 0!=c.audio&&!1!==c.audio&&(g.audio=!0),k(g,b,e);break;default:a.a.error("This browser does not support ScreenSharing"),u.a.error("agent-event",
d.a.event_incompatible_browser,{error:"This browser does not support ScreenSharing"})}};c.screen?h():"undefined"!==typeof f&&f.exports?a.a.error("Video/audio streams not supported in controller yet"):(a.a.debug("Calling getUserMedia with config",JSON.stringify(c)),n(c,b,e))},buildPair:function(c){var b={};n+=1;c.sessionId=n;b.browser=v();if("fake"===b.browser)a.a.warning("Publish/subscribe video/audio streams not supported in media yet"),u.a.warn("agent-event",d.a.event_incompatible_browser,{error:"Publish/subscribe video/audio streams not supported in media yet"}),
b=Object(e.a)(c);else if("mozilla"===b.browser)a.a.debug("Firefox Stack"),b=Object(k.a)(c);else if("safari"===b.browser)a.a.debug("Safari using Chrome Stable Stack"),b=Object(q.a)(c);else if("chrome-stable"===b.browser||"electron"===b.browser)a.a.debug("Chrome Stable Stack"),b=Object(q.a)(c);else if("IE"===b.browser)a.a.debug("IE using Chrome Stable Stack"),b=Object(q.a)(c);else throw a.a.error("No stack available for this browser"),u.a.error("agent-event",d.a.event_incompatible_browser,{error:"No stack available for this browser"}),
Error("WebRTC stack not available");b.updateSpec||(b.updateSpec=function(c,g){g=void 0===g?function(){}:g;a.a.error("Update Configuration not implemented in this browser");u.a.error("agent-event",d.a.event_incompatible_browser,{error:"Update Configuration not implemented in this browser"});g("unimplemented")});return b},browserEngineCheck:v,getAndroidVersion:function(){var a=navigator.userAgent;return 0<=a.indexOf("Android")?parseFloat(a.slice(a.indexOf("Android")+8)):!1},mediaDeviceUpdate:function(a,
d,c){void 0!=t.changedDevicesCallbacks?(void 0!=d&&1==d&&(t.changedDevicesCallbacks=[]),t.changedDevicesCallbacks.push(c)):(void 0===t.deviceList&&z(a,function(a){t.deviceList=a.devices}),t.changedDevicesCallbacks=[],t.changedDevicesCallbacks.push(c),"safari"===v()&&G(x.a.constant.SAFARI_VERSION_DEVICE_CHANGE_EVENT_SUPPORT)?setInterval(function(){z(a,function(a){if(void 0===t.deviceList)t.deviceList=a.devices;else{var d=F(a.devices);t.changedDevicesCallbacks.forEach(function(a){return a(d)})}})},
3E3):navigator.mediaDevices.ondevicechange=function(d){if(void 0==t.receivedDC||1!=t.receivedDC)t.receivedDC=!0,setTimeout(function(){t.receivedDC=!1;z(a,function(a){if(0==a.result)if(void 0===t.deviceList)t.deviceList=a.devices;else{var d=F(a.devices);t.changedDevicesCallbacks.forEach(function(a){return a(d)})}else console.log("ondevicechange() getDeviceList failed error: "+JSON.stringify(a))})},500)})},getDeviceList:z,getBrowserVersion:D,GetCanvasStream:function(c,b,e){b=void 0===b?function(){}:
b;e=void 0===e?function(){}:e;var g=null,f=null,n=v();if(c.canvas)if("chrome-stable"===n||"mozilla"===n||"safari"===n){if(void 0!==c.canvas.fps&&0<c.canvas.fps)var k=c.canvas.fps;else if(void 0!==c.canvas.fps){a.a.error("Framerate is invalid is: ",c.canvas.fps);e(h.a.error_1154);u.a.error("agent-event",d.a.event_incompatible_browser,{error:h.a.error_1154});return}c=c.canvas.canvasId;try{(g=document.querySelector("#"+c))&&(g instanceof HTMLMediaElement||g instanceof HTMLCanvasElement)?(f=g.captureStream(g instanceof
HTMLCanvasElement?k:void 0))?b(f):(a.a.error("captureStream() failed . canvasFps : ",k),e(h.a.error_1159),u.a.error("agent-event",d.a.event_incompatible_browser,{error:h.a.error_1159})):(a.a.error("DOM Element does not exists/ not a Media Element. DomId is: ",c),u.a.error("agent-event",d.a.event_incompatible_browser,{error:h.a.error_1157}),e(h.a.error_1157))}catch(ba){a.a.error("DOM Element does not exists/ not a Media Element. DomId is: ",c),e(h.a.error_1157),u.a.error("agent-event",d.a.event_incompatible_browser,
{error:h.a.error_1157,exception:"Canvas chrome err: "+JSON.stringify(ba)})}}else a.a.error(" getCanvasStream() This browser does not support canvas"),e(h.a.error_1158),u.a.error("agent-event",d.a.event_incompatible_browser,{error:h.a.error_1154});else a.a.error(" getCanvasStream() is called without canvas options"),u.a.error("agent-event",d.a.event_incompatible_browser,{error:"Canvas called without options"}),e(h.a.error_1155)},isCurrentVerLess:G,getSupportedDeviceConstraints:function(){return navigator.mediaDevices.getSupportedConstraints()}}}).call(r,
p(36)(l))},function(l,r,p){r.a={event_ice_failed:{event_code:"4000",severity:"critical",event_name:"ice-failed",event_description:"ICE failed"},event_ice_success:{event_code:"40001",severity:"",event_name:"ice-success",event_description:"ICE success"},event_stream_subscribe_failed:{event_code:"4001",severity:"critical",event_name:"stream-subscribe-failed",event_description:"Failed to subscribe to stream"},event_stream_subscribe_success:{event_code:"40011",severity:"",event_name:"stream-subscribe-success",
event_description:"Subscribe to stream successful"},event_stream_unsubscribe_failed:{event_code:"4002",severity:"critical",event_name:"stream-unsubscribe-failed",event_description:"Failed to unsubscribe from stream"},event_stream_unsubscribe_success:{event_code:"40021",severity:"",event_name:"stream-unsubscribe-success",event_description:"Unsubscribe from stream success"},event_socket_connect_failed:{event_code:"4003",severity:"critical",event_name:"socket-connect-failed",event_description:"Socket connection failed"},
event_socket_connect_success:{event_code:"40031",severity:"",event_name:"socket-connect-success",event_description:"Socket connection successful"},event_stream_publish_failed:{event_code:"4004",severity:"critical",event_name:"stream-publish-failed",event_description:"Failed to publish stream"},event_stream_publish_success:{event_code:"40041",severity:"",event_name:"stream-publish-success",event_description:"stream published successfully"},event_stream_unpublish_failed:{event_code:"4005",severity:"critical",
event_name:"stream-unpublish-failed",event_description:"Failed to unpublish stream"},event_stream_unpublish_success:{event_code:"40051",severity:"",event_name:"stream-unpublish-success",event_description:"Unpublish stream success"},event_start_recording_failed:{event_code:"4006",severity:"critical",event_name:"start-recording-failed",event_description:"Failed to start recording"},event_start_recording_success:{event_code:"40061",severity:"",event_name:"start-recording-success",event_description:"Start recording success"},
event_start_local_recording_failed:{event_code:"40062",severity:"critical",event_name:"start-local-recording-failed",event_description:"Failed to start local recording"},event_start_local_recording_success:{event_code:"40063",severity:"",event_name:"start-local-recording-success",event_description:"Start local recording success"},event_stop_recording_failed:{event_code:"4007",severity:"critical",event_name:"stop-recording-failed",event_description:"Failed to stop recording"},event_stop_recording_success:{event_code:"40071",
severity:"",event_name:"stop-recording-success",event_description:"Stop recording success"},event_stop_local_recording_failed:{event_code:"40072",severity:"critical",event_name:"stop-local-recording-failed",event_description:"Failed to stop local recording"},event_stop_local_recording_success:{event_code:"40073",severity:"",event_name:"stop-local-recording-success",event_description:"Stop local recording success"},event_start_screenshare_failed:{event_code:"4008",severity:"critical",event_name:"start-screenshare-failed",
event_description:"Failed to start screenshare"},event_start_screenshare_success:{event_code:"40081",severity:"",event_name:"start-screenshare-success",event_description:"Screenshare Start successfully"},event_stop_screenshare_failed:{event_code:"4009",severity:"critical",event_name:"stop-screenshare-failed",event_description:"Failed to stop screenshare"},event_stop_screenshare_success:{event_code:"40091",severity:"",event_name:"stop-screenshare-success",event_description:"Screenshare stopped successfully"},
event_start_canvas_failed:{event_code:"4010",severity:"critical",event_name:"start-canvas-failed",event_description:"Failed to start canvas"},event_start_canvas_success:{event_code:"40101",severity:"",event_name:"start-canvas-success",event_description:"Canvas started successfully"},event_stop_canvas_failed:{event_code:"4011",severity:"critical",event_name:"stop-canvas-failed",event_description:"Failed to stop canvas"},event_stop_canvas_success:{event_code:"40111",severity:"",event_name:"stop-canvas-success",
event_description:"Canvas stopped successfully"},event_network_reconnect_timeout:{event_code:"4012",severity:"high",event_name:"network-reconnect-timeout",event_description:"Reconnection timed out"},event_start_annotation_failed:{event_code:"4012",severity:"high",event_name:"start-annotation-failed",event_description:"Start Annotation Failed"},event_start_annotation_success:{event_code:"40121",severity:"high",event_name:"start-annotation-success",event_description:"Start Annotation successful"},event_stop_annotation_failed:{event_code:"4013",
severity:"high",event_name:"stop-annotation-failed",event_description:"Stop Annotation Failed"},event_stop_annotation_success:{event_code:"40131",severity:"high",event_name:"stop-annotation-success",event_description:"Stop Annotation successful"},event_send_message_failed:{event_code:"4013",severity:"high",event_name:"send-message-failed",event_description:"Failed to send message"},event_send_message_success:{event_code:"40131",severity:"",event_name:"send-message-success",event_description:"Send message success"},
event_reconnect_socket_failed:{event_code:"4014",severity:"high",event_name:"reconnect-socket-failed",event_description:"Failed to reconnect socket"},event_reconnect_socket_success:{event_code:"40141",severity:"",event_name:"reconnect-socket-success",event_description:"Socket reconnection success"},event_send_data_failed:{event_code:"4018",severity:"high",event_name:"send-data-failed",event_description:"Failed to send data"},event_send_data_success:{event_code:"40181",severity:"",event_name:"send-data-success",
event_description:"Send data success"},event_media_access_denied:{event_code:"4019",severity:"critical",event_name:"media-access-denied",event_description:"Access to media denied"},event_media_access_success:{event_code:"40191",severity:"",event_name:"media-access-allowed-success",event_description:"User has granted access to local media."},event_agent_media_access_denied:{event_code:"40192",severity:"critical",event_name:"agent-media-access-denied-failed",event_description:"Access to media denied (Agent)"},
event_gum_failed:{event_code:"4020",severity:"critical",event_name:"gum-failed",event_description:"Get User Media failed"},event_gum_success:{event_code:"40201",severity:"",event_name:"gum-success",event_description:"Get User Media success"},event_agent_gum_failed:{event_code:"40201",severity:"critical",event_name:"agent-gum-failed",event_description:"Get User Media failed (Agent)"},event_audio_device_access_failed:{event_code:"4021",severity:"critical",event_name:"audio-device-access-failed",event_description:"Failed to access Audio device"},
event_agent_audio_device_access_failed:{event_code:"40211",severity:"critical",event_name:"agent-audio-device-access-failed",event_description:"Failed to access Audio device (Agent)"},event_video_device_access_failed:{event_code:"4022",severity:"critical",event_name:"video-device-access-failed",event_description:"Failed to access Video device"},event_agent_video_device_access_failed:{event_code:"40221",severity:"critical",event_name:"agent-video-device-access-failed",event_description:"Failed to access Video device (Agent)"},
event_remote_canvas_stream_failed:{event_code:"4023",severity:"high",event_name:"remote-canvas-stream-failed",event_description:"Remote canvas stream failed"},event_capture_canvas_stream_failed:{event_code:"4024",severity:"critical",event_name:"capture-canvas-stream-failed",event_description:"Failed to capture canvas stream"},event_set_local_description:{event_code:"4025",severity:"none",event_name:"set-local-description",event_description:"Local SDP description is set"},event_set_remote_description:{event_code:"4026",
severity:"none",event_name:"set-remote-description",event_description:"Remote SDP description is set"},event_reconnect_subscribe_failed:{event_code:"4027",severity:"high",event_name:"reconnect-subscribe-failed",event_description:"Failed to subscribe while reconnecting"},event_reconnect_publish_failed:{event_code:"4028",severity:"high",event_name:"reconnect-publish-failed",event_description:"Failed to publish while reconnecting"},event_incompatible_browser:{event_code:"4029",severity:"high",event_name:"incompatible-browser",
event_description:"Browser is incompatible"},event_connect_socket_failed:{event_code:"4030",severity:"high",event_name:"connect-socket-failed",event_description:"Socket connection failed"},event_connect_socket_success:{event_code:"40301",severity:"",event_name:"connect-socket-success",event_description:"Socket connection successful"},event_room_reconnection_failed:{event_code:"4031",severity:"high",event_name:"room-reconnection-failed",event_description:"Room reconnection failed"},event_room_reconnection_success:{event_code:"40311",
severity:"",event_name:"room-reconnection- success",event_description:"Room reconnection success"},event_room_disconnection_failed:{event_code:"4032",severity:"high",event_name:"room-disconnection-failed",event_description:"Room disconnection failed"},event_room_disconnection_success:{event_code:"40321",severity:"",event_name:"room-disconnection-success",event_description:"Room disconnection success"},event_mute_self_audio_failed:{event_code:"4033",severity:"high",event_name:"mute-self-audio-failed",
event_description:"mute self audio failed"},event_mute_self_audio_success:{event_code:"40331",severity:"",event_name:"mute-self-audio-success",event_description:"mute self audio success"},event_unmute_self_audio_failed:{event_code:"4034",severity:"high",event_name:"unmute-self-audio-failed",event_description:"unmute self audio failed"},event_unmute_self_audio_success:{event_code:"40341",severity:"",event_name:"unmute-self-audio-success",event_description:"unmute self audio success"},event_room_mute_failed:{event_code:"4035",
severity:"high",event_name:"room-mute-failed",event_description:"room mute failed"},event_room_mute_success:{event_code:"40351",severity:"",event_name:"room-mute-success",event_description:"room mute success"},event_room_unmute_failed:{event_code:"4036",severity:"high",event_name:"room-unmute-failed",event_description:"room unmute failed"},event_room_unmute_success:{event_code:"40361",severity:"",event_name:"room-unmute-success",event_description:"room unmute success"},event_file_shared_failed:{event_code:"4037",
severity:"high",event_name:"file-shared-failed",event_description:"file shared failed"},event_file_shared_success:{event_code:"40371",severity:"",event_name:"file-shared-success",event_description:"file shared success"},event_file_download_failed:{event_code:"4038",severity:"high",event_name:"file-downlod-failed",event_description:"file download failed"},event_file_download_success:{event_code:"40381",severity:"",event_name:"file-downlod-success",event_description:"file downlod success"},event_mute_self_video_failed:{event_code:"4039",
severity:"high",event_name:"mute-self-video-failed",event_description:"mute self video failed"},event_mute_self_video_success:{event_code:"40391",severity:"",event_name:"mute-self-video-success",event_description:"mute self video success"},event_unmute_self_video_failed:{event_code:"4040",severity:"high",event_name:"unmute-self-video-failed",event_description:"unmute self video failed"},event_unmute_self_video_success:{event_code:"40401",severity:"",event_name:"unmute-self-video-success",event_description:"unmute self video failed"},
event_low_bandwidth_update:{event_code:"4041",severity:"",event_name:"low-bandwidth-update",event_description:"low bandwidth update"},event_network_change:{event_code:"4042",severity:"",event_name:"network-change",event_description:"network change"},event_connection_lost:{event_code:"4043",severity:"",event_name:"connection-lost",event_description:"connection lost"},event_make_outbound_call_failed:{event_code:"4044",severity:"high",event_name:"make-outbound-call-failed",event_description:"Outbound call failed"},
event_make_outbound_call_success:{event_code:"40441",severity:"",event_name:"make-outbound-call-success",event_description:"Outbound call success"},event_make_outbound_call_state:{event_code:"4045",severity:"",event_name:"make-outbound-call-state",event_description:"Outbound call state"},event_abwd_mute_video_success:{event_code:"4101",severity:"",event_name:"mute-publisher-video-success",event_description:"Publisher video muted due to low bandwidth"},event_fs_upload_started_success:{event_code:"4102",
severity:"",event_name:"fs-upload-started-success",event_description:"File is being shared"},event_fs_file_available_success:{event_code:"4103",severity:"",event_name:"fs-file-available-success",event_description:"File is being shared"},event_room_user_connect_failed:{event_code:"4104",severity:"",event_name:"room-user-connect-failed",event_description:"User connection to the Room failed"},event_room_user_connect_success:{event_code:"41041",severity:"",event_name:"room-user-connect-success",event_description:"A new user is connected to the Room"},
event_room_user_disconnect_failed:{event_code:"4105",severity:"",event_name:"room-user-disconnect-failed",event_description:"User disconnection to the Room failed"},event_room_user_disconnect_success:{event_code:"41051",severity:"",event_name:"room-user-disconnect-success",event_description:"User is disconnected to the Room"},event_start_live_recording_failed:{event_code:"4046",severity:"critical",event_name:"start-live-recording-failed",event_description:"Failed to start live recording"},event_start_live_recording_success:{event_code:"40461",
severity:"",event_name:"start-live-recording-success",event_description:"Start live recording success"},event_stop_live_recording_failed:{event_code:"4047",severity:"critical",event_name:"stop-live-recording-failed",event_description:"Failed to stop live recording"},event_stop_live_recording_success:{event_code:"40471",severity:"",event_name:"stop-live-recording-success",event_description:"Stop live recording success"},event_live_recording_param_change_failed:{event_code:"40472",severity:"",event_name:"live-recording-param-change-failed",
event_description:"live recording params change failed"},event_live_recording_param_change_success:{event_code:"40473",severity:"",event_name:"live-recording-param-change-success",event_description:"live recording params change success"},event_streaming_param_change_failed:{event_code:"40474",severity:"",event_name:"Streaming-param-change-failed",event_description:"Streaming params change failed"},event_streaming_param_change_success:{event_code:"40475",severity:"",event_name:"Streaming-param-change-success",
event_description:"Streaming params change success"},event_general_failed:{event_code:"4106",severity:"critical",event_name:"general-failed",event_description:"General error"},event_general_success:{event_code:"41061",severity:"",event_name:"general-success",event_description:"General success"},event_stream_player_failed:{event_code:"4107",severity:"critical",event_name:"player-play-failed",event_description:"player div is not playing the video"}}},function(l,r,p){var f=p(0);l=p(1);var q=p.n(l);p=
function(){var k={eventLoggerToken:void 0,eventServer:{},logID:void 0,eventBuffer:[],uniqueSequence:1,clientId:void 0};switch(q.a.eventLogLevel){case "trace":k.logLevel=2;break;case "debug":k.logLevel=1;break;case "info":k.logLevel=3;break;case "warn":k.logLevel=4;break;case "error":k.logLevel=5;break;default:k.logLevel=6}k.init=function(e){try{e.eventServer&&e.eventServer.url&&(k.eventServer.url=e.eventServer.url,k.logID=e.logId)}catch(a){f.a.error("Error! Failed to send auth request to Event Server. Error: "+
a+".")}};k.log=function(e,a){try{if(!(e<k.logLevel)){f.a.debug("EventLogger.log event SENT"+JSON.stringify(a));var b=(new Date).toISOString(),h="info",x={};switch(e){case 1:h="debug";break;case 2:h="trace";break;case 3:h="info";break;case 4:h="warning";break;case 5:h="error";break;default:h="info"}x.key={logID:k.logID,endpointType:"client",instanceID:k.logID,uniqueSequence:k.uniqueSequence++};x.severity=a.event?a.event.severity:"none";x.eventLevel=[];x.eventLevel.push(h);x.eventLevel.push(a.source);
x.eventMeta={};x.eventMeta.event=a.event;x.eventMeta.meta=a.meta;x.isAnonymousInfo=!0;x.sourceTimeStamp=b;if(k.eventServer.url&&k.eventLoggerToken){var d=new XMLHttpRequest;d.onreadystatechange=function(){4===this.readyState&&200===this.status?f.a.info(this.responseText):f.a.error("Connection to Event Server did not establish. readyState: "+this.readyState+" Status: "+this.status)};d.open("POST","https://"+k.eventServer.url+"/event",!0);d.setRequestHeader("Content-Type","application/json");d.setRequestHeader("eventToken",
k.eventLoggerToken);d.send(JSON.stringify(x))}else k.eventBuffer.push(x)}}catch(u){f.a.error("Error! Failed to post log event to Event Server. Error: "+u+".")}};k.debug=function(e,a,b){k.log(1,{source:e,event:a,meta:b})};k.trace=function(e,a,b){k.log(2,{source:e,event:a,meta:b})};k.info=function(e,a,b){k.log(3,{source:e,event:a,meta:b})};k.warn=function(e,a,b){k.log(4,{source:e,event:a,meta:b})};k.error=function(e,a,b){void 0!=b.error&&"object"!=typeof b.error&&(b.error={errorDesc:b.error});k.log(5,
{source:e,event:a,meta:b})};k.close=function(){};k.revalidate=function(){};k.processBufferEvents=function(){for(var e=0;e<k.eventBuffer.length;e++){var a=k.eventBuffer[e],b=new XMLHttpRequest;b.onreadystatechange=function(){4==this.readyState&&200==this.status?f.a.info(this.responseText):f.a.error("Connection to Event Server did not establish. Status: "+this.status)};b.open("POST","https://"+k.eventServer.url+"/event",!0);b.setRequestHeader("Content-Type","application/json");b.setRequestHeader("eventToken",
k.eventLoggerToken);b.send(JSON.stringify(a))}};k.setClientId=function(e){k.clientId=e};k.setEventLoggerToken=function(e){e&&(k.eventLoggerToken=e,k.eventLoggerToken&&k.eventServer&&k.eventServer.url&&k.processBufferEvents())};return k}();r.a=p},function(l,r,p){r.a={vcx_player:{width:"inherit",height:"inherit",position:"relative","background-color":"black",overflow:"hidden"},vcx_player_loader:{width:"100%",height:"100%",position:"absolute"},vcx_player_screen_saver:{width:"100%",height:"100%",position:"absolute",
"z-index":"1"},vcx_stream:{width:"inherit !important",height:"inherit !important",position:"absolute","object-fit":"cover"},default_vcx_bar:{height:"100%",width:"100%",position:"absolute"},vcx_subbar_bottom:{width:"100%",height:"15%","max-height":"33px",color:"#aaa",position:"absolute",bottom:0,"background-repeat":"repeat-x;","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)",transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)",
"background-position":"bottom","padding-top":"50px","z-index":2},vcx_subbar_top:{width:"100%",height:"15%","max-height":"30px",color:"#aaa",position:"absolute",top:0,"background-repeat":"repeat-x",transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"top !important","padding-bottom":"50px","z-index":2},vcx_subbar_left:{width:"15%",height:"100%","max-width":"30px",
color:"#aaa",position:"absolute",left:0,"background-repeat":"repeat-x",transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"bottom"},vcx_subbar_right:{width:"15%",height:"100%","max-width":"30px",color:"#aaa",position:"absolute",right:0,transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)",
"-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"bottom"},brand_logo:{"max-width":"30px","max-height":"30px",cursor:"pointer",position:"absolute",right:"0px",margin:"5px"},theater_view:{width:"100% !important",height:"80% !important"},full_view:{width:"100% !important",height:"100% !important",top:"0px",left:"0px",position:"fixed !important","z-index":3},icon:{margin:"7px","max-width":"30px",cursor:"pointer"},icon_record:{color:"#f00"},icon_volume:{color:"#aaa"},
icon_play:{color:"#aaa"},icon_mic:{color:"#aaa"},icon_zoom:{color:"#aaa"},icon_share:{color:"#aaa"}}},function(l,r,p){var f=p(7),q=p(4),k=p(40),e=p(14),a=p(52),b=p(3),h=p(53),x=p(19),d=p(0),u=p(5),n=p(6);l=p(1);var B=p.n(l),w=p(8),t=p(9),v=p(16),D=p(56),G=p(61),A=p(62),F=p(67),c=["user","owner","room","session"],Q=["all","none"],z=!0,J;window.statsIcon='<svg  viewBox="0 0 16 16" width="16" height="16" xml:space="preserve" fill="green"><rect height="6" width="4" y="10"/><rect height="10" width="4" x="6" y="6"/><rect height="16" width="4" x="12"/></svg>';
window.lowBwIcon='<svg id="icon_low_bw" height="20" viewBox="0 0 24 24" width="20" title="Low Bandwidth"><path d="m16.155 13.799-5.284 7.908c-.43.665.048 1.542.84 1.542h10.507c.789 0 1.268-.872.843-1.538l-5.223-7.908c-.392-.613-1.288-.616-1.683-.004z" fill="#ffc107"/><path fill="#f44236" d="m22.288 24.031h-10.576c-.944 0-1.712-.747-1.712-1.665 0-.333.098-.647.281-.908l5.271-8.206c.294-.479.852-.784 1.448-.784s1.154.305 1.456.796l5.28 8.221c.166.235.264.549.264.882 0 .918-.768 1.664-1.712 1.664zm-5.288-10.062c-.088 0-.154.042-.179.082l-5.296 8.245c-.025.148.062.235.187.235h10.576c.125 0 .212-.087.212-.165 0-.027-.006-.042-.008-.044l-5.306-8.26c-.032-.051-.098-.093-.186-.093z"/><path fill="#f44236" d="m17 19.719c-.414 0-.75-.336-.75-.75v-1.917c0-.414.336-.75.75-.75s.75.336.75.75v1.917c0 .414-.336.75-.75.75z"/><ellipse cx="17" cy="21.365" rx=".75" ry=".719"/><path fill="#f44236" d="m.75 24c-.414 0-.75-.336-.75-.75v-7.5c0-.414.336-.75.75-.75s.75.336.75.75v7.5c0 .414-.336.75-.75.75z"/><path fill="#f44236" d="m6.75 24c-.414 0-.75-.336-.75-.75v-11.5c0-.414.336-.75.75-.75s.75.336.75.75v11.5c0 .414-.336.75-.75.75z"/><path fill="#f44236" d="m12.75 13.74c-.414 0-.75-.336-.75-.75v-7.24c0-.414.336-.75.75-.75s.75.336.75.75v7.24c0 .414-.336.75-.75.75z"/><path fill="#f44236" d="m18.75 11.11c-.414 0-.75-.336-.75-.75v-9.61c0-.414.336-.75.75-.75s.75.336.75.75v9.61c0 .414-.336.75-.75.75z"/></svg>';
r.a=function(l,p,r){function M(m){return void 0==m||"string"!=typeof m||0==c.includes(m)?!1:!0}if(B.a.is_supported()){var g=Object(q.c)(r),I;g.filesToUpload=[];g.f2rec={};g.availableFiles=[];var P=new Map,U=new Map,ba=new Map,K=[],V=10485760,R="",O="";g.showFsUi=!1;g.internetDetectionUrl=B.a.internetDetectionUrl;g.remoteStreams=Object(h.a)();g.remotePendingStreams=Object(h.a)();g.numATSubscribersAdded=0;g.localStreams=Object(h.a)();g.roomID="";g.talkerCount=0;g.userAudioTalkerCount=0;g.userVideoTalkerCount=
0;g.state=0;g.allStreamsActive=!1;g.streamsHealthTimerId=0;g.Connection=void 0===p?f.a:p;g.receiveVideoQuality=new Map;g.receiveVideoQuality.set("talker","Auto");g.receiveVideoQuality.set("canvas","HD");g.mediaStatsMode="disable";g.liveTranscription=!1;g.liveRoomTranscription=!1;g.transcriptionLanguage="";var y=Object(k.a)(l);g.socket=y;g.userList=new Map;g.dialOutList=new Map;g.cControlReq=void 0;g.cCrequest=[];g.awaitedParticipants=new Map;g.floorGranted=!1;g.floorInvited=!1;g.floorAccepted=!1;
g.roomJson=void 0;g.clientId=void 0;g.mode=void 0;g.activeTalker=!1;g.shareStatus=!1;g.share_override_room=!1;g.shareOverRide=!1;g.shareOverRideCallback=void 0;g.isOverRidingShare=!1;g.ScreenSharelocalStream=null;g.isSharingClient=!1;g.forcedStopSharing=!1;g.isCanvasSharing=!1;g.isCanvasSharingClient=!1;g.canvasStatus=!1;g.activeTalkerList=new Map;g.audioOnlyMode=!1;g.roomMuted=!1;var W=JSON.parse(x.a.decodeBase64(r.token));g.reconnectionState=!1;g.reconnectAttempt=0;g.connectAttempt=0;var ia=3;g.isStreamingClient=
!1;g.sendRecvBitrateStats=!1;g.speakerInfo={id:r&&r.speakerId?r.speakerId:void 0,volume:1};var X="none",E=0,da=!1,ha=!1,aa=!1,za=!1,na=!1,va;r.hasOwnProperty("reconnectInfo")?(d.a.info("reconnect parameter",r.reconnectInfo),g.reconnectionAllowed=r.reconnectInfo.allow_reconnect,g.reconnectionTimeOutInterval=r.reconnectInfo.timeout_interval,ia=r.reconnectInfo.number_of_attempts):(g.reconnectionAllowed=!0,g.reconnectionTimeOutInterval=45E3,ia=3);B.a.alertNotifyInfo={mode:"image"};r.alertNotifyInfo&&
"object"===typeof r.alertNotifyInfo&&r.alertNotifyInfo.mode&&("text"==r.alertNotifyInfo.mode||"image"==r.alertNotifyInfo.mode||"none"==r.alertNotifyInfo.mode)&&(B.a.alertNotifyInfo=Object.assign(B.a.alertNotifyInfo,r.alertNotifyInfo));var ja=!1,Da=-1;g.localStreamsBeforeReconnect=Object(h.a)();g.oldSpecInfo=void 0;g.mediaConfiguration=W.roomMeta.settings.media_configuration?W.roomMeta.settings.media_configuration:"Default";g.maxVideoLayers=0;g.defaultBandwidth=new Map;g.defaultBandwidth.set(1,2E5);
g.defaultBandwidth.set(2,3E5);g.defaultBandwidth.set(3,4E5);g.defaultBandwidth.set(4,6E5);g.defaultBandwidth.set(5,8E5);g.defaultBandwidth.set(6,1E6);g.defaultBandwidth.set(7,12E5);g.videoMutedUsers={};var S,ma,Z=g.remoteStreams,ra=g.remotePendingStreams,N=g.numATSubscribersAdded,T=g.localStreams,fa={},oa={};g.hardMuteRoom=!1;var Ma=Object(a.a)(null,null);g.breakOutRoom=Ma;g.me={};g.roomSettings={};g.mute=!1;g.muteInfo={room:{audio:!1,video:!1},stream:{hard:{audio:!1,video:!1}}};g.muteAudioOnJoin=
!1;g.muteVideoOnJoin=!1;g.cCapprovedHands=[];g.externalIp="";g.subscribeSessionStats=!1;g.canvasOptions={width:1280,height:720,domHandle:""};g.inputContext=null;g.canvasVideoPlayer="";var H=B.a.video_resolution_range[W.roomMeta.settings.quality],Y=document.createElement("style");Y.innerHTML=".stats-container{ \n                         position: absolute;\n                         z-index: 5;\n                         padding: 2px;\n                         top: 2px;\n                         right: 2px;\n                         font-size: 12px;\n                         width: 22px;\n                         height: 22px;\n                         text-align: center;\n                         background: white;\n                         border-radius: 10px;\n                     }\n                     .stats-button{\n                         cursor:pointer;\n                         width: 15px;\n                         height: 15px;\n                         padding: 0 0 0 2px;\n                     }\n                     .stats-detail{ height: 100%;}\n                     .stats-overlay-inner{\n                         display: flex;\n                         flex-direction: row;\n                         justify-content: space-between;\n                         padding: 8px 2px 6px 10px;\n                     }\n                     .stats-right-partition, .stats-left-partition {}\n                     .stats-left-partition {margin-right: 10px;}\n                     .stats-button svg {width: 12px;height: 12px;}\n                         ";
var wa=document.createElement("style");wa.innerHTML=".bw-notification{\n                                 position: absolute;\n                                 //z-index: 5;\n                                 top:1%;\n                                 left:50%;\n                                 //bottom: 5px;\n                                 //right: 5px;\n                                 //margin-top:-50px;\n                                 //margin-left:-100px;\n                                 padding: 5px;\n                                 color: #fff;\n                                 //background: rgba(50,50,50,0.5);\n                                 }";
var ka=!1,Ea=!1,Na=0,Aa=function(m){d.a.info(" in Remove stream : stream.stream : "+m.stream);m.stream&&(m.hide(),m.stop(),m.close(),delete m.stream);m.pc&&(m.pc.close(),delete m.pc)},sa=function(m,a){Fa(m,"add",function(m){})},yb=function(m,a){d.a.info("Stream subscribed");a.stream&&(m.initRemoteStream(a.stream),g.remoteStreams.remove(m.getID()),g.remoteStreams.add(m.getID(),m));a=Object(q.f)({type:"stream-subscribed",stream:m});g.dispatchEvent(a);m.room=g;!0!==m.screen&&!0!==m.canvas||m.updateVideo(m.getID())},
Oa=function(m,a,c){var b={callback:function(a){d.a.debug("Sending message",a);y.sendSDP("signaling_message",{streamId:m.getID(),msg:a,browser:m.pc.browser},void 0,function(){})},nop2p:!0,audio:a.audio&&m.ifAudio(),video:a.video&&m.ifVideo(),maxAudioBW:a.maxAudioBW,maxVideoBW:a.maxVideoBW,limitMaxAudioBW:r.maxAudioBW,limitMaxVideoBW:r.maxVideoBW,iceServers:g.iceServers,forceTurn:m.forceTurn};c||(b.simulcast=a.simulcast);return b},Ya=function(){2==g.state&&g.allStreamsActive&&(Z.forEach(function(m,
a){2==g.state&&"connected"==m.state&&(a=Ia(m),a.audio&&a.video||Fa(m,"add",function(m){}))}),T.forEach(function(m,a){2==g.state&&"connected"==m.state&&(a=Ia(m),a.audio&&a.video||(d.a.debug(" stream state: id "+m.getID()+" health: "+JSON.stringify(a)),m.ifScreen()&&m.ifCanvas()?(a=m.ifScreen()?" stream-screen failed ":" stream-canvas failed",g.dispatchEvent({type:a,stream:m})):(a.audio||m.muteAudio(function(a){m.unmuteAudio(function(a){a.result!==n.a.error_000.result&&g.dispatchEvent({type:"stream-audio failed",
stream:m})},!1)},!1),a.video||m.muteVideo(function(a){m.unmuteVideo(function(a){a.result!==n.a.error_000.result&&g.dispatchEvent({type:"stream-video failed",stream:m})},!1)},!1))))}))},Ia=function(m){var a={audio:!0,video:!0};if(m){var c=function(a,c,g){void 0==m.tracksInfo&&(m.tracksInfo={audio:{numSecsMuted:0},video:{numSecsMuted:0}});if(c){var b=a.getAudioTracks();a=m.tracksInfo.audio}else b=a.getVideoTracks(),a=m.tracksInfo.video;c="NA";b=$jscomp.makeIterator(b);for(var e=b.next();!e.done;e=b.next())e=
e.value,!0===e.enabled?"live"===e.readyState?g&&e.muted?3>++a.numSecsMuted?d.a.error("Track ready but muted ,wait timeout id: "+m.getID()+" - "+e.kind+"num secs muted: "+a.numSecsMuted):(c="INACTIVE",a.numSecsMuted=0,d.a.error("Track not ready - muted with timeout id: "+m.getID()+" - "+e.kind+"num secs muted: "+a.numSecsMuted)):(d.a.debug("Track ready  id: "+m.getID()+" - "+e.kind),a.numSecsMuted&&(a.numSecsMuted=0),c="ACTIVE"):(d.a.error("Track not ready id : "+m.getID()+" - "+e.kind+" state: "+
e.readyState),a.numSecsMuted=0,c="INACTIVE"):d.a.debug("Track not ready  and not enabled : id "+m.getID()+" - "+e.kind);return c},b=!1,e=!1;if(m.local)m.audioStream&&(a.audio=c(m.audioStream,!0,!m.ifCanvas())),m.videoStream&&(a.video=c(m.videoStream,!1,!m.ifCanvas()));else{var h=g.activeTalkerList.get(m.getID());if(h)switch(h.mediatype){case "audiovideo":b=e=!0;break;case "video":b=!0;break;case "audio":case "audioOnly":e=!0}m.stream&&(a.audio="INACTIVE"!=c(m.stream,!0,e),a.video="INACTIVE"!=c(m.stream,
!1,b),a.video&&g.isStreamingClient&&m.player&&m.player.video&&(c=m.player.video,c.player_stats&&3E3<c.getVideoPlaybackQuality().creationTime-c.player_stats.creationTime&&!(c.getVideoPlaybackQuality().totalVideoFrames>c.player_stats.totalVideoFrames)&&(console.error(" video player stats stopped : frames prev: "+c.player_stats.totalVideoFrames+" new: "+c.getVideoPlaybackQuality().totalVideoFrames),c={streamId:m.getID(),currTotalFrames:c.getVideoPlaybackQuality().totalVideoFrames,prevTotalFrames:c.player_stats.totalVideoFrames},
t.a.error("stream-event",w.a.event_stream_player_failed,{error:c}))))}}return a},Ab=function(m,a){m.pc=g.Connection.buildPair(Oa(m,a,!0));d.a.info("Create remote connection for subscribe:-"+JSON.stringify(a));m.pc.onaddstream=yb.bind(null,m);d.a.info("Registering the peer connection timer for the subscriber stream "+m.getID());setTimeout(Ia,1E4,m);var c=function(a,c){d.a.debug(" stream state ICE remote id - "+m.getID()+" : "+a+" source: "+c);"failed"===a?(m.reconnect=!1,d.a.error(c+" connection state failed - streamId: "+
m.getID()),sa(m),t.a.error("room-event",w.a.event_ice_failed,{error:{}})):(d.a.debug("stream ID",m.getID()),d.a.debug("ice connection state",a),"connected"===a&&(d.a.info("ice connection state connected - streamId : "+m.getID()),t.a.info("room-event",w.a.event_ice_success,{message:"ICE connected successfully"}),m.reconnect&&(m.reconnect=!1,m.reconnectAttempt=0,(a=ba.get(m.getID()))?("none"!=a.mediatype&&(c=JSON.parse(JSON.stringify(a)),c.mediatype="none",m.reloadPlayer(c,aa)),m.reloadPlayer(a,aa)):
d.a.info(" stream state ICE remote id - "+m.getID()+" : ICE reconnected "))))};m.pc.oniceconnectionstatechange=function(m){c(m,"ice")};m.pc.onconnectionstatechange=function(m){c(m,"pc")};m.pc.createOffer(!0)},Fa=function(m,a,c){c=void 0===c?function(){}:c;if(0==g.socket.state||!0===g.reconnectionState)d.a.error("checkWaitReconnectStream() room/socket not connected id : "+m.getID()+" sock state: "+g.socket.state+" recon state: "+g.reconnectionState),c(!1);if("add"==a)if("connected"!==m.state)d.a.error("checkWaitReconnectStream() invalid state - stream id : "+
m.getID()+" state: "+m.state),c(!1);else if(m.reconnectAttempt>=ia)d.a.error("checkWaitReconnectStream() reconnect retries exceed - global reconnect stream id: "+m.getID()),2==g.state&&g.socket.disconnect(),c(!1);else{m.reconnect=!0;m.state="wait_for_reconnect";if("mobile"==B.a.browser_info.device_type){var b=Object.keys(fa).length||Object.keys(oa).length;m.local?m.ifCanvas()||m.ifScreen()?m.ifScreen()?fa.screen=m:m.ifCanvas()&&(fa.canvas=m):fa.main=m:oa[m.getID().toString()]=m;if(b){d.a.warning("reconnectStream() queue > 1 waiting id: "+
m.getID()+" len loc: "+Object.keys(fa).length+" rem: "+Object.keys(oa).length);c(!0);return}}E||(E++,g.dispatchEvent(Object(q.e)({type:"network-reconnecting",message:"Connection issues - reconnecting, please wait"})));Qa(m,function(a){!1===a&&(d.a.error("checkWaitReconnectStream () failed streamId: "+m.getID(),2==g.state?" global reconnect":"room not connected ignoring "),2==g.state&&g.socket.disconnect());c(a)})}else if("mobile"==B.a.browser_info.device_type){m.local?m.ifCanvas()||m.ifScreen()?m.ifScreen()?
fa.screen&&delete fa.screen:fa.canvas&&delete fa.canvas:fa.main&&delete fa.main:oa[m.getID().toString()]&&delete oa[m.getID().toString()];a=0;for(b in fa)if("wait_for_reconnect"==fa[b].state){Qa(fa[b],c);a++;break}if(!a)for(var e in oa)if("wait_for_reconnect"==oa[e].state){Qa(oa[e],c);a++;break}a||(1==E&&g.dispatchEvent(Object(q.e)({type:"network-reconnected"})),c(!0));E&&E--}},Qa=function(m,a){a=void 0===a?function(){}:a;m.state="reconnecting";m.reconnectAttempt++;m.reconnectsTotal+=1;var c=m.userRequestOptions,
b="none",e=setTimeout(function(){d.a.info("reconnectStream() fail timeout stream local: "+m.local+" id: "+m.getID()+" cmd: "+b);a(!1)},3E3);m.local?(d.a.info("reconnectStream()  streamId: "+m.getID()+" calling unpublish()"),b="unpublish",g.unpublish(m,function(h,pa){d.a.info("reconnectStream()  streamId: "+m.getID()+" unpublish callback calling publish()");b="publish";g.publish(m,c,function(){d.a.info("reconnectStream()  streamId: "+m.getID()+" publish callback");b="publish-done";clearTimeout(e);
a(!0)})})):(d.a.info("reconnectStream()  streamId: "+m.getID()+" calling unsubscribe()"),b="unsubscribe",g.unsubscribe(m,function(h,pa){b="subscribe";d.a.info("reconnectStream()  streamId: "+m.getID()+" unsubscribe callback calling publish()");g.subscribe(m,c,function(){b="subscribe-done";d.a.info("reconnectStream()  streamId: "+m.getID()+" subscribe callback");clearTimeout(e);a(!0)})}))};g.reconnectStream=function(m,a){Fa(m,"add",void 0===a?function(){}:a)};g.notifyDeviceUpdate=function(){T.forEach(function(m,
a){m.ifScreen()||m.ifCanvas()});f.a.mediaDeviceUpdate(function(m){m=Object(q.e)({type:"user-media-device-list-change",message:m.added});g.dispatchEvent(m)})};var Bb=function(m,a){m.pc=g.Connection.buildPair(Oa(m,a));if(m.audioStream)for(var c=$jscomp.makeIterator(m.audioStream.getAudioTracks()),b=c.next();!b.done;b=c.next())m.pc.addTrack(b.value);if(b=m.ifCanvas()||m.ifScreen()?m.videoStream:m.inputMediaSource.video[m.inputMediaSource.video.selected])for(c=$jscomp.makeIterator(b.getVideoTracks()),
b=c.next();!b.done;b=c.next())m.pc.addTrack(b.value);d.a.info("Registering the peer connection timer for the subscriber stream "+m.getID());setTimeout(Ia,1E4,m);var e=function(a,c){var g=m.ifCanvas()?"canvas":m.ifScreen()?"screen":"main";"failed"===a?(m.reconnect=!1,d.a.error(" stream state  local  "+g+" : "+a+" source: "+c+" reconnect: "+m.reconnect),sa(m)):"connected"===a&&(m.reconnect=!1,m.reconnectAttempt=0,d.a.info(" stream state local  "+g+" : "+a+" source: "+c));d.a.info("handleConnectionStateChange state:",
a)};m.pc.oniceconnectionstatechange=function(m){e(m,"ice")};m.pc.onconnectionstatechange=function(m){e(m,"pc")};a.createOffer||m.pc.createOffer()},$a=function(m){var a=Object(e.a)(g.Connection,{streamID:m.id,local:!1,clientId:m.clientId,audio:m.audio,video:m.video,data:m.data,screen:m.screen,attributes:m.attributes});a.room=g;Z.add(m.id,a);m=Object(q.f)({type:"stream-added",stream:a});t.a.info("room-event",w.a.event_general_success,{message:"socketOnAddStream - stream added"});g.dispatchEvent(m)},
Cb=function(m){m=m.id.streamId;var a=Object(e.a)(g.Connection,{streamID:m}),d=b.a.getById("screen_saver_"+m);b.a.getByClass("icon_play",d.parentNode).disabled=!0;d&&"none"===d.style.display?d.style.display="block":d&&"block"===d.style.display&&(d.style.display="none");m=Object(q.e)({type:"track-removed",streams:[a],message:"tracked removed from stream: "+m});t.a.info("room-event",w.a.event_general_success,{message:"socketOnRemoveTrack - tracked removed from stream"});g.dispatchEvent(m)},bb=function(m){var a=
m.name,c=m.role,b=m.permissions,e={name:m.name,permissions:m.permissions,role:m.role,user_ref:m.user_ref,videoMuted:m.videoMuted,audioMuted:m.audioMuted};e.audioEnabled=void 0!=m.audioEnabled?m.audioEnabled:!0;e.videoEnabled=void 0!=m.videoEnabled?m.videoEnabled:!0;void 0!=m.data&&(e.data=m.data);"audience"!=m.role&&g.userList.set(m.clientId,e);"audience"==m.role&&(g.audienceCount=m.audienceCount?m.audienceCount:0);var h=e.numActiveATSubs?e.numActiveATSubs:g.userList.size;if(h>N&&ra.size()){var f=
N+1,n=ra.get(f);n?(ra.remove(f),Z.add(f,n),N=f,ab(n,n.userRequestOptions,function(){})):d.a.error("susbcribe failed user connected stream not found streams id: "+(N+1)+" numActiveATSubs: "+h+" First: "+ra.get(f)+" second: "+ra.get(f.toString()))}g.awaitedParticipants.get(m.clientId)&&g.awaitedParticipants.delete(m.clientId);d.a.info("userConnected() user name: "+a);t.a.info("room-event",w.a.event_room_user_connect_success,{message:"userConnect - user connected"});g.dispatchEvent(Object(q.g)({type:"user-connected",
name:a,clientId:m.clientId,role:c,permission:b,user:e}))},Db=function(m){var a=g.userList.get(m.clientId);void 0!=a?"media-modes"==m.key?void 0!=m.info&&void 0!=m.info.publish?(a.audioEnabled!=m.info.publish.audio&&(a.audioEnabled=m.info.publish.audio,g.dispatchEvent(Object(q.g)({type:a.audioEnabled?"user-audio-enabled":"user-audio-disabled",clientId:m.clientId}))),a.videoEnabled!=m.info.publish.video&&(a.videoEnabled=m.info.publish.video,g.dispatchEvent(Object(q.g)({type:a.videoEnabled?"user-video-enabled":
"user-video-disabled",clientId:m.clientId})))):d.a.error("userUpdate() failed - filed missing for media-modes : "+JSON.stringify(m)):d.a.error("userUpdate() failed - invalid key : "+JSON.stringify(m)):d.a.error("userUpdate() failed - user not found : "+JSON.stringify(m))},db=function(m){var a=m.name,c=m.role,b=m.permissions,e=m.clientId;"audience"!=c&&g.userList.delete(m.clientId);"audience"==m.role&&g.audienceCount&&0<g.audienceCount&&g.audienceCount--;!0===g.isStreamingClient&&0===g.userList.size&&
(d.a.info("S.T. Client :true  and all users have disconnected"),cb("streaming-client-disconnect"));"lecture"===g.mode&&"moderator"===g.me.role&&Ja(e);m=Object(q.g)({type:"user-disconnected",name:a,clientId:e,role:c,permission:b});t.a.info("room-event",w.a.event_room_user_disconnect_success,{message:"userDisConnect - user disconnected"});g.dispatchEvent(m)},eb=function(m){m=Object(q.d)({type:"user-subscribed",name:m.name,role:m.role,user_ref:m.user_ref,socket:m.socket});t.a.info("room-event",w.a.event_general_success,
{message:"userSubcribe - user subscribed"});g.dispatchEvent(m)},fb=function(m){m=Object(q.d)({type:"user-subscribed",name:m.name,role:m.role,user_ref:m.user_ref,socket:m.socket});t.a.info("room-event",w.a.event_general_success,{message:"userUnSubcribe - user unsubscribed"});g.dispatchEvent(m)},gb=function(m){var a;if((a=m.peerId?Z.get(m.peerId):T.get(m.streamId))&&!a.failed&&a.pc)if(a.pc.processSignalingMessage(m.msg,g.mediaConfiguration),m.msg&&"object"===typeof m.msg&&"ready"===m.msg.type){if(a.local)if(Ka(a.ifScreen(),
a.ifCanvas()),a.ifCanvas())d.a.info("stream state local canvas ready");else if(a.ifScreen()||a.ifCanvas())d.a.info(" stream state local share: ready");else{d.a.info(" stream state local main: ready");1<g.maxVideoLayers&&(m={0:1E3*B.a.video_bandwidth_range[W.roomMeta.settings.quality][2].max,1:1E3*B.a.video_bandwidth_range[W.roomMeta.settings.quality][1].max,2:1E3*B.a.video_bandwidth_range[W.roomMeta.settings.quality][0].max},d.a.info("updating simulcast bps for quality: "+W.roomMeta.settings.quality+
" bitrates: "+JSON.stringify(m)),a.updateSimulcastLayersBitrate(m));var c=!0;m={local:!1,hard:!1,eventInfo:void 0};var b={local:!1,hard:!1,eventInfo:void 0};g.muteInfo.stream.hard.audio&&!g.hardMuteInitiator&&(m.hard|=1);d.a.info("streamId: "+a.getID()+" local cam Publish ready state");void 0!=g.videoMuteOnJoin&&(b.local|=g.videoMuteOnJoin.local,b.hard|=g.videoMuteOnJoin.hard,c=!1,delete g.videoMuteOnJoin);void 0!=g.audioMuteOnJoin&&(m.local|=g.audioMuteOnJoin.local,m.hard|=g.audioMuteOnJoin.hard,
c=!1,delete g.audioMuteOnJoin);m.local|=a.config.audioMuted;b.local|=a.config.videoMuted;0==a.video&&(b={local:!1,hard:!1});0==a.audio&&(m={local:!1,hard:!1});Eb(a,m,b,c);a.config.audioMuted&&(a.config.audioMuted=!1);a.config.videoMuted&&(a.config.videoMuted=!1)}else d.a.info(" stream state remote id - "+a.getID()+" : ready");a.onConnectionStateChanged(!0);Fa(a,"del")}else void 0!=g.speakerInfo.id&&a.setSpeaker(g.speakerInfo.id)},Fb=function(m){var a=T.get(m.streamId);a&&!a.failed?a.pc.get(m.peerSocket).processSignalingMessage(m.msg):
(a=Z.get(m.streamId),a.pc.processSignalingMessage(m.msg))},hb=function(m){T.get(m.streamId)},Gb=function(m){T.get(m.streamId)},ib=function(m){d.a.debug("Received SocketOnSelfBandwidthAlert",JSON.stringify(m));if("SubscriberBandWidth"===m.message){var a=Object(q.e)({type:"room-bandwidth-alert",message:m.bandwidth});g.dispatchEvent(a)}else T.forEach(function(a,c){1===m.bandwidth?(d.a.info("mute publisher video due to low bandwidth"),t.a.info("room-event",w.a.event_low_bandwidth_update,{message:"socketOnSelfBandwidthAlert - muted publisher video due to low bandwidth"}),
a.muteVideo()):"ShareBandwidth"===m.message&&a.screen?a.setVideoParamsRange(m.bandwidth,void 0,void 0,void 0,!0):"PublisherBandwidth"===m.message&&(J=m.bandwidth,a.setVideoParamsRange(m.bandwidth,void 0,void 0,void 0,!0))})},Hb=function(m){"bw-alert"===m.id?jb(m.msg):"publisher-bw"===m.id||"share-bw"===m.id?ib(m.msg):(m=Object(q.e)({type:m.id,message:m.msg}),g.dispatchEvent(m))},jb=function(m){d.a.info("OnbandwidthAlert:",m);for(var a=0;a<m.length;a++){var c=g.remoteStreams.getAll()[m[a].streamId];
null==c?d.a.info("Stream not found"):c.setBandwidthAlert(m[a])}},Ib=function(a){if(g.activeTalker)if(g.eventsList&&void 0!==g.eventsList&&"message-received"in g.eventsList){var m=Object(q.e)({type:"message-received",message:a.msg});g.dispatchEvent(m)}else m=Object(q.e)({type:"active-talker-data-in",message:a.msg}),g.dispatchEvent(m);else m=Z.get(a.id),a=Object(q.f)({type:"stream-data-in",msg:a.msg,stream:m}),m.dispatchEvent(a)},La=function(a,c,b,e){e=document.createElement("div");e.setAttribute("id",
"fs-notif-id-"+Math.random());e.setAttribute("class","fs-notification");e.setAttribute("style","display:block;position:relative;z-index:3;padding:5px 10px;top:50%;right:50%;transform:translateX(50%);background:rgba(0,0,0,0.29);border-radius:5px;color:rgb(255,255,255)");c.appendChild(e);c=e;switch(b){case "fs-upload-init":b="upload started for file "+a.data[a.data.length-1].name+" of size "+a.data[a.data.length-1].size/1E3+" KB";e=a.message;a=document.createElement("br");c.appendChild(a);b=document.createTextNode(b);
c.appendChild(b);c.appendChild(a);break;case "fs-file-uploaded":b="uploaded 100 % "+a.name+"  of size "+a.size/1E3+" KB";e=a.message;a=document.createElement("br");c.appendChild(a);b=document.createTextNode(b);c.appendChild(b);c.appendChild(a);break;case "fs-upload-started":b=a.sender+" is sharing file "+a.message.data[a.message.data.length-1].name+"  of size "+a.message.data[a.message.data.length-1].size/1E3+" KB";e=a.message;a=document.createElement("br");c.appendChild(a);b=document.createTextNode(b);
c.appendChild(b);c.appendChild(a);break;case "fs-file-available":e=a.message;a=document.createElement("br");c.appendChild(a);var m=document.createElement("BUTTON");b=document.createTextNode(e.name);m.setAttribute("style","color:red;font-size:23px");m.setAttribute("id",K.length-1);m.appendChild(b);c.appendChild(m);m.onclick=function(){g.recvFiles(m.id)};c.appendChild(a);break;default:d.a.info("random data to fantom UI ")}},Jb=function(a,c){d.a.info("socketOnDataStreamToRoom",a.type);switch(a.type){case "chat":var m=
"message-received";break;case "data-internal-in":m=a.message.type;switch(a.message.type){case "fs-upload-started":a.message.broadcast=a.broadcast;a.message.sender=a.sender;a.message.senderId=a.senderId;d.a.info(" file is being shared with you fs-upload-started",a.message);!0===g.showFsUi&&null!==document.getElementById(O)&&(La(a,document.getElementById(O),"fs-upload-started"),t.a.info("room-event",w.a.event_file_download_success,{error:{}}));break;case "fs-file-available":a.message.broadcast=a.broadcast;
a.message.sender=a.sender;a.message.senderId=a.senderId;K.push(a.message);var b={broadcast:a.broadcast,sender:a.sender,senderId:a.senderId,name:a.message.name,size:a.message.size,speed:a.message.speed,createdAt:a.message.createdAt,dlimit:a.message.dlimit,time:a.message.time,expiresAt:a.message.expiresAt,timeLimit:a.message.timeLimit,index:K.length-1};g.availableFiles.push(b);d.a.info("file is available to download fs-file-available",b);b=Object(q.e)({type:"fs-download-result",message:{messageType:"download-available",
result:0,description:"file-available",response:{downloadStatus:"available",jobId:b.index,downloadInfo:b}}});g.dispatchEvent(b);!0===g.showFsUi&&null!==document.getElementById(O)&&La(a,document.getElementById(O),"fs-file-available");break;case "fs-upload-cancelled":break;default:d.a.info("unknown internal data type from signaling server ",a.type),t.a.error("room-event",w.a.event_file_download_failed,{error:{}})}break;default:m="user-data-received"}g.eventsList&&m in g.eventsList?(a=Object(q.e)({type:m,
message:a}),g.dispatchEvent(a),c&&c(n.a.error_000)):c&&c(n.a.error_1169)},Kb=function(a){var m=Z.get(a.id),d=Object(q.f)({type:"stream-attributes-updated",attrs:a.attrs,stream:m});m.updateLocalAttributes(a.attrs);m.dispatchEvent(d)},kb=function(a){var m=T.get(a.id);if(m)sa(m);else if(m=Z.get(a.id))Z.remove(a.id),Aa(m),a=Object(q.f)({type:"stream-removed",stream:m}),t.a.info("room-event",w.a.event_general_success,{message:"socketOnRemoveStream - stream removed"}),g.dispatchEvent(a)},Lb=function(){d.a.info("Socket disconnected, lost connection to Signalling Server, room state: "+
g.state);0!==g.state&&3!==g.state&&(g.breakOutRoom.disconnectAll(),ta(!1,!1))},Mb=function(a){if(a.streamId){var m="ICE Connection Failed on "+a.type+" "+a.streamId+" "+g.state;d.a.error(m);t.a.error("room-event",w.a.event_ice_failed,{arg:a});a="publish"===a.type?T.get(a.streamId):Z.get(a.streamId);sa(a,m)}},Nb=function(a){d.a.error("Cannot connect to client Controller");t.a.info("room-event",w.a.event_general_success,{message:"socketOnError - Cannot connect to signalling"});g.dispatchEvent(Object(q.e)({type:"room-error",
message:a}))},Ra=function(a){d.a.debug("sendDataSocketFromStreamEvent");var m=a.stream;a=a.msg;m.local?y.sendMessage("sendDataStream",{id:m.getID(),msg:a}):(d.a.error("You can not send data through a remote stream"),t.a.error("room-event",w.a.event_general_failed,{message:"sendDataSocketFromStreamEvent - You can not send data through a remote stream"}))},Sa=function(a,c,b,e,h,f){a&&void 0!==c&&"boolean"===typeof c&&(!1!==c||b&&Array.isArray(b)&&b.length)&&"number"===typeof e?e>B.a.senduserDataMaximumLimit?
(d.a.error("message: content-length must be <= 2048, entered value : "+e+" kB"),f(n.a.error_1196)):g.socket.emitEvent("sendDataStreamToRoom",{msg:a,broadcast:c,clients:b,type:h},f):(d.a.error("message: invalid parameter, msg/broadcast/clients/contentLength undefined or type mistmatch"),f(n.a.error_1155))};g.sendUserData=function(a,c,g,b){b=void 0===b?function(){}:b;var m=100;a["content-length"]&&(m=a["content-length"],delete a["content-length"]);JSON.stringify(a).length/1024>m?(d.a.error("message: large data, failed - larger text-data. Max allowed length is "+
m+" kB"),b(n.a.error_1195)):Sa(a,c,g,m,"user_data",b)};var lb=function(a,d,c,g,b){a.type=d;Sa(a,c,g,0,"data-internal-in",void 0===b?function(){}:b)};g.sendMessage=function(a,d,c,g){g=void 0===g?function(){}:g;var m=0;"string"==typeof a?m=a.length/1024:"object"==typeof a&&(m=JSON.stringify(a).length/1024);Sa(a,d,c,m,"chat",g)};var Ob=function(a,c){c=void 0===c?function(){}:c;var m=["grid","talker","presenter"],b=["liveRecording","streaming","screenShare","all"],e=a.service;a=a.layout;void 0==c||"function"!==
typeof c?d.a.error("message: invalid value for callback parameter"):"moderator"!==g.me.role?(d.a.warning("User should be a moderator to change layout details."),c(n.a.error_1168)):0===g.state?(d.a.info("Room is disconnected"),c(n.a.error_7079)):void 0!=a&&"string"===typeof a&&m.includes(a)?void 0!=e&&"string"===typeof e&&b.includes(e)?(m={},m.layout=a,m.service=e,g.socket.sendParamEvent("sendLayoutData",m,function(a,m){d.a.info("sending sendLayoutData");null===a?(d.a.error("Error in layout update: ",
m),c(m)):(d.a.info("Layout updated successfully."),c(a))})):(d.a.error("message: invalid value for service parameter"),c&&c(n.a.error_1193)):(d.a.error("message: invalid value for layout parameter"),c&&c(n.a.error_1192))},qa=function(a){var m=0,d=0,c=0,g=0,b=0,e=0,h="";a&&(Object.keys(a).forEach(function(h){switch(h){case "bitrateCalculated":g=Math.round(a[h]/1E3);break;case "framerateCalculated":b=a[h];break;case "bandwidth":c=Math.round(a[h]/1E3);break;case "packetsLost":e=a[h];break;case "frameHeight":m=
a[h];break;case "frameWidth":d=a[h]}}),!B.a.csp_enabled&&(h+='<div> <strong style="color:black;" > '+d+"X"+m+"p"+b+"@"+g+"Kbps</strong>:</div>",c||e))&&(h+='<div> <strong style="color:black;" > AvailBw:'+c+"Kbps, loss:"+e+"</strong>:</div>");return B.a.csp_enabled?{resHeight:m,resWidth:d,packetsLost:e,bandwidth:c,frameRate:b,bitrate:g}:{displayString:h,resHeight:m,resWidth:d,packetsLost:e,bandwidth:c,frameRate:b,bitrate:g}},Pb=function(a){var m=[],c={},b={},e={};a.statData.stats.forEach(function(a){var h=
a.streamType;if("actStat"===h){var f={};if(B.a.csp_enabled)for(void 0==m[a.subscriberStreamId]&&(m[a.subscriberStreamId]={id:a.subscriberStreamId}),f.video=[],Object.keys(a.total).forEach(function(m){"bitrateCalculated"===m&&(m=Math.round(a.total[m]/1E3),"notify"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)&&(f["total-bitrate-kbps"]=m)}),h=0;h<a.videoStats.length;h++)f.video[h]=qa(a.videoStats[h]);else h=document.querySelectorAll("#stats-left-part-"+a.subscriberStreamId),void 0==m[a.subscriberStreamId]&&
(m[a.subscriberStreamId]={id:a.subscriberStreamId}),f.video=[],h.forEach(function(m){if(void 0!==m&&null!==m){var d="";Object.keys(a.total).forEach(function(m){if("bitrateCalculated"===m)if(m=Math.round(a.total[m]/1E3),"notify"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)f["total-bitrate-kbps"]=m;else if("display"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)d+="<div> <strong>Tx Total:</strong>:  "+m+"Kbps </div>"});for(var c=0;c<a.videoStats.length;c++)if(f.video[c]=qa(a.videoStats[c]),
"display"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)d+=f.video[c].displayString,m.innerHTML='<div id="" class="stats-detail"> \n                                    '+d+"\n                                </div>"}});m[a.subscriberStreamId].publisher=f}else if("selfPcStat"===h){void 0==m[a.subscriberStreamId]&&(m[a.subscriberStreamId]={id:a.subscriberStreamId});var pa={video:[]};if(B.a.csp_enabled)for(parseInt(a.streamId),Object.keys(a.total).forEach(function(m){"bitrateCalculated"===m&&
(m=Math.round(a.total[m]/1E3),"notify"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)&&(pa["total-bitrate-kbps"]=m)}),h=0;h<a.videoStats.length;h++)pa.video[h]=qa(a.videoStats[h]);else{var n=parseInt(a.streamId)+1;document.querySelectorAll("#stats-right-part-"+a.subscriberStreamId).forEach(function(m){if(void 0!==m&&null!==m){var d="";Object.keys(a.total).forEach(function(m){if("bitrateCalculated"===m)if(m=Math.round(a.total[m]/1E3),"notify"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)pa["total-bitrate-kbps"]=
m;else if("display"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)d+="<div> <strong>Rx ID: "+n+", Total:</strong>:  "+m+"Kbps </div>"});m.innerHTML='<div id="" class="stats-detail"> \n                                        '+d+"\n                                    </div>";for(var c=0;c<a.videoStats.length;c++)if(pa.video[c]=qa(a.videoStats[c]),"display"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)d+=pa.video[c].displayString,m.innerHTML='<div id="" class="stats-detail"> \n                                '+
d+"\n                                </div>"}})}d.a.debug(" subscriberStreamId: "+a.subscriberStreamId+" substat: "+JSON.stringify(pa));m[a.subscriberStreamId].subscriber=pa}else if("selfPubStat"===h)if(B.a.csp_enabled)for(Object.keys(a.total).forEach(function(m){"bitrateCalculated"===m&&(m=Math.round(a.total[m]/1E3),"notify"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)&&(c["total-bitrate-kbps"]=m)}),c.video=[],h=0;h<a.videoStats.length;h++)c.video[h]=qa(a.videoStats[h]);else h=document.querySelectorAll("#stats-left-part-"+
a.streamId),h.forEach(function(m){if(void 0!==m&&null!==m){var d="";Object.keys(a.total).forEach(function(m){if("bitrateCalculated"===m)if(m=Math.round(a.total[m]/1E3),"notify"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)c["total-bitrate-kbps"]=m;else if("display"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)d+="<div> <strong>Tx Total</strong>: "+m+"Kbps</div>"});c.video=[];for(var b=0;b<a.videoStats.length;b++)if(c.video[b]=qa(a.videoStats[b]),"display"==g.mediaStatsMode||"notify-display"==
g.mediaStatsMode)d+=c.video[b].displayString,m.innerHTML='<div id="" class="stats-detail"> \n                                        '+d+"\n                                    </div>"}});else"canvasStat"===h?B.a.csp_enabled?(Object.keys(a.total).forEach(function(m){"bitrateCalculated"===m&&(m=Math.round(a.total[m]/1E3),"notify"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)&&(b["total-bitrate-kbps"]=m)}),b.video=qa(a.videoStats)):(h=document.querySelectorAll("#stats-left-part-"+a.subscriberStreamId),
h.forEach(function(m){if(void 0!==m&&null!==m){var d="";Object.keys(a.total).forEach(function(m){if("bitrateCalculated"===m)if(m=Math.round(a.total[m]/1E3),"notify"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)b["total-bitrate-kbps"]=m;else if("display"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)d+="<div> <strong>Tx Total:</strong>:  "+m+"Kbps </div>"});b.video=qa(a.videoStats);if("display"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)d+=b.video.displayString,m.innerHTML=
'<div id="" class="stats-detail"> \n                                            '+d+"\n                                        </div>"}})):"shareStat"===h&&(B.a.csp_enabled?(Object.keys(a.total).forEach(function(m){"bitrateCalculated"===m&&(m=Math.round(a.total[m]/1E3),"notify"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)&&(e["total-bitrate-kbps"]=m)}),e.video=qa(a.videoStats)):(h=document.querySelectorAll("#stats-left-part-"+a.subscriberStreamId),h.forEach(function(m){if(void 0!==m&&null!==
m){var d="";Object.keys(a.total).forEach(function(m){if("bitrateCalculated"===m)if(m=Math.round(a.total[m]/1E3),"notify"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)e["total-bitrate-kbps"]=m;else if("display"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)d+="<div> <strong>Tx Total:</strong>:  "+m+"Kbps </div>"});e.video=qa(a.videoStats);if("display"==g.mediaStatsMode||"notify-display"==g.mediaStatsMode)d+=e.video.displayString,m.innerHTML='<div id="" class="stats-detail"> \n                                            '+
d+"\n                                        </div>"}})))});d.a.info("that.mediaStatsMode : "+g.mediaStatsMode+" talkers: "+JSON.stringify(m)+" selfPublisherStat: "+JSON.stringify(c));"notify"!=g.mediaStatsMode&&"notify-display"!=g.mediaStatsMode||g.dispatchEvent({type:"media-stats",talkers:m,publisher:c,share:e,canvas:b})},mb=function(a){var m=a.stream;a=a.attrs;m.local?(m.updateLocalAttributes(a),y.sendMessage("updateStreamAttributes",{id:m.getID(),attrs:a}),t.a.info("room-event",w.a.event_general_success,
{message:"updateAttributesFromStreamEvent - updateStreamAttributes - success"})):d.a.error("You can not update attributes in a remote stream")},C=function(a,d){d.args?a.apply(null,$jscomp.arrayFromIterable(d.args)):a()},Ta=function(a,d,c){return{state:a,data:d.ifData(),audio:d.ifAudio(),video:d.ifVideo(),screen:d.ifScreen(),canvas:d.ifCanvas(),canvasType:c.canvasType,attributes:d.getAttributes(),metadata:c.metadata,createOffer:c.createOffer,muteStream:c.muteStream,shareMetadata:c.shareMetadata}},
Ua=function(a,c,b,e){e=void 0===e?function(){}:e;null===a?(d.a.error("Error when publishing the stream",b),t.a.error("room-event",w.a.event_stream_publish_failed,{error:b}),e(void 0,b)):(d.a.info("Stream published"),t.a.info("room-event",w.a.event_stream_publish_success,{error:{}}),c.setID(a),c.on("internal-send-data",Ra),c.on("internal-set-attributes",mb),T.add(a,c),c.room=g,e(a))},Qb=function(a,c,b){b=void 0===b?function(){}:b;if(a.url){var m="url";var g=a.url}else m="recording",g=a.recording;d.a.info("Checking publish options for",
a.getID());a.checkOptions(c);y.sendSDP("publish",Ta(m,a,c),g,function(m,d){Ua(m,a,d,b)})},Rb=function(a,d,c){c=void 0===c?function(){}:c;y.sendSDP("publish",Ta("data",a,d),void 0,function(m,d){Ua(m,a,d,c)})},Va=function(a,c,b){b=void 0===b?function(){}:b;if(void 0!==a.screen&&0!=a.screen||void 0!==a.canvas&&0!=a.canvas)void 0!==a.canvas&&1==a.canvas?d.a.info("Publishing Canvas spatiallayers 3 createOffer",c.createOffer):d.a.info("Publishing Share createOffer",c.createOffer);else{var m=c.maxVideoLayers?
c.maxVideoLayers:g.maxVideoLayers;1<m&&3>=m&&(c.simulcast={numSpatialLayers:m,spatialLayerBitrates:B.a.video_layer_bitrates});d.a.info("Publishing Main, createOffer",c.createOffer," Max video layers: "+m)}m=Ta("media_engine",a,c);m.minVideoBW=c.minVideoBW;m.maxVideoBW=c.maxVideoBW;m.scheme=c.scheme;d.a.info("publish video: constraints: "+JSON.stringify(m)+" options: "+JSON.stringify(c));y.sendSDP("publish",m,void 0,function(m){m&&0===m.result&&(Ua(m.id,a,void 0,void 0),Bb(a,c),a.clientId=g.clientId,
a.maxVideoBwKbpsReqByServer=c.maxVideoBW);b(m)});void 0!=S&&clearTimeout(S);d.a.debug("calling mediaConnectionTimer pub streamId: "+a.getID());S=setTimeout(function(){nb(a.getID(),!0)},3E4)},Sb=function(a,d){a=d&&a.ifVideo();var m=d&&d.width,c=d&&d.height;d=d&&d.frameRate;return m||c||d?{width:m,height:c,frameRate:d}:a},ab=function(a,c,b){b=void 0===b?function(){}:b;c.maxVideoBW=c.maxVideoBW||r.defaultVideoBW;c.maxVideoBW>r.maxVideoBW&&(c.maxVideoBW=r.maxVideoBW);c.audio=void 0===c.audio?!0:c.audio;
c.video=void 0===c.video?!0:c.video;c.data=void 0===c.data?!0:c.data;c.canvas=void 0===c.canvas?!0:c.canvas;a.checkOptions(c);var m={streamId:a.getID(),audio:c.audio&&a.ifAudio(),video:Sb(a,c.video),data:c.data&&a.ifData(),canvas:c.canvas&&a.ifCanvas(),browser:g.Connection.browserEngineCheck(),createOffer:c.createOffer,metadata:c.metadata,muteStream:c.muteStream,slideShowMode:c.slideShowMode};d.a.debug("SOCKET EVENT subscribe:- "+JSON.stringify(m));y.sendSDP("subscribe",m,void 0,function(m,g){null===
m?(d.a.error("Error subscribing to stream ",g),t.a.error("room-event",w.a.event_stream_subscribe_failed,{error:g}),b(void 0,g)):(d.a.info("Subscriber added"),d.a.info("stream subscription result",m),Ab(a,c),b(!0))})},Tb=function(a,c,b){b=void 0===b?function(){}:b;y.sendSDP("subscribe",{streamId:a.getID(),data:c.data,metadata:c.metadata},void 0,function(m,c){null===m?(d.a.error("Error subscribing to stream ",c),t.a.error("room-event",w.a.event_stream_subscribe_failed,{error:c}),b(void 0,c)):(d.a.info("Stream subscribed"),
m=Object(q.f)({type:"stream-subscribed",stream:a}),g.dispatchEvent(m),b(!0))})},ta=function(a,c){!a&&g.reconnectAttempt<ia?(d.a.info("validateProcessNetworkTimeout() rejoin room:"+c+" retries: "+g.reconnectAttempt),g.reconnectionAllowed=!0,c?(g.dispatchEvent(Object(q.e)({type:"network-reconnecting",message:"Network issues - reconnecting, please wait "})),g.rejoinRoom()):Wa()):(d.a.info("force disconnect"),g.reconnectionAllowed=!1,Wa(),a={type:"network-reconnect-timeout",error:n.a.error_1165.result,
message:n.a.error_1165.error},g.dispatchEvent(Object(q.e)(a)),t.a.error("room-event",w.a.event_network_reconnect_timeout,a))},pb=function(){d.a.info("detect doesConnectionExist");if(0===g.state){var a=0,c=new XMLHttpRequest,b=void 0!==g.internetDetectionUrl?g.internetDetectionUrl:B.a.internetDetectionUrl,e=Math.round(1E4*Math.random());c.timeout=15E3;c.open("HEAD",b+"?rand="+e,!0);c.ontimeout=function(a){d.a.info("xhr timeout---------------")};c.addEventListener("readystatechange",function(m){4===
c.readyState?200<=c.status&&304>c.status?(a++,d.a.info("internet is back connection exists !"),ob(),1===a&&ta(!1,!0)):(d.a.info("internet connection doesn't exist!"),Date.now()-g.reconStartTime>g.reconnectionTimeOutInterval?(ob(),d.a.info("Internet not resumed timeout :",g.reconnectionTimeOutInterval/1E3,"seconds"),ta(!0,!1)):ta(!1,!1)):d.a.debug("ajax req readystate: ",c.readyState,"status ",c.status,"timer",I)},!1);c.send()}},ob=function(){void 0!==I?(d.a.info("stopInternetDetection kill it"),clearInterval(I)):
d.a.info("stopInternetDetection handle is undefined",I)},Wa=function(a){d.a.debug("room-disconnected clear all ");if(!1===g.reconnectionAllowed){d.a.debug("room-disconnected ---- reconnection not allowed---- clear all normal closer");Z.forEach(function(a,m){Aa(a);Z.remove(m);a&&!a.failed&&(a=Object(q.f)({type:"stream-removed",stream:a}),g.dispatchEvent(a))});Z=Object(h.a)();T.forEach(function(a,m){a.ifCanvas()&&g.stopCanvas(function(){});Aa(a);T.remove(m)});T=Object(h.a)();try{d.a.debug("normal socket closure, disconnect socket room state:"+
g.state);var m=function(m){d.a.debug("disconnectSocket() room state: "+g.state+" initiator: "+m);0!=g.state&&(g.state=0,g.allStreamsActive=!1,0!==g.streamsHealthTimerId&&(clearInterval(g.streamsHealthTimerId),g.streamsHealthTimerId=0),y.disconnect(),y.state=y.DISCONNECTED,y=void 0);a&&a(n.a.error_000)};if(2==g.state){g.state=3;g.allStreamsActive=!1;0!==g.streamsHealthTimerId&&(clearInterval(g.streamsHealthTimerId),g.streamsHealthTimerId=0);var c=setTimeout(m,1E3,"timer");g.socket.emitEvent(u.a.RoomEvent.drop,
{self:!0},function(a){clearTimeout(c);m("disc callback")})}else 3!=g.state&&m("direct")}catch(Zc){d.a.debug("Socket already disconnected"),a&&(t.a.error("room-event",w.a.event_general_failed,{message:n.a.error_1163}),a(n.a.error_1163))}}else{d.a.debug("in clear all - unexpected disconnection and the case for reconnect");Z.forEach(function(a,m){void 0!==a&&void 0!==a.stream?a.stream.getTracks().forEach(function(a){a.onended=null;a.stop()}):d.a.debug("remote stream or media stream is undefined id: "+
m);a.pc&&(a.pc.close(),delete a.pc);Z.remove(m)});T.forEach(function(a,m){a.pc&&(a.pc.close(),delete a.pc);qb(a);a&&a.local&&(d.a.info("stream off for internal send data"),a.off("internal-send-data",Ra));T.remove(m)});y.state=y.DISCONNECTED;g.state=0;g.allStreamsActive=!1;0!==g.streamsHealthTimerId&&(clearInterval(g.streamsHealthTimerId),g.streamsHealthTimerId=0);d.a.info("send network disconnected event");var b=Object(q.e)({type:"network-disconnected",error:n.a.error_1163.result,message:n.a.error_1163.error});
g.dispatchEvent(b);g.reconStartTime=Date.now();pb();I=setInterval(pb,15E3);a&&(t.a.error("room-event",w.a.event_general_failed,{message:n.a.error_1163}),a(n.a.error_1163))}};g.connect=function(a,c){a=void 0===a?{allow_reconnect:!0,number_of_attempts:3,timeout_interval:45E3}:a;c=void 0===c?function(){}:c;var m=JSON.parse(x.a.decodeBase64(r.token));g.reconnectionAllowed=a.allow_reconnect;g.reconnectionTimeOutInterval=a.timeout_interval;ia=a.number_of_attempts;d.a.debug(" connection attempt check :"+
g.connectAttempt);7<=g.connectAttempt||g.reconnectAttempt>=ia?ta(!0,!1):(!0===g.reconnectionState&&(g.reconnectAttempt++,m.isReconnecting=!0,m.reconnectAttempt=g.reconnectAttempt,m.oldClientIdForReconnect=g.clientId,m.room=g.roomID,m.role=g.me.role,m.name=g.me.name,d.a.info("new token request for the reconnection: ",m)),m.logId&&B.a.setLocalStorageItem("logID",m.logId),g.state=1,g.me.logId=m.logId,g.allStreamsActive=!1,0!==g.streamsHealthTimerId&&(clearInterval(g.streamsHealthTimerId),g.streamsHealthTimerId=
0),m.hostType=B.a.browser_info.name,m.hostVersion=B.a.browser_info.version,m.hostDeviceType=B.a.browser_info.device_type,m.userAgent=B.a.user_agent,m.advancedOptions=r.options,m.version=B.a.product.version,void 0!=r.maxActiveTalkers&&"number"==typeof r.maxActiveTalkers&&(m.maxActiveTalkers=r.maxActiveTalkers),g.connectAttempt++,d.a.info("calling socket connect that.connectAttempt: "+g.connectAttempt),y.connect(m,function(a){d.a.info("socket response: ",a);0===a.result?(g.connectAttempt=0,d.a.info("socket.connect token accepted"),
g.externalIp=a.connectedIP,c(n.a.error_000)):(d.a.info("connect error",a),ta(!0,!1),g.dispatchEvent(Object(q.e)({type:"room-error",error:a.result,message:a.msg})),g.createEventLog("clientConnFailed",{clientId:"",hostType:B.a.browser_info.name,hostVersion:B.a.browser_info.version,error:a.msg,externalIp:g.externalIp}),c(n.a.error_1161))},function(a){d.a.error("Not Connected! Error: "+a);ta(!0,!1);if("object"==typeof a&&void 0!=a.result){d.a.error("socket.connect failed with error: "+JSON.stringify(a));
var m=a.result}else m=a;m=Object(q.e)({type:"room-error",error:m,message:a});t.a.error("room-event",w.a.event_general_failed,{message:"clientConnFailed - error"});g.dispatchEvent(m);g.createEventLog("clientConnFailed",{clientId:"",hostType:B.a.browser_info.name,hostVersion:B.a.browser_info.version,error:a,externalIp:g.externalIp});c(n.a.error_1161)}))};g.rejoinRoom=function(){fa={};oa={};d.a.debug("=========== port of hope--- reconnect");""!=g.externalIp&&(g.reconnectionState=!0);void 0===y&&!0===
g.reconnectionState?(d.a.info("reconnect creating a new socket"),g.state=0,g.allStreamsActive=!1,0!==g.streamsHealthTimerId&&(clearInterval(g.streamsHealthTimerId),g.streamsHealthTimerId=0),d.a.info("reconnect force a new socket"),y=Object(k.a)(void 0),g.socket=y):d.a.debug("previous connection is still there or the reconnection state is false");g.userList.clear();g.connect()};g.disconnect=function(a){d.a.debug("that.disconnect() clearing all ");g.reconnectionAllowed=!1;Wa(function(m){void 0==a&&
(a={cause:n.a.CC006});m=Object(q.e)({type:"room-disconnected",message:a});d.a.debug("that.disconnect() sending room-disconnected event");g.dispatchEvent(m)})};g.removeTrack=function(a){y.sendSDP("removeTrack",{streamId:a,msg:"track-removed"},void 0,function(){})};g.getWaitingUserList=function(a){g.socket.sendMessage("getAwaitedUser",function(m){if(0===m.result)for(var d in m.awaitedParticipants)g.awaitedParticipants.set(m.awaitedParticipants[d].clientId,{clientId:m.awaitedParticipants[d].clientId,
name:m.awaitedParticipants[d].name});a&&a(m)})};g.updateLayout=function(a,d){Ob(a,d)};var Ga=function(a,c){d.a.info("event: "+a+":"+c.clientId+"::::"+c.name);g.cCrequest.push({clientId:c.clientId,name:c.name,type:"raised"});a=Object(q.e)({type:a,users:c});g.dispatchEvent(a)},Ja=function(a){for(var m=0;m<g.cCapprovedHands.length;m++)if(g.cCapprovedHands[m].clientId==a){g.cCapprovedHands.splice(m,1);break}},Ha=function(a,c){switch(a){case "floor-granted":c.clientId===g.clientId?g.floorGranted=!0:g.cCapprovedHands.push({clientId:c.clientId,
moderatorId:c.moderatorId});break;case "floor-invited":c.clientId===g.clientId&&(g.floorInvited=!0);break;case "floor-denied":c.clientId===g.clientId&&(g.floorGranted=!1);break;case "floor-cancelled":c.clientId===g.clientId?g.floorInvited=!1:Ja(c.clientId);break;case "floor-released":c.clientId===g.clientId?(g.localStreams.getAll(),T.forEach(function(a,m){d.a.info(a.getID()+"::::"+m);g.unpublish(a,function(m){1==m?(d.a.info("stream has been un-published"),t.a.info("room-event",w.a.event_stream_unpublish_success,
{error:{}})):(d.a.info("error during stream un-publishing"),t.a.error("room-event",w.a.event_stream_unpublish_failed,{stream:a}));g.floorGranted=!1})})):Ja(c.clientId)}"floor-released"==a&&g.dispatchEvent(Object(q.e)({type:"release-floor",users:c}));g.dispatchEvent(Object(q.e)({type:a,users:c}))},Ub=function(a){d.a.info(" onFloorManagementEvents: "+JSON.stringify(a));switch(a.id){case "floorRequested":Ga("floor-requested",a);break;case "floorCancelled":Ga("floor-cancelled",a);break;case "floorFinished":Ga("floor-finished",
a);break;case "floorRejected":g.floorInvited=!1;Ga("floor-rejected",a);break;case "floorAccepted":Ga("floor-accepted",a);break;case "inviteToFloor":Ha("floor-invited",a);break;case "floorGranted":Ha("floor-granted",a);break;case "floorDenied":Ha("floor-denied",a);break;case "floorReleased":Ha("floor-released",a);break;case "cancelFloorInvite":Ha("floor-invite-cancelled",a)}},Vb=function(a){d.a.info(a);a=Object(q.e)({type:"hard-mute",users:a});g.dispatchEvent(a)},Wb=function(a,d){Ba(!1,!0,!1,!0,d,
!0,{type:"hard-unmute-room",message:a});g.mute=g.muteInfo.room.audio=!1;g.hardMuteInitiator=!1},Xb=function(a,d){Ba(!0,!0,!1,!0,d,!0,{type:"hard-mute-room",message:a});g.mute=g.muteInfo.room.audio=!0;g.hardMuteInitiator=!1};g.enableKnock=function(a,c){void 0!==a&&"boolean"===typeof a?g.socket.emitEvent("enableKnock",a,function(m){d.a.info("enableKnock response"+JSON.stringify(m));0===m.result&&!1===a&&g.awaitedParticipants.clear();c&&c(m)}):c(!1)};g.openFloor=function(a,c){void 0!==a&&"boolean"===
typeof a?g.socket.emitEvent("openFloor",a,function(m){d.a.info("openFloor response"+JSON.stringify(m));0===m.result&&(g.floorOpen=a);c&&c(m)}):c(!1)};var Yb=function(a){a=Object(q.e)({type:"room-awaited",message:"waiting for moderator approval"});g.dispatchEvent(a)},Zb=function(a){var m={clientId:a.clientId,name:a.name};a.data&&(m.data=a.data);g.awaitedParticipants.set(a.clientId,m);a=Object(q.e)({type:"user-awaited",message:{user:m}});g.dispatchEvent(a)};g.approveAwaitedUser=function(a,c){c=void 0===
c?function(){}:c;"function"===typeof c?g.socket.emitEvent("user-allowed",a,function(m,b){null===m?d.a.error("Error on knock approve request",b):(g.awaitedParticipants.delete(a),c(m,b))}):d.a.error("approveAwaitedUser() invalid param - callback")};g.denyAwaitedUser=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?g.socket.emitEvent("user-denied",a,function(m,b){null===m?d.a.error("Error on knock deny request",b):(g.awaitedParticipants.delete(a),c(m,b))}):d.a.error("denyAwaitedUser() invalid param - callback")};
var $b=function(a){d.a.info("onRoomConnected() - reconnection: "+g.reconnectionState);var m=[],c=a.streams||[],b=a.id,h=a.userList,f=a.room;g.me=a.user||{};g.roomSettings=a.room.settings||{};g.mute=g.muteInfo.room.audio=a.room.mute;g.reconnectionState||(g.muteInfo.stream.hard.audio=g.muteInfo.room.audio);g.mediaRecord=a.mediaRecord;g.subscription=a.subscription;g.mode=a.room.settings.mode;g.share_override_room=a.room.settings.screen_share_override||!1;B.a.csp_enabled||(document.head.append(Y),document.head.append(wa));
"lecture"===g.mode&&"moderator"===a.user.role&&(0<a.raisedHands.length&&a.raisedHands.forEach(function(a){g.cCrequest.push(a)}),0<a.floorInvites.length&&a.floorInvites.forEach(function(a){g.cCrequest.push(a)}),0<a.approvedHands.length&&a.approvedHands.forEach(function(a){g.cCapprovedHands.push(a)}));g.activeTalker=f.settings.active_talker;for(n in a.awaitedParticipants)g.awaitedParticipants.set(a.awaitedParticipants[n].clientId,{clientId:a.awaitedParticipants[n].clientId,name:a.awaitedParticipants[n].name});
g.iceServers=a.iceServers;g.state=2;g.mediaConfiguration=a.mediaConfiguration;a.nonTalkerMediaParams&&(g.nonTalkerMediaParams=a.nonTalkerMediaParams);g.videoMutedUsers=a.videoMutedUsers;r.defaultVideoBW=a.defaultVideoBW;r.maxVideoBW=a.maxVideoBW;g.clientId=a.clientId;g.confId=a.room.conf_num;g.maxVideoLayers=a.maxVideoLayers||0;g.maxCanvasRefreshRate=a.maxCanvasRefreshRate||0;g.share=a.room.share;g.locked=a.room.locked||!1;g.waitRoom=a.room.waitRoom||!1;g.knockEnabled=a.room.knockEnabled||!1;g.userAudioTalkerCount=
a.numAudioTalkers||0;g.userVideoTalkerCount=a.numVideoTalkers||0;r.minVideoBW=a.minVideoBW;r.maxVideoFps=a.maxVideoFps;g.liveRoomTranscription=a.transcription;!0===a.transcription&&(g.transcriptionLanguage=a.transcriptionLanguage);g.internetDetectionUrl=void 0!=a.internetDetectionUrl?a.internetDetectionUrl:B.a.internetDetectionUrl;g.floorOpen=void 0!==a.room.openFloor?a.room.openFloor:!0;B.a.setVideoBwQualityMapper(a.videoBitrateQualityMap);t.a.setClientId(a.clientId);a.utilToken&&t.a.setEventLoggerToken(a.utilToken);
if(void 0!==a.room.fileShareService){var n={};n=a.room.fileShareService;var k={};k.call_num=a.clientId;k.room_id=a.id;k.service_id=a.room.service_id;k.conf_num=a.room.conf_num;k.userName=a.user.name||"";V=a.room.fileShareService.maxSize;n.callInfo=k;Object(v.f)(n)}void 0!=a.isStreamingClient?!0===a.isStreamingClient?(d.a.info("is a streaming client"),g.isStreamingClient=!0):(d.a.debug("NOT A S T Client"),g.isStreamingClient=!1):d.a.info(" server does not support file sharing ",a.room.fileShareService);
void 0!=a.room.hls&&(g.hls=a.room.hls);g.audienceCount=a.audienceCount?a.audienceCount:0;a.room.customRoomData&&(g.customRoomData=a.room.customRoomData);a.room.customSessionData&&(g.customSessionData=a.room.customSessionData);k=a.initialNumATs?parseInt(a.initialNumATs):1;var u=Object.keys(c);d.a.info(" onRoomConnected() num subs streams: "+u.length+" activate: "+k);for(var x=0;x<u.length;x+=1){var w=c[u[x]];n=Object(e.a)(g.Connection,{streamID:w.id,local:!1,audio:w.audio,video:w.video,data:w.data,
screen:w.screen,canvas:!("undefined"===typeof w.canvas||!1===w.canvas),attributes:w.attributes});m.push(n);n.screen||n.canvas||parseInt(w.id)<=k||g.isStreamingClient?Z.add(w.id,n):ra.add(w.id,n)}N=k;g.roomID=b;g.confID=f.conf_num;d.a.info("Connected to room "+g.roomID);for(var l in h)g.userList.set(h[l].clientId,h[l]);g.getMaxTalkers(function(a){g.talkerCount=a.maxTalkers});c={conf_num:f.conf_num,name:f.name,owner_ref:f.owner_ref,mode:f.settings.mode,moderators:f.settings.moderators,participants:f.settings.participants,
auto_recording:f.settings.auto_recording,canvas:f.settings.canvas,description:f.settings.description,created:f.created,mute:f.mute,quality:f.settings.quality,screen_share:f.share,locked:f.locked,wait_room:f.wait_room,duration:f.remainingDuration,analyzer:f.analyzer,screen_share_override:f.settings.screen_share_override};g.screenResolutionRange=null!=a.room.screenResolutionRange?a.room.screenResolutionRange:B.a.screen_resolution_range[c.quality];void 0!=g.speakerInfo.id&&rb(g.speakerInfo.id,function(a){a||
(g.speakerInfo.id=void 0);d.a.error("selected speaker id valid : "+a)});d.a.debug("room-connected event - room Info : "+JSON.stringify(c));m=Object(q.e)({type:"room-connected",streams:m,users:h,room:c,me:g.me,mediaRecord:g.mediaRecord});g.dispatchEvent(m);d.a.info("that.externalIp: ",g.externalIp);g.reconnectClientName=a.user.name;g.createEventLog("clientConnSuccess",{clientId:a.clientId,clientName:a.user.name,hostType:B.a.browser_info.name,hostVersion:B.a.browser_info.version,externalIp:g.externalIp})},
nb=function(a,c){var m=0;g.localStreams.forEach(function(a,c){"connected"!=a.state&&(m++,d.a.error(" pub stream not connected id: "+c))});g.remoteStreams.forEach(function(a,m){"connected"!=a.state&&d.a.error(" sub stream not connected id: "+m)});d.a.debug("mediaConnectionTimeout (): streamId: "+a+" disc streams: "+m);m&&ta(!1,!0)},cb=function(a){d.a.info(" onRoomDisconnected() : calling that.disconnect  with msg : "+JSON.stringify(a));void 0==a&&(a=n.a.CC002);g.disconnect(a)},Ba=function(a,c,b,e,
h,f,k){var m=!1,u=function(a,c,b,e){d.a.info("hardMuteMediaDevices callback resp : "+JSON.stringify(c));c.result===n.a.error_000.result&&e&&(b?g.dispatchEvent(Object(q.e)(e)):a.dispatchEvent(Object(q.f)(e)),m=!0)};d.a.info("hardMuteMediaDevices muteOn: "+a+" audio: "+c+" video: "+b+" sendsendServerEvent : "+e);g.localStreams.forEach(function(m,d){c&&m.ifAudio()?a?(g.muteInfo.stream.hard.audio=!0,m.muteAudio(function(a){u(m,a,f,k);h(a)},e,0,!1)):(g.muteInfo.stream.hard.audio=!1,m.unmuteAudio(function(a){u(m,
a,f,k);h(a)},e,0,!1)):b&&m.ifVideo()&&(a?(g.muteInfo.stream.hard.video=!0,m.muteVideo(function(a){u(m,a,f,k);h(a)},e,0,!1)):(g.muteInfo.stream.hard.video=!1,m.unmuteVideo(function(a){u(m,a,f,k);h(a)},e,0,!1)))});if(!m&&f&&k){var pa=Object(q.e)(k);g.dispatchEvent(pa)}h&&(t.a.error("room-event",w.a.event_general_failed,{message:n.a.error_1159.error}),h(n.a.error_1159))},Eb=function(a,c,b,g){var m=function(a,m){m.result===n.a.error_000.result?d.a.info("mediaDeviceMuteOnJoin() "+a+" audio: "+JSON.stringify(c)+
" video: "+JSON.stringify(b)+" success"):d.a.error("mediaDeviceMuteOnJoin() "+a+" audio: "+JSON.stringify(c)+" video: "+JSON.stringify(b)+" failed. result: "+JSON.stringify(m))};b.local?a.muteVideo(function(a){m("videoSelfMuteCallback",a)},g,1E3,!0):a.selfMuteVideo&&a.unmuteVideo(function(a){m("videoSelfUnmuteCallback",a)},g,1E3,!0);b.hard?a.muteVideo(function(a){m("videoHardMuteCallback",a)},g,1E3,!1):a.hardVideoMuted&&a.unmuteVideo(function(a){m("videoHardUnmuteCallback",a)},g,1E3,!1);c.local?a.muteAudio(function(a){m("AudioSelfMuteCallback",
a)},g,1E3,!0):a.selfMuteAudio&&a.unmuteAudio(function(a){m("AudioSelfUnmuteCallback",a)},g,1E3,!0);c.hard?a.muteAudio(function(a){m("AudioHardMuteCallback",a)},g,1E3,!1):a.hardAudioMuted&&a.unmuteAudio(function(a){m("AudioHardUnmuteCallback",a)},g,1E3,!1)},ac=function(a,d){g.hardMuteInitiator=!1;Ba(!0,!0,!1,!0,d,!0,{type:"hardmute-user-audio",message:a})},bc=function(a,d){g.hardMuteInitiator=!1;Ba(!1,!0,!1,!0,d,!0,{type:"hardunmute-user-audio",message:a})},cc=function(a,d){Ba(!0,!1,!0,!0,d,!0,{type:"hardmute-user-video",
message:a})},dc=function(a,d){Ba(!1,!1,!0,!0,d,!0,{type:"hardunmute-user-video",message:a})},ec=function(a){xa(!0,g.canvasStatus);var m=Object(q.e)({type:"share-started",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,layout:a.layout}});g.shareStatus=!0;g.clientId==a.clientId&&(g.isSharingClient=!0);d.a.debug(" share-started event : "+JSON.stringify(m));g.dispatchEvent(m)},fc=function(a){0===a.result&&a.mediaConfiguration!==g.mediaConfiguration&&(g.mediaConfiguration=a.mediaConfiguration,
g.localStreams.forEach(function(m,d){m.resetMediaConfiguration(a.mediaConfiguration)}))},gc=function(a){d.a.info("Stop sharing requested by client: ",a.clientId);g.forcedStopSharing=!0;console.log("that.forcedStopSharing: ",g.forcedStopSharing);g.isSharingClient&&(d.a.info("stopScreenShare for current client"),g.stopScreenShare(function(a){}));1==g.isCanvasSharingClient&&(d.a.info("stopCanvasShare for current client"),g.stopAnnotation(function(a){}))},hc=function(a){d.a.info("Update Layout requested by client: ",
a.clientId);g.clientId!=a.clientId&&(a=Object(q.e)({type:"layout-updated",message:a}),g.dispatchEvent(a))},ic=function(a){xa(!1,g.canvasStatus);var m={streamType:"share",streamId:a.streamId,negotiatedCodecs:{video:{codec:"default"===g.mediaConfiguration||"Default"===g.mediaConfiguration?"VP8":g.mediaConfiguration},audio:{codec:"OPUS"}},externalIp:g.externalIp};console.log("that.forcedStopSharing: ",g.forcedStopSharing);a=0==g.forcedStopSharing?Object(q.e)({type:"share-stopped",message:{clientId:a.clientId,
name:a.name,streamId:a.streamId}}):Object(q.e)({type:"share-stopped",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,stoppedBy:"moderator"}});g.forcedStopSharing=!1;g.shareStatus=!1;console.log(" share-stopped event : "+JSON.stringify(a));g.dispatchEvent(a);d.a.info("additionalOptions: ",m);g.createEventLog("clientStreamShareStopped",m);g.isSharingClient=!1;g.isOverRidingShare&&(console.log("onShareStopped start sharing for this client"),m=g.startScreenShare(g.shareOverRideCallback),
g.ScreenSharelocalStream=m,m=Object(q.e)({type:"start-new-screen-share",message:{clientId:g.clientId}}),g.dispatchEvent(m),g.isOverRidingShare=!1)},jc=function(a){console.log("onScreenShareOverride");g.isSharingClient&&(g.stopScreenShare(function(a){console.log("stopScreenShare response: ",a)}),a=Object(q.e)({type:"stop-old-screen-share",message:{clientId:g.clientId}}),g.dispatchEvent(a))},kc=function(a){g.userList.get(a.clientId).audioMuted=a.user.audioMuted;g.userList.set(a.clientId,a.user);a=Object(q.g)({type:"user-audio-muted",
clientId:a.clientId});g.dispatchEvent(a)},lc=function(a){g.userList.get(a.clientId).audioMuted=a.user.audioMuted;g.userList.set(a.clientId,a.user);a=Object(q.g)({type:"user-audio-unmuted",clientId:a.clientId});g.dispatchEvent(a)},mc=function(a){g.userList.get(a.clientId).videoMuted=a.user.videoMuted;g.userList.set(a.clientId,a.user);a=Object(q.g)({type:"user-video-muted",clientId:a.clientId});g.dispatchEvent(a)},nc=function(a){g.userList.get(a.clientId).videoMuted=a.user.videoMuted;g.userList.set(a.clientId,
a.user);a=Object(q.g)({type:"user-video-unmuted",clientId:a.clientId});g.dispatchEvent(a)},xa=function(a,c){g.localStreams.forEach(function(m){if(!m.ifCanvas()&&!m.ifScreen()&&m.video&&m.local&&1<g.maxVideoLayers){var b=a||c?"ND":W.roomMeta.settings.quality;b={0:1E3*B.a.video_bandwidth_range[b][2].max,1:1E3*B.a.video_bandwidth_range[b][1].max,2:1E3*B.a.video_bandwidth_range[b][0].max};d.a.info("updating main video simulcast bps: "+JSON.stringify(b));m.updateSimulcastLayersBitrate(b)}})};g.publish=
function(a,c,b){c=void 0===c?{}:c;b=void 0===b?function(){}:b;if("function"===typeof b){var m=c;if(g.subscription&&(!g.subscription.audio_video&&a.video||!g.subscription.audio_only&&!g.subscription.audio_video&&a.audio||!g.subscription.audio_video&&a.canvas||!g.subscription.audio_video&&a.share))d.a.error("Licence error : feature not supported subscription - av: "+g.subscription.audio_video+" audio: "+g.subscription.audio_only+" canvas: "+g.subscription.audio_video+" share: "+g.subscription.audio_video+
" req audio: "+a.audio+" video: "+a.video+" share: "+a.share+" canvas: "+a.canvas),t.a.error("room-event",w.a.event_general_failed,{message:n.a.error_1170.error}),b(n.a.error_1170);else{if(a.video&&!a.canvas&&!a.share&&null!=a.videoStream){var e=void 0==a.videoSize?!0:!1,h=sb(a,!0);if(h.result!==n.a.error_000.result){d.a.error(" Failed : room.publish video size invalid video size req: "+a.videoSize+" default : "+JSON.stringify(H));t.a.error("room-event",w.a.event_general_failed,{message:"room.publish video size invalid video size req: "+
a.videoSize+" default : "+JSON.stringify(H)});b(h);return}!e||void 0===a.videoSize||"mobile"===B.a.browser_info.device_type||a.videoSize[0]==B.a.video_resolution_range.Default.min.wdith&&a.videoSize[1]==B.a.video_resolution_range.Default.min.height&&a.videoSize[2]==B.a.video_resolution_range.Default.min.wdith&&a.videoSize[3]==B.a.video_resolution_range.Default.max.height||a.setVideoQualityParams(a.videoSize[0],a.videoSize[1],a.videoSize[2],a.videoSize[3]);a.maxVideoLayers=g.maxVideoLayers}a.userRequestOptions=
JSON.parse(JSON.stringify(c));!a.audio||a.canvas||a.share||null!=a.audioStream||(a.audio=!1);!1===g.reconnectionState?a.ifScreen()?m.forceTurn=za:a.ifCanvas()?(m.forceTurn=na,va=m.canvasType):(na=za=da=m.forceTurn?m.forceTurn:!1,(m.maxVideoBW||m.minVideoBW||m.maxVideoFps)&&a.setVideoParamsRange(m.maxVideoBW,m.minVideoBW,m.maxVideoFps,void 0,!1),(r.maxVideoBW||r.minVideoBW||r.maxVideoFps)&&a.setVideoParamsRange(r.maxVideoBW,r.minVideoBW,r.maxVideoFps,void 0,!0),d.a.info(" options.maxVideoBW: "+m.maxVideoBW+
" spec.maxVideoBW: "+r.maxVideoBW),void 0==m.maxVideoBW&&(m.maxVideoBW=r.maxVideoBW,m.minVideoBW=r.minVideoBW)):a.ifScreen()?m.forceTurn=za:a.ifCanvas()?(m.forceTurn=na,m.canvasType=va):m.forceTurn=da;m.maxVideoBW=m.maxVideoBW||r.defaultVideoBW;m.maxVideoBW>r.maxVideoBW&&(m.maxVideoBW=r.maxVideoBW);void 0===m.minVideoBW&&(m.minVideoBW=0);m.minVideoBW>r.defaultVideoBW&&(m.minVideoBW=r.defaultVideoBW);m.forceTurn&&(a.forceTurn=m.forceTurn);m.simulcast=m.simulcast||!1;m.muteStream={audio:a.ifCanvas()?
!0:a.audioMuted,video:a.videoMuted};g.muteAudioOnJoin=!!m.audioMuted;g.muteVideoOnJoin=!!m.videoMuted;d.a.debug("Publish forceTurn: ( "+m.forceTurn+","+da+" ) reconnect state: "+g.reconnectionState);a&&a.local&&!a.failed?g.waitRoom?(d.a.error("Publish() : failed Moderator not present and  waiting for moderator "),t.a.error("room-event",w.a.event_general_failed,{message:n.a.error_1130.error}),b(n.a.error_1130)):a.ifMedia()?a.ifExternal()?Qb(a,m,b):(void 0!=g.videoMuteOnJoin&&delete g.videoMuteOnJoin,
void 0!=g.audioMuteOnJoin&&delete g.audioMuteOnJoin,!g.reconnectionState&&!a.reconnect||a.ifCanvas()||a.ifScreen()?(d.a.info("Publish stream options : ",m),Va(a,m,b)):(g.audioMuteOnJoin={local:a.selfMuteAudio,hard:a.hardAudioMuted},a.selfMuteVideo||a.hardVideoMuted?(g.videoMuteOnJoin={local:a.selfMuteVideo,hard:a.hardVideoMuted},a.unmuteVideo(function(c){0==c.result?(a.muteVideo(function(){},!1,0,!0,!0),d.a.info("Publish stream options after unmute video success")):d.a.error("Publish stream options after unmute video failed :"+
JSON.stringify(c));Va(a,m,b)},!1,0,!a.hardVideoMuted)):Va(a,m,b))):a.ifData()&&Rb(a,m,b):(d.a.error("Trying to publish invalid stream"),t.a.info("room-event",w.a.event_stream_publish_failed,{stream:a}),b(void 0,"Invalid Stream"),c={streamId:a.getID(),selectedCandidates:{local:"",remote:""},negotiatedCodecs:{video:{codec:"default"===g.mediaConfiguration||"Default"===g.mediaConfiguration?"VP8":g.mediaConfiguration},audio:{codec:"OPUS"}},selectedCam:a.video.deviceId,selectedMic:a.audio.deviceId,error:"Invalid stream",
externalIp:g.externalIp},g.createEventLog("clientStreamPublishFailed",c))}}else d.a.error("publish() invalid param - callback")};var oc=function(a){a=Object(q.e)({type:"room-record-on",message:{moderatorId:a.moderatorId}});g.dispatchEvent(a)},pc=function(a){a=Object(q.e)({type:"room-record-off",message:{moderatorId:a.moderatorId}});g.dispatchEvent(a)},qc=function(a){a=Object(q.e)({type:"room-live-recording-on",message:{message:"live recording is running"}});g.dispatchEvent(a)},rc=function(a){a=Object(q.e)({type:"room-live-recording-off",
message:{message:""}});g.dispatchEvent(a)},sc=function(a){a=Object(q.e)({type:"room-live-recording-failed",message:{error:a.error}});g.dispatchEvent(a)},tc=function(a){a=Object(q.e)({type:"change-layout",message:{layout:a.layout}});g.dispatchEvent(a)},uc=function(a){g.liveRoomTranscription=!0;g.transcriptionLanguage=a.language;a=Object(q.e)({type:"room-transcription-on",message:{language:a.language}});g.dispatchEvent(a)},vc=function(a){g.liveRoomTranscription=!1;!1===g.liveTranscription&&(g.transcriptionLanguage=
"");a=Object(q.e)({type:"room-transcription-off",message:{}});g.dispatchEvent(a)},wc=function(a){g.liveTranscription=!0;g.transcriptionLanguage=a.language;a=Object(q.e)({type:"self-transcription-on",message:{language:a.language}});g.dispatchEvent(a)},xc=function(a){g.liveTranscription=!1;!1===g.liveRoomTranscription&&(g.transcriptionLanguage="");a=Object(q.e)({type:"self-transcription-off",message:{}});g.dispatchEvent(a)},yc=function(a){"safari"===f.a.browserEngineCheck()&&!1===g.sendRecvBitrateStats&&
tb();if(g.nonTalkerMediaParams&&a.active!=z){if(a.active){if(void 0==J&&(J=r.maxVideoBW),void 0!=r.minVideoBW){var c={min:r.minVideoBW,max:J};var m=r.maxVideoFps}}else c={min:g.nonTalkerMediaParams.video.bw,max:g.nonTalkerMediaParams.video.bw},m=g.nonTalkerMediaParams.video.fps;void 0!=c&&(z=a.active,g.localStreams.forEach(function(b,g){!b.ifVideo()||b.ifScreen()||b.ifCanvas()||(d.a.debug("onActiveList (): setting video param for AT: "+a.active+" kbps: "+c.max+" fps:"+m),b.setVideoParamsRange(c.max,
c.min,m,void 0,!0))}))}for(var b=new Map,e=0;e<a.activeList.length;e++)if(g.remoteStreams.getAll()[a.activeList[e].streamId]){"audio"===a.activeList[e].mediatype&&g.videoMutedUsers[a.activeList[e].clientId]?(g.remoteStreams.getAll()[a.activeList[e].streamId].audioOnly=!0,d.a.info("Recieved active talker list, videomuted: "+a.activeList[e].videomuted+" reason: "+a.activeList[e].reason),g.remoteStreams.getAll()[a.activeList[e].streamId].setVideoMutedMessage(a.activeList[e]),delete g.videoMutedUsers[a.activeList[e].clientId]):
"audioOnly"===a.activeList[e].mediatype&&(g.remoteStreams.getAll()[a.activeList[e].streamId].audioOnly=!0);g.remoteStreams.getAll()[a.activeList[e].streamId].audioOnly&&"audiovideo"===a.activeList[e].mediatype&&delete g.remoteStreams.getAll()[a.activeList[e].streamId].audioOnly;g.remoteStreams.getAll()[a.activeList[e].streamId].reloadPlayer(a.activeList[e],aa);b.set(a.activeList[e].streamId,a.activeList[e]);var h=ba.get(a.activeList[e].streamId);if(h&&h.mediatype!=a.activeList[e].mediatype){switch(a.activeList[e].mediatype){case "audiovideo":case "video":g.remoteStreams.getAll()[a.activeList[e].streamId].setVideoMutedMessage(a.activeList[e]);
g.remoteStreams.getAll()[a.activeList[e].streamId].blankFrameSet&&delete g.remoteStreams.getAll()[a.activeList[e].streamId].blankFrameSet;break;case "audio":case "audioOnly":g.remoteStreams.getAll()[a.activeList[e].streamId].setVideoMutedMessage(a.activeList[e]);g.remoteStreams.getAll()[a.activeList[e].streamId].blankFrameSet||(g.remoteStreams.getAll()[a.activeList[e].streamId].blankFrameSet=!0);break;default:d.a.info("mediatype not handled entry:",JSON.stringify(a.activeList[e]))}ba.set(a.activeList[e].streamId,
a.activeList[e])}else h||ba.set(a.activeList[e].streamId,a.activeList[e])}else d.a.error("onNewActiveTalker() remote stream undefined streamId: "+a.activeList[e].streamId);g.activeTalkerList=b;b=Object(q.e)({type:"active-talkers-updated",message:{activeList:a.activeList,active:a.active}});g.dispatchEvent(b);g.allStreamsActive||(g.allStreamsActive=!0,0==g.streamsHealthTimerId&&(void 0!=S&&(clearTimeout(S),S=void 0),g.streamsHealthTimerId=setInterval(Ya,1E4)))};g.startRecord=function(a){a=void 0===
a?function(){}:a;"function"===typeof a?g.startRecording(void 0,a):d.a.error("startRecord() invalid param - callback")};g.stopRecord=function(a){a=void 0===a?function(){}:a;"function"===typeof a?g.stopRecording(void 0,a):d.a.error("stopRecord() invalid param - callback")};g.startStreaming=function(a,c){c=void 0===c?function(){}:c;if("function"===typeof c&&"object"===typeof a&&a.hasOwnProperty("rtmpDetails")){d.a.info("start streaming called");var m=!0;if("moderator"!==g.me.role)m=!1,d.a.info("user is trying to start streaming and he is not a moderator"),
t.a.error("room-event",w.a.event_general_failed,{message:"startStreaming - "+n.a.error_7008.desc}),c(n.a.error_7008);else if(void 0===a.rtmpDetails)t.a.error("room-event",w.a.event_general_failed,{message:"startStreaming - "+n.a.error_7009.desc}),c(n.a.error_7009);else if(void 0!==a.rtmpDetails.rtmpUrl&&3<a.rtmpDetails.rtmpUrl.split(",").length)c(n.a.error_7101);else if(/(http|https|rtmp|rtmps):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(a.rtmpDetails.rtmpUrl)){var b={};
0===g.state?(b=n.a.error_7103,d.a.info(" room is disconnected"),c(b)):(c&&"function"===typeof c||(c=function(a){d.a.info("SDK defined callback streaming response ",a)}),d.a.info("start streaming called with callback "),m?y.sendMessage("startStreaming",a,function(a,m){null===a?(d.a.error("Error on start streaming",m),void 0!==m.result?c(m):void 0!==m.status&&c({result:m.status.resultCode,error:"streaming error",desc:m.status.error.errorDesc,status:m.status})):c({result:a.status.resultCode,error:"",
desc:"",status:a.status},m)}):c(n.a.error_7000))}else d.a.info(" invalid rtmp or page input url"),m=!1,t.a.error("room-event",w.a.event_general_failed,{message:"startStreaming - "+n.a.error_7102.desc}),c(n.a.error_7102)}else d.a.error("startStreaming() invalid param - streamingConfig/callback")};g.stopStreaming=function(a,c){var m;void 0!=a&&"function"===typeof a?m=a:void 0!=c&&"function"===typeof c&&(m=c);"function"===typeof m?(d.a.info("stop streaming called"),"moderator"!==g.me.role?(d.a.info("user is trying to stop streaming and he is not a moderator"),
m(n.a.error_7044)):(a={options:{confNum:"12345",roomId:"9876"},rtmpDetails:{rtmpUrl:"rtmp://a.rtmp.youtube.com/live2/4rjb-hprf-7wf5-9923"},urlDetails:{url:"https://vc-manu.vcloudx.com:9074/room/?token=",layOut:{}}},c={},0===g.state?(c=n.a.error_7045,d.a.info(" room is disconnected"),m(c)):(m&&"function"===typeof m||(m=function(a){d.a.info("SDK defined callback streaming response ",a)}),d.a.info("stop called with callback "),y.sendMessage("stopStreaming",a,function(a,c){null===a?(d.a.error("Error on stop streaming",
c),void 0!==c.status&&m({result:c.status.resultCode,error:"streaming error",desc:c.status.error.errorDesc,status:c.status})):(d.a.info("Stop streaming"),m({result:a.status.resultCode,error:"",desc:"",status:a.status},c))})))):d.a.error("stopStreaming() invalid param - streamingConfig/callback")};g.setStreamingParams=function(a,c){d.a.info("set Streaming Params called");if("moderator"!==g.me.role)d.a.warning("User should be a moderator user to change Streaming params"),c(n.a.error_7072);else{var m=
{};0===g.state?(m=n.a.error_7078,d.a.info(" room is disconnected"),c(m)):(c&&"function"===typeof c||(c=function(a){d.a.info("SDK defined callback Streaming params change response ",a)}),d.a.info("Streaming params change called with callback "),y.sendMessage("setStreamingParams",a,function(a,m){null===a?(d.a.error("Error on Streaming param change: ",m),t.a.error("room-event",w.a.event_streaming_param_change_failed,{error:m,message:m.status.error}),c(m)):(d.a.info("Streaming param change Success"),
t.a.info("room-event",w.a.event_streaming_param_change_success,{error:{}}),c(a,m))}))}};g.startLiveRecording=function(a,c){d.a.info("start Live Recording called");var m=!0;if("moderator"!==g.me.role)m=!1,d.a.warning("User should be a moderator to start live recording"),c(n.a.error_7201);else{var b={};0===g.state?(b=n.a.error_7203,d.a.info(" room is disconnected"),c(b)):(c&&"function"===typeof c||(c=function(a){d.a.info("SDK defined callback Live recording response ",a)}),d.a.info("start Live Recording called with callback "),
m?y.sendMessage("startLiveRecording",a,function(a,m){if(null===a&&(d.a.error("Error on start Live Recording",m),t.a.error("room-event",w.a.event_start_live_recording_failed,{error:m,message:m.message}),void 0!==m.status)){c({result:m.status.resultCode,error:"live recording error",desc:m.status.error.errorDesc});return}7014===a.status.resultCode&&(ja=!0);t.a.info("room-event",w.a.event_start_live_recording_success,{error:{}});d.a.info("Start Live Recording Success");c({result:a.status.resultCode,error:"",
desc:""},m)}):c(n.a.error_7204))}};g.stopLiveRecording=function(a){a=void 0===a?function(){}:a;d.a.info("stop Live Recording called");if("moderator"!==g.me.role)d.a.warning("User should be a moderator user to start live recording"),a(n.a.error_7036);else{var c={urlDetails:{url:"",layOut:{}}},m={};0===g.state?(m=n.a.error_7037,d.a.info(" room is disconnected"),a(m)):(a&&"function"===typeof a||(a=function(a){d.a.info("SDK defined callback Live Recording response ",a)}),d.a.info("stop Live Recording called with callback "),
y.sendMessage("stopLiveRecording",c,function(c,m){null===c?(d.a.error("Error on stop stop live recording",m),t.a.error("room-event",w.a.event_stop_live_recording_failed,{error:m,message:m.message}),void 0!==m.status&&a({result:m.status.resultCode,error:"live recording error",desc:m.status.error.errorDesc})):(7034===c.status.resultCode&&(ja=!1,c.status.resultCode=0),d.a.info("Stop Live Recording Success"),t.a.info("room-event",w.a.event_stop_live_recording_success,{error:{}}),a({result:c.status.resultCode,
error:"",desc:""},m))}))}};g.setLiveRecordingParams=function(a,c){d.a.info("set Live Recording Params called");if("moderator"!==g.me.role)d.a.warning("User should be a moderator user to change live recording params"),n.a.error_7071.desc="Only moderator can change live recording params",c(n.a.error_7071);else{var m={};0===g.state?(m=n.a.error_7079,d.a.info(" room is disconnected"),c(m)):(c&&"function"===typeof c||(c=function(a){d.a.info("SDK defined callback Live Recording params change response ",
a)}),d.a.info("Live Recording params change called with callback "),y.sendMessage("setLiveRecordingParams",a,function(a,m){null===a?(d.a.error("Error on live recording param change: ",m),t.a.error("room-event",w.a.event_live_recording_param_change_failed,{error:m,message:m.status.error}),c(m)):(d.a.info("Live Recording param change Success"),t.a.info("room-event",w.a.event_live_recording_param_change_success,{error:{}}),c(a,m))}))}};g.invalidateTranscoding=function(a,c){d.a.info("Invalidate Transcoding called");
var m={};0===g.state?(m=n.a.error_8000,d.a.info(" room is disconnected"),c(m)):(c&&"function"===typeof c||(c=function(a){d.a.info("SDK defined callback Invalidate Transcoding response ",a)}),d.a.info("Invalidate Transcoding called with callback "),y.sendMessage("invalidateTranscoding",a,function(a,m){null===a?(d.a.error("Error on Invalidate Transcoding",m),c(m)):(d.a.info("Invalidate Transcoding"),c(a,m))}))};g.requestFloor=function(a){a=void 0===a?function(){}:a;"function"===typeof a?ua(g.clientId,
"requestFloor",function(c,d){a(c,d);void 0!==c&&(g.cCrequest=g.cCrequest.filter(function(a){return a.clientId!==options}))}):d.a.error("requestFloor() invalid param - callback")};g.cancelFloor=function(a){a=void 0===a?function(){}:a;"function"===typeof a?ua(g.clientId,"cancelFloor",function(c,d){a(c,d);null!==c&&(g.cCrequest=g.cCrequest.filter(function(a){return a.clientId!==options}))}):d.a.error("cancelFloor() invalid param - callback")};g.finishFloor=function(a){a=void 0===a?function(){}:a;"function"===
typeof a?ua(g.clientId,"finishFloor",function(c,m){T.forEach(function(a,c){d.a.info("finishFloor: unpulish "+a.getID()+"::::"+c);g.unpublish(a,function(a){})});g.floorGranted=!1;a(c,m)}):d.a.error("finishFloor() invalid param - callback")};g.grantFloor=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?ua(a,"grantFloor",function(d,m){null!==d&&(g.cCrequest=g.cCrequest.filter(function(c){return c.clientId!==a}),g.cCapprovedHands.push({clientId:a,moderatorId:g.clientId}));c(d,m)}):d.a.error("grantFloor() invalid param - callback")};
g.denyFloor=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?ua(a,"denyFloor",function(d,m){c(d,m);null!==d&&(g.cCrequest=g.cCrequest.filter(function(c){return c.clientId!==a}))}):d.a.error("denyFloor() invalid param - callback")};g.relaseFloor=function(a,c){g.releaseFloor(a,void 0===c?function(){}:c)};g.releaseFloor=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?ua(a,"releaseFloor",function(d,m){null!==d&&(g.cCrequest=g.cCrequest.filter(function(c){return c.clientId!==
a}),Ja(a));c(d,m)}):d.a.error("releaseFloor() invalid param - callback")};g.inviteToFloor=function(a,c){c=void 0===c?function(){}:c;var d={clientId:a};g.socket.sendMessage("inviteToFloor",d,function(m){0===m.result&&g.cCrequest.push({clientId:d.clientId,name:g.userList.get(a).name,type:"requested"});c(m)})};g.acceptInviteFloorRequest=function(a){a=void 0===a?function(){}:a;ua(g.clientId,"acceptFloor",function(c,d){a(c,d);void 0!==c&&(g.cCrequest=g.cCrequest.filter(function(a){return a.clientId!==
options}))})};g.rejectInviteFloor=function(a){a=void 0===a?function(){}:a;ua(g.clientId,"rejectFloor",function(c,d){g.floorInvited=!1;a(c,d);void 0!==c&&(g.cCrequest=g.cCrequest.filter(function(a){return a.clientId!==options}))})};g.cancelFloorInvite=function(a,c){c=void 0===c?function(){}:c;ua(a,"cancelFloorInvite",function(a,d){c(a,d);void 0!==a&&(g.cCrequest=g.cCrequest.filter(function(a){return a.clientId!==options}))})};g.chairControlMuteAll=function(a){a=void 0===a?function(){}:a;g.socket.sendEvent("room-muted",
function(c,m){null===c?(d.a.error("Error on floor request",m),a(void 0,m)):a(c)})};g.chairControlUnMuteAll=function(a){a=void 0===a?function(){}:a;g.socket.sendEvent("room-unmuted",function(c,m){null===c?(d.a.error("Error on floor request",m),a(void 0,m)):a(c)})};g.muteOne=function(a,c){c=void 0===c?function(){}:c;g.socket.sendParamEvent("muteUser",a,function(a,m){null===a?(d.a.error("Error on floor request",m),c(void 0,m)):c(a)})};g.unMuteOne=function(a,c){c=void 0===c?function(){}:c;g.socket.sendParamEvent("unMuteUser",
a,function(a,m){null===a?(d.a.error("Error on floor request",m),c(void 0,m)):c(a)})};g.muteRoom=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?void 0===a||void 0===a.audio&&void 0===a.video?c(n.a.error_1155):!1===a.video&&!1===a.audio?(d.a.error("at least one of the constraints should be false"),c(n.a.error_1155)):(T.forEach(function(c,m){c.screen||c.canvas||(!0===a.audio&&c.ifAudio()&&!c.selfMuteAudio&&c.muteAudio(function(a){d.a.info("Mute Audio for the call")},!0,0,!1,!0),c.ifVideo()&&
!0===a.video&&!c.selfMuteVideo&&c.muteVideo(function(a){d.a.info("Mute Video for the call")},!0,0,!1,!1,!0))}),g.socket.sendMessage("muteRoom",a,function(a,m){null===a?(d.a.error("Error on mute room request",m),t.a.error("room-event",w.a.event_room_mute_failed,{message:"mute room request failed"}),c(void 0,m)):(g.roomMuted=!0,t.a.info("room-event",w.a.event_room_mute_success,{message:"mute room request succeeded"}),c(a))})):d.a.error("muteRoom() invalid param - callback")};g.unMuteRoom=function(a,
c){c=void 0===c?function(){}:c;"function"===typeof c?void 0===a||void 0===a.audio&&void 0===a.video?c(n.a.error_1155):0!=a.video&&0!=a.audio?(d.a.error("at least one of the constraints should be false"),c(n.a.error_1155)):(T.forEach(function(c,m){c.screen||c.canvas||(d.a.info("SelfMuteAudio: "+c.selfMuteAudio+" hardMutedAudio: "+c.hardAudioMuted),a.audio||!c.ifAudio()||c.hardAudioMuted||c.unmuteAudio(function(a){d.a.info("UnMute Audio for the call")},!0,0,!1,!0),d.a.info("SelfMuteVideo: "+c.selfMuteVideo+
" hardMutedVideo: "+c.hardVideoMuted),a.video||!c.ifVideo()||c.hardVideoMuted||c.unmuteVideo(function(a){d.a.info("UnMute Video for the call")},!0,0,!1,!0))}),g.socket.sendMessage("unMuteRoom",a,function(a,m){null===a?(d.a.error("Error on mute room request",m),t.a.error("room-event",w.a.event_room_unmute_failed,{message:"unmute room request failed"}),c(void 0,m)):(g.roomMuted=!1,t.a.info("room-event",w.a.event_room_unmute_success,{message:"unmute room request succeeded"}),c(a))})):d.a.error("unMuteRoom() invalid param - callback")};
g.pauseRoom=function(a){a=void 0===a?function(){}:a;"function"===typeof a?(d.a.info("Pausing the room"),g.muteRoom({audio:!0,video:!0},function(c){a(c)})):d.a.error("pauseRoom() invalid param - callback")};g.resumeRoom=function(a){a=void 0===a?function(){}:a;"function"===typeof a?(d.a.info("Resuming the room"),g.unMuteRoom({audio:!1,video:!1},function(c){a(c)})):d.a.error("resumeRoom() invalid param - callback")};g.switchRoomMode=function(a,c){c=void 0===c?function(){}:c;g.socket.sendParamEvent("switchRoomMode",
a,function(a,m){null===a?(d.a.error("Error on floor request",m),c(void 0,m)):c(a)})};g.startRecording=function(a,c){c=void 0===c?function(){}:c;d.a.debug("Trying to start recording...");var m,b=!(g.subscription&&!1===g.subscription.recording);b&&(a&&!1===a.local||!a)?(a&&(m=a.getID()),y.sendMessage("startRecord",{to:m},function(a,m){null===a?(d.a.error("Error on start recording",m),t.a.error("room-event",w.a.event_start_recording_failed,{error:m,message:m.msg}),c(m),g.createEventLog("roomRecordingFailed",
{error:m,externalIp:g.externalIp})):(d.a.info("Started recording"),t.a.info("room-event",w.a.event_start_recording_success,{error:{}}),0===a.result&&(ja=!0),c(a,m),g.createEventLog("roomRecordingSuccess",{externalIp:g.externalIp}))})):b||(t.a.info("room-event",w.a.event_start_recording_failed,{message:n.a.error_1170.desc}),c(n.a.error_1170))};g.onMediaDeviceStateChanged=function(a,c,b){b=void 0===b?function(){}:b;if("active"==c.state)if("cam"==c.type)if("connected"!=a.state||a.negotiatedMedia.video)b(n.a.error_000);
else{if(a.userRequestOptions.video)var m=a.userRequestOptions.video;zc(m,a,b)}else b(n.a.error_000);else"inactive"==c.state&&(d.a.error("mediaDeviceError() errr: "+JSON.stringify(c.error)+"reconencting"),g.socket.disconnect(),b(n.a.error_000))};g.manageLiveTranscription=function(){console.log("Calling startLiveTranscription",g.liveTranscription);!0===g.liveTranscription&&0<g.reconnectAttempt&&!0===g.reconnectionAllowed&&g.socket.sendMessage("startLiveTranscription",{language:g.transcriptionLanguage},
function(a){g.liveTranscription=a&&0===a.result?!0:!1})};g.manageRecordingStatus=function(a){d.a.info("reconnected manage recording status ",a);"moderator"===g.me.role&&1==ja&&0<g.reconnectAttempt&&!0===g.reconnectionAllowed?(d.a.info("room recording was enabled before reconnect"),g.startRecord(function(a,c){null!==a?(d.a.info("reconnected manage recording success "),t.a.info("room-event",w.a.event_start_recording_success,{message:"reconnected manage recording success"})):(d.a.info("Failed to restart recording after reconnection."),
t.a.error("room-event",w.a.event_start_recording_failed,{message:"Failed to restart recording after reconnection."}))})):(d.a.info("reenbling recording for this role is not allowed ",g.me.role),t.a.info("room-event",w.a.event_start_recording_failed,{message:"reenbling recording for role "+g.me.role+" is not allowed"}))};g.stopRecording=function(a,c){c=void 0===c?function(){}:c;g.subscription&&!1===g.subscription.recording?(t.a.info("room-event",w.a.event_stop_recording_failed,{message:n.a.error_1170.desc}),
c(n.a.error_1170)):y.sendMessage("stopRecord",{id:a},function(m,b){null===m?(d.a.error("Error on stop recording",b),t.a.error("room-event",w.a.event_stop_recording_failed,{error:b}),c(b)):(ja=!1,d.a.info("Stop recording",a),t.a.info("room-event",w.a.event_stop_recording_success,{error:{}}),c(m,b),g.createEventLog("roomRecordingStopped",{externalIp:g.externalIp}))})};var Ka=function(a,c){var d=[];g.localStreamsBeforeReconnect.forEach(function(m,b){(m.canvas&&c||m.screen&&a||!(m.canvas||c||m.screen||
a))&&d.push(m)});for(var m=0;m<d.length;m++)g.localStreamsBeforeReconnect.remove(d[m].getID())},qb=function(a){d.a.debug("Inside storeLocalStreamForReconnect() reconnect: "+a.reconnect+" that.reconnectionState: "+g.reconnectionState+" that.reconnectionAllowed: "+g.reconnectionAllowed+" streamId: "+a.getID()+" canvas: "+a.canvas+" screen: "+a.screen);return a.reconnect||g.reconnectionState||g.reconnectionAllowed?(Ka(a.screen,a.canvas),g.localStreamsBeforeReconnect.add(a.getID(),a),!0):!1};g.unpublish=
function(a,c){c=void 0===c?function(){}:c;if("function"===typeof c)if(a&&a.local){y.sendMessage("unpublish",a.getID(),function(m,b){null===m?(d.a.error("Error unpublishing stream",b),t.a.error("room-event",w.a.event_stream_unpublish_failed,{error:b}),c(void 0,b)):(delete a.failed,t.a.error("room-event",w.a.event_stream_unpublish_success,{error:{}}),d.a.info("Stream unpublished"),c(!0))});a.room=void 0;var m=T.get(a.getID());void 0!==m&&(m.hardVideoMuted&&m.unmuteVideo(function(a){d.a.info("videoHardUnmuteCallback: "+
JSON.stringify(a))},!1,0,!1),m.hardAudioMuted&&m.unmuteAudio(function(a){d.a.info("audioHardUnmuteCallback: "+JSON.stringify(a))},!1,0,!1),m.pc.close(),m.pc=null,m.reconnect&&qb(m));T.remove(a.getID());a.setID(0);a.off("internal-send-data",Ra);a.off("internal-set-attributes",mb)}else t.a.info("room-event",w.a.event_stream_unpublish_failed,{error:"Cannot unpublish, stream does not exist or is not local"}),d.a.error("Cannot unpublish, stream does not exist or is not local"),c(void 0,"Cannot unpublish, stream does not exist or is not local");
else d.a.error("unpublish() invalid param - callback")};g.sendControlMessage=function(a,c,d){a&&a.getID()&&(c={type:"control",action:d},y.sendSDP("signaling_message",{streamId:a.getID(),msg:c}))};g.subscribe=function(a,c,b){c=void 0===c?{}:c;b=void 0===b?function(){}:b;var m=JSON.parse(JSON.stringify(c));d.a.debug("room.subscribe streamId: "+a.getID()+" options: "+JSON.stringify(m));if(!a||a.local||a.failed)c="Error on subscribe",a?a.local?(d.a.warning("Cannot subscribe to local stream, you should subscribe to the remote version of your local stream"),
c="Local copy of stream",t.a.error("room-event",w.a.event_stream_subscribe_failed,{error:c,stream:a})):a.failed&&(d.a.warning("Cannot subscribe to failed stream."),c="Failed stream",t.a.error("room-event",w.a.event_stream_subscribe_failed,{error:c,stream:a})):(d.a.warning("Cannot subscribe to invalid stream"),c="Invalid or undefined stream",t.a.error("room-event",w.a.event_stream_subscribe_failed,{error:c})),b(void 0,c),b={streamType:a.ifScreen()?"share":"main",streamId:a.getID(),selectedCandidates:{local:"",
remote:""},negotiatedCodecs:{video:{codec:"default"===g.mediaConfiguration||"Default"===g.mediaConfiguration?"VP8":g.mediaConfiguration},audio:{codec:"OPUS"}},error:c,externalIp:g.externalIp},g.createEventLog("clientStreamSubscribeFailed",b);else{if(a.ifMedia())a.ifVideo()||a.ifScreen()||(m.video=!1),a.ifAudio()||(m.audio=!1),a.ifCanvas()&&(m.data=!1),a.ifCanvas()||(m.canvas=!1),g.mediaConfiguration!==u.a.constant.H264_CODEC&&"safari"===B.a.browser_info.name&&B.a.browser_info.version<=u.a.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8?
(m.video=!1,d.a.debug("Stream for subscribe in room.subscribe:- SAFARI - false")):g.mediaConfiguration!==u.a.constant.H264_CODEC&&"safari"===B.a.browser_info.name&&B.a.browser_info.version>=u.a.constant.SAFARI_VERSION_SUPPORTING_VP8&&(m.video=!0,d.a.debug("Stream publish in Init publish:- SAFARI - true")),d.a.info("Stream for subscribe in room.subscribe:- options:: "+JSON.stringify(m)),m.muteStream={audio:a.ifCanvas()?!0:void 0!=a.audioMuted?a.audioMuted:!1,video:a.videoMuted},d.a.info("subscribe() streamId: ",
a.getID()," options  ",JSON.stringify(m)),!1===g.reconnectionState?(ha=m.forceTurn?m.forceTurn:!1,aa=m.imageOnVideoMute?m.imageOnVideoMute:!1):m.forceTurn=ha,d.a.debug(" Subscribe forceTurn: ( "+m.forceTurn+","+ha+" ) reconnect state: "+g.reconnectionState),a.forceTurn=m.forceTurn,a.userRequestOptions=JSON.parse(JSON.stringify(c)),ra.get(a.getID())?b(n.a.error_000):ab(a,m,b);else if(a.ifData()&&!1!==m.data)Tb(a,m,b);else{d.a.warning("There's nothing to subscribe to");b(void 0,"Nothing to subscribe to");
return}d.a.debug("Subscribing to: "+a.getID());t.a.info("room-event",w.a.event_stream_subscribe_success,{message:"Subscribing to: "+a.getID()});void 0!=S&&clearTimeout(S);S=setTimeout(function(){nb(a.getID(),!1)},3E4)}};g.unsubscribe=function(a,c){c=void 0===c?function(){}:c;void 0!==y?a&&!a.local?a.reconnect?(d.a.info(" in that.unsubscribe() remove stream"),Aa(a),delete a.failed,c(n.a.error_000)):y.sendMessage("unsubscribe",a.getID(),function(d,m){null===d?c(n.a.error_1167):(Aa(a),delete a.failed,
t.a.error("room-event",w.a.event_stream_unsubscribe_success,{message:"Unsubscribe from stream - success"}),c(n.a.error_000))},function(){d.a.error("Error calling unsubscribe.");t.a.error("room-event",w.a.event_stream_unsubscribe_failed,{stream:a})}):c(n.a.error_1156):c(n.a.error_1163)};g.hardMute=function(a){a=void 0===a?function(){}:a;"function"===typeof a?Ca("room-muted",!0,!1,!0,void 0,function(c){0==c.result&&(g.hardMuteInitiator=!0);a(c)}):d.a.error("hardMute() invalid param - callback")};g.hardUnmute=
function(a){a=void 0===a?function(){}:a;"function"===typeof a?Ca("room-unmuted",!0,!1,!0,void 0,function(c){0==c.result&&(g.hardMuteInitiator=!1);a(c)}):d.a.error("hardUnmute() invalid param - callback")};g.hardMuteUserAudio=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?Ca("hardmute-user-audio",!0,!1,!1,a,c):d.a.error("hardMuteUserAudio() invalid param - callback")};g.hardUnmuteUserAudio=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?Ca("hardunmute-user-audio",!0,
!1,!1,a,c):d.a.error("hardUnmuteUserAudio() invalid param - callback")};g.hardMuteUserVideo=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?Ca("hardmute-user-video",!1,!0,!1,a,c):d.a.error("hardMuteUserVideo() invalid param - callback")};g.hardUnmuteUserVideo=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?Ca("hardunmute-user-video",!1,!0,!1,a,c):d.a.error("hardUnmuteUserVideo() invalid param - callback")};g.subscriberVideoMute=function(a,c){g.socket.emitEvent(u.a.RoomEvent.subscriber_video_mute,
{streamId:a},function(a){0==a.result&&c(a)})};g.setTalkerCount=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?"undefined"!=typeof a&&"number"===typeof a&&0<=a&&a===parseInt(a)?(Da=a,g.socket.emitEvent(u.a.RoomEvent.set_active_talker,{numTalkers:a,numAudioTalkers:3>=a?3:a,numVideoTalkers:g.audioOnlyMode?0:a},function(a){0==a.result&&(g.userAudioTalkerCount=a.numAudioTalkers,!1===g.audioOnlyMode&&(g.userVideoTalkerCount=a.numVideoTalkers));c(a)})):c(n.a.error_1155):d.a.error("setTalkerCount() invalid param - callback")};
g.getTalkerCount=function(a){"function"===typeof a?g.socket.sendEvent(u.a.RoomEvent.get_active_talker,function(c){a(c)}):d.a.error("getTalkerCount() invalid param - callback")};g.getMaxTalkers=function(a){"function"===typeof a?g.socket.sendEvent(u.a.RoomEvent.get_active_max_talker,function(c){a(c)}):d.a.error("getMaxTalkers() invalid param - callback")};g.setAdvancedOptions=function(a,c){c=void 0===c?function(a){}:c;a&&Array.isArray(a)&&a.length&&"function"==typeof c?g.socket.emitEvent(u.a.RoomEvent.set_adavanced_options,
a,c):c(n.a.error_1155)};g.getAdvancedOptions=function(a){a=void 0===a?function(a){}:a;"function"==typeof a?g.socket.sendEvent(u.a.RoomEvent.get_adavanced_options,function(c){a(c)}):a(n.a.error_1155)};g.switchUserRole=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?"moderator"===g.me.role&&a&&g.clientId&&a!=g.clientId?g.socket.emitEvent(u.a.RoomEvent.switch_user_role,a,function(a){c(a)}):c("moderator"!==g.me.role?n.a.error_1168:g.clientId?n.a.error_1155:n.a.error_1171):d.a.error("switchUserRole() invalid param - callback")};
g.setSpeakerVolume=function(a,c){c=void 0===c?function(){}:c;if(void 0==a||"number"!=typeof a&&"boolean"!=typeof a||"function"!=typeof c)c(n.a.error_1155);else{var d="boolean"==typeof a?Number(a):a;0<=d&&1>=d&&g.speakerInfo.volume!=a?(g.remoteStreams.forEach(function(c){c.setSpeaker(void 0,a)}),a?g.speakerInfo.volume||g.dispatchEvent(Object(q.e)({type:"speaker-unmuted",message:{}})):g.dispatchEvent(Object(q.e)({type:"speaker-muted",message:{}})),g.speakerInfo.volume=a,c(n.a.error_000)):c(g.speakerInfo.volume!=
a?n.a.error_1188:n.a.error_1155)}};g.switchSpeaker=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?void 0==a||void 0!=g.speakerInfo.id&&a==g.speakerInfo.id||void 0!=c&&"function"!==typeof c||"safari"===f.a.browserEngineCheck()?"function"===typeof c&&c("safari"===f.a.browserEngineCheck()?n.a.error_1153:void 0==a?n.a.error_1155:n.a.error_1177):rb(a,function(d){d?(Z.forEach(function(c){c.setSpeaker(a)}),g.speakerInfo.id=a,c(n.a.error_000)):c(n.a.error_1142)}):d.a.error("switchSpeaker() invalid param - callback")};
g.startLocalRecord=function(a,c,b){a=void 0===a?"remote":a;c=void 0===c?10:c;if("none"===X){var m=[],e=0;if("remote"===a||"all"===a)Z.forEach(function(a){m[e]=new Promise(function(c,d){a.startLocalRecord(respCallback=function(d){c({id:a.getID(),status:d})})});e++}),X=a;if("local"===a||"all"===a)T.forEach(function(a){m[e]=new Promise(function(c,d){a.startLocalRecord(respCallback=function(d){c({id:a.getID(),status:d})})});e++}),X=a;"none"!==X?(0!==c&&(m[e]=new Promise(function(a,d){setTimeout(function(){g.stopLocalRecord(respCallback=
function(c,d){a(d)})},1E3*c)})),Promise.all(m).then(function(a){b&&(t.a.info("room-event",w.a.event_start_recording_success,{error:{}}),b(n.a.error_000,a))})):(d.a.error("invalid param type"),t.a.info("room-event",w.a.event_start_recording_failed,{error:"invalid param type"}),b&&b(n.a.error_1155))}else d.a.error("recording already in progress"),t.a.info("room-event",w.a.event_start_recording_failed,{error:"recording already in progress"}),b&&b(n.a.error_1174)};g.stopLocalRecord=function(a){if("none"!==
X){var c=0;"remote"!==X&&"all"!==X||Z.forEach(function(a){new Promise(function(c,d){a.stopLocalRecord(respCallback=function(d){c({id:a.getID(),status:d})})});c++});"local"!==X&&"all"!==X||T.forEach(function(a){new Promise(function(c,d){a.stopLocalRecord(respCallback=function(d){c({id:a.getID(),status:d})})});c++});X="none";t.a.error("room-event",w.a.event_stop_recording_success,{error:{}})}else d.a.error("recoding not stopped"),t.a.info("room-event",w.a.event_stop_recording_failed,{message:n.a.error_1175.desc}),
a&&a(n.a.error_1175)};g.setReceiveVideoQuality=function(a,c){if("[object Object]"===Object.prototype.toString.call(a)&&"function"===typeof c){var b={},m={},e={};e=a.videoQuality;var h=a.streamType;void 0===e&&(e="Auto");void 0===h&&(h="talker");d.a.info("Dumping opts in setReceiveVideoQuality"+JSON.stringify(a)+" streamType"+h);if("talker"!=h&&"canvas"!=h)d.a.info("setReceiveVideoQuality Failed Invalid Param -StreamType: "+h),c(n.a.error_1155);else{switch(e){case "HD":m.width=1280;m.height=720;break;
case "SD":m.width=960;m.height=540;break;case "LD":m.width=640;m.height=360;break;case "Auto":break;default:d.a.info("setReceiveVideoQuality for "+h+". Failed Invalid Param -videoQuality: "+e);c(n.a.error_1155);return}m.frameRate=30;b.video=m;if("talker"==h&&g.receiveVideoQuality.get("talker")!==e||"canvas"==h&&g.receiveVideoQuality.get("canvas")!==e)Z.forEach(function(a){"talker"===h&&!1===a.canvas&&!1===a.screen?a.updateConfiguration(b,function(a){d.a.info("stream.updateConfiguration for talker stream result : "+
a)}):"canvas"===h&&!0===a.canvas&&a.updateConfiguration(b,function(a){d.a.info("stream.updateConfiguration for canvas stream result : "+a)})}),g.receiveVideoQuality.set(h,e);e={result:0,msg:"Video quality successfully updated."};c(e)}}else"function"!==typeof c?d.a.error("setReceiveVideoQuality() invalid param - callback() "):(d.a.error("setReceiveVideoQuality() invalid param - QualityOpt "),c(n.a.error_1155))};g.getReceiveVideoQuality=function(a){return"talker"===a||"canvas"===a?{result:0,videoQuality:g.receiveVideoQuality.get(a)}:
n.a.error_1156};g.getStats=function(a,c,b){c=void 0===c?{intervalSecs:2,log:!0}:c;b=void 0===b?function(){}:b;if(void 0!=a&&"boolean"==typeof a&&"function"==typeof b)if(a){var m=function(a,d,b,m){a.pc&&a.pc.peerConnection&&a.pc.peerConnection.getStats(null).then(function(g){var e;g.forEach(function(d){switch(d.type){case "candidate-pair":d.nominated&&(e=d);break;case "outbound-rtp":case "inbound-rtp":void 0==b[a.getID()+"-"+d.kind]&&(b[a.getID()+"-"+d.kind]={id:a.getID(),ssrc:0,reconnects:0,availKbps:0},
m[a.getID()+"-"+d.kind]={});var g="outbound-rtp"===d.type,h=b[a.getID()+"-"+d.kind],f=m[a.getID()+"-"+d.kind];h.ssrc=d.ssrc;h.id=a.getID();h.reconnects=a.reconnectsTotal;g?(h.type="pub",h.kbps=f.bytes?8*(d.bytesSent-f.bytes)/(1E3*c.intervalSecs):0,h.targetkbps=d.targetBitrate/1E3):(h.type="sub",h.kbps=f.bytes?8*(d.bytesReceived-f.bytes)/(1E3*c.intervalSecs):0,h.packetsLost=d.packetsLost);"video"==d.kind?(h.id="vid:"+a.getID(),g?(h.fps=f.framesSent?(d.framesSent-f.frames)/c.intervalSecs:0,f.frames=
d.framesSent,h.retransmitKbps=f.retransmittedBytesSent?8*(d.retransmittedBytesSent-f.retransmittedBytesSent)/(1E3*c.intervalSecs):0,f.retransmittedBytesSent=d.retransmittedBytesSent,h.keyFrames=d.keyFramesEncoded,h.targetFps=d.framesPerSecond):(h.fps=f.framesDecoded?(d.framesDecoded-f.framesDecoded)/c.intervalSecs:0,f.framesDecoded=d.framesDecoded,h.recivedfps=f.frames?(d.framesReceived-f.frames)/c.intervalSecs:0,f.frames=d.framesReceived,h.droppedfps=f.framesDropped?(d.framesDropped-f.framesDropped)/
c.intervalSecs:0,f.framesDropped=d.framesDropped),h.resoln=d.frameWidth+"X"+d.frameHeight,h.firs=d.firCount,h.plis=d.pliCount,h.nacks=d.nackCount):h.id="aud:"+a.getID();f.bytes=g?d.bytesSent:d.bytesReceived;h.type+=a.ifScreen()?"sh":a.ifCanvas()?"cn":"mn"}});e&&(g=(d?e.availableOutgoingBitrate:e.availableIncomingBitrate)/1E3,b[a.getID()+"-audio"]&&(b[a.getID()+"-audio"].availKbps=g),b[a.getID()+"-video"]&&(b[a.getID()+"-video"].availKbps=g))},function(a){return console.log(" peerconnection getStats failed err : "+
a)})},e={},h={};ma=setInterval(function(){2==g.state&&(T.forEach(function(a,c){"connected"==a.state?m(a,!0,e,h):e[a.getID()+"-video"]&&(delete e[a.getID()+"-audio"],delete e[a.getID()+"-video"],delete h[a.getID()+"-audio"],delete h[a.getID()+"-video"])}),Z.forEach(function(a,c){"connected"==a.state?(g.activeTalkerList.get(parseInt(c))||100<parseInt(c)&&(g.shareStatus||g.canvasStatus))&&m(a,!1,e,h):e[a.getID()+"-video"]&&(delete e[a.getID()+"-audio"],delete e[a.getID()+"-video"],delete h[a.getID()+
"-audio"],delete h[a.getID()+"-video"])}),c.log&&console.table(Object.values(e)))},1E3*c.intervalSecs)}else ma&&(clearTimeout(ma),ma=void 0);else d.a.error("Invalid paramaters "),b&&"function"==typeof b&&b(n.a.error_1155)};g.getStreamStats=function(a,c){c=void 0===c?function(){}:c;if(!y)return"Error getting stats - no socket";if(!a)return"Error getting stats - no stream";y.sendMessage("getStreamStats",a.getID(),function(a){a&&c(a)})};g.getStreamsByAttribute=function(a,c){var d=[];Z.forEach(function(b){void 0!==
b.getAttributes()&&b.getAttributes()[a]===c&&d.push(b)});return d};g.installPlugin=function(){if(!document.getElementById("WebrtcEverywherePluginId")){var a=!!(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window);navigator.userAgent.indexOf("Safari");var c=document.createElement("object");a?c.setAttribute("classid","CLSID:7FD49E23-C8D7-4C4F-93A1-F7EACFA1EC53"):c.setAttribute("type","application/webrtc-everywhere");c.setAttribute("id",
"WebrtcEverywherePluginId");document.body.appendChild(c);c.setAttribute("width","0");c.setAttribute("height","0");c.isWebRtcPlugin||"undefined"!==typeof navigator.plugins&&(navigator.plugins["WebRTC Everywhere"]||navigator.plugins["WebRTC Everywhere Plug-in for Safari"])?(d.a.info("Installed WEBRTC plugin for IE"),t.a.info("room-event",w.a.event_general_success,{message:"Installed WEBRTC plugin for IE"})):(d.a.info("Browser does not appear to be WebRTC-capable"),t.a.warn("room-event",w.a.event_incompatible_browser,
{message:"Browser does not appear to be WebRTC-capable"}),window.open("/assets/plugin/VCXIE_PLUGINS.exe","new"))}};g.sendStoredLogs=function(a,c){g.socket.sendSDP("clientLogPosted",a,d.a.storedBuff,function(a,d){a?a&&(a={result:0,message:"Log posted successfully"},c(a)):(a={result:1340,message:"Error in posing log"},c(a))})};g.postClientLogs=function(a,c){c=void 0===c?function(){}:c;if("function"===typeof c){var b=x.a.decodeBase64(a);a=B.a.getLocalStorageItem("vcxRTCLib-log");null!=a&&(b=JSON.parse(b).logId,
JSON.parse(a),JSON.stringify(a).replace(",",", ").replace("{","").replace("}",""),g.sendStoredLogs(b,c))}else d.a.error("postClientLogs() invalid param - callback")};g.whoAmI=function(a){a=void 0===a?function(a){}:a;var c;g.userList.forEach(function(a,d){d===g.clientId&&(c=a)});a(c)};var zc=function(a,c,b){c.userRequestOptions.video=void 0!=a?a:!0;c.config.video=c.video=!0;d.a.info("addRenegotiateVideo() : caling reconnectStream");Fa(c,"add",function(a){b(a?n.a.error_000:n.a.error_1167)})};g.startScreenShare=
function(a,c){var b;if(void 0!=a&&"function"===typeof a)var m=a;else void 0!=c&&"function"===typeof c&&(void 0!=a&&(b=a),m=c);if("function"===typeof m){void 0==b?(b={},b.audio="chrome-stable"===B.a.browser_info.name||"edge"===B.a.browser_info.name?!0:!1):void 0==b.audio&&(b.audio=!1);b.layout=void 0!=b.layout?b.layout:"grid";g.shareOverRide=!1;g.shareOverRide=void 0!=b.shareOverride?b.shareOverride:g.share_override_room;g.shareOverRideCallback=1==g.shareOverRide?m:void 0;if(g&&g.share&&(!g.subscription||
g.subscription.audio_video))var e=Ac(b,function(a){!0===a?g.publish(e,{share:!0,maxVideoBW:B.a.video_bandwidth_range.share.max,minVideoBW:B.a.video_bandwidth_range.share.min,shareMetadata:{layout:b.layout}},function(a){m(a);0===a.result?(a={streamId:e.getID(),negotiatedCodecs:{video:{codec:"default"===g.mediaConfiguration||"Default"===g.mediaConfiguration?"VP8":g.mediaConfiguration},audio:{codec:"OPUS"}},externalIp:g.externalIp},d.a.info("additionalOptions:",a),t.a.info("room-event",w.a.event_start_screenshare_success,
{error:{}}),xa(!0,g.canvasStatus),g.createEventLog("clientStreamShareSuccess",a)):4108===a.result&&(a={streamId:e.getID(),negotiatedCodecs:{video:{codec:"default"===g.mediaConfiguration||"Default"===g.mediaConfiguration?"VP8":g.mediaConfiguration},audio:{codec:"OPUS"}},externalIp:g.externalIp,error:a.msg},g.createEventLog("clientStreamShareFailed",a),t.a.info("room-event",w.a.event_start_screenshare_failed,{additionalOptions:a}),e.stream.getTracks().forEach(function(a){a.stop()}))}):m(a)});else a=
g?n.a.error_1170:n.a.error_1171,d.a.info("Room not connected../ licence error"),t.a.info("room-event",w.a.event_start_screenshare_failed,{error:a}),m(a);return e}d.a.error("startScreenShare() invalid param - callback")};g.getScreenShareStream=function(){return g.ScreenSharelocalStream};g.stopScreenShare=function(a,c){c=void 0===c?function(){}:c;if("function"===typeof c){var b=n.a.error_1159;if(g&&g.share&&(!g.subscription||g.subscription.audio_video)){var m;g.localStreams.forEach(function(a){a.ifScreen()&&
a.local&&(Ka(!0,!1),a.close(),m=a,b=n.a.error_000,t.a.error("room-event",w.a.event_stop_screenshare_success,{error:{}}))});xa(!1,g.canvasStatus);void 0!=m&&g.localStreams.remove(m.getID())}else b=g?n.a.error_1170:n.a.error_1171,d.a.info("Room not connected../ licence error"),t.a.info("room-event",w.a.event_stop_screenshare_failed,{error:b});g.ScreenSharelocalStream=null;c?c(b):a&&"function"===typeof a&&a(b)}else d.a.error("stopScreenShare() invalid param - callback")};g.stopAllSharing=function(a){console.log("stopAllSharing");
1!=g.shareStatus&&1!=g.isCanvasSharing||g.socket.sendParamEvent("stopAllSharing",g.clientId,function(c){0!=c.result&&(d.a.error(c.msg),c.result=-1);a(c)})};var Bc=function(a){a=Object(q.e)({type:"custom-data-saved",message:{result:a.result,scope:a.scope}});g.dispatchEvent(a)},Cc=function(a){var c=a.data,d=a.scope;"room"==d?g.customRoomData=c:"session"==d?g.customSessionData=c:"user"==d&&(d=g.userList.get(a.clientId),d.customUserData=c,g.userList.set(a.clientId,d));a=Object(q.e)({type:"custom-data-updated",
message:{result:a.result,scope:a.scope,msg:a.msg}});g.dispatchEvent(a)};g.saveCustomData=function(a,c,b){if(!g.subscription||void 0!==g.subscription.datastore&&!1!==g.subscription.datastore){var m={result:0},e=a.scope,h=a.query;if(0==M(e))m.result=1,m.msg="Invalid scope parameter: "+e,b(m);else if(void 0==c||"object"!=typeof c||"object"==typeof c&&Array.isArray(c))d.a.error("Invalid data: "+c),m.result=1,m.msg="Invalid  data",b(m);else if(h&&"string"!=typeof h)d.a.error("Invalid data type of query: "+
h),m.result=1,m.msg="Invalid  data type",b(m);else{h=Object.keys(c);h=$jscomp.makeIterator(h);for(var f=h.next();!f.done;f=h.next())if(""===f.value){m.result=1;m.msg="Empty string as key not allowed.";b(m);return}g.socket.sendParamEvent("saveCustomData",{scope:e,data:c,query:a.query},function(a){0!=a.result&&d.a.error(a.msg);b(a)})}}else d.a.error("Customer datastore subsciption isn't supported for the room !!"),b(n.a.error_1170)};g.setCustomData=function(a,c,b){var m=a.scope,e=a.query;a=a.broadcast;
if(!g.subscription||void 0!==g.subscription.datastore&&!1!==g.subscription.datastore){var h={result:0};if("owner"==m||0==M(m))h.result=1,h.msg="owner"==m?"Owner scope not allowed.":"Invalid scope parameter: "+m,b(h);else{var f;if(f=a)f="string"!=typeof a||0==Q.includes(a)?!1:!0,f=0==f;if(f)h.result=1,h.msg="Invalid broadcast parameter: "+a,b(h);else if(void 0==c||"object"!=typeof c||"object"==typeof c&&Array.isArray(c))d.a.error("Invalid data: "+c),h.result=1,h.msg="Invalid  data",b(h);else if("user"!=
m||void 0!=a&&"none"!=a){f=Object.keys(c);f=$jscomp.makeIterator(f);for(var k=f.next();!k.done;k=f.next())if(""===k.value){h.result=1;h.msg="Empty string as key not allowed.";b(h);return}if(e&&"string"!=typeof e)d.a.error("Invalid data type of query: "+e),h.result=1,h.msg="Invalid  data type",b(h);else if(e&&2<e.split(".").length)d.a.error("Object level access exceeded, current size : "+e.split(".").length),h.result=1,h.msg="Object level access exceeded, It mustn't be greater than 2.",b(h);else{if("room"==
m){if(e)if(f=e.split("."),0==f.length)g.customRoomData=Object.assign(g.customRoomData,c);else if(1==f.length)g.customRoomData[e]=g.customRoomData[e]?Object.assign(g.customRoomData[e],c):c;else if(2==f.length)g.customRoomData[f[0]]?g.customRoomData[f[0]][f[1]]=g.customRoomData[f[0]][f[1]]?Object.assign(g.customRoomData[f[0]][f[1]],c):c:(g.customRoomData[f[0]]={},g.customRoomData[f[0]][f[1]]=c);else{d.a.error("Object access level exceeded, it must be atmost 2 : "+e);h.result=1;h.msg="Object level access exceeded";
b(h);return}else g.customRoomData=Object.assign(g.customRoomData,c);c=g.customRoomData}else if("session"==m){if(e)if(f=e.split("."),0==f.length)g.customSessionData=Object.assign(g.customSessionData,c);else if(1==f.length)g.customSessionData[e]=g.customSessionData[e]?Object.assign(g.customSessionData[e],c):c;else if(2==f.length)g.customSessionData[f[0]]?g.customSessionData[f[0]][f[1]]=g.customSessionData[f[0]][f[1]]?Object.assign(g.customSessionData[f[0]][f[1]],c):c:(g.customSessionData[f[0]]={},g.customSessionData[f[0]][f[1]]=
c);else{d.a.error("Object access level exceeded, it must be atmost 2 : "+e);h.result=1;h.msg="Object level access exceeded";b(h);return}else g.customSessionData=Object.assign(g.customSessionData,c);c=g.customSessionData}"all"==a?g.socket.sendParamEvent("setCustomData",{scope:m,data:c,query:e},function(a){0!=a.result&&d.a.error(a.msg);b(a)}):(c=Object(q.e)({type:"custom-data-updated",message:{result:0,scope:m,msg:"success"}}),g.dispatchEvent(c))}}else h.result=1,h.msg="Invalid broadcast option for scope USER, it mustn't be undefined or set to none.",
b(h)}}else d.a.error("Customer datastore subsciption isn't supported for the room !!"),b(n.a.error_1170)};g.getCustomData=function(a,c){if(!g.subscription||void 0!==g.subscription.datastore&&!1!==g.subscription.datastore){var b={result:0};if(void 0==a||"object"!=typeof a||"object"==typeof a&&Array.isArray(a))d.a.error("Invalid data: "+a),b.result=1,b.msg="Invalid  options",c(b);else{var m=a.scope,e=a.query,h=a.db;if(h&&"boolean"!=typeof h)d.a.error("Invalid data type of db: "+e),b.result=1,b.msg=
"Invalid  data type",c(b);else if(0==M(m))b.result=1,b.msg="Invalid scope parameter: "+m,c(b);else if(e&&"string"!=typeof e)d.a.error("Invalid data type of query: "+e),b.result=1,b.msg="Invalid  data type",c(b);else if(e&&2<e.split(".").length)d.a.error("Object level access exceeded, current size : "+e.split(".").length),b.result=1,b.msg="Object level access exceeded, It mustn't be greater than 2.",c(b);else if(void 0==h||0==h){if("room"==m)var f=g.customRoomData;else"session"==m?f=g.customSessionData:
"user"==m&&g.userList.get(g.clientId)&&(f=g.userList.get(g.clientId).customUserData);e?(a=e.split("."),2<a.length?(d.a.error("Object access level exceeded, it must be atmost 2 : "+e),b.result=1,b.msg="Object level access exceeded",c(b)):void 0==f?c("No data is set wrt provided scope : "+m+", Data : "+f):0==a.length?c(f):1==a.length?f[e]?c(f[e]):c("Data wrt query doesn't exist"):2==a.length&&(f[a[0]]?f[a[0]][a[1]]?c(f[a[0]][a[1]]):c("Data wrt query doesn't exist"):c("Data wrt query doesn't exist"))):
c(f)}else 1==h&&"session"!=m?(b.result=1,b.msg="Option true for db paramereter is valid for session scope only, scope used  : "+m,c(b)):g.socket.sendParamEvent("getCustomData",{scope:m,options:a,query:e},function(a){0!=a.result&&d.a.error(a.msg);c(a)})}}else d.a.error("Customer datastore subsciption isn't supported for the room !!"),c(n.a.error_1170)};g.lock=function(a){ub(!0,a)};g.unlock=function(a){ub(!1,a)};g.dropUser=function(a,c){c=void 0===c?function(){}:c;if(void 0===a||null===a||Array.isArray(a)&&
"function"===typeof c&&"moderator"===g.me.role){var b={all:!1};b.clientIds=void 0===a||null===a?[]:a;g.socket.emitEvent(u.a.RoomEvent.drop,b,c)}else"function"===typeof c?c("moderator"!==g.me.role?n.a.error_1168:n.a.error_1155):d.a.error("dropUser() invalid param - callback")};g.pinUsers=function(a,c){vb(!0,a,void 0===c?function(){}:c)};g.unpinUsers=function(a,c){vb(!1,a,void 0===c?function(){}:c)};g.addSpotlightUsers=function(a,c){wb(!0,a,void 0===c?function(){}:c)};g.removeSpotlightUsers=function(a,
c){wb(!1,a,void 0===c?function(){}:c)};g.destroy=function(a){a=void 0===a?function(){}:a;"function"===typeof a&&"moderator"===g.me.role?g.socket.emitEvent(u.a.RoomEvent.drop,{all:!0,clients:null},function(a){}):"function"===typeof a?(t.a.info("room-event",w.a.event_general_success,{message:"destroy - "+n.a.error_1168}),a(n.a.error_1168)):d.a.error("() invalid param - callback")};g.setAudioOnlyMode=function(a,c){c=void 0===c?function(){}:c;if(void 0!==a&&"boolean"===typeof a&&a!=g.audioOnlyMode&&"function"===
typeof c){var b=[],e={numTalkers:g.userVideoTalkerCount,numAudioTalkers:g.userAudioTalkerCount};b[0]=new Promise(function(c,d){e.numVideoTalkers=a?0:g.userVideoTalkerCount;g.socket.emitEvent(u.a.RoomEvent.set_active_talker,e,function(a){c(a)})});b[1]=new Promise(function(c,d){T.forEach(function(d,b){d&&d.ifVideo()&&(a?d.muteVideo:d.unmuteVideo)(function(a){c(a)})})});Promise.all(b).then(function(d){for(var b=0;b<d.length;b++)if(0!==d[b].result&&d[b].result!==n.a.error_1177.result){c(d[b].result);
return}g.audioOnlyMode=a;c(n.a.error_000)})}else b=void 0===a||"boolean"!==typeof a?n.a.error_1168:n.a.error_1188,"function"===typeof c?c(b):d.a.error("setAudioOnlyMode() invalid param - callback")};var rb=function(a,c){f.a.getDeviceList({speaker:!0},function(d){var b=!1;if(0==d.result)for(var e=0;e<d.devices.speaker.length;e++)if(d.devices.speaker[e].deviceId==a){b=!0;break}c(b)})},ub=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?"moderator"===g.me.role&&a!=g.locked?g.socket.emitEvent(u.a.RoomEvent.lock_room,
a,function(d){0===d.result&&(g.locked=a);c(d)}):c("moderator"!==g.me.role?n.a.error_1168:n.a.error_4121):d.a.error("lockRoom() invalid param - callback")},vb=function(a,c,b){b=void 0===b?function(){}:b;void 0===c||null===c||Array.isArray(c)&&c.length&&"function"===typeof b&&"moderator"===g.me.role?g.setAdvancedOptions([{id:"update-pin-users",request:a?"add":"remove",clientIds:c}],b):"function"===typeof b?b("moderator"!==g.me.role?n.a.error_1168:n.a.error_1155):d.a.error("pinUsers() invalid param - callback")},
wb=function(a,c,b){b=void 0===b?function(){}:b;void 0===c||null===c||Array.isArray(c)&&c.length&&"function"===typeof b&&"moderator"===g.me.role?g.setAdvancedOptions([{id:"spotlight-users",request:a?"add":"remove",clientIds:c}],b):"function"===typeof b?b("moderator"!==g.me.role?n.a.error_1168:n.a.error_1155):d.a.error("spotlightUsers() invalid param - callback")},ua=function(a,c,b){b=void 0===b?function(){}:b;void 0!==a&&"string"===typeof a?g.socket.sendSDP("processFloorRequest",a,c,function(a,e){null===
a?(d.a.error("Error on "+c+" error: "+e),b(void 0,e)):b(a)}):(d.a.error(" Floor Req : "+c+"Invalid params"),b(void 0,n.a.error_1155))};g.sendSocketEvent=function(a,c){c=void 0===c?function(){}:c;g.socket.emitEvent("logClientEvents",a,function(a,d){d?c(d,"error"):c(a,"success")})};g.createEventLog=function(a,c){var b={eventType:a,roomId:g.roomID,logId:W.logId,timestamp:new Date};Object.assign(b,c);d.a.info(a+" :",b);g.sendSocketEvent(b,function(c,b){d.a.info("Logging "+a+" response:  "+JSON.stringify(c)+
" , "+b+" ")})};var tb=function(){if(!1===g.reconnectionState){g.sendRecvBitrateStats||(g.sendRecvBitrateStats=!0);var a=[],c=0;Z.forEach(function(b){b.pc&&b.pc.peerConnection&&(a[c]=b.pc.peerConnection.getStats(null).then(function(a){var c;a.forEach(function(a){"candidate-pair"===a.type&&void 0!==a.availableIncomingBitrate&&(d.a.debug("incoming bitrate: "+a.availableIncomingBitrate),c={streamId:b.getID(),availableRecvBitrate:parseInt(a.availableIncomingBitrate)})});return c||{streamId:b.getID(),
availableRecvBitrate:0}},function(a){console.log(a);return{streamId:b.getID(),availableRecvBitrate:0}}),c++)});Promise.all(a).then(function(a){for(var c=0,b=0;b<a.length;b++)c+=a[b].availableRecvBitrate;d.a.info("Bitrates Total:"+c+" streamInfo: "+JSON.stringify(a));g.socket.emitEvent(u.a.RoomEvent.client_stats,{media:{subscribers:{totalAvailableBw:c}}},function(a){})});d.a.debug("Setting timeout again to execute ");setTimeout(tb,5E3)}else g.sendRecvBitrateStats=!1},sb=function(a,c){if(void 0==a.videoSize)if(c)a.videoSize=
[H.min.width,H.min.height,H.max.width,H.max.height];else return d.a.error(" Failed : video size undefined"),n.a.error_1184;else{c=a.videoSize[0]*a.videoSize[1];var b=a.videoSize[2]*a.videoSize[3],e=H.min.width*H.min.height,g=H.max.width*H.max.height;if(c<e||c>g||b>g||b<e||c>b)return d.a.error(" Failed : video size invalid minPixelsSet:"+c+" minPixelsConfig:"+e+" maxPixelsSet: "+b+" maxPixelsConfig: "+g+" req: min: "+a.videoSize[0]+" X "+a.videoSize[1]+" max: "+a.videoSize[2]+" X "+a.videoSize[3]+
" config: min: "+H.min.width+" X "+H.min.height+" max: "+H.max.width+" X "+H.max.height),n.a.error_1184}return n.a.error_000};g.initPublishStream=function(a,c,b,e){if(void 0!==c){if(void 0!=c.stream){var m=c.stream;if(m.audio||m.video)return m.stream?(void 0!=a&&null!==document.getElementById(a)&&m.play(a,c.options),b(m)):m.init(),m;d.a.error(" Failed : initPublishStream(): audio and video disabled in input stream");t.a.error("room-event",w.a.event_general_failed,{message:"initPublishStream - a/v disabled in input stream"});
e(n.a.error_1146);return}if(c.audio||c.video||c.screen||c.canvas){c.video&&g.mediaConfiguration!==u.a.constant.H264_CODEC&&"safari"===B.a.browser_info.name&&B.a.browser_info.version<=u.a.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8&&(c.video=!1,d.a.info("Stream publish in Init publish:- SAFARI - false"));if(c.video&!c.canvas){var h=sb(c,!0);if(h.result!==n.a.error_000.result){d.a.error(" Failed : initPublishStream(): video size invalid");t.a.error("room-event",w.a.event_general_failed,{message:"initPublishStream - video size invalid"});
e(h);return}}d.a.debug("video Size: "+JSON.stringify(H)+" config.video_resolution_range: "+B.a.video_resolution_range+" token.roomMeta.settings.quality: "+W.roomMeta.settings.quality+" room meta: "+JSON.stringify(W.roomMeta)+" video Size: "+B.a.video_resolution_range[W.roomMeta.settings.quality]);void 0!=c.videoSize&&c.videoSize.length||(c.videoSize=[H.min.width,H.min.height,H.max.width,H.max.height]);m=EnxRtc.EnxStream(c)}else d.a.error(" Failed : all stream opions (audio/video/screen/canvas)  false/undefined"),
t.a.error("room-event",w.a.event_general_failed,{message:"initPublishStream - all stream opions (audio/video/screen/canvas) false/undefined"}),e(n.a.error_1155)}else t.a.info("room-event",w.a.event_stream_publish_success,{message:"initPublishStream - success"}),m=EnxRtc.EnxStream({audio:!0,video:!0,data:!0,videoSize:[H.min.width,H.min.height,H.max.width,H.max.height]});"IE"===f.a.browserEngineCheck()?document.getElementById("WebrtcEverywherePluginId").addEventListener("media-access-allowed",function(c){d.a.info("got media access:- "+
JSON.stringify(c));null!==document.getElementById(a)&&m.play(a);b()}):(m.addEventListener("media-access-denied",e),m.addEventListener("media-access-failed",e),m.addEventListener("media-access-allowed",function(d){null!==document.getElementById(a)&&m.play(a,c.options);b(d.stream)}));m.init();return m};var Ac=function(a,c){if(g.shareStatus&&!1===g.reconnectionState)0==g.shareOverRide?c(n.a.error_1151):(g.isOverRidingShare=!0,g.socket.sendParamEvent("screenShareOverRide",g.clientId,function(a,b){null===
a&&(d.a.error("Error on stop screen share request",b),c(void 0,b))}));else{var b={video:!0,data:!0,screen:!0,fps:g.screenResolutionRange.fps,attributes:{name:"share"}};g.whoAmI(function(a){b.attributes.name=a.name+"_share"});b.audio=void 0!=a&&void 0!=a.audio?a.audio:!1;return g.initPublishStream("",b,function(){t.a.info("room-event",w.a.event_start_screenshare_success,{error:{}});c(!0)},function(a){"OverconstrainedError"===a.msg.name&&d.a.info("Resolution selected is not supported by your webcam");
t.a.error("room-event",w.a.event_start_screenshare_failed,{event:a});c(a.msg)})}},xb=function(a,c,d){c=void 0===c?null:c;if(a)return a;c.style.position="relative";a=document.createElement("div");a.setAttribute("class","annotate-div");a.setAttribute("style","display:flex;justify-content: center;align-items: center;height: 100%;width: 100%;");if(d){var b=document.querySelector("#player_"+d.getID()).parentElement;if(b){var e=document.createElement("canvas"),m=g.canvasVideoPlayer+"_veneer";e.id=m;e.width=
c?c.clientWidth:g.canvasOptions.width;e.height=c?c.clientHeight:g.canvasOptions.height;c.style.height=e.height+"px";c.style.width=e.width+"px";e.className=g.canvasVideoPlayer+"_input_veneer";e.setAttribute("style","display:none;");document.body.appendChild(e);if(c){g.canvasOptions.width=c.clientWidth;g.canvasOptions.height=c.clientHeight;var h=document.createElement("div");h.setAttribute("id","canvas-wrapper");h.setAttribute("class","canvas-wrapper");if(!e)return;h.style.width=e.width+"px";h.style.height=
e.height+"px";h.style.position="absolute";h.style.top="0%";h.append(e);F.a.appendCustomCanvas(h,e.className,e.width,e.height);F.a.appendCanvasFrame(h,e.className,e.width,e.height,d);document.getElementById(c.id)&&document.getElementById(c.id).appendChild(h)}else document.body.appendChild(wrapper);null!=c&&(a.appendChild(c),b.prepend(a));F.a.bindEventListernersForTools();g.inputContext=e.getContext("2d");F.a.startFrame();F.a.pause_play();Dc();return m}}},Dc=function(){var a=F.a.getVideoFrameId(),c=
document.getElementById(a);if(c){a=F.a.getCanvasId();var d=document.getElementById(a);d&&(Na=setInterval(function(){g.inputContext.globalAlpha=.1;0<c.width&&0<c.height&&0<F.a.getCanvasWidth()&&0<F.a.getCanvasHeight()&&g.inputContext.drawImage(c,0,0,F.a.getCanvasWidth(),F.a.getCanvasHeight());g.inputContext.globalAlpha=1;0<d.width&&0<d.height&&0<F.a.getCanvasWidth()&&0<F.a.getCanvasHeight()&&g.inputContext.drawImage(d,0,0,F.a.getCanvasWidth(),F.a.getCanvasHeight())},.3))}};g.annotateToolAction=function(a,
c){F.a.toolBarAction(a,c)};g.startAnnotation=function(a,c){var b=document.getElementById("canvas-wrapper");b&&b.remove();try{if(a){var e=a.getID(),m=document.querySelector("#player_"+e);if(m){var h=Xa();d.a.info(h,"status");g.canvas_video_player=document.getElementById("stream"+e);if(g.canvas_video_player)if(g.canvasVideoPlayer="stream"+e,h.result===n.a.error_000.result){var f=xb(null,m,a);g.startCanvas({canvasSelector:f,fps:23,canvasType:"Annotation"},function(a){0==a.result&&c&&c(h)});Ea=!1;ka=
!0;t.a.info("room-event",w.a.event_start_annotation_success,{error:{}});F.a.mouseAnnotate(f,g.inputContext,"player_"+e,a)}else c&&c(h)}}}catch(Pa){console.info(Pa,"error"),d.a.error("incorrect annotate params "+Pa),t.a.error("room-event",w.a.event_start_annotation_failed,{error:Pa}),c&&c(n.a.error_1155)}};g.stopAnnotation=function(a){ka=!1;g.stopCanvas(a);F.a.stopAnnotation();clearInterval(Na)};g.adjustCanvas=function(){F.a.resize()};g.startCanvas=function(a,c){c=void 0===c?function(){}:c;if("function"===
typeof c){var b=a?a.canvasSelector:"";try{var e=Xa();if(e.result===n.a.error_000.result){var m=xb(b);if(a){var h=a.fps?a.fps:g.canvasOptions.fps;var f=a.canvasType?a.canvasType:"default"}else h=g.canvasOptions.fps,f="default";var k=Ec({domHandle:m,fps:23<h?23:h,canvasType:f,refreshFn:a.refreshFn,maxRefreshRate:g.maxCanvasRefreshRate},function(a,b){"success"===b?g.publish(a,{canvas:!0,canvasType:f,maxVideoBW:B.a.video_bandwidth_range.canvas.max,minVideoBW:B.a.video_bandwidth_range.canvas.min},function(a){0===
a.result&&(d.a.info("startCanvas response.result:",a),t.a.info("room-event",w.a.event_start_canvas_success,{error:{}}),xa(g.shareStatus,!0),c&&c(a))}):c&&c(a)})}else c&&c(e)}catch(Za){d.a.error("incorrect canvas params "+Za),t.a.error("room-event",w.a.event_start_canvas_failed,{error:Za}),c&&c(n.a.error_1155)}return k}d.a.error("startCanvas() invalid param - callback")};g.playVideo=function(a,c,d){g.canvasVideoPlayer=a;a=document.querySelector("#"+a);void 0===a||null===a?d(n.a.error_1162):(g.canvas_video_player=
a,c&&(g.canvasOptions.width=c.width?c.width:g.canvasOptions.width,g.canvasOptions.height=c.height?c.height:g.canvasOptions.height,g.canvasOptions.fps=c.fps?c.fps:23),g.startCanvas({fps:c.fps},d))};g.stopCanvas=function(a){a=void 0===a?function(){}:a;if("function"===typeof a){var c=Xa();if(c.result===n.a.error_000.result){var b;g.localStreams.forEach(function(c){c&&c.ifCanvas()&&(Ka(!1,!0),b=c,c.stream.getTracks().forEach(function(a){a.stop()}),c.onConnectionStateChanged(!1),c.close(),t.a.info("room-event",
w.a.event_stop_canvas_success,{error:{}}),a({result:0,msg:"Canvas stopped successfully."}))});xa(g.shareStatus,!1);void 0!=b&&g.localStreams.remove(b.getID())}else t.a.error("room-event",w.a.event_stop_canvas_failed,{error:{}}),a(c)}else d.a.error("stopCanvas() invalid param - callback")};g.isModerator=function(){return g.me&&"moderator"===g.me.role};var Ca=function(a,c,d,b,e,h){c=Fc(c,d,!0);c.result===n.a.error_000.result&&(b||e&&"string"===typeof e)?g.socket.sendMessage(a,{clientId:e},function(a){h(a)}):
h(c.result!==n.a.error_000.result?c:n.a.error_1155)},Fc=function(a,c,b){a=!g.subscription||(!c||g.subscription.audio_video)&&(!a||g.subscription.audio_only||g.subscription.audio_video);if(g&&a&&(!b||"moderator"===g.me.role))return n.a.error_000;b=g?a?n.a.error_1168:n.a.error_1170:n.a.error_1171;d.a.error("validateCanvas error code "+b.result);return b},Xa=function(){if(g&&(!g.subscription||g.subscription.audio_video)&&("lecture"!==g.mode||"moderator"===g.me.role||!0===g.floorGranted))return n.a.error_000;
var a=g?!g.subscription||g.subscription.audio_video?n.a.error_1173:n.a.error_1170:n.a.error_1171;d.a.error("validateCanvas error code "+a.result);return a},Ec=function(a,c){var b=null,e={video:!0,canvas:!0,attributes:{name:"canvas"}};!1===e.canvas&&(e.canvas=!0);!1===e.video&&(e.video=!0);!0===e.audio&&(e.audio=!1);e.div||(e.div=a.domHandle);e.fps||(e.fps=a.fps);void 0!=a.refreshFn&&(e.refreshFn=a.refreshFn,e.maxCanvasRefreshRate=a.maxRefreshRate);void 0===e.attributes?e.attributes={name:"canvas"}:
(void 0===e.attributes.name||"canvas"===e.attributes.name)&&g.whoAmI(function(a){e.attributes.name=a.name+"_canvas"});e.videoSize=[1920,1080,1920,1080];d.a.info("initcanvas config "+JSON.stringify(e));g.initPublishStream("",e,function(a){b=a;c(b,"success")},function(a){"OverconstrainedError"===a.msg.name&&d.a.info("Resolution selected is not supported by your webcam");c(a.msg,"error")});return b},Gc=function(a){var c=null;g.isCanvasSharing=!0;g.clientId==a.clientId&&(g.isCanvasSharingClient=!0);Ea?
c=Object(q.e)({type:"annotation-started-ack",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,canvasType:a.canvasType}}):"Annotation"===a.canvasType?(ka=!0,c=Object(q.e)({type:"canvas-started",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,canvasType:a.canvasType}})):(g.canvasStatus=!0,ka&&(g.canvasStatus=!1),ka=!1,c=Object(q.e)({type:"canvas-started",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,canvasType:a.canvasType?a.canvasType:"default"}}));xa(g.shareStatus,
!0);g.dispatchEvent(c);d.a.debug("onCanvasStarted event :",JSON.stringify(c));a.streamId?(a=Z.get(a.streamId))&&!a.failed?a._setStaticQualityLayer(2,-1,function(a){d.a.info("stream._setStaticQualityLayer (2/-1) for canvas result : "+a)}):d.a.error("canvas started:stream is undefined or failed"):d.a.error("canvas arg.streamId is undefined")},Hc=function(a){a=Object(q.e)({type:"canvas-stopped",message:{clientId:a.clientId,name:a.name,streamId:a.streamId}});g.canvasStatus=!1;g.isCanvasSharing=!1;xa(g.shareStatus,
!1);d.a.debug("onCanvasStopped event :",JSON.stringify(a));g.dispatchEvent(a);g.isCanvasSharingClient=!1},Ic=function(a){d.a.info("canvasStateEvents");!0===a.videomuted?(a=Object(q.e)({type:"canvas-state-events",message:"Canvas stopped",reason:"bw"}),g.dispatchEvent(a)):(a=Object(q.e)({type:"canvas-state-events",message:"Canvas resumed",reason:"bw"}),g.dispatchEvent(a))},Jc=function(a){d.a.info("shareStateEvents");!0===a.videomuted?(a=Object(q.e)({type:"share-state-events",message:"Share stopped",
reason:"bw"}),g.dispatchEvent(a)):(a=Object(q.e)({type:"share-state-events",message:"Share resumed",reason:"bw"}),g.dispatchEvent(a))},Kc=function(a){if("speaker_notification"===a.id){a.id="talker-notification";for(var c={},d=$jscomp.makeIterator(a.data),b=d.next();!b.done;b=d.next())b=b.value,!0===b.speech?c.speech=b.users:!0===b.noise&&(c.noise=b.users);a=Object(q.e)({type:a.id,message:c});g.dispatchEvent(a)}else a=Object(q.e)({type:a.id,message:a.data}),g.dispatchEvent(a)},Lc=function(a){d.a.debug("onUserRoleChangedEvent"+
JSON.stringify(a)+" ownclientId: "+g.clientId);a.moderator.new===g.clientId?"participant"===g.me.role?(g.me.role="moderator","lecture"===g.mode&&(g.cCrequest=[],g.cCapprovedHands=[],0<a.raisedHands.length&&a.raisedHands.forEach(function(a){g.cCrequest.push(a)}),0<a.approvedHands.length&&a.approvedHands.forEach(function(a){g.cCapprovedHands.push(a)}))):d.a.info("onUserRoleChangedEvent() Already Moderator - no change"):a.moderator.old===g.clientId&&("moderator"===g.me.role?(g.me.role="participant",
"lecture"===g.mode&&(g.cCrequest=[],g.cCapprovedHands=[],g.localStreams.getAll(),T.forEach(function(a,c){g.unpublish(a,function(c){1==c?d.a.info("stream has been un-published"):(d.a.info("error during stream un-publishing"),t.a.error("room-event",w.a.event_stream_unpublish_failed,{stream:a}))})}))):d.a.info("onUserRoleChangedEvent() Already partcipant - no change"));a=Object(q.e)({type:"user-role-changed",message:a});g.dispatchEvent(a)},Mc=function(a){d.a.debug("onUserRoleChangedEvent"+JSON.stringify(a)+
" ownclientId: "+g.clientId);"lecture"===g.mode?(g.mode="group",g.roomSettings.mode="group",g.cCrequest=[],g.cCapprovedHands=[]):"group"===g.mode&&(g.roomSettings.mode="lecture",g.mode="lecture",g.cCrequest=[],g.cCapprovedHands=[],"participant"===g.me.role?T.forEach(function(a,c){g.unpublish(a,function(c){1==c?d.a.info("stream has been un-published"):(d.a.info("error during stream un-publishing"),t.a.error("room-event",w.a.event_stream_unpublish_failed,{stream:a}))})}):d.a.info("onUserRoleChangedEvent() Already Moderator - no change"));
a=Object(q.e)({type:"room-mode-switched",message:{mode:g.mode,moderator:a.moderator}});g.dispatchEvent(a)},Nc=function(a){d.a.info("onRoomManagementEvents:"+JSON.stringify(a));var c={};switch(a.id){case "room-locked":case "room-unlocked":g.locked="room-locked"===a.id;c=a.msg;break;case "floor-opened":g.floorOpen=!0;break;case "floor-closed":g.floorOpen=!1;break;case "knock-enabled":g.knockEnabled=!0;break;case "knock-disabled":g.knockEnabled=!1;g.awaitedParticipants.clear();break;case "wait-room-disabled":g.waitRoom&&
(g.waitRoom=!1);for(var b=[],h=a.roomData.streams||[],m=Object.keys(h),f=a.roomData.userList,n=0;n<m.length;n+=1){var k=h[m[n]];c=Object(e.a)(g.Connection,{streamID:k.id,local:!1,audio:k.audio,video:k.video,data:k.data,screen:k.screen,canvas:!("undefined"===typeof k.canvas||!1===k.canvas),attributes:k.attributes});b.push(c);Z.add(k.id,c)}for(var u in f)g.userList.set(f[u].clientId,f[u]);g.videoMutedUsers=a.roomData.videoMutedUsers||[];c={streams:b,users:f};break;default:c=a.msg}a=Object(q.e)({type:a.id,
message:c});g.dispatchEvent(a)},Oc=function(a){d.a.info("Recieved an invite to join breakout room "+JSON.stringify(a));d.a.info("Join Breakout Room event dispatched");if(!0===a.force_join){var c=Object(q.e)({type:"breakout-room-joining",message:{room_id:a.room_id,requestor:a.requestor}});g.dispatchEvent(c);g.muteRoom({audio:!0,video:!0},function(c){0===c.result?T.forEach(function(c,d){c.screen||c.canvas||!c.ifAudio()&&!c.ifVideo()||g.joinBreakOutRoom({room_id:a.room_id,role:"participant"},{audio:!0,
video:!1},function(a,c){a?(a=Object(q.e)({type:"breakout-room-connected",streams:a.streams,room:a.room,roomData:a.roomData,localBreakoutStream:a.localBreakoutStream}),g.dispatchEvent(a)):c&&(a=Object(q.e)({type:"breakout-room-error",message:c}),g.dispatchEvent(a))})}):(c=Object(q.e)({type:"breakout-room-error"},{message:"mute room request failed"}),g.dispatchEvent(c))})}else c=Object(q.e)({type:"join-breakout-room",message:{room_id:a.room_id,requestor:a.requestor}}),g.dispatchEvent(c)};g.rejectBreakoutRoomInvite=
function(a,c){c=void 0===c?function(){}:c;d.a.info("Rejecting the breakout room invite ",a);a?g.socket.sendMessage("reject-breakout-room",a,function(a){a&&(d.a.info("Reject breakout room, result: "+JSON.stringify(a)),c(a))}):(d.a.info("Invalid value room_id"),c&&c(n.a.error_1155))};var Pc=function(a){d.a.info("Recieved user joined breakout room "+JSON.stringify(a));a=Object(q.e)({type:"user-joined-breakout-room",message:{clientId:a.client}});g.dispatchEvent(a)},Qc=function(a){d.a.info("USER DISCONNECTED BREAKOUT ROOM "+
JSON.stringify(a));a=Object(q.e)({type:"user-disconnected-breakout-room",message:{name:a.name,clientId:a.clientId,room:a.room}});g.dispatchEvent(a)},Rc=function(a){d.a.info("BREAKOUT ROOM DESTROYED"+JSON.stringify(a));a=Object(q.e)({type:"breakout-room-destroyed",message:{room_id:a.room_id}});g.dispatchEvent(a)},Sc=function(a){d.a.debug("Received transcription events: "+JSON.stringify(a));"transcription-started"===a.type?("room"===a.transcription_type?g.liveRoomTranscription=!0:g.liveTranscription=
!0,g.transcriptionLanguage=a.language):"transcription-stopped"===a.type&&("room"===a.transcription_type?g.liveRoomTranscription=!1:g.liveTranscription=!1);a=Object(q.e)({type:"transcription-events",message:{data:a}});g.dispatchEvent(a)};g.extendConferenceDuration=function(a){a=void 0===a?function(){}:a;"function"===typeof a?g.socket.emitEvent(u.a.RoomEvent.extend_conference_duration,{},function(c){a(c)}):d.a.error("extendConferenceDuration() : failed Invalid param. callback is not function")};g.subscribeMediaStats=
function(a,c){c=void 0===c?function(){}:c;if(void 0!==a&&"string"===typeof a&&"function"===typeof c)if(2!==g.state||g.mediaStatsMode==a||"disable"!=a&&"notify"!=a&&"display"!=a&&"notify-display"!=a){var b=2!==g.state?n.a.error_1171:g.mediaStatsMode==a?n.a.error_1188:n.a.error_1155;d.a.error("that.subscribeMediaStats () error: "+JSON.stringify(b));c(b)}else{var e=function(a){var c=document.querySelectorAll(".stats-container"),d=document.querySelectorAll(".stats-overlay");c.forEach(function(c){void 0!==
c&&null!==c&&(c.style.display=a)});d.forEach(function(c){void 0!==c&&null!==c&&(c.style.display=a)})};"disable"==a||"disable"==g.mediaStatsMode?T.forEach(function(c,d){c.ifCanvas()||c.ifScreen()||y.sendMessage("subscribeStreamStatsForClient",{streamId:d,statsEnabled:"disable"!=a},function(c){void 0!=c&&("Success"===c.status&&e("display"==a||"notify-display"==a?"block":"none"),g.mediaStatsMode=a)})}):(e("display"==a||"notify-display"==a?"block":"none"),g.mediaStatsMode=a)}else d.a.error("that.subscribeMediaStats () invalid param "),
"function"===typeof c&&c(n.a.error_1155)};g.subscribeStreamStatsForClient=function(a,c,d){d=void 0===d?function(){}:d;if(!y)return"Error getting stats - no socket";if(!a)return"Error getting stats - no stream";y.sendMessage("subscribeStreamStatsForClient",{streamId:a.getID(),statsEnabled:c},function(a){if(a){var b=document.querySelectorAll(".stats-container"),e=document.querySelectorAll(".stats-overlay");"Success"===a.status&&!0===c?(g.mediaStatsMode="display",g.subscribeSessionStats=!0,b.forEach(function(a){void 0!==
a&&null!==a&&(a.style.display="block")}),e.forEach(function(a){void 0!==a&&null!==a&&(a.style.display="block")})):(g.mediaStatsMode="disable",g.subscribeSessionStats=!1,b.forEach(function(a){void 0!==a&&null!==a&&(a.style.display="none")}),e.forEach(function(a){void 0!==a&&null!==a&&(a.style.display="none")}));d(a)}})};g.subscribeForTalkerNotification=function(a,c){c=void 0===c?function(){}:c;if("function"===typeof c){if(!y)return"Error subscribing - no socket";g.setAdvancedOptions([{id:"speaker-notification",
enable:a}],c)}else d.a.error("subscribeForTalkerNotification() invalid param - Callback")};g.manageStatsSubscription=function(a){"disable"!=g.mediaStatsMode?(a=g.mediaStatsMode,g.mediaStatsMode="disable",g.subscribeMediaStats(a,function(a){})):!0===g.subscribeSessionStats?(d.a.info("resubscribe session stats"),g.subscribeStreamStatsForClient(a,g.subscribeSessionStats)):d.a.info("session stats not subscribed")};g.reconPubSubFailed=function(a){d.a.info("reconnect publish or subscribe failed",a);ta(!0,
!1)};g.manageNumTalker=function(){d.a.info("Reset the preferred number of active talkers");-1!==Da?g.setTalkerCount(Da,function(a){d.a.info("reset active talker",a)}):d.a.info("Use default prefrence of number of active talkers")};g.startLiveTranscription=function(a,c){var b={};d.a.info("Starting the live transcription for the room");void 0===a&&void 0===c?(b.language="english_us",b.room=!0):void 0===c?a&&"function"===typeof a?(c=a,b.room=!0,b.language="english_us",d.a.info("Parameter null callback is params",
JSON.stringify(b))):(b.room=!0,void 0===a?(d.a.error("Language parameter undefined, going ahead with default english_us"),b.language="english_us"):(b.language=a,d.a.info("Parameter null callback is params",JSON.stringify(b)))):(b.room=!0,b.language=a);!1===g.liveRoomTranscription?g.socket.sendMessage("startLiveTranscription",b,function(a){a&&0===a.result&&(d.a.info("Setting the live transcription for room"),g.liveRoomTranscription=!0);c&&(d.a.info("Sending the callbacks"),c(a))}):c&&c(n.a.error_8001)};
g.subscribeForLiveTranscription=function(a,c){var b={};void 0===a||void 0===c?(d.a.error("subscribeForLiveTranscription() invalid parameters"),void 0!==a&&"function"===typeof a&&a(response.error_1155)):void 0!==a&&void 0!==a.enable&&"boolean"===typeof a.enable?!0===a.enable?(!0===g.liveRoomTranscription?b.language=g.transcriptionLanguage:void 0!==a.language&&(b.language=a.language),!1===g.liveTranscription?g.socket.sendMessage("startLiveTranscription",b,function(a){a&&0===a.result&&(g.liveTranscription=
!0);c&&c(a)}):c&&c(n.a.error_8001)):(a={client:!0},!0===g.liveTranscription?g.socket.sendMessage("stopLiveTranscription",a,function(a){g.liveTranscription=!1;c(a)}):c(n.a.error_8002)):c(response.error_1155)};g.stopLiveTranscription=function(a){a=void 0===a?function(){}:a;var c={};!0===g.liveRoomTranscription?(c.room=!0,g.socket.sendMessage("stopLiveTranscription",c,function(c){g.liveRoomTranscription=!1;a(c)})):a(n.a.error_8002)};g.makeOutboundCall=function(a,c,b,e){e=void 0===e?function(){}:e;if("function"===
typeof e){var h=!(g.subscription&&!1===g.subscription.sip_outbound),f={};void 0===b?f.silent_join=!0:(void 0!==b.name&&(f.name=b.name),void 0!==b.early_media&&"boolean"==typeof b.early_media?f.early_media=b.early_media:f.silent_join=void 0!==b.silent_join&&"boolean"==typeof b.silent_join?b.silent_join:!0);!0===h?null!=a&&(console.log("Options: "+JSON.stringify(f)),g.socket.sendMessage("makeOutboundCall",{number:a,caller_id:c,options:f},function(c){c&&0===c.result?(g.dialOutList.set(a,{initiator:!0,
state:"initiated"}),d.a.info("Outbound call initiated for the number: "+a)):c&&1141===c.result?d.a.error("Outbound call is in progress for the number: "+a):d.a.info("Received "+JSON.stringify(c)+" for outbound number: "+a);e&&e(c)})):!h&&e&&(t.a.error("room-event",w.a.event_general_failed,{message:"makeOutboundCall - not allowed"}),e(n.a.error_1170))}else d.a.error("makeOutboundCall() invalid param - callback")};g.cancelOutboundCall=function(a,c){var b=g.dialOutList.get(a);void 0===b?"moderator"===
g.me.role?g.socket.sendMessage("cancelOutboundCall",{number:a},function(a){d.a.info("Cancel outbound call, response received is "+JSON.stringify(a));t.a.info("room-event",w.a.event_general_success,{message:"cancelOutboundCall - success"});c&&c(a)}):c&&(t.a.error("room-event",w.a.event_general_failed,{message:"cancelOutboundCall - Insufficient Privileges"}),c({result:1705,msg:"Insufficient Privileges"})):"moderator"===g.me.role||!0===b.initiator?g.socket.sendMessage("cancelOutboundCall",{number:a},
function(a){d.a.info("Cancel outbound call, response received is "+JSON.stringify(a));t.a.info("room-event",w.a.event_general_success,{message:"cancelOutboundCall - success"});c&&c(a)}):(d.a.error(" You need to be moderator or the initiator of the oubound call to disconnect the call."),t.a.error("room-event",w.a.event_general_failed,{message:"cancelOutboundCall - Insufficient Privileges"}),c&&c({result:1705,msg:"Insufficient Privileges"}))};var Tc=function(a){d.a.debug("recieved dialStateEvents");
var c=g.dialOutList.get(a.number);switch(a.status){case "dialing":void 0===c&&(c={initiator:!1,state:"dialing"},g.dialOutList.set(a.number,c));break;case "proceeding":case "connected":c.state=a.status;break;case "failed":case "timeout":case "disconnected":g.dialOutList.delete(a.number);break;default:d.a.debug("Unknown response received")}a=Object(q.e)({type:"dial-state-events",message:{number:a.number,state:a.status,description:a.description}});d.a.debug("Dispatching dial state event: "+JSON.stringify(a));
g.dispatchEvent(a)};g.pingBack=function(a){g.socket.sendMessage("pingBack",{},function(c){a&&a(c)})};g.startClientUsage=function(a,c){g.socket.sendMessage("startClientUsage",a,function(a){c&&c(a)})};g.stopClientUsage=function(a,c){g.socket.sendMessage("stopClientUsage",a,function(a){d.a.info("callback received "+JSON.stringify(a));c&&c(a)})};g.createBreakOutRoom=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c&&"object"===typeof a&&a.hasOwnProperty("participants")?a&&0<a.participants?
g.socket.sendMessage("create-breakout-room",a,function(a){a&&(d.a.info("Create breakout room, result: "+JSON.stringify(a)),t.a.info("room-event",w.a.event_general_success,{message:"createBreakOutRoom - success"}),c(a))}):(d.a.info("Invalid value for participants "+JSON.stringify(a)),t.a.error("room-event",w.a.event_general_failed,{message:"createBreakOutRoom - Invalid value for participants "+JSON.stringify(a)}),c&&c(n.a.error_1155)):d.a.error("createBreakOutRoom() invalid param - callback/RoomDefinition")};
g.createAndInviteBreakOutRoom=function(a,c){a&&0<a.max_rooms?(a.force_join=!0,g.socket.sendMessage("create-invite-breakout-room",a,function(a){a&&(d.a.info("Create breakout room, result: "+JSON.stringify(a)),t.a.info("room-event",w.a.event_general_success,{message:"createAndInviteBreakOutRoom - success"}),c(a))})):(d.a.info("Invalid value for participants "+JSON.stringify(a)),t.a.error("room-event",w.a.event_general_failed,{message:"createAndInviteBreakOutRoom - Invalid value for participants "+JSON.stringify(a)}),
c&&c(n.a.error_1155))};g.joinBreakOutRoom=function(a,c,b){b=void 0===b?function(){}:b;"function"===typeof b?a&&null!==a.room_id&&null!==a.role?g.socket.sendMessage("join-breakout-room",a,function(e){e&&0===e.result?g.breakOutRoom.joinRoom(e.token,c,function(a,c){a&&(d.a.info("****Join Breakout Room Success****, sending user-joined-event****"+JSON.stringify(a.roomData)),g.socket.sendMessage("user-joined-breakout-room",{name:a.roomData.name}),t.a.info("room-event",w.a.event_general_success,{message:"joinBreakOutRoom - success"}),
b&&b(a,null));c&&(t.a.error("room-event",w.a.event_general_failure,{message:"joinBreakOutRoom - failure"}),b&&b(null,c))}):(d.a.error("Invalid data, room id not found "+JSON.stringify(a)),t.a.error("room-event",w.a.event_general_failure,{message:"joinBreakOutRoom - Invalid data, room id not found "+JSON.stringify(a)}),b&&b(n.a.error_1155))}):(d.a.error("Invalid data, room id not found"+JSON.stringify(a)),t.a.error("room-event",w.a.event_general_failure,{message:"joinBreakOutRoom - Invalid data, room id not found "+
JSON.stringify(a)}),b&&b(n.a.error_1155)):d.a.error("joinBreakoutRoom() invalid param - callback")};g.inviteToBreakoutRoom=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c&&"object"===typeof a&&a.hasOwnProperty("room_id")?void 0===a||void 0===a.room_id?(d.a.info("Invalid data, room id not found"+JSON.stringify(a)),t.a.error("room-event",w.a.event_general_failure,{message:"inviteToBreakoutRoom - Invalid data, room id not found "+JSON.stringify(a)}),c&&c(n.a.error_1155)):g.socket.sendMessage("invite-breakout-room",
a,function(a){a&&(d.a.info("Create breakout room, result:"+JSON.stringify(a)),t.a.info("room-event",w.a.event_general_success,{message:"inviteToBreakoutRoom - success"}),c&&c(a))}):d.a.error("inviteToBreakoutRoom() invalid param - callback/invitee")};g.clearAllBreakOutSession=function(a){void 0!==a&&"function"===typeof a&&(g.breakOutRoom.disconnectAll(),g.resumeRoom(a))};g.destroyAllBreakOutSession=function(a){"moderator"===g.me.role&&(g.breakOutRoom.destroyAll(),g.resumeRoom(a))};var Uc=function(a,
c,b){c=void 0===c?{isMobile:!1,broadcast:!0,clientList:[]}:c;var e,h,f,m,k,u,x,v,l,ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(A){if(1==A.nextAddress)return d.a.info(" init file upload "),e=P.size,h={messageType:"upload-started",result:0,description:"upload started",response:{uploadStatus:"started",upJobId:e,uploadInfo:{upJobId:e,name:a.name,size:a.size,type:a.type}}},A.setCatchFinallyBlocks(2),f=new D.a,m={sender:f,status:"started"},P.set(e,m),k=Object(q.e)({type:"fs-upload-result",
message:h}),g.dispatchEvent(k),A.yield(f.upload(a),4);if(2!=A.nextAddress){u=A.yieldResult;x=u.toJSON();m.status="completed";P.set(e,m);h.messageType="upload-completed";h.response.uploadStatus=m.status;h.response.upJobId=e;h.description=" upload completed";h.response.uploadInfo={upJobId:e,name:x.name,size:x.size,speed:x.speed,createdAt:x.createdAt,dlimit:x.dlimit,time:x.time,expiresAt:x.expiresAt,timeLimit:x.timeLimit};if(!0===c.isMobile)return d.a.info(" file sharing mobile client "),h.response.uploadInfo=
x,h.response.uploadInfo.upJobId=e,k=Object(q.e)({type:"fs-upload-result",message:h}),g.dispatchEvent(k),b(h),A.return();d.a.info(" is mobile  false ",c.isMobile);!0===g.showFsUi&&null!==document.getElementById(O)&&La(x,document.getElementById(O),"fs-file-uploaded");lb(x,"fs-file-available",c.broadcast,c.clientList,function(a){h.response.sentStatus=a;d.a.info("sent message to all participants: file is available for download ",a,"fupload result",h);k=Object(q.e)({type:"fs-upload-result",message:h});
g.dispatchEvent(k);b(h)});k=Object(q.e)({type:"fs-upload-result",message:h});g.dispatchEvent(k);t.a.error("room-event",w.a.event_file_shared_success,{error:{}});b(h);return A.leaveTryBlock(0)}v=A.enterCatchBlock();d.a.info("upload to file server failed",v);P.delete(e);h.messageType="upload-failed";h.response.uploadStatus="failed";h.description=" upload failed";h.result=1;l=Object(q.e)({type:"fs-upload-result",message:h});g.dispatchEvent(l);d.a.error("exception in file upload ",v);ka=n.a.error_1182;
d.a.info(" send file failed",ka);t.a.error("room-event",w.a.event_file_shared_failed,{error:{}});b(ka);A.jumpToEnd()})};g.sendFiles=function(a,c,b){a=void 0===a?[]:a;c=void 0===c?{isMobile:!1,broadcast:!0,clientList:[]}:c;d.a.info("Send file called options "+JSON.stringify(c)+" file object "+JSON.stringify(a));if(0===g.state&&!1===c.isMobile)a=n.a.error_1180,d.a.info(" file upload: room is disconnected, file operations are not allowed"),t.a.error("room-event",w.a.event_file_shared_failed,{message:"file upload: room is disconnected, file operations are not allowed"}),
b(a);else if(b&&"function"===typeof b?d.a.info("send file called with callback "):b=function(a){d.a.info("SDK defined callback send file response ",a)},0<a.length){d.a.info("preparing to upload files");g.filesToUpload=a;try{if(0>=g.filesToUpload[g.filesToUpload.length-1].size)d.a.info(" file size is 0 bytes ",g.filesToUpload[g.filesToUpload.length-1].size),b(n.a.error_1186+g.filesToUpload[g.filesToUpload.length-1].size);else{if(!c.isMobile){if(g.filesToUpload[g.filesToUpload.length-1].size>V){d.a.info(" file upload limit exceeded. max allowed limit is ",
V);b(n.a.error_1187+V);return}var e={};e.data=a;!0===g.showFsUi&&null!==document.getElementById(O)&&La(e,document.getElementById(O),"fs-upload-init");lb(e,"fs-upload-started",c.broadcast,c.clientList,function(a){d.a.info(" file-upload-started sent to all participants",a)})}var h=new G.a(a);Uc(h,c,b);t.a.info("room-event",w.a.event_file_shared_success,{error:{}})}}catch(zb){d.a.error("exception occured in send file ",zb),a=n.a.error_1182,d.a.info(" send file failed",a),t.a.error("room-event",w.a.event_file_shared_failed,
{error:{}}),b(a)}}else c=n.a.error_1185,d.a.info(" input file list to upload is empty",c," length of file array",a.length),b(c)};g.recvFiles=function(a,c,b){c=void 0===c?{isMobile:!1}:c;b=void 0===b?function(){}:b;var e,h,f,m,k,u,x,v,l,ka,F,p,va,V,B;return $jscomp.asyncExecutePromiseGeneratorProgram(function(D){switch(D.nextAddress){case 1:if("function"!==typeof b){d.a.error("recvFiles() invalid param - callback");D.jumpTo(0);break}if(0===g.state&&!1===c.isMobile)return e=n.a.error_1180,d.a.info(" file download: room is disconnected file operations are not allowed"),
void 0!=b&&b(e),D.return();if(a>K.length)return h=n.a.error_1181,d.a.info(" file download: file is not available"),void 0!=b&&b(h),D.return();f={messageType:"download-started",result:0,description:"download-started",response:{downloadStatus:"started",jobId:a,downloadInfo:g.availableFiles[a]}};D.setCatchFinallyBlocks(3);m=K[a];k=m.url.split("#")[0];return D.yield(fetch(k),5);case 5:return u=D.yieldResult,x=u.headers.get("WWW-Authenticate"),v=x.replace("send-v1 ",""),l=new A.a({secretKey:m.secretKey,
id:m.id,nonce:v,requiresPassword:!1}),ka={receiver:l,status:"started"},U.set(a,ka),F=Object(q.e)({type:"fs-download-result",message:f}),g.dispatchEvent(F),D.yield(l.getMetadata(),6);case 6:return D.yield(l.download(c),7);case 7:p=D.yieldResult;d.a.info(" file downloaded successfully ",p);ka.status="completed";U.set(a,ka);f.messageType="download-completed";f.response.downloadStatus=ka.status;f.response.jobId=a;f.description=" upload completed";F=Object(q.e)({type:"fs-download-result",message:f});t.a.info("room-event",
w.a.event_file_download_success,{error:{}});g.dispatchEvent(F);void 0!=b&&b(p);D.leaveTryBlock(0);break;case 3:va=D.enterCatchBlock(),d.a.info(" file download failed",va),U.delete(a),f.messageType="download-failed",f.response.downloadStatus="failed",f.description=" download failed",f.result=1,V=Object(q.e)({type:"fs-download-result",message:f}),g.dispatchEvent(V),B=n.a.error_1183,t.a.error("room-event",w.a.event_file_download_failed,{error:n.a.error_1183.desc}),void 0!=b&&b(B),D.jumpToEnd()}})};g.mobileSetAvailableFile=
function(a,c){d.a.info("mobile sdk wants to set the available file list ",a);"fs-file-available"===a.message.type&&(K.push(a.message),g.availableFiles.push({name:a.message.name,size:a.message.size,speed:a.message.speed,createdAt:a.message.createdAt,dlimit:a.message.dlimit,time:a.message.time,expiresAt:a.message.expiresAt,timeLimit:a.message.timeLimit,index:K.length-1}));c(!0)};g.setFsEndPoint=function(a){a=void 0===a?{isMobile:!1,fsDetails:{}}:a;!0===a.isMobile&&Object(v.f)(a.fsDetails,a.callInfo)};
g.inJectFsUI=function(a){(a=void 0===a?{enable:!0,uploadElToAppend:"",recvElToAppend:""}:a)&&!0===a.enable&&""!==a.uploadElToAppend&&null!==document.getElementById(a.uploadElToAppend)&&""!==a.recvElToAppend&&null!==document.getElementById(a.recvElToAppend)?(d.a.info(" show file sharing UI "),g.showFsUi=!0,R=a.uploadElToAppend,O=a.recvElToAppend,g.testFT()):d.a.info(" file UI injection failed")};g.testFT=function(){if(!1===g.showFsUi||!0===g.showFsUi&&null===document.getElementById(R))d.a.info(" file upload  UI can not be appended");
else{var a=document.createElement("INPUT");a.setAttribute("type","file");a.setAttribute("id","filesID");document.getElementById(R).appendChild(a);document.getElementById("filesID").addEventListener("change",function(a){a=a.target.files;g.sendFiles(a);for(var c=0,d;d=a[c];c++)console.log(d)},!1);document.getElementById("filesID").addEventListener("click",function(a){a.target.value=null},!1)}};g.cancelUploads=function(a,c,b){a=void 0===a?!1:a;var e={description:"failed",result:1};if(void 0===c&&!1===
a){if(d.a.error(" upJobId must be defined for cancelling a particular upload "),e.description="upJobId is undefined.",e.result=1,void 0!==b)return b(e)}else if(!0===a){c=$jscomp.makeIterator(P);for(a=c.next();!a.done;a=c.next())a=$jscomp.makeIterator(a.value),a.next(),a=a.next().value,"started"===a.status?(a.sender.cancel(),d.a.info(" running jobs are",a)):d.a.info(" status is ",a.status);e.description="Cancelled all uploads";e.result=0;void 0!==b&&b(e)}else void 0!=c&&(d.a.info("cancelling specified upload with id",
c),a=P.get(c),void 0!=a?"started"===a.status?(d.a.info("canceled upload",c),a.sender.cancel(),e.description="Cancelled upload "+c,e.result=0,void 0!=b&&b(e)):"completed"===a.status&&(d.a.info("upload can not be cancelled because it is already completed"),e.description="upload is already completed.",e.result=1,void 0!=b&&b(e)):(d.a.info("Uplode id is invalid"),e.description="Uplode id is invalid. ",e.result=1,void 0!=b&&b(e)))};g.cancelDownloads=function(a,c,b){a=void 0===a?!1:a;var e={description:"failed",
result:1};if(void 0===c&&!1===a){if(d.a.error("ID must be defined for cancelling a particular upload "),e.description="ID is undefined.",e.result=1,void 0!==b)return b(e)}else if(!0===a){c=$jscomp.makeIterator(U);for(a=c.next();!a.done;a=c.next())a=$jscomp.makeIterator(a.value),a.next(),a=a.next().value,"started"===a.status?(a.receiver.cancel(),d.a.info(" running jobs are",a)):d.a.info(" status is ",a.status);e.description="Cancelled all downloads";e.result=0;void 0!==b&&b(e)}else void 0!=c&&(d.a.info("cancelling specified download with id",
c),c=c.toString(),a=U.get(c),void 0!=a?"started"===a.status?(d.a.info("cancelling download",c),a.receiver.cancel(),e.description="Cancelled download "+c,e.result=0,void 0!=b&&b(e)):"completed"===a.status&&(d.a.info("Download can not be cancelled because it is already completed"),e.description="download is already completed.",e.result=1,void 0!=b&&b(e)):(d.a.info("download id is invalid"),e.description="Download id is invalid. ",e.result=1,void 0!=b&&b(e)))};g.testFtMobile=function(a){a=void 0===a?
!1:a;var c=document.createElement("INPUT");c.setAttribute("type","file");c.setAttribute("id","files-mobile");var b="";b=!1===a?document.getElementById("chat_btn"):document.body;b.appendChild(c);document.getElementById("files-mobile").addEventListener("change",function(a){a=a.target.files;d.a.info("mobile list of files to upload",a[0]);g.filesToUpload=a;for(var c=0,b;b=a[c];c++)console.log("iterating file list",b)},!1)};var Vc=function(a){d.a.debug("onstreamingnotification events"+JSON.stringify(a));
a=Object(q.e)({type:a.type,message:a.data});g.dispatchEvent(a)},Wc=function(a){d.a.debug("socketOnHlsStreamingNotificationToPublisher events"+JSON.stringify(a));a=Object(q.e)({type:a.type,message:a.data});g.dispatchEvent(a)},Xc=function(a){a=Object(q.e)({type:a.type,message:a.data});g.dispatchEvent(a)},Yc=function(a){a=Object(q.e)({type:a.type,message:a.data});g.dispatchEvent(a)};if("IE"!==f.a.browserEngineCheck())y.on(u.a.SocketEvent.onAddStream,C.bind(null,$a)),y.on(u.a.SocketEvent.media_engine_connecting,
C.bind(null,gb)),y.on(u.a.SocketEvent.signaling_message_peer,C.bind(null,Fb)),y.on(u.a.SocketEvent.publish_me,C.bind(null,hb)),y.on(u.a.SocketEvent.unpublish_me,C.bind(null,Gb)),y.on(u.a.SocketEvent.onBandwidthAlert,C.bind(null,jb)),y.on(u.a.SocketEvent.onBandwidthEvents,C.bind(null,Hb)),y.on(u.a.SocketEvent.onSelfBandwidthAlert,C.bind(null,ib)),y.on(u.a.SocketEvent.onDataStream,C.bind(null,Ib)),y.on(u.a.SocketEvent.onUpdateAttributeStream,C.bind(null,Kb)),y.on(u.a.SocketEvent.onRemoveStream,C.bind(null,
kb)),y.on(u.a.SocketEvent.disconnect,C.bind(null,Lb)),y.on(u.a.SocketEvent.connection_failed,C.bind(null,Mb)),y.on(u.a.SocketEvent.error,C.bind(null,Nb)),y.on(u.a.SocketEvent.onRemoveTrack,C.bind(null,Cb)),y.on(u.a.SocketEvent.user_connected,C.bind(null,bb)),y.on(u.a.SocketEvent.user_updated,C.bind(null,Db)),y.on(u.a.SocketEvent.user_disconnected,C.bind(null,db)),y.on(u.a.SocketEvent.user_subscribed,C.bind(null,eb)),y.on(u.a.SocketEvent.user_unsubscribed,C.bind(null,fb)),y.on(u.a.SocketEvent.floor_management_events,
C.bind(null,Ub)),y.on(u.a.SocketEvent.dial_state_events,C.bind(null,Tc)),y.on(u.a.UserEvent.user_awaited,C.bind(null,Zb)),y.on(u.a.SocketEvent.data_stream_room,C.bind(null,Jb)),y.on(u.a.RoomEvent.room_awaited,C.bind(null,Yb)),y.on(u.a.RoomEvent.room_connected,C.bind(null,$b)),y.on(u.a.RoomEvent.room_disconnected,C.bind(null,cb)),y.on(u.a.RoomEvent.room_record_on,C.bind(null,oc)),y.on(u.a.RoomEvent.room_record_off,C.bind(null,pc)),y.on(u.a.RoomEvent.change_layout,C.bind(null,tc)),y.on(u.a.RoomEvent.new_active_talker,
C.bind(null,yc)),y.on(u.a.RoomEvent.hard_mute_audio,C.bind(null,ac)),y.on(u.a.RoomEvent.hard_unmute_audio,C.bind(null,bc)),y.on(u.a.RoomEvent.hard_mute_video,C.bind(null,cc)),y.on(u.a.RoomEvent.hard_unmute_video,C.bind(null,dc)),y.on(u.a.RoomEvent.share_started,C.bind(null,ec)),y.on(u.a.RoomEvent.share_stopped,C.bind(null,ic)),y.on(u.a.RoomEvent.screen_share_override,C.bind(null,jc)),y.on(u.a.RoomEvent.stop_sharing,C.bind(null,gc)),y.on(u.a.RoomEvent.update_layout,C.bind(null,hc)),y.on(u.a.RoomEvent.share_state_events,
C.bind(null,Jc)),y.on(u.a.RoomEvent.custom_data_saved,C.bind(null,Bc)),y.on(u.a.RoomEvent.custom_data_updated,C.bind(null,Cc)),y.on(u.a.RoomEvent.canvas_started,C.bind(null,Gc)),y.on(u.a.RoomEvent.canvas_stopped,C.bind(null,Hc)),y.on(u.a.RoomEvent.canvas_state_events,C.bind(null,Ic)),y.on(u.a.RoomEvent.generic_events,C.bind(null,Kc)),y.on(u.a.RoomEvent.user_role_changed,C.bind(null,Lc)),y.on(u.a.RoomEvent.switch_codec,C.bind(null,fc)),y.on(u.a.RoomEvent.invite_breakout_room,C.bind(null,Oc)),y.on(u.a.RoomEvent.user_joined_breakout_room,
C.bind(null,Pc)),y.on(u.a.RoomEvent.user_left_breakout_room,C.bind(null,Qc)),y.on(u.a.RoomEvent.breakout_room_destroyed,C.bind(null,Rc)),y.on(u.a.RoomEvent.transcription_events,C.bind(null,Sc)),y.on(u.a.UserEvent.user_audio_muted,C.bind(null,kc)),y.on(u.a.UserEvent.user_audio_unmuted,C.bind(null,lc)),y.on(u.a.UserEvent.user_video_muted,C.bind(null,mc)),y.on(u.a.UserEvent.user_video_unmuted,C.bind(null,nc)),y.on(u.a.SocketEvent.room_management_events,C.bind(null,Nc)),y.on(u.a.SocketEvent.hard_mute,
C.bind(null,Vb)),y.on(u.a.SocketEvent.hard_mute_room,C.bind(null,Xb)),y.on(u.a.SocketEvent.hard_unmute_room,C.bind(null,Wb)),y.on(u.a.SocketEvent.onStatSubscription,C.bind(null,Pb)),y.on(u.a.SocketEvent.onStreamingNotification,C.bind(null,Xc)),y.on(u.a.SocketEvent.onHlsStreamingNotification,C.bind(null,Vc)),y.on(u.a.SocketEvent.onHlsStreamingNotificationToPublisher,C.bind(null,Wc)),y.on(u.a.SocketEvent.onLiveRecordingNotification,C.bind(null,Yc)),y.on(u.a.SocketEvent.onRoomLiveRecordingOn,C.bind(null,
qc)),y.on(u.a.SocketEvent.onRoomLiveRecordingOff,C.bind(null,rc)),y.on(u.a.SocketEvent.onRoomLiveRecordingFailed,C.bind(null,sc)),y.on(u.a.SocketEvent.switched_room,C.bind(null,Mc)),y.on(u.a.RoomEvent.room_transcription_on,C.bind(null,uc)),y.on(u.a.RoomEvent.room_transcription_off,C.bind(null,vc)),y.on(u.a.RoomEvent.self_transcription_on,C.bind(null,wc)),y.on(u.a.RoomEvent.self_transcription_off,C.bind(null,xc));else{null===document.getElementById("WebrtcEverywherePluginId")&&g.installPlugin();var ya=
document.getElementById("WebrtcEverywherePluginId");ya.addEventListener(u.a.SocketEvent.onAddStream,function(a){for(arg in a.data.args)$a(a.data.args[arg])});ya.addEventListener(u.a.SocketEvent.onRemoveStream,function(a){for(arg in a.data.args)kb(a.data.args[arg])});ya.addEventListener(u.a.SocketEvent.media_engine_connecting,function(a){for(arg in a.data.args)gb(a.data.args[arg])});ya.addEventListener(u.a.SocketEvent.publish_me,function(a){for(arg in a.data.args)hb(a.data.args[arg])});ya.addEventListener(u.a.SocketEvent.user_connected,
function(a){for(arg in a.data.args)bb(a.data.args[arg])});ya.addEventListener(u.a.SocketEvent.user_disconnected,function(a){for(arg in a.data.args)db(a.data.args[arg])});ya.addEventListener(u.a.SocketEvent.user_subscribed,function(a){for(arg in a.data.args)eb(a.data.args[arg])});ya.addEventListener(u.a.SocketEvent.user_unsubscribed,function(a){for(arg in a.data.args)fb(a.data.args[arg])})}return g}d.a.info("Failed - Webrtc support is missing ")}},function(l,r,p){function f(a){a=void 0===a?100:a;return new Promise(function(b){return setTimeout(b,
a)})}var q=p(30),k=!("object"!==typeof Intl||!Intl||"function"!==typeof Intl.NumberFormat||"object"!==typeof navigator),e=["bytes","kb","mb","gb"],a=function(){throw Error("uninitialized translate function. call setTranslate first");};l.exports={fadeOut:function(a){a=document.querySelector(a).classList;a.remove("effect--fadeIn");a.add("effect--fadeOut");return f(300)},delay:f,allowedCopy:function(){return document.queryCommandSupported?document.queryCommandSupported("copy"):!1},bytes:function(b){if(1>
b)return"0B";var h=Math.min(Math.floor(Math.log10(b)/3),e.length-1);b=Number(b/Math.pow(1024,h));var f=Math.floor(b)===b?0:1,d=b.toFixed(f);if(k)try{d=b.toLocaleString(locale(),{minimumFractionDigits:f,maximumFractionDigits:f})}catch(u){}return a("fileSize",{num:d,units:a(e[h])})},percent:function(a){if(k)try{return a.toLocaleString(locale(),{style:"percent"})}catch(h){}return Math.floor(100*a)+"%"},number:function(a){return k?a.toLocaleString(locale()):a.toString()},copyToClipboard:function(a){var b=
document.createElement("input");b.setAttribute("value",a);b.contentEditable=!0;b.readOnly=!0;document.body.appendChild(b);if(navigator.userAgent.match(/iphone|ipad|ipod/i)){var e=document.createRange();e.selectNodeContents(b);var d=getSelection();d.removeAllRanges();d.addRange(e);b.setSelectionRange(0,a.length)}else b.select();a=document.execCommand("copy");document.body.removeChild(b);return a},arrayToB64:function(a){return q.fromByteArray(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},
b64ToArray:function(a){return q.toByteArray(a+"===".slice((a.length+3)%4))},isFile:function(a){return/^[0-9a-fA-F]{10,16}$/.test(a)},openLinksInNewTab:function(a,e){e=void 0===e?!0:e;a=a||Array.from(document.querySelectorAll("a:not([target])"));e?a.forEach(function(a){a.setAttribute("target","_blank");a.setAttribute("rel","noopener noreferrer")}):a.forEach(function(a){a.removeAttribute("target");a.removeAttribute("rel")});return a},browserName:function(){try{return/firefox/i.test(navigator.userAgent)?
"firefox":/edge/i.test(navigator.userAgent)?"edge":/trident/i.test(navigator.userAgent)?"ie":/chrome/i.test(navigator.userAgent)?"chrome":/safari/i.test(navigator.userAgent)?"safari":/send android/i.test(navigator.userAgent)?"android-app":"other"}catch(b){return"unknown"}},streamToArrayBuffer:function(a,e){var b,d,h,f,k,w,t,q,l,p,A;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){switch(n.nextAddress){case 1:return b=a.getReader(),n.yield(b.read(),2);case 2:d=n.yieldResult;if(!e){n.jumpTo(3);
break}h=new Uint8Array(e);f=0;case 4:if(d.done){n.jumpTo(5);break}h.set(d.value,f);f+=d.value.length;return n.yield(b.read(),6);case 6:d=n.yieldResult;n.jumpTo(4);break;case 5:return n.return(h.buffer);case 3:k=[],w=0;case 7:if(d.done){n.jumpTo(8);break}k.push(d.value);w+=d.value.length;return n.yield(b.read(),9);case 9:d=n.yieldResult;n.jumpTo(7);break;case 8:t=0;q=new Uint8Array(w);l=$jscomp.makeIterator(k);for(p=l.next();!p.done;p=l.next())A=p.value,q.set(A,t),t+=A.length;return n.return(q.buffer)}})},
list:function(a,e,f){e=void 0===e?"":e;f=void 0===f?"":f;a=a.map(function(a){return html($jscomp$templatelit$0,f,a)});return html($jscomp$templatelit$1,e,a)},secondsToL10nId:function(a){return 3600>a?{id:"timespanMinutes",num:Math.floor(a/60)}:86400>a?{id:"timespanHours",num:Math.floor(a/3600)}:{id:"timespanDays",num:Math.floor(a/86400)}},timeLeft:function(a){if(1>a)return{id:"linkExpiredAlt"};a=Math.floor(a/1E3/60);var b=Math.floor(a/60),e=Math.floor(b/24);return 1<=e?{id:"expiresDaysHoursMinutes",
days:e,hours:b%24,minutes:a%60}:1<=b?{id:"expiresHoursMinutes",hours:b,minutes:a%60}:0===b?0===a?{id:"expiresMinutes",minutes:"< 1"}:{id:"expiresMinutes",minutes:a}:null},platform:function(){return"object"===typeof Android?"android":"web"},encryptedSize:function(a,e,f){f=(void 0===f?16:f)+1;return 21+a+f*Math.ceil(a/((void 0===e?65536:e)-f))},setTranslate:function(b){a=b}}},function(l,r){function p(f){this.max_=this.count_=this.sum_=this.startTime_=0;this.rampUpThreshold_=f;this.rampUpTime_=Infinity}
var f;p.prototype={add:function(f,k){0===this.startTime_&&(this.startTime_=f);this.sum_+=k;this.max_=Math.max(this.max_,k);Infinity===this.rampUpTime_&&k>this.rampUpThreshold_&&(this.rampUpTime_=f);this.count_+=1},getAverage:function(){return 0===this.count_?0:Math.round(this.sum_/this.count_)},getMax:function(){return this.max_},getRampUpTime:function(){return Math.round(this.rampUpTime_-this.startTime_)}};l.exports={arrayAverage:function(f){for(var k=f.length,e=0,a=0;a<k;a++)e+=f[a];return Math.floor(e/
k)},arrayMax:function(f){return 0===f.length?NaN:Math.max.apply(Math,$jscomp.arrayFromIterable(f))},arrayMin:function(f){return 0===f.length?NaN:Math.min.apply(Math,$jscomp.arrayFromIterable(f))},enumerateStats:function(f,k,e){var a={audio:{local:{audioLevel:0,bytesSent:0,clockRate:0,codecId:"",mimeType:"",packetsSent:0,payloadType:0,timestamp:0,trackId:"",transportId:""},remote:{audioLevel:0,bytesReceived:0,clockRate:0,codecId:"",fractionLost:0,jitter:0,mimeType:"",packetsLost:-1,packetsReceived:0,
payloadType:0,timestamp:0,trackId:"",transportId:""}},video:{local:{bytesSent:0,clockRate:0,codecId:"",firCount:0,framesEncoded:0,frameHeight:0,framesSent:-1,frameWidth:0,nackCount:0,packetsSent:-1,payloadType:0,pliCount:0,qpSum:0,timestamp:0,trackId:"",transportId:""},remote:{bytesReceived:-1,clockRate:0,codecId:"",firCount:-1,fractionLost:0,frameHeight:0,framesDecoded:0,framesDropped:0,framesReceived:0,frameWidth:0,nackCount:-1,packetsLost:-1,packetsReceived:0,payloadType:0,pliCount:-1,qpSum:0,
timestamp:0,trackId:"",transportId:""}},connection:{availableOutgoingBitrate:0,bytesReceived:0,bytesSent:0,consentRequestsSent:0,currentRoundTripTime:0,localCandidateId:"",localCandidateType:"",localIp:"",localPort:0,localPriority:0,localProtocol:"",remoteCandidateId:"",remoteCandidateType:"",remoteIp:"",remotePort:0,remotePriority:0,remoteProtocol:"",requestsReceived:0,requestsSent:0,responsesReceived:0,responsesSent:0,timestamp:0,totalRoundTripTime:0}};f&&(f.forEach(function(b,h){switch(b.type){case "outbound-rtp":b.hasOwnProperty("trackId")&&
(1!==b.trackId.indexOf(k.audio)&""!==k.audio?(a.audio.local.bytesSent=b.bytesSent,a.audio.local.codecId=b.codecId,a.audio.local.packetsSent=b.packetsSent,a.audio.local.timestamp=b.timestamp,a.audio.local.trackId=b.trackId,a.audio.local.transportId=b.transportId):1!==b.trackId.indexOf(k.video)&""!==k.video&&(a.video.local.bytesSent=b.bytesSent,a.video.local.codecId=b.codecId,a.video.local.firCount=b.firCount,a.video.local.framesEncoded=b.framesEncoded,a.video.local.framesSent=b.framesSent,a.video.local.packetsSent=
b.packetsSent,a.video.local.pliCount=b.pliCount,a.video.local.qpSum=b.qpSum,a.video.local.timestamp=b.timestamp,a.video.local.trackId=b.trackId,a.video.local.transportId=b.transportId));break;case "inbound-rtp":b.hasOwnProperty("trackId")&&(1!==b.trackId.indexOf(e.audio)&""!==e.audio&&(a.audio.remote.bytesReceived=b.bytesReceived,a.audio.remote.codecId=b.codecId,a.audio.remote.fractionLost=b.fractionLost,a.audio.remote.jitter=b.jitter,a.audio.remote.packetsLost=b.packetsLost,a.audio.remote.packetsReceived=
b.packetsReceived,a.audio.remote.timestamp=b.timestamp,a.audio.remote.trackId=b.trackId,a.audio.remote.transportId=b.transportId),1!==b.trackId.indexOf(e.video)&""!==e.video&&(a.video.remote.bytesReceived=b.bytesReceived,a.video.remote.codecId=b.codecId,a.video.remote.firCount=b.firCount,a.video.remote.fractionLost=b.fractionLost,a.video.remote.nackCount=b.nackCount,a.video.remote.packetsLost=b.packetsLost,a.video.remote.packetsReceived=b.packetsReceived,a.video.remote.pliCount=b.pliCount,a.video.remote.qpSum=
b.qpSum,a.video.remote.timestamp=b.timestamp,a.video.remote.trackId=b.trackId,a.video.remote.transportId=b.transportId));break;case "candidate-pair":b.hasOwnProperty("availableOutgoingBitrate")&&(a.connection.availableOutgoingBitrate=b.availableOutgoingBitrate,a.connection.bytesReceived=b.bytesReceived,a.connection.bytesSent=b.bytesSent,a.connection.consentRequestsSent=b.consentRequestsSent,a.connection.currentRoundTripTime=b.currentRoundTripTime,a.connection.localCandidateId=b.localCandidateId,a.connection.remoteCandidateId=
b.remoteCandidateId,a.connection.requestsReceived=b.requestsReceived,a.connection.requestsSent=b.requestsSent,a.connection.responsesReceived=b.responsesReceived,a.connection.responsesSent=b.responsesSent,a.connection.timestamp=b.timestamp,a.connection.totalRoundTripTime=b.totalRoundTripTime)}}.bind()),f.forEach(function(b){switch(b.type){case "track":b.hasOwnProperty("trackIdentifier")&&(1!==b.trackIdentifier.indexOf(k.video)&""!==k.video&&(a.video.local.frameHeight=b.frameHeight,a.video.local.framesSent=
b.framesSent,a.video.local.frameWidth=b.frameWidth),1!==b.trackIdentifier.indexOf(e.video)&""!==e.video&&(a.video.remote.frameHeight=b.frameHeight,a.video.remote.framesDecoded=b.framesDecoded,a.video.remote.framesDropped=b.framesDropped,a.video.remote.framesReceived=b.framesReceived,a.video.remote.frameWidth=b.frameWidth),1!==b.trackIdentifier.indexOf(k.audio)&""!==k.audio&&(a.audio.local.audioLevel=b.audioLevel),1!==b.trackIdentifier.indexOf(e.audio)&""!==e.audio&&(a.audio.remote.audioLevel=b.audioLevel));
break;case "codec":b.hasOwnProperty("id")&&(1!==b.id.indexOf(a.audio.local.codecId)&""!==k.audio&&(a.audio.local.clockRate=b.clockRate,a.audio.local.mimeType=b.mimeType,a.audio.local.payloadType=b.payloadType),1!==b.id.indexOf(a.audio.remote.codecId)&""!==e.audio&&(a.audio.remote.clockRate=b.clockRate,a.audio.remote.mimeType=b.mimeType,a.audio.remote.payloadType=b.payloadType),1!==b.id.indexOf(a.video.local.codecId)&""!==k.video&&(a.video.local.clockRate=b.clockRate,a.video.local.mimeType=b.mimeType,
a.video.local.payloadType=b.payloadType),1!==b.id.indexOf(a.video.remote.codecId)&""!==e.video&&(a.video.remote.clockRate=b.clockRate,a.video.remote.mimeType=b.mimeType,a.video.remote.payloadType=b.payloadType));break;case "local-candidate":b.hasOwnProperty("id")&&-1!==b.id.indexOf(a.connection.localCandidateId)&&(a.connection.localIp=b.ip,a.connection.localPort=b.port,a.connection.localPriority=b.priority,a.connection.localProtocol=b.protocol,a.connection.localType=b.candidateType);break;case "remote-candidate":b.hasOwnProperty("id")&&
-1!==b.id.indexOf(a.connection.remoteCandidateId)&&(a.connection.remoteIp=b.ip,a.connection.remotePort=b.port,a.connection.remotePriority=b.priority,a.connection.remoteProtocol=b.protocol,a.connection.remoteType=b.candidateType)}}.bind()));return a},doGetUserMedia:function(f,k,e){try{navigator.mediaDevices.getUserMedia(f).then(function(a){a.onremovetrack=function(){};k(a)}).catch(function(a){e(a)})}catch(a){e(a.message)}},setTimeoutWithProgressBar:function(q,k){var e=window.performance.now(),a=setInterval(function(){var a=
window.performance.now();f.setProgress(100*(a-e)/k)},100),b=function(){clearInterval(a);f.setProgress(100);q()},h=setTimeout(b,k);return function(){clearTimeout(h);b()}},setActiveTest:function(q){f=q},appendSourceId:function(f,k,e){""!==f&&(!0===e[k]?e[k]={optional:[{sourceId:f}]}:"object"===typeof e[k]&&("undefined"===typeof e[k].optional&&(e[k].optional=[]),e[k].optional.push({sourceId:f})))},StatisticsAggregate:p,enumerateStatsFirefox:function(f){var k={audio:{local:{bytesSent:0,packetsSent:0},
remote:{bytesReceived:-1,packetsReceived:0,packetsLost:-1,jitter:0,roundTripTime:0,timestamp:0}},video:{local:{bytesSent:0,packetsSent:-1,bitrateMean:0,bitrateStdDev:0,qpSum:0},remote:{bytesReceived:-1,packetsReceived:0,packetsLost:-1,bitrateMean:0,bitrateStdDev:0,roundTripTime:0,timestamp:0}},connection:{bytesSent:0,bytesReceived:0,timestamp:0}};f&&f.forEach(function(e,a){switch(e.type){case "outbound-rtp":"audio"==e.mediaType?(k.audio.local.bytesSent=e.bytesSent,k.audio.local.packetsSent=e.packetsSent):
"video"==e.mediaType&&(k.video.local.bytesSent=e.bytesSent,k.video.local.packetsSent=e.packetsSent,k.video.local.bitrateMean=e.bitrateMean,k.video.local.bitrateStdDev=e.bitrateStdDev,k.video.local.qpSum=e.qpSum);break;case "remote-outbound-rtp":"audio"==e.mediaType?(k.audio.local.bytesSent=e.bytesSent,k.audio.local.packetsSent=e.packetsSent):"video"==e.mediaType&&(k.video.local.bytesSent=e.bytesSent,k.video.local.packetsSent=e.packetsSent);break;case "inbound-rtp":"audio"==e.mediaType?(k.audio.remote.bytesReceived=
e.bytesReceived,k.audio.remote.packetsLost=e.packetsLost,k.audio.remote.packetsReceived=e.packetsReceived,k.audio.remote.jitter=e.jitter):"video"==e.mediaType&&(k.video.remote.bytesReceived=e.bytesReceived,k.video.remote.packetsLost=e.packetsLost,k.video.remote.packetsReceived=e.packetsReceived,k.video.remote.bitrateMean=e.bitrateMean,k.video.remote.bitrateStdDev=e.bitrateStdDev,k.video.remote.qpSum=e.qpSum);break;case "remote-inbound-rtp":"audio"==e.mediaType?(k.audio.remote.bytesReceived=e.bytesReceived,
k.audio.remote.packetsLost=e.packetsLost,k.audio.remote.packetsReceived=e.packetsReceived,k.audio.remote.jitter=e.jitter,k.audio.remote.roundTripTime=e.roundTripTime,k.audio.remote.timestamp=e.timestamp):"video"==e.mediaType&&(k.video.remote.bytesReceived=e.bytesReceived,k.video.remote.packetsLost=e.packetsLost,k.video.remote.packetsReceived=e.packetsReceived,k.video.remote.roundTripTime=e.roundTripTime,k.video.remote.timestamp=e.timestamp);break;case "candidate-pair":k.connection.bytesReceived=e.bytesReceived,
k.connection.bytesSent=e.bytesSent,k.connection.timestamp=e.timestamp}}.bind());return k}}},function(l,r,p){var f=p(4),q=p(42),k=p(28),e=p(7),a=p(0),b=p(27),h=p(6),x=p(5);p(29);var d=p(8),u=p(9);l=p(1);var n=p.n(l),B=p(51),w=void 0;1==n.a.noise_analysis&&"desktop"==n.a.browser_info.device_type&&function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(a){if(1==a.nextAddress)return a.yield(Object(B.a)(),2);w=a.yieldResult;a.jumpToEnd()})}();r.a=function(t,v){function l(a){return 0<a.length?
a.reduce(function(a,c){return a+c})/a.length:0}function p(a){return a.filter(function(a){return 0<=a})}function A(){if(0<c.scoreArrayVoice.length){if(.6<l(c.scoreArrayVoice).toFixed(2)){a.a.info("Your microphone is muted");var d=Object(f.f)({type:"talking-while-muted",stream:c});c.dispatchEvent(d)}c.scoreArrayVoice.length=0;c.processing_voice_while_mute=!1}}function F(){if(0<c.scoreArrayNoise.length){var d=l(c.scoreArrayNoise),b=l(c.audioLevelArray);.2>d&&.04<b&&(a.a.info("noise-detected"),d=Object(f.f)({type:"noise-detection",
stream:c}),c.dispatchEvent(d));c.scoreArrayNoise.length=0;c.processing_noise_detection=!1}}if(n.a.is_supported()){var c=Object(f.c)(v);c.config=v;c.stream=v.stream;c.url=v.url;c.recording=v.recording;c.recordingId=void 0;c.room=void 0;c.showing=!1;c.local=!1;c.video=v.video;c.audio=v.audio;c.screen=v.screen;c.videoSize=v.videoSize;c.videoFrameRate=v.videoFrameRate;c.extensionId=v.extensionId;c.desktopStreamId=v.desktopStreamId;c.recordingId=v.recordingId;c.clientId=v.clientId;c.videoMutedDueToBw=
!1;c.hardAudioMuted=!1;c.hardVideoMuted=!1;c.softVideoMuted=!1;c.selfMuteVideo=!1;c.selfMuteAudio=!1;c.ATVideoMuted=!1;c.selfPausedVideo=!1;c.selfPausedAudio=!1;c.processingVideoMute=!1;c.attributes=v.attributes;c.Connection=void 0===t?e.a:t;c.playerDivs=[];c.canvas=v.canvas;c.transactions=new Map;c.audioStream=v.audioStream;c.audioStreamClone=void 0;c.videoStream=v.videoStream;c.recordedBlobs=[];c.negotiatedMedia={audio:void 0!=v.audio,video:void 0!=v.video};c.state="idle";var B={},z=!1,r=!1,M=!1;
c.inputMediaSource={audio:{},video:{user:null,self:null,selected:"self"}};void 0==c.config.videoMuted&&(c.config.videoMuted=!1);void 0==c.config.audioMuted&&(c.config.audioMuted=!1);c.abwdEnabled=!0;c.abwdNotification="sdk";c.abwdLanguage="en";var I="none",U="none",ca=!1,g="none",ea;c.maxVideoBwKbpsReqByUser=0;c.maxVideoBwKbpsReqByServer=0;c.maxVideoBwKbpsSet=0;c.reconnect=!1;c.reconnectAttempt=0;c.reconnectsTotal=0;c.pcmInputBuf=void 0;c.pcmOutputBuf=void 0;c.pcmInputIndex=void 0;c.rnn=void 0;c.bufferResidue=
new Float32Array([]);c.scoreArrayVoice=[];c.scoreArrayNoise=[];c.audioLevelArray=[];c.processing_voice_while_mute=!1;c.processing_noise_detection=!1;c.audioContext=void 0;var P={videoFps:{set:0,max:{user:0,server:0},min:{user:0,server:0}},videoBw:{set:0,max:{user:0,server:0},min:{user:0,server:0}}};void 0===v.local||!0===v.local?c.local=!0:z=r=!0;c.isAudioMuted=function(){return z};c.isVideoMuted=function(){return r||c.config.videoMuted};c.setID=function(a){(v.streamID=a)&&c.player&&c.player.streamUpdated(a)};
c.getID=function(){return c.local&&!v.streamID?"local":v.streamID};c.getAttributes=function(){return v.attributes};c.setAttributes=function(d){c.local?c.emit(Object(f.f)({type:"internal-set-attributes",stream:c,attrs:d})):a.a.error("Error! Stream Object is not published. Failed to update attributes.")};c.updateLocalAttributes=function(a){v.attributes=a};c.ifAudio=function(){return!1!==v.audio&&void 0!==v.audio?!0:!1};c.ifVideo=function(){return!1!==v.video&&void 0!==v.video?!0:!1};c.ifData=function(){return!1!==
v.data&&void 0!==v.data?!0:!1};c.ifScreen=function(){return v.screen};c.ifMedia=function(){return!1!==v.audio&&void 0!==v.audio||!1!==v.video&&void 0!==v.video||!1!==v.screen?!0:!1};c.ifExternal=function(){return void 0!==c.url||void 0!==c.recording?!0:!1};c.ifCanvas=function(){return v.canvas};c.sendData=function(b){c.local&&c.ifData()?c.emit(Object(f.f)({type:"internal-send-data",stream:c,msg:b})):(a.a.error("Error! Stream Object is not published. Failed to send data."),u.a.error("stream-event",
d.a.event_send_data_failed,{error:"Error! Stream Object is not published. Failed to send data."}))};var la=function(){c.Connection.mediaDeviceUpdate({mic:c.audio,cam:c.video,speaker:!1},!0,function(d){var b=d.current,e=d.added;d=d.removed;var g=function(a,c,d,b,e,g){var h=!1,f=!1,k="object"==typeof b?b.deviceId.exact:b.deviceId;b=b.groupId;var n="object"==typeof e?e.deviceId.exact:e.deviceId;e=e.groupId;for(var u in c)"default"!=k&&c[u].deviceId!=k||c[u].groupId!=b||(h=!1),"default"!=n&&c[u].deviceId!=
n||c[u].groupId!=e||(f=!1);for(var t in a)"default"!=k&&a[t].deviceId!=k||a[t].groupId!=b||(h=!0),"default"!=n&&a[t].deviceId!=n||a[t].groupId!=e||(f=!0);if(!h||!f)for(var w in d)"default"!=k&&d[w].deviceId!=k||d[w].groupId!=b||(h=!0),"default"!=n&&d[w].deviceId!=n||d[w].groupId!=e||(f=!0);if((k!=n||b!=e||!g)&&f)return n;if(!h){if(d.length)return d[0].deviceId;if(a.length)return a[0].deviceId}};if(v.params){var k=null,u=null;if(v.params.set.video&&c.videoStream){var t=!1;c.videoStream.getVideoTracks().forEach(function(a){"ended"!=
a.readyState&&(t=!0)});k=g(b.cam,d.cam,e.cam,v.params.set.video,v.params.config.video,t)}else a.a.error("spec.params.set.video not defined");if(v.params.set.audio&&c.audioStream){var w=!1;c.audioStream.getAudioTracks().forEach(function(a){"ended"!=a.readyState&&(w=!0)});u=g(b.mic,d.mic,e.mic,v.params.set.audio,v.params.config.audio,w)}else a.a.error("spec.params.set.audio not defined");var x,q;void 0!=u?(c.selfMuteAudio||c.hardAudioMuted||(x=u),c.selectedMicId=u):c.selectedMicId=v.params.set.audio.deviceId;
void 0!=k?(c.selfMuteVideo||c.hardVideoMuted||(q={deviceId:k}),c.selectedCam={deviceId:k}):c.selectedCam={deviceId:"object"==typeof v.params.set.video.deviceId?v.params.set.video.deviceId.exact:v.params.set.video.deviceId};void 0==q&&void 0==x||W(c,x,q,!0,function(d){if(d.result===h.a.error_000.result)d={},void 0!=q&&(E(c.inputMediaSource.video[c.inputMediaSource.video.selected]),d.video={deviceId:q.deviceId}),void 0!=x&&(d.audio={deviceId:x}),d=Object(f.f)({type:"media-device-updated",evntDetails:d}),
c.dispatchEvent(d);else if(a.a.error("setMediaDevicesTrack() returned failure : "+JSON.stringify(d)),d.result===h.a.error_1145&&"mobile"==n.a.browser_info.device_type&&void 0!==c.room)c.room.onMediaDeviceStateChanged(c,{type:"mic",state:"inactive",error:d})})}else a.a.error("spec.params not defined")})},ba=function(a){"mobile"!=n.a.browser_info.device_type&&(a.width={},a.height={},void 0!==c.videoSize?(a.width.min=c.videoSize[0],a.height.min=c.videoSize[1],a.width.max=c.videoSize[2],a.height.max=
c.videoSize[3]):(a.width.min=n.a.video_resolution_range.Default.min.wdith,a.height.min=n.a.video_resolution_range.Default.min.height,a.width.max=n.a.video_resolution_range.Default.max.width,a.height.max=n.a.video_resolution_range.Default.max.height),"chrome-stable"===e.a.browserEngineCheck()&&(a.width.ideal=a.width.max,a.height.ideal=a.height.max))};c.init=function(){try{if(a.a.info("requested getUsermedia options: "+JSON.stringify(v)),v.audio||v.video||v.screen||v.canvas||void 0===v.url){a.a.info("Note! Requested access to local media");
var b=!1,g=!1,h=!1;v.video&&!1!==v.video&&(void 0!=v.disableGUMOptions&&v.disableGUMOptions?b=!0:(b={},ba(b),void 0!==c.videoFrameRate&&(b.frameRate={min:c.videoFrameRate[0],max:c.videoFrameRate[1]}),"object"===typeof v.video&&(void 0!==v.video.deviceId&&""!==v.video.deviceId&&(b.deviceId="safari"!==e.a.browserEngineCheck()?{exact:v.video.deviceId}:v.video.deviceId),void 0!==v.video.facingMode&&""!==v.video.facingMode&&"mobile"==n.a.browser_info.device_type&&(b.facingMode=v.video.facingMode))));v.screen&&
!1!==v.screen&&(b=!0);v.canvas&&!1!==v.canvas&&(h={},h=void 0===c.videoSize?{width:{min:c.videoSizeForCanvas[0],max:c.videoSizeForCanvas[2]},height:{min:c.videoSizeForCanvas[1],max:c.videoSizeForCanvas[3]},canvasId:v.div,fps:v.fps}:{width:{min:c.videoSize[0],max:c.videoSize[2]},height:{min:c.videoSize[1],max:c.videoSize[3]},canvasId:v.div,fps:v.fps});v.audio&&!1!==v.audio&&(void 0!=v.disableGUMOptions&&v.disableGUMOptions?g=!0:(g={echoCancellation:{exact:!0},googEchoCancellation:{exact:!0},autoGainControl:{exact:!0},
noiseSuppression:{exact:!0},googHighpassFilter:{exact:!0},googExperimentalNoiseSuppression:{exact:!0},googExperimentalEchoCancellation:{exact:!0},googExperimentalAutoGainControl:{exact:!0}},"object"===typeof v.audio&&v.audio.deviceId&&""!==v.audio.deviceId&&(g.deviceId=v.audio.deviceId)));var k={video:b,audio:g,screen:v.screen,canvas:h,fake:v.fake,extensionId:c.extensionId,desktopStreamId:c.desktopStreamId};v.screen&&!1!==v.screen&&(k.fps=v.fps);v.canvas&&!1!==v.canvas?(c.state="initing",c.Connection.GetCanvasStream(k,
function(b){c.videoStream=b;c.stream=b;a.a.debug("Got stream from canvas opt: "+k+" refreshFn: "+v.refreshFn);c.state="inited";c.videoStream.getTracks().forEach(function(d){a.a.info("getTracks canvas: ",d);d.onended=function(){c.videoStream.getTracks().forEach(function(a){a.onended=null});var a=Object(f.f)({type:"stream-ended",stream:c,msg:d.kind});c.dispatchEvent(a)}});b=Object(f.f)({type:"media-access-allowed",stream:c});c.dispatchEvent(b);u.a.info("stream-event",d.a.event_media_access_success,
{error:{}})},function(b){a.a.error("GetCanvasStream: ",b);var e=Object(f.f)({type:"media-access-denied",msg:b});c.dispatchEvent(e);u.a.error("stream-event",d.a.event_media_access_denied,{error:b})})):(a.a.debug("Note!! calling getUserMedia "+JSON.stringify(k)),!v.screen&&c.local&&void 0==v.params&&(v.params={},v.params.config=JSON.parse(JSON.stringify(k)),v.params.set=JSON.parse(JSON.stringify(k))),c.state="initing",V(k,function(b,g){if(!g)void 0==v.params&&(v.params={set:{},config:{}}),a.a.info("Note!!!!! User has granted access to local media."),
u.a.info("stream-event",d.a.event_media_access_success,{error:{}}),c.stream=b,w&&(c.audioContext=new (window.AudioContext||window.webkitAudioContext)),c.stream.getTracks().forEach(function(d,g){"video"===d.kind?(c.videoStream=b,c.inputMediaSource.video.self=b,a.a.info(" GUM success vidtrack muted : "+d.muted+" state: "+d.readyState+" enabled: "+d.enabled),"object"!==typeof v.video&&(v.video={}),v.video.trackIndex=g,d.getSettings().deviceId&&(v.video.deviceId=d.getSettings().deviceId,v.params.set.video=
{},v.params.config.video={},v.params.config.video.deviceId="safari"!==e.a.browserEngineCheck()?{exact:v.video.deviceId}:v.video.deviceId,v.params.config.video.groupId=d.getSettings().groupId,v.params.set.video=JSON.parse(JSON.stringify(v.params.config.video))),a.a.info(" Checking and setting soft video muted : "+c.config.videoMuted+" firstGumcall: "+c.firstGumCall),c.config.videoMuted&&void 0===c.firstGumCall&&(d.enabled=!1,c.softVideoMuted=!0,a.a.debug(" soft muted video "))):"audio"===d.kind&&(c.audioStream=
b,w&&(c.audioStreamClone=b.clone(),c.audioStreamClone.getVideoTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()})),"object"!==typeof v.audio&&(v.audio={}),v.audio.trackIndex=g,d.getSettings().deviceId&&(v.audio.deviceId=d.getSettings().deviceId,v.params.set.audio={},v.params.config.audio={},v.params.config.audio.deviceId=(e.a.browserEngineCheck(),v.audio.deviceId),v.params.config.audio.groupId=d.getSettings().groupId,v.params.set.audio=JSON.parse(JSON.stringify(v.params.config.audio))),
c.config.audioMuted&&void 0===c.firstGumCall&&(d.enabled=!1,z=!0,c.selfMuteAudio=!0,a.a.debug(" soft muted aduio")));!c.local||c.ifScreen()||c.ifCanvas()||"mobile"==n.a.browser_info.device_type||"safari"==e.a.browserEngineCheck()||la();a.a.info("getTracks",d," kind: ",d.kind);d.onended=function(){c.stream.getTracks().forEach(function(a){a.onended=null});var a=Object(f.f)({type:"stream-ended",stream:c,msg:d.kind});c.dispatchEvent(a)}}),null==c.videoStream&&(c.config.videoMuted=!0),null==c.audioStream&&
(c.audio=!1,c.config.audioMuted=!0),!0!==v.audio&&!0!==v.video||(!1!==c.audio||c.ifScreen)&&!1!==c.video||(g={},!1===c.video&&(g.video=c.video),!1===c.audio&&(g.audio=c.audio),g=Object(f.f)({type:"media-access-failed",evntDetails:g}),c.dispatchEvent(g)),c.state="inited",g=Object(f.f)({type:"media-access-allowed",stream:c}),c.dispatchEvent(g),u.a.info("stream-event",d.a.event_media_access_success,{error:{}});else if(!c.ifScreen()){a.a.error("Error! Failed to get access to local media. Error code was "+
JSON.stringify(g)+".");var h=Object(f.f)({type:"media-access-denied",msg:g});c.dispatchEvent(h);u.a.error("stream-event",d.a.event_media_access_denied,{error:g})}c.fistGumCall=!0}))}else b=Object(f.f)({type:"media-access-allowed"}),c.dispatchEvent(b),u.a.info("stream-event",d.a.event_media_access_success,{error:{}})}catch(ma){a.a.error("Error! Failed to get access to local media. Error was "+ma+"."),b=Object(f.f)({type:"media-access-denied",msg:ma}),c.dispatchEvent(b),u.a.error("stream-event",d.a.event_media_access_denied,
{error:ma})}};c.initRemoteStream=function(a){if(!c.local){c.stream=a;if(c.ifAudio()||c.audioOnly)c.audioStream=new MediaStream,c.stream.getAudioTracks().forEach(function(a){c.audioStream.addTrack(a)});c.mediaStream=new MediaStream;c.stream.getTracks().forEach(function(a){c.mediaStream.addTrack(a)})}};c.close=function(){c.local&&(void 0!==c.room&&c.room.unpublish(c),c.hide(),void 0!==c.videoStream&&(c.videoStream.getVideoTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()}),c.videoStream=
void 0),void 0!==c.audioStream&&(c.audioStream.getAudioTracks().forEach(function(a){a.onended=null;a.stop()}),c.audioStream=void 0),c.pc&&void 0!==c.pc.peerConnection&&c.pc.peerConnection.close(),c.stream=void 0)};c.disableTrack=function(a){c.room.removeTrack(a)};c.attachMediaStream=function(c,d){if(!c)return null;if(c.isWebRtcPlugin)return c.src=d,c;if("video"===c.nodeName.toLowerCase()){a.a.info("Checked element is video");if(!c.pluginObj&&d){a.a.info("Plugins and stream validated");var b=document.createElement("object");
if(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window){a.a.info("Browser IE validated");var e=document.createElement("param");e.setAttribute("name","windowless");e.setAttribute("value",!0);b.appendChild(e);b.setAttribute("classid","CLSID:7FD49E23-C8D7-4C4F-93A1-F7EACFA1EC53")}else a.a.info("Other browser got"),b.setAttribute("type","application/webrtc-everywhere");c.pluginObj=b;b.setAttribute("className",c.className);b.setAttribute("innerHTML",
c.innerHTML);e=c.getAttribute("width");var g=c.getAttribute("height"),h=c.getBoundingClientRect();e||(e=h.right-h.left);g||(g=h.bottom-h.top);"getComputedStyle"in window&&(a.a.info("computing style"),h=window.getComputedStyle(c,null),e||"auto"==h.width||"0px"==h.width||(e=h.width),g||"auto"==h.height||"0px"==h.height||(g=h.height));e?b.setAttribute("width",e):b.setAttribute("autowidth",!0);g?b.setAttribute("height",g):b.setAttribute("autoheight",!0);document.body.appendChild(b);c.parentNode&&(a.a.info("parent node found"),
c.parentNode.replaceChild(b,c),document.body.appendChild(c),c.style.visibility="hidden")}c.pluginObj&&(a.a.info("plugin object found"),c.pluginObj.bindEventListener("play",function(a){c.pluginObj&&(c.pluginObj.getAttribute("autowidth")&&a.videoWidth&&c.pluginObj.setAttribute("width",a.videoWidth),c.pluginObj.getAttribute("autoheight")&&a.videoHeight&&c.pluginObj.setAttribute("height",a.videoHeight))}),c.pluginObj.src=d);return c.pluginObj}if("audio"===c.nodeName.toLowerCase())return c};var K=1,V=
function(e,g,h){h=void 0===h?!0:h;var f=JSON.parse(JSON.stringify(e));a.a.info("getusermedia called  opt "+JSON.stringify(f));(e=c.Connection.getSupportedDeviceConstraints())&&f.video&&"object"==typeof f.video&&("mobile"==n.a.browser_info.device_type?(e.hasOwnProperty("facingMode")&&f.video.facingMode?f.video.deviceId&&delete f.video.deviceId:(e.hasOwnProperty("deviceId")&&f.video.deviceId||f.video.deviceId&&delete f.video.deviceId,f.video.facingMode&&delete f.video.facingMode),f.video.height&&delete f.video.height,
f.video.width&&delete f.video.width):e.hasOwnProperty("deviceId")&&f.video.deviceId?f.video.facingMode&&delete f.video.facingMode:e.hasOwnProperty("facingMode")&&f.video.facingMode?f.video.deviceId&&delete f.video.deviceId:(f.video.deviceId&&delete f.video.deviceId,f.video.facingMode&&delete f.video.facingMode),e.hasOwnProperty("frameRate")||void 0==f.video.frameRate||delete f.video.frameRate);a.a.debug("calling gum with options: "+JSON.stringify(f));c.Connection.GetUserMedia(f,function(c){a.a.info("getUserMedia success");
u.a.info("stream-event",d.a.event_gum_success,{error:{}});K=0;g(c)},function(e){a.a.error("Get User Media scren  failed streamId: ",c.getID()," Error ",e);e=Object(b.a)(e);f.video.height&&f.video.height.min&&f.video.width&&f.video.width.min&&(a.a.info("getUserMedia failed error: "+e.result+" min Res: "+f.video.height.min+"X"+f.video.width.min),u.a.error("stream-event",d.a.event_gum_failed,{error:e}));var k={};Object.assign(k,f);switch(e.result){case 1143:case 1144:a.a.error(" ERROR : "+e.result+" newOpt: "+
JSON.stringify(k));k.screen||v.media_order&&"exact"==v.media_order?(a.a.error("getUserMedia() Failed with device denied/unvailable . no retry "),h=!1):k.video&&k.audio?(a.a.error("getUserMedia() Failed with device denied/unvailable .. retrying with audio only"),k.video=!1):h=!1;break;case 1147:case 1148:case 1149:switch(k.video.height.min){case 720:k.video.height.min=540;k.video.width.min=960;break;case 540:k.video.height.min=540;k.video.width.min=960;break;case 480:k.video.height.min=360;k.video.width.min=
480;break;default:h=!1}break;case 1145:a.a.error(" ERROR : "+e.result+" Opt: "+JSON.stringify(k)+" check and retry");break;default:a.a.error(" ERROR Default : "+e.result+" newOpt: "+JSON.stringify(k)),h=!1}!c.ifScreen()&&!0===h&&5>=K?(K+=1,a.a.info("getUserMedia() failed retry count: "+K),V(k,g)):(a.a.error("getUserMedia() failed no retry allowed  or retry count exceeded: "),K=0,g(void 0,e))})};c.setQualityLayers=function(d){c.pc&&c.stream&&c.local&&c.pc.peerConnection&&c.pc.peerConnection.getSenders?
(a.a.info(" that.setQulaityLayers numSpatialLayers:"+d),c.pc.peerConnection.getSenders().forEach(function(c){if(c.track&&"video"===c.track.kind){var b=c.getParameters();if(void 0!=b&&void 0!=b.encodings){for(var e=0;e<b.encodings.length;e++)d>e?(a.a.info(" Layer :"+e+" enabled"),b.encodings[e].active=!0):(a.a.info(" Layer :"+e+" disabled"),b.encodings[e].active=!1);c.setParameters(b)}else a.a.info(" that.setQulaityLayers: no sender params/encodings-  Not in simulcast mod")}})):a.a.info("setQulaityLayers Failed invalid stream :"+
c.stream+" local: "+c.local)};c.onConnectionStateChanged=function(d){a.a.debug(" that.onConnectionStateChanged() active : "+d+" spec:"+JSON.stringify(v));if(c.local)if(d)if(c.ifCanvas()){if(void 0!==v.refreshFn){v.refreshFn();var b=v.fps>v.maxCanvasRefreshRate?1E3/v.maxCanvasRefreshRate:1E3/v.fps;a.a.info(" that.onConnectionStateChanged ()  timerVal : "+b+" spec.fps: "+v.fps);c.refreshTimer=setInterval(function(){a.a.debug("refresh called timer ");v.refreshFn()},b)}}else c.ifScreen()||(c.negotiatedMedia.video=
void 0!=c.videoStream,c.negotiatedMedia.audio=void 0!=c.audioStream,c.video&&c.negotiatedMedia.video&&(0>=c.maxVideoLayers?(P.videoBw.set=P.videoFps.set=0,R(P.videoBw,P.videoFps)):c.videoStream.getVideoTracks().forEach(function(d){var b=d.getConstraints();b.height.max=c.videoSize[3];b.height.ideal=c.videoSize[3];b.width.max=c.videoSize[2];b.width.ideal=c.videoSize[2];b.frameRate={max:26};d.applyConstraints(b).then(function(){a.a.debug("applying constraints for simulcast video success")}).catch(function(c){a.a.error(" error in applying constraints for simulcast video error: "+
c)})})));else c.ifCanvas()&&void 0!=c.refreshTimer&&(clearInterval(c.refreshTimer),c.refreshTimer=void 0);d&&(c.state="connected")};c.setVideoParamsRange=function(d,b,e,g,h){1<c.maxVideoLayers||(h?(void 0!==d&&(P.videoBw.max.server=parseInt(d)),void 0!==e&&(P.videoFps.max.server=parseInt(e)),void 0!==b&&(P.videoBw.min.server=parseInt(b)),void 0!==g&&(P.videoFps.min.server=parseInt(g))):(void 0!==d&&(P.videoBw.max.user=parseInt(d)),void 0!==e&&(P.videoFps.max.user=parseInt(e)),void 0!==b&&(P.videoBw.min.user=
parseInt(b)),void 0!==g&&(P.videoFps.min.user=parseInt(g))),a.a.debug("setVideoParamsRange() id: "+c.getID()+" :: "+d+": "+b+":"+e+":"+g+":"+h),R(P.videoBw,P.videoFps))};var R=function(b,g){var h=0,f=0;h=b.max.user&&b.max.user<b.min.user?b.min.user:b.max.user&&(!b.max.server||b.max.user<=b.max.server)?b.max.user:b.max.server&&b.max.server<b.min.user?b.min.user:b.max.server&&b.max.server<b.min.server?b.min.server:b.max.server;f=g.max.user<g.min.user?g.min.user:g.max.user&&(!g.max.server||g.max.user<=
g.max.server)?g.max.user:g.max.server&&g.max.server<g.min.user?g.min.user:g.max.server&&g.max.server<g.min.server?g.min.server:g.max.server;if(void 0==c.pc||void 0==c.pc.peerConnection||void 0==c.room)a.a.error("setVideoParams() not set pc/room not defined "+JSON.stringify(P)+" b2Set: "+h+" fps2Set: "+f);else{if(h&&b.min.server!=h&&b.max.server!=h){var k=[{id:"publisher-video-bw-update",streamId:c.getID(),min:b.min.user,max:b.max.user}];c.room.setAdvancedOptions(k,function(){})}a.a.debug(" setVideoParams: id: "+
c.getID()+" b2Set "+h+" fps2Set "+f+" bwrange: "+JSON.stringify(b));if(h&&b.set!=h||f&&g.set!=f)if(k=e.a.browserEngineCheck(),"chrome-stable"===k||"mozilla"===k&&!e.a.isCurrentVerLess(x.a.constant.FIREFOX_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT)||"safari"===k&&!e.a.isCurrentVerLess(x.a.constant.SAFARI_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT)){c.pc.peerConnection.getSenders().forEach(function(c){if(c.track&&"video"===c.track.kind){var d=c.getParameters();if(void 0!=d){d.encodings||(d.encodings=[{}]);
for(var e=0;e<d.encodings.length;e++)h&&(a.a.info(" that.setMaxVideoBitarte: bw: ",h),d.encodings[e].maxBitrate=1E3*h,b.set=h),f&&(a.a.info(" that.setMaxVideoFramerate: fps: ",f),d.encodings[e].maxFramerate=f,g.set=f);c.setParameters(d)}else a.a.error(" that.setMaxVideoBitarte: no sender params/encodings-  ")}});var t=function(a,c,d,b,e,g,h,f){if(b<d.length){var k=a.getConstraints(),n=!1;c.height&&(c.height.max=d[b].res[e].height,c.height.ideal=d[b].res[e].height,k.height&&k.height.max&&k.height.max==
c.height.max||(n=!0));c.width&&(c.width.max=d[b].res[e].width,c.width.ideal=d[b].res[e].width,k.width&&k.width.max&&k.width.max==c.width.max||(n=!0));c.frameRate={max:g};k.frameRate&&k.frameRate.max&&k.frameRate.max==c.frameRate.max||(n=!0);n?a.applyConstraints(c).then(function(){f(c,h)}).catch(function(k){h.push({res:d[b].res[e],error:k});d[b].res.length<e+1?e++:(b++,e=0,g=30);t(a,c,d,b,e,g,h,f)}):f(c,h)}else f(null,h)};c.ifScreen()||c.ifCanvas()||"safari"===k||c.videoStream.getVideoTracks().forEach(function(d){var e=
n.a.getCamResTableToCheck(b.set),g=d.getConstraints();void 0==e?(a.a.error("reverting kbps: "+b.set+" constraints: curr: "+JSON.stringify(g)+" original: "+c.videoSize[3]+" X "+c.videoSize[2]),void 0==g.height||void 0==g.width||void 0!=g.height.max&&void 0!=g.width.max&&c.videoSize[3]==g.height.max&&c.videoSize[2]==g.width.max||(g.height.max=c.videoSize[3],g.height.ideal=c.videoSize[3],g.width.max=c.videoSize[2],g.width.ideal=c.videoSize[2],g.frameRate={max:26},d.applyConstraints(g).then(function(){a.a.info("apply constraints to original value")}).catch(function(c){a.a.error("failed  - apply constraints to original value")}))):
(g.height&&g.width||(g.width={min:n.a.video_resolution_range.Default.min.width},g.height={min:n.a.video_resolution_range.Default.min.height}),t(d,g,e.resTable,0,0,e.fps,[],function(c,d){a.a.debug("setVideoQualityConstraints() "+(null!=c?"Succes":"Failure")+" constraints old: "+JSON.stringify(g)+" new: "+JSON.stringify(c)+"  errors: "+JSON.stringify(d))}))})}else a.a.error("Setting Max Bw  using sdp reneg videoBwKbps= ",videoBwKbps),k={maxVideoBW:h,Sdp:!0},b.set=h,c.pc.updateSpec(k,function(){a.a.info("that.setMaxVideoBitarte: sdp reneg success")}),
u.a.warn("stream-event",d.a.event_incompatible_browser,{message:"Setting Max Bw  using traditional way of sdp renegotiation videoBwKbps= "+h});else a.a.debug("setVideoParams Failed id: "+c.getID()+" b2Set "+h+" bwrange: "+JSON.stringify(b))}};c.setVideoQualityParams=function(b,g,h,f,k){c.videoStream.getVideoTracks().forEach(function(c){var n=c.getConstraints();a.a.info("RESOLUTION Set track before constariants : "+JSON.stringify(n));null!=b&&null!=g&&(void 0==n.width&&(n.width={}),void 0==n.height&&
(n.height={}),n.width.min=b,n.height.min=g);null!=f&&null!=h&&(void 0==n.width&&(n.width={}),void 0==n.height&&(n.height={}),n.height.max=f,n.width.max=h,"chrome-stable"===e.a.browserEngineCheck()&&(n.width.ideal=h,n.height.ideal=f));if(n.width.min&&n.height.min&&n.width.max&&n.height.max&&n.width.min*n.height.min>n.width.max*n.height.max)return a.a.error("setVideoResolution() : constraint mismatch : "+JSON.stringify(n)),!1;null!=k&&(n.frameRate={max:k});c.applyConstraints(n).then(function(){console.log("RESOLUTION Set track constariants success : "+
JSON.stringify(n))}).catch(function(c){a.a.error("RESOLUTION Set trac constraints failed: "+c+" constraints: "+JSON.stringify(n));u.a.error("stream-event",d.a.event_general_failed,{message:"RESOLUTION Set trac constraints failed: "+c+" constraints: "+JSON.stringify(n)})})})};c.switchMicrophone=function(b,e,g,f){f=void 0===f?!0:f;c.negotiatedMedia.audio?0==O("setMicrophoneTrack")?(u.a.warn("stream-event",d.a.event_general_failed,{message:"switchMicrophone - Previous similar request in process"}),g(h.a.error_1140)):
(c.selfMuteAudio||c.hardAudioMuted)&&f?(B.switchMicrophone={newStream:b,deviceInfo:e},y("setMicrophoneTrack"),g({result:0,msg:"set but not active"})):W(b,e,void 0,!0,function(d){y("setMicrophoneTrack");a.a.error("setMediaDevicesTrack() in switch mic returned failure : "+JSON.stringify(d)+"device type: "+n.a.browser_info.device_type);if(d.result===h.a.error_1145&&"mobile"==n.a.browser_info.device_type)if(void 0!==c.room)c.room.onMediaDeviceStateChanged(b,{type:"mic",state:"inactive",error:d});else g(d);
else g(0===d.result?b:d)}):(u.a.error("stream-event",d.a.event_general_failed,{message:"switchMicrophone - Stream not found"}),g(h.a.error_1159))};c.switchCamera=function(b,e,g,f,k){g=void 0===g?function(){}:g;f=void 0===f?!0:f;k=void 0===k?!0:k;if("function"===typeof g)if(void 0==c.stream)g(h.a.error_1159);else if(1!==c.stream.getVideoTracks().length)g(h.a.error_1159);else if(c.negotiatedMedia.video)if(0==O("setCameraTrack"))u.a.warn("stream-event",d.a.event_general_failed,{message:"switchCamera - Previous similar request in process"}),
g(h.a.error_1140);else if((c.selfMuteVideo||c.hardVideoMuted)&&!M&&f)B.switchCamera={newStream:b,deviceInfo:e},g({result:0,msg:"set but not active"}),y("setCameraTrack");else{var t={};if(void 0!=e){if("string"===typeof e)t.deviceId=e;else if("object"===typeof e){if(void 0!=e.deviceId&&"string"===typeof e.deviceId&&(t.deviceId=e.deviceId),void 0!=e.facingMode&&"string"===typeof e.facingMode&&(t.facingMode=e.facingMode),void 0==t.deviceId&&void 0==t.facingMode){a.a.error("Error switchCamera(), error: invalid camera options "+
JSON.stringify(e));u.a.error("stream-event",d.a.event_general_failed,{message:"Error switchCamera(), error: invalid camera options "+JSON.stringify(e)});g(h.a.error_1155);return}}else{a.a.error("Error switchCamera(), error: invalid camera options type "+JSON.stringify(e));u.a.error("stream-event",d.a.event_general_failed,{message:"Error switchCamera(), error: invalid camera options type "+JSON.stringify(e)});g(h.a.error_1155);y("setCameraTrack");return}c.stream.getVideoTracks().forEach(function(d){d.enabled=
!1;d.stop();d.onended=W(b,void 0,t,k,function(d){var e=!1;b.stream.getVideoTracks().forEach(function(a){e=a.readyState});if(0===d.result)E(c.inputMediaSource.video[c.inputMediaSource.video.selected]),y("setCameraTrack"),g(0===d.result?b:d);else if(1150===d.result)"live"==e&&(E(c.inputMediaSource.video[c.inputMediaSource.video.selected]),y("setCameraTrack"),g(b));else if(y("setCameraTrack"),a.a.error("setMediaDevicesTrack() switch cam returned failure : "+JSON.stringify(d)+"device type: "+n.a.browser_info.device_type),
d.result===h.a.error_1145&&"mobile"==n.a.browser_info.device_type)if(void 0!==c.room)c.room.onMediaDeviceStateChanged(b,{type:"cam",state:"inactive",error:d});else g(d);else y("setCameraTrack"),g(d)})})}else a.a.error("Error switchCamera(), error: camera options undefined"),u.a.error("stream-event",d.a.event_general_failed,{message:"Error switchCamera(), error: camera options undefined"}),g(h.a.error_1155),y("setCameraTrack")}else u.a.error("stream-event",d.a.event_general_failed,{message:"switchCamera - Stream not found"}),
g(h.a.error_1159);else a.a.error("switchCamera() invalid param - callback")};c.switchMediaDevices=function(b,e,g,f){if(c.negotiatedMedia.audio&&c.negotiatedMedia.video){if(void 0!==g){if(c.selfMuteVideo||c.hardVideoMuted){u.a.warn("stream-event",d.a.event_general_failed,{message:"switchMediaDevices - Media device switching not allowed in video mute state"});f(h.a.error_1189);return}if(0==O("setCameraTrack")){u.a.warn("stream-event",d.a.event_general_failed,{message:"switchMediaDevices - Previous similar request in process"});
f(h.a.error_1140);return}}if(void 0!==e){if(c.selfMuteAudio||c.hardAudioMuted){u.a.warn("stream-event",d.a.event_general_failed,{message:"switchMediaDevices - Media device switching not allowed in audio mute state"});f(h.a.error_1189);void 0!==g&&y("setCameraTrack");return}if(0==O("setMicrophoneTrack")){void 0!==g&&y("setCameraTrack");f(h.a.error_1140);u.a.warn("stream-event",d.a.event_general_failed,{message:"switchMediaDevices - Previous similar request in process"});return}}var k={};if(void 0!=
g)if("string"===typeof g)k.deviceId=g;else if("object"===typeof g){if(void 0!=g.deviceId&&"string"===typeof g.deviceId&&(k.deviceId=g.deviceId),void 0!=g.facingMode&&"string"===typeof g.facingMode&&(k.facingMode=g.facingMode),void 0==k.deviceId&&void 0==k.facingMode){a.a.error("Error switchMediaDevices(), error: invalid camera options "+JSON.stringify(g));u.a.error("stream-event",d.a.event_general_failed,{message:"Error switchMediaDevices(), error: invalid camera options "+JSON.stringify(g)});f(h.a.error_1155);
return}}else{a.a.error("Error switchMediaDevices(), error: invalid camera options type "+JSON.stringify(g));u.a.error("stream-event",d.a.event_general_failed,{message:"Error switchMediaDevices(), error: invalid camera options type "+JSON.stringify(g)});f(h.a.error_1155);return}else k=void 0;void 0==c.stream?(f(h.a.error_1159),y("setCameraTrack")):c.stream.getVideoTracks().forEach(function(a){a.stop();a.onended=W(b,e,k,!0,function(a){var d=!1;b.stream.getVideoTracks().forEach(function(a){d=a.readyState});
if(0===a.result)E(c.inputMediaSource.video[c.inputMediaSource.video.selected]),y("setCameraTrack"),y("setMicrophoneTrack"),f(0===a.result?b:a);else if(1150===a.result)E(c.inputMediaSource.video[c.inputMediaSource.video.selected]),f(b),"live"==d?(E(c.inputMediaSource.video[c.inputMediaSource.video.selected]),y("setCameraTrack"),y("setMicrophoneTrack"),f(b)):(y("setCameraTrack"),y("setMicrophoneTrack"),f(a));else if(y("setCameraTrack"),y("setMicrophoneTrack"),console.log("setMediaDevicesTrack() switch media dev  failure : "+
JSON.stringify(a)+"device type: "+n.a.browser_info.device_type),a.result===h.a.error_1145&&"mobile"==n.a.browser_info.device_type)if(void 0!==c.room)c.room.onMediaDeviceStateChanged(b,{type:"mic",state:"inactive",error:a});else f(a);else f(a)})})}else u.a.error("stream-event",d.a.event_general_failed,{message:"switchMediaDevices - Stream not found"}),f(h.a.error_1159)};c.setSpeaker=function(a,d){var b=c.getPlayerId();void 0!==document.querySelector("#"+b.stream)&&null!==document.querySelector("#"+
b.stream)&&document.querySelectorAll("#"+b.stream).forEach(function(c){"function"===typeof c.setSinkId&&void 0!=a&&c.setSinkId(a);void 0!=d&&(c.volume=d)})};var O=function(b){if(!c.transactions.get(b))return c.transactions.set(b,{state:"inprogress"}),!0;a.a.error("Invalid state: previous request in progress. transId: "+b);u.a.warn("stream-event",d.a.event_general_failed,{message:"setTrasactionIfNotExists - Invalid state: previous request in progress. transId: "+b});return!1},y=function(a){return c.transactions.delete(a)},
W=function(b,e,g,f,k){var n=new MediaStream;if(!b||!0!==b.local||b.ifScreen()||b.ifCanvas())a.a.info("Cannot switch devices over invalid stream"),u.a.error("stream-event",d.a.event_general_failed,{message:"setMediaDevicesTrack - Cannot switch devices over invalid stream"}),k(h.a.error_1155);else{var t={};t.audio=void 0!==e?"none"!==e?{deviceId:e}:!0:!1;void 0!==g?(t.video={},ba(t.video),void 0!=g.deviceId&&"none"!==g.deviceId&&(t.video={deviceId:{exact:g.deviceId}}),void 0!=g.facingMode&&(t.video=
{facingMode:{exact:g.facingMode}}),void 0!==c.videoFrameRate&&(t.video.frameRate={min:c.videoFrameRate[0],max:c.videoFrameRate[1]})):t.video=!1;V(t,function(w,x){void 0==x?(b.pc&&b.pc.peerConnection&&f&&(g?(x="user"===c.inputMediaSource.video.selected?c.inputMediaSource.video.user:w,c.inputMediaSource.video.self=w):x=w,ia(b,void 0!==e,void 0!==g,x,"self"==c.inputMediaSource.video.selected)),g?(b.videoStream=w,v.params.set.video&&"object"==typeof v.params.set.video||(v.params.set.video={}),c.inputMediaSource.video.self=
w,w.getVideoTracks().forEach(function(a,c){n.addTrack(a);v.params.set.video.groupId=a.getSettings().groupId}),void 0!=g.deviceId?"none"!==g.deviceId&&(v.video.deviceId=g.deviceId,v.params.set.video.deviceId=JSON.parse(JSON.stringify(t.video.deviceId))):w.getVideoTracks().forEach(function(a,c){void 0!=a.getSettings().deviceId&&(v.video.deviceId=a.getSettings().deviceId);n.addTrack(a)}),a.a.log("Got video access from devices:- ",v.video.deviceId),u.a.info("stream-event",d.a.event_gum_success,{message:"Got video access from devices:- "+
v.video.deviceId})):b.videoStream&&b.videoStream.getVideoTracks().forEach(function(a,c){n.addTrack(a)}),e?(b.audioStream=w,w.getAudioTracks().forEach(function(a,c){n.addTrack(a);v.params.set.audio.groupId=a.getSettings().groupId}),"none"!==e&&(v.audio&&(v.audio.deviceId=e),v.params.set.audio.deviceId=JSON.parse(JSON.stringify(t.audio.deviceId))),a.a.log("Got audio access from devices:- ",e),u.a.info("stream-event",d.a.event_gum_success,{message:"Got audio access from devices:- "+e})):b.audioStream&&
b.audioStream.getAudioTracks().forEach(function(a){return n.addTrack(a)}),k(h.a.error_000)):(w=g?g.deviceId:"null",a.a.info("Error getUserMedia(), error: "+x+" cam: "+w+" mic: ",e),u.a.error("stream-event",d.a.event_gum_failed,{cam_id:w,mic_id:e}),k(x));b.stream=n})}},ia=function(c,b,e,g,h){h=void 0===h?!0:h;var f=!1,k=!1;c.pc&&c.pc.peerConnection?c.pc.peerConnection.getSenders().forEach(function(a,d){a.track&&(e&&"video"===a.track.kind?(v.video.trackIndex=d,k=!0,g?g.getVideoTracks().forEach(function(c){c.enabled=
!0;a.replaceTrack(c)}):a.replaceTrack(null),h&&c.videoStream.getVideoTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()})):b&&"audio"===a.track.kind&&(v.audio.trackIndex=d,f=!0,g?g.getAudioTracks().forEach(function(c){c.enabled=!0;a.replaceTrack(c)}):a.replaceTrack(null),c.audioStream&&c.audioStream.getAudioTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()})))}):(e&&c.videoStream&&h&&c.videoStream.getVideoTracks().forEach(function(a){console.log("without replace track setting current videotracks to stop");
a.enabled=!1;a.onended=null;a.stop()}),b&&c.audioStream&&c.audioStream.getAudioTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()}));c.pc&&c.pc.peerConnection&&(b&&!f||e&&!k)&&(c.pc.peerConnection.getSenders().forEach(function(a,c){!a.track&&g&&(b&&!f&&void 0!==v.audio.trackIndex&&c===v.audio.trackIndex&&(f=!0,g.getAudioTracks().forEach(function(c){c.enabled=!0;a.replaceTrack(c)})),e&&!k&&void 0!==v.video.trackIndex&&c===v.video.trackIndex&&(k=!0,g.getVideoTracks().forEach(function(c){c.enabled=
!0;a.replaceTrack(c)})))}),b&&!f||e&&!k)&&(a.a.error("Error: Not finding sender track::  audio: "+b+" found: "+f+" index: "+v.audio.trackIndex+" video: "+e+" found: "+k+" index: "+v.video.trackIndex),u.a.error("stream-event",d.a.event_general_failed,{message:"replaceNewMediaStreamTrack - Not finding sender track::  audio: "+b+" found: "+f+" index: "+v.audio.trackIndex+" video: "+e+" found: "+k+" index: "+v.video.trackIndex}),c.pc.peerConnection.getSenders().forEach(function(c,d){a.a.error("index : "+
d+" sender.track: "+c.track+" kind : "+(c.track?c.track.kind:"none"))}))},X=function(a,c,d){return a&&(U==c||"none"==U)&&("video"==I||"audiovideo"==I||ca&&!d)};c.getPlayerId=function(a){a=void 0===a?null:a;var d=c.getID();a=a?a:c.room;a="breakout-room"===(a&&a.roomSettings&&a.roomSettings.room_type?a.roomSettings.room_type:null)?"br_"+a.roomID+"_":"";return{stream:a+"stream"+d,player:a+"player_"+d}};c.reloadPlayer=function(b,h){var f=b.mediatype,k=b.clientId;if(I!=f||ca||h&&"none"!=g&&g!=b.reason){a.a.debug("reloadPlayer() streamId: "+
c.getID()+" mediatype:( "+f+" , "+I+" ), clientId:( "+k+" , "+U+" ), reason:( "+b.reason+" , "+g+" )  imageOnVideoMute: "+h);c.getID();var n=c.getPlayerId();if(void 0!==document.querySelector("#"+n.stream)&&null!==document.querySelector("#"+n.stream)){var t=!1;document.querySelectorAll("#"+n.stream).forEach(function(n){try{switch(f){case "audio":if(g=b.reason,X(h,k,"user"==b.reason)){c.mediaStream&&0==c.mediaStream.getAudioTracks().length&&c.stream.getAudioTracks().forEach(function(a){c.mediaStream.addTrack(a)});
t=ca=!0;z=!1;r=!0;break}case "audioOnly":c.audioStream?(n.srcObject=c.audioStream,ca=!1,t=!0,z=!1,r=!0):a.a.error("reloadPlayer() failed id : "+c.getID()+" audiostream null medtype - curr: "+(I+" new: "+f));break;case "video":c.mediaStream?("audiovideo"==I?(0==c.mediaStream.getVideoTracks().length&&c.stream.getVideoTracks().forEach(function(a){c.mediaStream.addTrack(a)}),0!=c.mediaStream.getAudioTracks().length&&c.mediaStream.getAudioTracks().forEach(function(a){c.mediaStream.removeTrack(a)})):n.srcObject=
c.mediaStream,ca=!1,g="none",z=t=!0,r=!1):(a.a.error("reloadPlayer() failed id : "+c.getID()+" videostream null, medtype - curr: "+I+" new: "+f),u.a.error("stream-event",d.a.event_general_failed,{message:"reloadPlayer() failed id : "+c.getID()+" videostream null, medtype - curr: "+I+" new: "+f}));break;case "audiovideo":if(c.mediaStream){0==c.mediaStream.getAudioTracks().length&&c.stream.getAudioTracks().forEach(function(a){c.mediaStream.addTrack(a)});0==c.mediaStream.getVideoTracks().length&&c.stream.getVideoTracks().forEach(function(a){c.mediaStream.addTrack(a)});
if("video"!=I||"safari"===e.a.browserEngineCheck())n.srcObject=c.mediaStream;ca=!1;g="none";t=!0;z=r=!1}else a.a.error("reloadPlayer() failed id : "+c.getID()+" stream null, medtype - curr: "+I+" new: "+f),u.a.error("stream-event",d.a.event_general_failed,{message:"reloadPlayer() failed id : "+c.getID()+" stream null, medtype - curr: "+I+" new: "+f});break;default:g=b.reason,z=r=!0,X(h,k,"user"==b.reason)?ca=!0:(n.srcObject=null,ca=!1),t=!0}}catch(N){a.a.error("reloadPlayer() id : "+c.getID()+" NULL set medtype - curr: "+
I+" new: "+f),u.a.error("stream-event",d.a.event_general_failed,{message:"reloadPlayer() id : "+c.getID()+" NULL set medtype - curr: "+I+" new: "+f})}});t&&(I=f,U=k)}else a.a.error("reloadPlayer() id : "+c.getID()+" ID selector null medtype - curr: "+I+" new: "+f+" storing AT req"),u.a.error("stream-event",d.a.event_general_failed,{message:"reloadPlayer() id : "+c.getID()+" ID selector null medtype - curr: "+I+" new: "+f+" storing AT req"})}else{a.a.debug("reloadPlayer() id : "+c.getID()+" no change in media type: "+
f);if("none"===U)switch(I){case "audio":case "audioOnly":z=!1;r=!0;break;case "video":z=!0;r=!1;break;case "audiovideo":z=r=!1;break;default:z=r=!0}U=k}ea={talkerInfo:JSON.parse(JSON.stringify(b)),imageOnVideoMute:h}};c.setBandwidthAlert=function(a){c.getID();c.player&&!0===c.abwdEnabled&&("low"===a.bw?"sdk"===c.abwdNotification?c.player.setBwAlert(!0,a.type,a.name):(a=Object(f.f)({type:"bw-alert",stream:c,stream_type:a.type,msg:"subscriber"===a.type?"subscriber low":a.name+" publisher low"}),c.dispatchEvent(a)):
"sdk"===c.abwdNotification?c.player.setBwAlert(!1):(a=Object(f.f)({type:"bw-restored",stream:c}),c.dispatchEvent(a)))};c.setVideoMutedMessage=function(a){null!=c.player&&(!0===a.videomuted&&"bw"===a.reason?(c.videoMutedDueToBw=!0,c.player.setVideoMutedMsg(a)):!0===c.videoMutedDueToBw&&c.player.setVideoMutedMsg(a))};var E=function(b){for(var e=0;e<c.playerDivs.length;e++){var g=document.getElementById(c.playerDivs[e].elementId);g&&(g=g.querySelectorAll("video"),0<g.length&&document.querySelectorAll("#"+
g[0].id).forEach(function(e){try{e.srcObject=b}catch(ma){a.a.error("Exception:: attachStreamOnPlayerDivs() streamId: "+c.getID()+" error: "+ma),u.a.error("stream-event",d.a.event_general_failed,{message:"attachStreamOnPlayerDivs() streamId: "+c.getID()+" error: "+ma})}}))}};c.muteSubscriberStreamVideo=function(a){c.stream&&!c.local&&c.stream.getVideoTracks().forEach(function(c){c.enabled=!a})};c.updateVideo=function(b){b=c.getPlayerId();void 0!==document.querySelector("#"+b.stream)&&null!==document.querySelector("#"+
b.stream)?(a.a.info("Player element exists and playing the video",""+b.stream),c.htmlPlay(""+b.stream)):(a.a.error("Player element does not exist"),u.a.error("stream-event",d.a.event_general_failed,{message:"updateVideo - Player element does not exist"}))};c.play=function(b,d){if("object"===typeof d&&d.hasOwnProperty("player")){a.a.debug("Element ID is "+b);var g=d||{};c.elementID=b;d.player&&d.player.abwd&&(void 0!==d.player.abwd.enabled&&(c.abwdEnabled=d.player.abwd.enabled),!0===c.abwdEnabled&&
d.player.abwd.notification&&(c.abwdNotification=d.player.abwd.notification,"sdk"===c.abwdNotification&&void 0!==d.player.abwd.language&&(c.abwdLanguage="en"===d.player.abwd.language||"zh"===d.player.abwd.language?d.player.abwd.language:"en")));if(c.ifVideo()||c.ifScreen()||c.audioOnly||c.ifAudio())if(void 0!==b&&null!==document.getElementById(b)){if("IE"===e.a.browserEngineCheck()){g=document.getElementById(b);var h=document.getElementById(b);"VIDEO"!==g.nodeName&&(a.a.info("not video tag"),h=document.createElement("video"),
h.setAttribute("height",g.getAttribute("height")),h.setAttribute("width",g.getAttribute("width")),g.appendChild(h));c.attachMediaStream(h,c.stream)}else h={autoplay:!0},"safari"===e.a.browserEngineCheck()&&(h.playsinline=!0),g=Object(k.a)({id:c.getID(),stream:c,elementID:b,options:g,extraPlayerOptions:h,vroom:c.room?c.room:null,videoSource:c.local?c.inputMediaSource.video[c.inputMediaSource.video.selected]:c.stream}),c.local?g.video.muted=!0:c.playerDivs=[],c.player=g,c.showing=!0;c.playerDivs.push({elementId:b,
options:d});I="audiovideo";void 0!==ea&&(a.a.debug("stream.play currentActiveTalkerList : calling reload player()"),c.reloadPlayer(ea.talkerInfo,ea.imageOnVideoMute));c.local||void 0==c.room||void 0==c.room.speakerInfo.id||c.setSpeaker(c.room.speakerInfo.id)}else a.a.error("Element not found");else if(c.ifAudio()||c.audioOnly)g=Object(q.a)({id:c.getID(),stream:c,elementID:b,options:g,vroom:c.room?c.room:null}),c.local?g.audio.muted=!0:c.playerDivs=[],c.player=g,c.showing=!0,c.playerDivs.push({elementId:b,
options:d}),I="audio";c.reload&&delete c.reload;void 0!==c.room?!0===c.room.subscribeSessionStats?c.ShowSessionStats(!0):c.ShowSessionStats(!1):a.a.info("room is not allocated to stream , stats UI will not be shown")}else a.a.error("play() invalid param - callback/RoomDefinition")};c.resetMediaConfiguration=function(a){c.pc.resetSDP(a)};c.htmlPlay=function(b,e){c.elementID=b;(c.ifVideo()||c.ifScreen())&&void 0!==b&&document.querySelectorAll("#"+b).forEach(function(b){try{b.srcObject=c.local?c.videoStream:
c.stream}catch(S){b.src=URL.createObjectURL(c.local?c.videoStream:c.stream)}b.play().then(function(){}).catch(function(c){a.a.error("Error playing video stream: "+c);u.a.error("stream-event",d.a.event_general_failed,{message:"Error playing video stream: "+c})})})};c.stop=function(a){if(c.showing){if(void 0!=a&&(c.playerDivs=c.playerDivs.filter(function(c){return c.elementId!=a}),!c.playerDivs.length))return;void 0!==c.player&&(c.player.destroy(),c.showing=!1)}};c.show=c.play;c.hide=c.stop;var da=
function(a){if(void 0!==c.player&&void 0!==c.stream){var b=document.defaultView.getComputedStyle(c.player.video),d=parseInt(b.getPropertyValue("width"),10),e=parseInt(b.getPropertyValue("height"),10);parseInt(b.getPropertyValue("left"),10);parseInt(b.getPropertyValue("top"),10);b="object"===typeof c.elementID&&"function"===typeof c.elementID.appendChild?c.elementID:document.getElementById(c.elementID);var g=document.defaultView.getComputedStyle(b);b=parseInt(g.getPropertyValue("width"),10);g=parseInt(g.getPropertyValue("height"),
10);if(document.getElementById(a))var h=document.getElementById(a);else h=document.createElement("canvas"),h.id=a,h.width=b,h.height=g,h.className="canvas_input",h.setAttribute("style","position: absolute;top: 15%;left: 45%;z-index: 897;"),document.body.appendChild(h);c.inputContext=h.getContext("2d");c.inputContext.drawImage(c.player.video,0,0,d,e);return h}return null};c.getVideoFrameURL=function(a){var c=da();return null!==c?a?c.toDataURL.apply(c,$jscomp.arrayFromIterable(a)):c.toDataURL():null};
c.getVideoFrameImage=function(a){a=da(a);return null!==a?a.getContext("2d").getImageData(10,10,a.width,a.height):null};c.checkOptions=function(b,d){if(!0===d){if(b.audio||b.screen)a.a.warning("Error! Cannot update type of subscription"),b.audio=void 0,b.screen=void 0}else!1===c.local&&(!0===b.video&&!1===c.ifVideo()&&(a.a.warning("Error! Stream doesn't have Video Track. Can't subscribe to Video"),b.video=!1),!0===b.audio&&!1===c.ifAudio()&&(a.a.warning("Error! Stream doesn't have Audio Track. Can't subscribe to Audio"),
b.audio=!1));!1!==c.local||c.ifVideo()||!0!==b.slideShowMode||(a.a.warning("Error! Stream doesn't have Video Track. Cannot enable slideShowMode. Check parameters"),b.slideShowMode=!1)};var ha=function(b,g,f){f=void 0===f?function(){}:f;console.log("Muting the stream : enable "+b);if(c.negotiatedMedia.audio)if(b===z)u.a.error("stream-event",d.a.event_general_failed,{message:"muteStreamAudio - MediaDevice state is already in same state"}),f(h.a.error_1177);else if(0==O("setMicrophoneTrack"))u.a.error("stream-event",
d.a.event_general_failed,{message:"muteStreamAudio - Previous similar request in process"}),f(h.a.error_1140);else{var k=function(b,g){try{var f=!1;if("safari"===e.a.browserEngineCheck()){var k=c.pc.peerConnection.getSenders().find(function(a){return a.track&&"audio"===a.track.kind||null===a.track});k&&c.audioStream.getAudioTracks().forEach(function(a){a.enabled=!b;b||"live"==a.readyState?k.replaceTrack(b?null:c.audioStream.getAudioTracks()[0]):(console.log(" setAudioTrack(): safari trackstate: ended"),
f=!0)})}else c.audioStream.getAudioTracks().forEach(function(a){a.enabled=!b;f||"ended"!=a.readyState||(f=!0);console.log(" setAudioTrack(): trackstate: ended")});z=b;y("setMicrophoneTrack");void 0!=c.selectedMicId&&console.log("that.selectedMicId: "+c.selectedMicId);if(!b&&f){var n=void 0!=c.selectedMicId?c.selectedMicId:v.audio.deviceId;n?W(c,n,void 0,!0,function(a){console.log("setMediaDevicesTrack : audio  status: "+a);a.result===h.a.error_000.result&&("safari"===e.a.browserEngineCheck()&&(c.pc.peerConnection.getSenders().find(function(a){return a.track&&
"audio"===a.track.kind||null===a.track}).replaceTrack(c.audioStream.getAudioTracks()[0]),z=b),g(a))}):(u.a.error("stream-event",d.a.event_general_failed,{message:"muteStreamAudio - error - stream ended"}),g(h.a.error_1191))}else z=b,u.a.info("stream-event",d.a.event_general_success,{message:"muteStreamAudio - success"}),g(h.a.error_000)}catch(fa){a.a.error("Excpetion happend : "+fa),y("setMicrophoneTrack"),u.a.error("stream-event",d.a.event_general_failed,{message:"muteStreamAudio - error - "+fa}),
g(h.a.error_1150)}};g?setTimeout(k,g,b,f):k(b,f)}else u.a.error("stream-event",d.a.event_general_failed,{message:"muteStreamAudio - Stream not found"}),f(h.a.error_1159)},aa=function(a,b,e,g){g=void 0===g?function(){}:g;!a||c.negotiatedMedia.video||e?a!==r||e?0==O("setCameraTrack")?g(h.a.error_1140):(console.log("muteSTreamVideo() enable: "+a+" localVideoOn: "+M),e=function(a,b){try{if(a)ia(c,!1,!0,null,!M),r=a,y("setCameraTrack"),b(h.a.error_000);else if(M)r=a,c.pc&&c.pc.peerConnection&&ia(c,!1,
!0,c.videoStream,!1),y("setCameraTrack"),b(h.a.error_000);else{var e={};void 0!=v.video.deviceId?e.deviceId=v.video.deviceId:void 0!==v.video.facingMode&&"mobile"==n.a.browser_info.device_type&&(e.facingMode=v.video.facingMode);void 0==e.deviceId&&void 0==e.facingMode&&(e.deviceId="none");W(c,void 0,e,!0,function(c){if(c.result===h.a.error_000.result)r=a;else{var e=n.a.getLocalStorageItem("vcxRTCLib-log");null!=e&&(e=JSON.parse(e),u.a.error("stream-event",a?d.a.event_mute_self_video_failed:d.a.event_unmute_self_video_failed,
{message:e}))}y("setCameraTrack");b(c)})}}catch(N){console.log("Excpetion happend : "+N),y("setCameraTrack"),e=n.a.getLocalStorageItem("vcxRTCLib-log"),null!=e&&(e=JSON.parse(e),u.a.error("stream-event",a?d.a.event_mute_self_video_failed:d.a.event_unmute_self_video_failed,{message:e})),b(h.a.error_1150)}},b?setTimeout(e,b,a,g):e(a,g)):(u.a.error("stream-event",d.a.event_general_failed,{message:"muteStreamVideo - MediaDevice state is already in same state"}),g(h.a.error_1177)):(u.a.error("stream-event",
d.a.event_general_failed,{message:"muteStreamVideo - Stream not found"}),g(h.a.error_1159))};c.muteAudio=function(b,d,e,g,f){b=void 0===b?function(){}:b;d=void 0===d?!0:d;e=void 0===e?0:e;g=void 0===g?!0:g;f=void 0===f?!1:f;"function"===typeof b?(console.log("muteAudio() selfSet : "+g+" selfMuteAudio: "+c.selfMuteAudio+" hardAudioMuted: "+c.hardAudioMuted+" audioMuted: "+z+" paused: "+c.selfPausedAudio+" config.audioMuted: "+c.config.audioMuted),g&&c.selfMuteAudio||!g&&(c.hardAudioMuted||c.selfPausedAudio)?
(!0===f&&(c.selfPausedAudio=!0),d&&c.sendEvent("user-audio-muted"),b(h.a.error_1177)):void 0!==c.pc&&null!=c.pc||void 0==c.audioStream?ha(!0,e,function(a){if(a.result===h.a.error_000.result||a.result===h.a.error_1177.result)g?c.selfMuteAudio=!0:f?c.selfPausedAudio=!0:c.hardAudioMuted=!0,a.result===h.a.error_000.result&&d?c.sendEvent("user-audio-muted"):d||(a=h.a.error_000);b(a)}):(c.audioStream.getAudioTracks().forEach(function(a){a.onended=null;a.enabled=!1}),z=!0,g?(c.selfMuteAudio=!0,c.config.audioMuted=
!0):f?c.selfPausedAudio=!0:c.hardAudioMuted=!0,b(h.a.error_000))):a.a.error("muteAudio() invalid param - callback")};c.setMediaDeviceMuteState=function(a,b,d,e,g){try{if(b){if(a===z){g(h.a.error_1177);return}c.audioStream.getAudioTracks().forEach(function(c){c.enabled=!a});z=a;e&&c.sendEvent(z?"user-audio-muted":"user-audio-unmuted")}if(d){if(a===r){g(h.a.error_1177);return}c.stream.getVideoTracks().forEach(function(c){c.enabled=!a});r=a;e&&c.sendEvent(r?"user-video-muted":"user-video-unmuted")}g(h.a.error_000)}catch(Z){console.log("Excpetion happend : "+
Z),g(h.a.error_1150)}};c.muteAudioNotSelf=function(a,b){ha(!0,0,void 0===a?function(){}:a);void 0!==b&&!1===b||c.sendEvent("user-audio-muted")};var za=function(a){a.data&&0<a.data.size&&c.recordedBlobs.push(a.data)};c.startLocalRecord=function(b){b=void 0===b?function(){}:b;if(c.mediaRecorder)a.a.error("Recording started already:"),b(h.a.error_1174);else try{c.mediaRecorder=new MediaRecorder(c.stream,{mimeType:"video/webm"}),c.mediaRecorder.ondataavailable=za,c.recordedBlobs=[],c.mediaRecorder.start(10),
b(h.a.error_000)}catch(ja){a.a.error("Exception while creating MediaRecorder:",ja),b(h.a.error_000)}};c.stopLocalRecord=function(a){a=void 0===a?function(){}:a;if(c.mediaRecorder&&0<c.recordedBlobs.length){var b=new Date,d=b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate();b=b.getHours()+":"+b.getMinutes()+":"+b.getSeconds();d="stream_"+c.getID()+"_"+d+"::"+b+".webm";b=new Blob(c.recordedBlobs,{type:"video/webm"});b=window.URL.createObjectURL(b);var e=document.createElement("a");e.style.display=
"none";e.href=b;e.download=d;e.click();window.URL.revokeObjectURL(b);a(h.a.error_000)}else a(h.a.error_1175);c.mediaRecorder=void 0;c.recordedBlobs=[]};c.sendEvent=function(a){c.room&&c.room.socket.sendEvent(a,function(a){})};c.sendMessage=function(a,b,d){d=void 0===d?function(){}:d;c.room&&c.room.socket.emitEvent(a,b,function(a){d(a)})};c.unmuteAudio=function(b,d,e,g,f){b=void 0===b?function(){}:b;d=void 0===d?!0:d;e=void 0===e?0:e;g=void 0===g?!0:g;f=void 0===f?!1:f;if("function"===typeof b)if(console.log("unmuteAudio() selfSet : "+
g+" selfMuteAudio: "+c.selfMuteAudio+" hardAudioMuted: "+c.hardAudioMuted+" audioMuted: "+z+" paused: "+c.selfPausedAudio+" config.audioMuted: "+c.config.audioMuted),(!g||c.selfMuteAudio||c.hardAudioMuted||c.selfPausedAudio)&&(g||c.hardAudioMuted||c.selfPausedAudio))if(!g||!c.hardAudioMuted||!c.selfPausedAudio||c.room&&c.room.isModerator())if(!g&&c.selfMuteAudio)c.hardAudioMuted=!1,f&&(c.selfPausedAudio=!1),b(h.a.error_000);else if(void 0!=B.switchMicrophone){var k=B.switchMicrophone;c.switchMicrophone(k.newStream,
k.deviceInfo,function(a){delete B.switchMicrophone;void 0==a.result?b(h.a.error_000):c.unmuteAudio(b,d,e,g,f)},!1)}else void 0!==c.pc&&null!=c.pc||void 0==c.audioStream?ha(!1,e,function(a){if(a.result===h.a.error_000.result||a.result===h.a.error_1177.result)g?c.selfMuteAudio=!1:f?c.selfPausedAudio=!1:c.hardAudioMuted=!1,a.result===h.a.error_000.result&&d?c.sendEvent("user-audio-unmuted"):d||(a=h.a.error_000);b(a)}):(c.audioStream.getAudioTracks().forEach(function(a){a.enabled=!0}),!0===c.config.audioMuted&&
(c.config.audioMuted=!1),z=!1,g?c.selfMuteAudio=!1:f?c.selfPausedAudio=!1:c.hardAudioMuted=!1,b(h.a.error_000));else b(h.a.error_1176);else console.log(" that.unmuteAudio() error177: selfSet: "+g+"  that.selfMuteAudio: "+c.selfMuteAudio+" that.hardAudioMuted: "+c.hardAudioMuted+" that.selfPausedAudio: "+c.selfPausedAudio),!d||c.selfMuteAudio||c.hardAudioMuted||c.sendEvent("user-audio-unmuted"),b(h.a.error_1177);else a.a.error("unmuteAudio() invalid param - callback")};c.hardMuteAudio=function(a){c.room&&
!c.local&&c.sendMessage("hardmute-user-audio",{clientId:c.clientId})};c.hardUnmuteAudio=function(a){c.room&&!c.local&&c.sendMessage("hardunmute-user-audio",{clientId:c.clientId})};c.hardMuteVideo=function(a){c.room&&!c.local&&c.sendMessage("hardmute-user-video",{clientId:c.clientId})};c.hardUnmuteVideo=function(a){c.room&&!c.local&&c.sendMessage("hardunmute-user-video",{clientId:c.clientId})};c.muteNonATPubVideo=function(a){c.videoStream&&(c.ATVideoMuted=!0,c.videoStream.getVideoTracks().forEach(function(a){a.enabled=
!1}))};c.unmuteNonATPubVideo=function(a){c.videoStream&&!1===c.hardAudioMuted&&!1===c.selfMuteVideo&&!0===c.ATVideoMuted&&(c.ATVideoMuted=!1,c.videoStream.getVideoTracks().forEach(function(a){a.enabled=!0}))};c.muteVideo=function(b,d,e,g,f,k,n){b=void 0===b?function(){}:b;d=void 0===d?!0:d;e=void 0===e?0:e;g=void 0===g?!0:g;f=void 0===f?!1:f;k=void 0===k?!1:k;n=void 0===n?!1:n;"function"===typeof b?(console.log("SelfSet:"+g+"selfMuteVideo"+c.selfMuteVideo+"selfPausedVideo:"+c.selfPausedVideo),g&&
c.selfMuteVideo||!g&&(c.hardVideoMuted||c.selfPausedVideo)?(k&&(c.selfPausedVideo=!0),d&&c.sendEvent("user-video-muted"),b(h.a.error_1177)):void 0!==c.pc&&null!=c.pc||void 0==c.room||void 0==c.videoStream?f?(M||c.videoStream.getVideoTracks().forEach(function(a){a.enabled=!1}),c.softVideoMuted=!0,b(h.a.error_000)):aa(!0,e,n,function(a){if(a.result===h.a.error_000.result||a.result===h.a.error_1177.result)g?c.selfMuteVideo=!0:k?c.selfPausedVideo=!0:c.hardVideoMuted=!0,a.result===h.a.error_000.result?
(M||E(null),d&&c.sendEvent("user-video-muted")):a=h.a.error_000;b(a)}):(M||c.videoStream.getVideoTracks().forEach(function(a){a.onended=null;a.enabled=!1}),r=c.config.videoMuted=!0,g?c.selfMuteVideo=!0:k?c.selfPausedVideo=!0:c.hardVideoMuted=!0,b(h.a.error_000))):a.a.error("muteVideo() invalid param - callback")};c.unmuteVideo=function(b,d,e,g,f,k){b=void 0===b?function(){}:b;d=void 0===d?!0:d;e=void 0===e?0:e;g=void 0===g?!0:g;f=void 0===f?!1:f;k=void 0===k?!1:k;if("function"===typeof b)if(console.log("unmuteVideo() selfSet : "+
g+" that.selfMuteVideo: "+c.selfMuteVideo+" that.softVideoMuted: "+c.softVideoMuted+" that.hardVideoMuted: "+c.hardVideoMuted+" paused: "+c.selfPausedAudio),k||(!g||c.selfMuteVideo||c.softVideoMuted||c.hardVideoMuted||c.selfPausedVideo)&&(g||c.hardVideoMuted||c.selfPausedVideo))if(!g||!c.hardVideoMuted||!c.selfPausedVideo||c.room&&c.room.isModerator())if(!g&&c.selfMuteVideo)c.hardVideoMuted=!1,f&&(c.selfPausedVideo=!1),b(h.a.error_000);else if(void 0!=B.switchCamera){var n=B.switchCamera;c.switchCamera(n.newStream,
n.deviceInfo,function(a){delete B.switchCamera;void 0==a.result?(r=c.softVideoMuted=!1,g?c.selfMuteVideo=!1:f?c.selfPausedVideo=!1:c.hardVideoMuted=!1,console.log("unmuteVideo() switchCamera () NOT attaching playerdivs"),d&&c.sendEvent("user-video-unmuted"),b(h.a.error_000)):c.unmuteVideo(b,d,e,g,f)},!1,!0)}else void 0!==c.pc&&null!=c.pc||!c.room||void 0==c.videoStream?aa(!1,e,k,function(a){if(a.result===h.a.error_000.result||a.result===h.a.error_1177.result)if(c.softVideoMuted=!1,g?c.selfMuteVideo=
!1:f?c.selfPausedVideo=!1:c.hardVideoMuted=!1,a.result===h.a.error_000.result?(console.log("unmuteVideo() muteStreamVideo() success"),M||E(c.inputMediaSource.video[c.inputMediaSource.video.selected]),d&&c.sendEvent("user-video-unmuted")):a=h.a.error_000,c.room&&!k){c.room.onMediaDeviceStateChanged(c,{type:"cam",state:"active"},b);return}b(a)}):(c.videoStream.getVideoTracks().forEach(function(a){a.enabled=!0}),!0===c.config.videoMuted&&(c.config.videoMuted=!1),r=c.softVideoMuted=!1,g?c.selfMuteVideo=
!1:f?c.selfPausedVideo=!1:c.hardVideoMuted=!1,b(h.a.error_000));else b(h.a.error_1176);else!d||c.selfMuteVideo||c.softVideoMuted||c.hardVideoMuted||c.sendEvent("user-video-unmuted"),b(h.a.error_1177);else a.a.error("unmuteVideo() invalid param - callback")};c.setLocalView=function(b,e){e=void 0===e?function(){}:e;if("function"===typeof e)if(M==b)a.a.error("setLocalVideo() already in same state"),e(h.a.error_1177);else if(0==O("setCameraTrack"))u.a.warn("stream-event",d.a.event_general_failed,{message:"setLocalVideo - Previous similar camera request in process"}),
e(h.a.error_1140);else if(console.log("setLocalView() enable : "+b),b)if(c.isVideoMuted()){var g={};v.params&&v.params.set.video&&"object"===typeof v.params.set.video.deviceId&&(g.deviceId=v.params.set.video.deviceId.exact);if(void 0!=B.switchCamera){var f=B.switchCamera;c.switchCamera(f.newStream,f.deviceInfo,function(a){delete B.switchCamera;void 0==a.result?M=!0:c.setLocalView(b,e)},!1,!1)}else f=JSON.parse(JSON.stringify(v.video)),v.params&&v.params.set&&v.params.set.video&&(v.params.set.video.deviceId?
f.deviceId="object"==typeof v.params.set.video.deviceId?v.params.set.video.deviceId.exact:v.params.set.video.deviceId:v.params.set.video.facingMode&&(f.facingMode="object"==typeof v.params.set.video.facingMode?v.params.set.video.facingMode.exact:v.params.set.video.facingMode)),void 0!=f.deviceId?g.deviceId=f.deviceId:void 0!==f.facingMode&&"mobile"==n.a.browser_info.device_type&&(g.facingMode=f.facingMode),void 0==g.deviceId&&void 0==g.facingMode&&(g.deviceId="none"),W(c,void 0,g,!1,function(b){b.result===
h.a.error_000.result?(console.log("setMediaDevicesTrack() success attaching playerdiv "),M=!0,E(c.inputMediaSource.video[c.inputMediaSource.video.selected])):(console.log("setMediaDevicesTrack() failed "),a.a.info("Error setMediaDevicesTrack(), error: "+JSON.stringify(b)+" cam: "+g.deviceId));y("setCameraTrack");e(b,M?c.videoStream:null)})}else c.negotiatedMedia.video&&void 0!=c.videoStream?(M=!0,y("setCameraTrack"),console.log("not muted sending stream "),e(h.a.error_000,c.videoStream)):(y("setCameraTrack"),
console.log("error not muted but no video stream"),e(h.a.error_1159));else M=!1,c.isVideoMuted()&&(console.log("muted disabling localview by replace track"),void 0!==c.videoStream&&c.videoStream.getTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()})),console.log("disabling localview detaching player divs"),E(null),y("setCameraTrack"),e(h.a.error_000);else a.a.error("setLocalView() invalid param - callback")};c._setStaticQualityLayer=function(b,d,e){e=void 0===e?function(){}:e;c.room&&
c.room.p2p?(a.a.warning("Error! p2p streams don't support setStaticQualityLayer"),e("error")):(b={qualityLayer:{spatialLayer:b,temporalLayer:d}},c.checkOptions(b,!0),c.pc.updateSpec(b,e))};c._setDynamicQualityLayer=function(b){if(c.room&&c.room.p2p)a.a.warning("Error! p2p streams don't support setDynamicQualityLayer"),b("error");else{var d={qualityLayer:{spatialLayer:-1,temporalLayer:-1}};c.checkOptions(d,!0);c.pc.updateSpec(d,b)}};var na=function(a,b,d){!0!==b&&(b=!1);a="string"===typeof a?[a]:a;
a=a instanceof Array?a:[];0<a.length&&c.room.sendControlMessage(c,"control",{name:"controlhandlers",enable:d,publisherSide:b,handlers:a})};c.disableHandlers=function(a,c){na(a,c,!1)};c.enableHandlers=function(a,c){na(a,c,!0)};c.updateSimulcastLayersBitrate=function(a,b){c.pc&&c.local&&(c.pc.updateSimulcastLayersBitrate(a),b&&(config.maxVideoLayeredBitrates=a))};c.updateConfiguration=function(a,b){b=void 0===b?function(){}:b;if(void 0!==a)if(c.pc)if(c.checkOptions(a,!0),c.local)if(c.room.p2p)for(var d=
0;d<c.pc.length;d+=1)c.pc[d].updateSpec(a,b);else void 0!=a.maxVideoBW||void 0!=a.minVideoBW||void 0!=a.maxVideoFps||void 0!=a.minVideoFps?1>=c.maxVideoLayers&&c.setVideoParamsRange(a.maxVideoBW,a.minVideoBW,a.maxVideoFps,a.minVideoFps,!1):c.pc.updateSpec(a,b);else c.pc.updateSpec(a,b);else b("Error! This stream has no peerConnection attached, Skipping")};c.ShowSessionStats=function(b){!0===b?void 0!==c.player?c.player.ShowSessionStats(!0):a.a.info("stream does not have a player to show stats"):void 0!==
c.player?c.player.ShowSessionStats(!1):a.a.info("stream does not have a player to hide stats")};c.changeInputMediaSource=function(b,e){e=void 0===e?function(){}:e;"function"!==typeof e?a.a.error("changeInputMediaSource() invalid param - callback"):!c.local||c.ifCanvas()||c.ifScreen()?(a.a.error("changeInputMediaSource() not supported "),e(h.a.error_1156)):void 0==b||"object"!==typeof b||void 0==b.video&&void 0==b.audio?(a.a.error("changeInputMediaSource() invalid param - options"),e(h.a.error_1155)):
b.video&&(!b.stream||b.stream.getVideoTracks()&&b.stream.getVideoTracks().length?0==O("setCameraTrack")?(u.a.warn("stream-event",d.a.event_general_failed,{message:"changeInputMediaSource() - Previous similar camera request in process"}),e(h.a.error_1140)):(c.inputMediaSource.video.user=void 0!=b.stream&&null!=b.stream?b.stream:null,null!=c.inputMediaSource.video.user?(b=c.inputMediaSource.video.user,e="user"):(b=c.inputMediaSource.video.self,e="self"),c.isVideoMuted()||c.inputMediaSource.video.selected==
e||(ia(c,!1,!0,b,!1),E(b)),c.inputMediaSource.video.selected=e,y("setCameraTrack")):(a.a.error("changeInputMediaSource() video tracks not found"),e(h.a.error_1156)))};c.replaceLocalTrack=function(a,c){a.pc.peerConnection.getSenders().forEach(function(b,d){b.track&&("video"===b.track.kind?c&&c.getVideoTracks().forEach(function(a){console.log(a);a.enabled=!0;b.replaceTrack(a)}):"audio"===b.track.kind&&a&&a.audioStream.getAudioTracks().forEach(function(a){console.log(a);a.enabled=!0;b.replaceTrack(a)}))})};
c.startAudioAnalysis=function(){void 0==w?a.a.info("AudioAnalysis feature not enabled"):void 0!=c.rnn?a.a.info("startAudioAnalysis already enabled"):c.audioStreamClone&&(a.a.info("startAudioAnalysis enabled for audio track"),c.audioSource=c.audioContext.createMediaStreamSource(c.audioStreamClone),c.pcmInputBuf=w._malloc(1920),c.pcmOutputBuf=w._malloc(1920),c.pcmInputIndex=c.pcmInputBuf/4,c.rnn=w._rnnoise_create(),c.processor=c.audioContext.createScriptProcessor(512,1,1),c.processor.onaudioprocess=
function(a){a=a.inputBuffer.getChannelData(0);a=[].concat($jscomp.arrayFromIterable(c.bufferResidue),$jscomp.arrayFromIterable(a));for(var b=0;b+480<a.length;b+=480){for(var d=a.slice(b,b+480),e=$jscomp.makeIterator(d.entries()),g=e.next();!g.done;g=e.next()){var h=$jscomp.makeIterator(g.value);g=h.next().value;h=h.next().value;d[g]=32767*h}w.HEAPF32.set(d,c.pcmInputIndex);e=w._rnnoise_process_frame(c.rnn,c.pcmOutputBuf,c.pcmInputBuf);c.isAudioMuted()?c.processing_voice_while_mute?c.scoreArrayVoice.push(e):
.9<e&&(c.processing_voice_while_mute=!0,setTimeout(A,700)):c.processing_noise_detection?(c.scoreArrayNoise.push(e),d=p(d),d=l(d),c.scoreArrayNoise.push(e),c.audioLevelArray.push(d)):.2<e&&(d=p(d),d=l(d),.02<d&&(c.processing_noise_detection=!0,c.scoreArrayNoise.push(e),c.audioLevelArray.push(d),setTimeout(F,1500)))}c.bufferResidue=a.slice(b,a.length)},c.audioSource.connect(c.processor),c.processor.connect(c.audioContext.destination))};c.stopAudioAnalysis=function(){void 0==w?a.a.info("AudioAnalysis feature not enabled"):
void 0==c.rnn?a.a.info("startAudioAnalysis not enabled"):(a.a.info("startAudioAnalysis disabled for audio track"),c.pcmInputBuf&&w._free(c.pcmInputBuf),c.pcmOutputBuf&&w._free(c.pcmOutputBuf),w._rnnoise_destroy(c.rnn),c.pcmInputBuf=void 0,c.pcmOutputBuf=void 0,c.rnn=void 0,c.processor.onaudioprocess=function(){},c.processor.disconnect(),c.audioSource.disconnect())};return c}console.log("Webrtc not supported")}},function(l,r,p){r.a=function(){return{player:{default:{autoplay:"autoplay",name:"",nameDisplayMode:"",
frameFitMode:"bestFit",skin:"default",class:"",height:"240px",width:"320px",minHeight:"200px",minWidth:"250px",aspectRatio:"16:9",volume:5,media:"",loader:{show:!0,style:"default",class:""}}},brand:{default:{display:!0,url:"http://www.vcloudx.com",logo:"/assets/favicon.png",show:!0,target:"_blank",title:"VCloudX Infotech"}},toolbar:{default:{skin:"default",buttons:{play:!0,resize:!0,share:!0,mic:!0,volume:!0,mute:!0,record:!0,playtime:!0,zoom:!0},position:"bottom",class:"",displayMode:!0,autoDisplayTimeout:0}}}}},
function(l,r,p){function f(a,b){var c={"Content-Type":"application/json"};b&&(c.Authentication="Bearer "+b);return{method:"POST",headers:new Headers(c),body:JSON.stringify(a)}}function q(a,b,c){var d,e,h,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress)return d={},b=b||{},k.yield(c.authHeader(),2);if(3!=k.nextAddress)return e=k.yieldResult,b.headers=new Headers({Authorization:e}),k.yield(fetch(a,b),3);h=k.yieldResult;d.response=h;d.ok=h.ok;f=(h.headers.get("WWW-Authenticate")||
"").split(" ")[1];d.shouldRetry=401===h.status&&f!==c.nonce;c.nonce=f;return k.return(d)})}function k(a,b,c){var d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.yield(q(a,b,c),2);d=e.yieldResult;return d.shouldRetry?e.return(q(a,b,c)):e.return(d)})}function e(a){return new Promise(function(b,c){try{var d=new WebSocket(a);d.addEventListener("open",function(){return b(d)},{once:!0})}catch(z){n.a.info("asyncInitWebSocket exception while creating websocket",
z),c(new v(!1))}})}function a(a,b){return new Promise(function(c,d){function e(c){a.removeEventListener("message",h);d(new v(b.cancelled))}function h(b){a.removeEventListener("close",e);try{var h=JSON.parse(b.data);if(h.error)throw n.a.error(" listenForResponse throw exception ",h.error),Error(h.error);c(h)}catch(U){n.a.error(" listenForResponse exception ",U),d(U)}}a.addEventListener("message",h,{once:!0});a.addEventListener("close",e,{once:!0})})}function b(b,h,c,f,k,x,q,l,v){var A,g,p,F,D,r,K,
V,R,z,Q,J,M,I,E;return $jscomp.asyncExecutePromiseGeneratorProgram(function(y){switch(y.nextAddress){case 1:return A=0,g=Date.now(),p="https:"===window.location.protocol?"wss:":"ws:",F="file:"===window.location.protocol?B:p+"//"+w+(t?":":"")+t+"/api/ws",y.yield(e(F),2);case 2:D=y.yieldResult;y.setCatchFinallyBlocks(3,4);r=Object(d.arrayToB64)(new Uint8Array(h));K={};var O=q;O=void 0===O?{}:O;G.file_meta=O;G.trans_dt=Date.now();K=G;V={fileMetadata:r,authorization:"send-v1 "+c,bearer:x,timeLimit:f,
dlimit:k,callInfo:K};R=a(D,v);D.send(JSON.stringify(V));return y.yield(R,6);case 6:return z=y.yieldResult,Q=a(D,v),J=b.getReader(),y.yield(J.read(),7);case 7:M=y.yieldResult;case 8:if(M.done){y.jumpTo(9);break}v.cancelled&&(n.a.info(" websocket upload cancelled"),D.close());if(D.readyState!==WebSocket.OPEN){y.jumpTo(9);break}I=M.value;D.send(I);l(A);A+=I.length;return y.yield(J.read(),10);case 10:M=y.yieldResult;case 11:if(!(D.bufferedAmount>2*u.a&&D.readyState===WebSocket.OPEN)||v.cancelled){y.jumpTo(8);
break}return y.yield(Object(d.delay)(),11);case 9:return D.readyState===WebSocket.OPEN&&D.send(new Uint8Array([0])),y.yield(Q,14);case 14:return z.duration=Date.now()-g,y.return(z);case 4:y.enterFinallyBlock();[WebSocket.CLOSED,WebSocket.CLOSING].includes(D.readyState)||D.close();y.leaveFinallyBlock(0);break;case 3:throw E=y.enterCatchBlock(),E.size=A,E.duration=Date.now()-g,n.a.info(" websocket upload failed",E),E;}})}function h(a,b,c,d){var e,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==
f.nextAddress)return f.yield(b.authHeader(),2);e=f.yieldResult;h=new XMLHttpRequest;d.oncancel=function(){h.abort()};return f.return(new Promise(function(f,k){h.addEventListener("loadend",function(){d.oncancel=function(){};var a=h.getResponseHeader("WWW-Authenticate");a&&(b.nonce=(a||"").split(" ")[1]);if(200!==h.status)return k(Error(h.status));a=new Blob([h.response]);f(a)});h.addEventListener("progress",function(a){200===a.target.status&&c(a.loaded)});h.open("get",D+("/api/download/blob/"+a));
h.setRequestHeader("Authorization",e);h.responseType="blob";h.send();c(0)}))})}function x(a,b,c,d,e){e=void 0===e?2:e;var f,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==n.nextAddress)return n.setCatchFinallyBlocks(2),n.yield(h(a,b,c,d),4);if(2!=n.nextAddress)return f=n.yieldResult,n.return(f);k=n.enterCatchBlock();if("401"===k.message&&0<--e)return n.return(x(a,b,c,d,e));throw k;})}r.d=function(a){return D+a};r.f=function(a){void 0!=a&&void 0!=a.url&&void 0!=a.hostName&&
void 0!=a.port&&(D=a.url,w=a.hostName,t=a.port,B="wss://"+w+":"+t+"/api/ws",a=a.callInfo,n.a.info(" file sharing service call details",a),G.userName=a.userName,G.room_id=a.room_id,G.conf_num=a.conf_num,G.call_num=a.call_num,G.service_id=a.service_id)};r.a=function(a,b){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(fetch(D+("/api/delete/"+a),f({owner_token:b})),2);c=d.yieldResult;return d.return(c.ok)})};r.g=function(a,b,c,d){var e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==
h.nextAddress)return h.yield(fetch(D+("/api/params/"+a),f({owner_token:b,dlimit:d.dlimit},c)),2);e=h.yieldResult;return h.return(e.ok)})};r.c=function(a,b){var c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:return e.yield(fetch(D+("/api/info/"+a),f({owner_token:b})),2);case 2:c=e.yieldResult;if(!c.ok){e.jumpTo(3);break}return e.yield(c.json(),4);case 4:return d=e.yieldResult,e.return(d);case 3:throw Error(c.status);}})};r.e=function(a,b){var c,e,h;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return f.yield(k(D+("/api/metadata/"+a),{method:"GET"},b),2);case 2:c=f.yieldResult;if(!c.ok){f.jumpTo(3);break}return f.yield(c.response.json(),4);case 4:return e=f.yieldResult,f.yield(b.decryptMetadata(Object(d.b64ToArray)(e.metadata)),5);case 5:return h=f.yieldResult,f.return({size:h.size,ttl:e.ttl,iv:h.iv,name:h.name,type:h.type,manifest:h.manifest});case 3:throw Error(c.response.status);}})};r.h=function(a,
b,c){var d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.yield(c.authKeyB64(),2);if(3!=h.nextAddress)return d=h.yieldResult,h.yield(fetch(D+("/api/password/"+a),f({owner_token:b,auth:d})),3);e=h.yieldResult;return h.return(e.ok)})};r.i=function(a,d,c,e,h,f,k,n){var u={cancelled:!1};return{cancel:function(){u.cancelled=!0},result:b(a,d,c,e,h,f,k,n,u)}};r.b=function(a,b,c){var d={oncancel:function(){}};return{cancel:function(){d.oncancel()},result:x(a,
b,c,d)}};var d=p(12);p.n(d);var u=p(31),n=p(0),B=null,w="",t="";B||(B="");var v=function(a,b,c){var d=Error.call(this,a?"0":"connection closed");this.message=d.message;"stack"in d&&(this.stack=d.stack);this.cancelled=a;this.duration=b;this.size=c};$jscomp.inherits(v,Error);var D="",G={}},function(l,r,p){(function(f){function q(){try{var a=new Uint8Array(1);a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return 42===a.foo()&&"function"===typeof a.subarray&&0===a.subarray(1,1).byteLength}catch(V){return!1}}
function k(a,c){if((e.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<c)throw new RangeError("Invalid typed array length");e.TYPED_ARRAY_SUPPORT?(a=new Uint8Array(c),a.__proto__=e.prototype):(null===a&&(a=new e(c)),a.length=c);return a}function e(c,b,d){if(!(e.TYPED_ARRAY_SUPPORT||this instanceof e))return new e(c,b,d);if("number"===typeof c){if("string"===typeof b)throw Error("If encoding is specified then the first argument must be a string");return h(this,c)}return a(this,c,b,d)}function a(a,c,b,g){if("number"===
typeof c)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&c instanceof ArrayBuffer){c.byteLength;if(0>b||c.byteLength<b)throw new RangeError("'offset' is out of bounds");if(c.byteLength<b+(g||0))throw new RangeError("'length' is out of bounds");c=void 0===b&&void 0===g?new Uint8Array(c):void 0===g?new Uint8Array(c,b):new Uint8Array(c,b,g);e.TYPED_ARRAY_SUPPORT?(a=c,a.__proto__=e.prototype):a=x(a,c);return a}if("string"===typeof c){g=a;a=b;if("string"!==
typeof a||""===a)a="utf8";if(!e.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');b=n(c,a)|0;g=k(g,b);c=g.write(c,a);c!==b&&(g=g.slice(0,c));return g}return d(a,c)}function b(a){if("number"!==typeof a)throw new TypeError('"size" argument must be a number');if(0>a)throw new RangeError('"size" argument must not be negative');}function h(a,c){b(c);a=k(a,0>c?0:u(c)|0);if(!e.TYPED_ARRAY_SUPPORT)for(var d=0;d<c;++d)a[d]=0;return a}function x(a,c){var b=0>c.length?0:u(c.length)|
0;a=k(a,b);for(var d=0;d<b;d+=1)a[d]=c[d]&255;return a}function d(a,c){if(e.isBuffer(c)){var b=u(c.length)|0;a=k(a,b);if(0===a.length)return a;c.copy(a,0,0,b);return a}if(c){if("undefined"!==typeof ArrayBuffer&&c.buffer instanceof ArrayBuffer||"length"in c)return(b="number"!==typeof c.length)||(b=c.length,b=b!==b),b?k(a,0):x(a,c);if("Buffer"===c.type&&P(c.data))return x(a,c.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function u(a){if(a>=
(e.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(e.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return a|0}function n(a,c){if(e.isBuffer(a))return a.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(a)||a instanceof ArrayBuffer))return a.byteLength;"string"!==typeof a&&(a=""+a);var b=a.length;if(0===b)return 0;for(var d=!1;;)switch(c){case "ascii":case "latin1":case "binary":return b;
case "utf8":case "utf-8":case void 0:return I(a).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*b;case "hex":return b>>>1;case "base64":return g.toByteArray(M(a)).length;default:if(d)return I(a).length;c=(""+c).toLowerCase();d=!0}}function l(a,c,b){var d=!1;if(void 0===c||0>c)c=0;if(c>this.length)return"";if(void 0===b||b>this.length)b=this.length;if(0>=b)return"";b>>>=0;c>>>=0;if(b<=c)return"";for(a||(a="utf8");;)switch(a){case "hex":a=c;c=b;b=this.length;if(!a||0>a)a=0;
if(!c||0>c||c>b)c=b;d="";for(b=a;b<c;++b)a=d,d=this[b],d=16>d?"0"+d.toString(16):d.toString(16),d=a+d;return d;case "utf8":case "utf-8":return D(this,c,b);case "ascii":a="";for(b=Math.min(this.length,b);c<b;++c)a+=String.fromCharCode(this[c]&127);return a;case "latin1":case "binary":a="";for(b=Math.min(this.length,b);c<b;++c)a+=String.fromCharCode(this[c]);return a;case "base64":return c=0===c&&b===this.length?g.fromByteArray(this):g.fromByteArray(this.slice(c,b)),c;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=
this.slice(c,b);b="";for(a=0;a<c.length;a+=2)b+=String.fromCharCode(c[a]+256*c[a+1]);return b;default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();d=!0}}function w(a,c,b){var d=a[c];a[c]=a[b];a[b]=d}function t(a,c,b,d,g){if(0===a.length)return-1;"string"===typeof b?(d=b,b=0):2147483647<b?b=2147483647:-2147483648>b&&(b=-2147483648);b=+b;isNaN(b)&&(b=g?0:a.length-1);0>b&&(b=a.length+b);if(b>=a.length){if(g)return-1;b=a.length-1}else if(0>b)if(g)b=0;else return-1;"string"===
typeof c&&(c=e.from(c,d));if(e.isBuffer(c))return 0===c.length?-1:v(a,c,b,d,g);if("number"===typeof c)return c&=255,e.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?g?Uint8Array.prototype.indexOf.call(a,c,b):Uint8Array.prototype.lastIndexOf.call(a,c,b):v(a,[c],b,d,g);throw new TypeError("val must be string, number or Buffer");}function v(a,c,b,d,e){function g(a,c){return 1===h?a[c]:a.readUInt16BE(c*h)}var h=1,f=a.length,k=c.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===
d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(2>a.length||2>c.length)return-1;h=2;f/=2;k/=2;b/=2}if(e)for(d=-1;b<f;b++)if(g(a,b)===g(c,-1===d?0:b-d)){if(-1===d&&(d=b),b-d+1===k)return d*h}else-1!==d&&(b-=b-d),d=-1;else for(b+k>f&&(b=f-k);0<=b;b--){f=!0;for(d=0;d<k;d++)if(g(a,b+d)!==g(c,d)){f=!1;break}if(f)return b}return-1}function D(a,c,b){b=Math.min(a.length,b);for(var d=[];c<b;){var e=a[c],g=null,h=239<e?4:223<e?3:191<e?2:1;if(c+h<=b)switch(h){case 1:128>e&&(g=e);break;case 2:var f=a[c+1];
128===(f&192)&&(e=(e&31)<<6|f&63,127<e&&(g=e));break;case 3:f=a[c+1];var k=a[c+2];128===(f&192)&&128===(k&192)&&(e=(e&15)<<12|(f&63)<<6|k&63,2047<e&&(55296>e||57343<e)&&(g=e));break;case 4:f=a[c+1];k=a[c+2];var n=a[c+3];128===(f&192)&&128===(k&192)&&128===(n&192)&&(e=(e&15)<<18|(f&63)<<12|(k&63)<<6|n&63,65535<e&&1114112>e&&(g=e))}null===g?(g=65533,h=1):65535<g&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|g&1023);d.push(g);c+=h}a=d.length;if(a<=la)d=String.fromCharCode.apply(String,d);else{b="";for(c=
0;c<a;)b+=String.fromCharCode.apply(String,d.slice(c,c+=la));d=b}return d}function G(a,c,b){if(0!==a%1||0>a)throw new RangeError("offset is not uint");if(a+c>b)throw new RangeError("Trying to access beyond buffer length");}function A(a,c,b,d,g,h){if(!e.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>g||c<h)throw new RangeError('"value" argument is out of bounds');if(b+d>a.length)throw new RangeError("Index out of range");}function F(a,c,b,d){0>c&&(c=65535+c+1);
for(var e=0,g=Math.min(a.length-b,2);e<g;++e)a[b+e]=(c&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function c(a,c,b,d){0>c&&(c=4294967295+c+1);for(var e=0,g=Math.min(a.length-b,4);e<g;++e)a[b+e]=c>>>8*(d?e:3-e)&255}function Q(a,c,b,d,e,g){if(b+d>a.length)throw new RangeError("Index out of range");if(0>b)throw new RangeError("Index out of range");}function z(a,c,b,d,e){e||Q(a,c,b,4,3.4028234663852886E38,-3.4028234663852886E38);ea.write(a,c,b,d,23,4);return b+4}function J(a,c,b,d,e){e||Q(a,c,b,8,1.7976931348623157E308,
-1.7976931348623157E308);ea.write(a,c,b,d,52,8);return b+8}function M(a){a=a.trim?a.trim():a.replace(/^\s+|\s+$/g,"");a=a.replace(ba,"");if(2>a.length)return"";for(;0!==a.length%4;)a+="=";return a}function I(a,c){c=c||Infinity;for(var b,d=a.length,e=null,g=[],h=0;h<d;++h){b=a.charCodeAt(h);if(55295<b&&57344>b){if(!e){if(56319<b){-1<(c-=3)&&g.push(239,191,189);continue}else if(h+1===d){-1<(c-=3)&&g.push(239,191,189);continue}e=b;continue}if(56320>b){-1<(c-=3)&&g.push(239,191,189);e=b;continue}b=(e-
55296<<10|b-56320)+65536}else e&&-1<(c-=3)&&g.push(239,191,189);e=null;if(128>b){if(0>--c)break;g.push(b)}else if(2048>b){if(0>(c-=2))break;g.push(b>>6|192,b&63|128)}else if(65536>b){if(0>(c-=3))break;g.push(b>>12|224,b>>6&63|128,b&63|128)}else if(1114112>b){if(0>(c-=4))break;g.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw Error("Invalid code point");}return g}function U(a){for(var c=[],b=0;b<a.length;++b)c.push(a.charCodeAt(b)&255);return c}function ca(a,c,b,d){for(var e=0;e<d&&!(e+
b>=c.length||e>=a.length);++e)c[e+b]=a[e];return e}var g=p(30),ea=p(54),P=p(55);r.Buffer=e;r.SlowBuffer=function(a){+a!=a&&(a=0);return e.alloc(+a)};r.INSPECT_MAX_BYTES=50;e.TYPED_ARRAY_SUPPORT=void 0!==f.TYPED_ARRAY_SUPPORT?f.TYPED_ARRAY_SUPPORT:q();r.kMaxLength=e.TYPED_ARRAY_SUPPORT?2147483647:1073741823;e.poolSize=8192;e._augment=function(a){a.__proto__=e.prototype;return a};e.from=function(c,b,d){return a(null,c,b,d)};e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=
Uint8Array,$jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbol(),"undefined"!==typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&($jscomp.initSymbol(),Object.defineProperty(e,Symbol.species,{value:null,configurable:!0})));e.alloc=function(a,c,d){b(a);a=0>=a?k(null,a):void 0!==c?"string"===typeof d?k(null,a).fill(c,d):k(null,a).fill(c):k(null,a);return a};e.allocUnsafe=function(a){return h(null,a)};e.allocUnsafeSlow=function(a){return h(null,a)};e.isBuffer=function(a){return!(null==a||
!a._isBuffer)};e.compare=function(a,c){if(!e.isBuffer(a)||!e.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(a===c)return 0;for(var b=a.length,d=c.length,g=0,h=Math.min(b,d);g<h;++g)if(a[g]!==c[g]){b=a[g];d=c[g];break}return b<d?-1:d<b?1:0};e.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};e.concat=function(a,
c){if(!P(a))throw new TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return e.alloc(0);var b;if(void 0===c)for(b=c=0;b<a.length;++b)c+=a[b].length;c=e.allocUnsafe(c);var d=0;for(b=0;b<a.length;++b){var g=a[b];if(!e.isBuffer(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(c,d);d+=g.length}return c};e.byteLength=n;e.prototype._isBuffer=!0;e.prototype.swap16=function(){var a=this.length;if(0!==a%2)throw new RangeError("Buffer size must be a multiple of 16-bits");
for(var c=0;c<a;c+=2)w(this,c,c+1);return this};e.prototype.swap32=function(){var a=this.length;if(0!==a%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<a;c+=4)w(this,c,c+3),w(this,c+1,c+2);return this};e.prototype.swap64=function(){var a=this.length;if(0!==a%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<a;c+=8)w(this,c,c+7),w(this,c+1,c+6),w(this,c+2,c+5),w(this,c+3,c+4);return this};e.prototype.toString=function(){var a=this.length|
0;return 0===a?"":0===arguments.length?D(this,0,a):l.apply(this,arguments)};e.prototype.equals=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===e.compare(this,a)};e.prototype.inspect=function(){var a="",c=r.INSPECT_MAX_BYTES;0<this.length&&(a=this.toString("hex",0,c).match(/.{2}/g).join(" "),this.length>c&&(a+=" ... "));return"<Buffer "+a+">"};e.prototype.compare=function(a,c,b,d,g){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");
void 0===c&&(c=0);void 0===b&&(b=a?a.length:0);void 0===d&&(d=0);void 0===g&&(g=this.length);if(0>c||b>a.length||0>d||g>this.length)throw new RangeError("out of range index");if(d>=g&&c>=b)return 0;if(d>=g)return-1;if(c>=b)return 1;c>>>=0;b>>>=0;d>>>=0;g>>>=0;if(this===a)return 0;var h=g-d,f=b-c,k=Math.min(h,f);d=this.slice(d,g);a=a.slice(c,b);for(c=0;c<k;++c)if(d[c]!==a[c]){h=d[c];f=a[c];break}return h<f?-1:f<h?1:0};e.prototype.includes=function(a,c,b){return-1!==this.indexOf(a,c,b)};e.prototype.indexOf=
function(a,c,b){return t(this,a,c,b,!0)};e.prototype.lastIndexOf=function(a,c,b){return t(this,a,c,b,!1)};e.prototype.write=function(a,c,b,d){if(void 0===c)d="utf8",b=this.length,c=0;else if(void 0===b&&"string"===typeof c)d=c,b=this.length,c=0;else if(isFinite(c))c|=0,isFinite(b)?(b|=0,void 0===d&&(d="utf8")):(d=b,b=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var e=this.length-c;if(void 0===b||b>e)b=e;if(0<a.length&&(0>b||0>c)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");
d||(d="utf8");for(e=!1;;)switch(d){case "hex":a:{c=Number(c)||0;d=this.length-c;b?(b=Number(b),b>d&&(b=d)):b=d;d=a.length;if(0!==d%2)throw new TypeError("Invalid hex string");b>d/2&&(b=d/2);for(d=0;d<b;++d){e=parseInt(a.substr(2*d,2),16);if(isNaN(e)){a=d;break a}this[c+d]=e}a=d}return a;case "utf8":case "utf-8":return ca(I(a,this.length-c),this,c,b);case "ascii":return ca(U(a),this,c,b);case "latin1":case "binary":return ca(U(a),this,c,b);case "base64":return ca(g.toByteArray(M(a)),this,c,b);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":d=
a;e=this.length-c;for(var h=[],f=0;f<d.length&&!(0>(e-=2));++f){var k=d.charCodeAt(f);a=k>>8;k%=256;h.push(k);h.push(a)}return ca(h,this,c,b);default:if(e)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();e=!0}};e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var la=4096;e.prototype.slice=function(a,c){var b=this.length;a=~~a;c=void 0===c?b:~~c;0>a?(a+=b,0>a&&(a=0)):a>b&&(a=b);0>c?(c+=b,0>c&&(c=0)):c>b&&(c=b);c<a&&(c=a);if(e.TYPED_ARRAY_SUPPORT)c=
this.subarray(a,c),c.__proto__=e.prototype;else{b=c-a;c=new e(b,void 0);for(var d=0;d<b;++d)c[d]=this[d+a]}return c};e.prototype.readUIntLE=function(a,c,b){a|=0;c|=0;b||G(a,c,this.length);b=this[a];for(var d=1,e=0;++e<c&&(d*=256);)b+=this[a+e]*d;return b};e.prototype.readUIntBE=function(a,c,b){a|=0;c|=0;b||G(a,c,this.length);b=this[a+--c];for(var d=1;0<c&&(d*=256);)b+=this[a+--c]*d;return b};e.prototype.readUInt8=function(a,c){c||G(a,1,this.length);return this[a]};e.prototype.readUInt16LE=function(a,
c){c||G(a,2,this.length);return this[a]|this[a+1]<<8};e.prototype.readUInt16BE=function(a,c){c||G(a,2,this.length);return this[a]<<8|this[a+1]};e.prototype.readUInt32LE=function(a,c){c||G(a,4,this.length);return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};e.prototype.readUInt32BE=function(a,c){c||G(a,4,this.length);return 16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])};e.prototype.readIntLE=function(a,c,b){a|=0;c|=0;b||G(a,c,this.length);b=this[a];for(var d=1,e=0;++e<c&&(d*=256);)b+=
this[a+e]*d;b>=128*d&&(b-=Math.pow(2,8*c));return b};e.prototype.readIntBE=function(a,c,b){a|=0;c|=0;b||G(a,c,this.length);b=c;for(var d=1,e=this[a+--b];0<b&&(d*=256);)e+=this[a+--b]*d;e>=128*d&&(e-=Math.pow(2,8*c));return e};e.prototype.readInt8=function(a,c){c||G(a,1,this.length);return this[a]&128?-1*(255-this[a]+1):this[a]};e.prototype.readInt16LE=function(a,c){c||G(a,2,this.length);a=this[a]|this[a+1]<<8;return a&32768?a|4294901760:a};e.prototype.readInt16BE=function(a,c){c||G(a,2,this.length);
a=this[a+1]|this[a]<<8;return a&32768?a|4294901760:a};e.prototype.readInt32LE=function(a,c){c||G(a,4,this.length);return this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};e.prototype.readInt32BE=function(a,c){c||G(a,4,this.length);return this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};e.prototype.readFloatLE=function(a,c){c||G(a,4,this.length);return ea.read(this,a,!0,23,4)};e.prototype.readFloatBE=function(a,c){c||G(a,4,this.length);return ea.read(this,a,!1,23,4)};e.prototype.readDoubleLE=function(a,
c){c||G(a,8,this.length);return ea.read(this,a,!0,52,8)};e.prototype.readDoubleBE=function(a,c){c||G(a,8,this.length);return ea.read(this,a,!1,52,8)};e.prototype.writeUIntLE=function(a,c,b,d){a=+a;c|=0;b|=0;d||A(this,a,c,b,Math.pow(2,8*b)-1,0);d=1;var e=0;for(this[c]=a&255;++e<b&&(d*=256);)this[c+e]=a/d&255;return c+b};e.prototype.writeUIntBE=function(a,c,b,d){a=+a;c|=0;b|=0;d||A(this,a,c,b,Math.pow(2,8*b)-1,0);d=b-1;var e=1;for(this[c+d]=a&255;0<=--d&&(e*=256);)this[c+d]=a/e&255;return c+b};e.prototype.writeUInt8=
function(a,c,b){a=+a;c|=0;b||A(this,a,c,1,255,0);e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));this[c]=a&255;return c+1};e.prototype.writeUInt16LE=function(a,c,b){a=+a;c|=0;b||A(this,a,c,2,65535,0);e.TYPED_ARRAY_SUPPORT?(this[c]=a&255,this[c+1]=a>>>8):F(this,a,c,!0);return c+2};e.prototype.writeUInt16BE=function(a,c,b){a=+a;c|=0;b||A(this,a,c,2,65535,0);e.TYPED_ARRAY_SUPPORT?(this[c]=a>>>8,this[c+1]=a&255):F(this,a,c,!1);return c+2};e.prototype.writeUInt32LE=function(a,b,d){a=+a;b|=0;d||A(this,a,b,4,4294967295,
0);e.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=a&255):c(this,a,b,!0);return b+4};e.prototype.writeUInt32BE=function(a,b,d){a=+a;b|=0;d||A(this,a,b,4,4294967295,0);e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a&255):c(this,a,b,!1);return b+4};e.prototype.writeIntLE=function(a,c,b,d){a=+a;c|=0;d||(d=Math.pow(2,8*b-1),A(this,a,c,b,d-1,-d));d=0;var e=1,g=0;for(this[c]=a&255;++d<b&&(e*=256);)0>a&&0===g&&0!==this[c+d-1]&&(g=1),this[c+
d]=(a/e>>0)-g&255;return c+b};e.prototype.writeIntBE=function(a,c,b,d){a=+a;c|=0;d||(d=Math.pow(2,8*b-1),A(this,a,c,b,d-1,-d));d=b-1;var e=1,g=0;for(this[c+d]=a&255;0<=--d&&(e*=256);)0>a&&0===g&&0!==this[c+d+1]&&(g=1),this[c+d]=(a/e>>0)-g&255;return c+b};e.prototype.writeInt8=function(a,c,b){a=+a;c|=0;b||A(this,a,c,1,127,-128);e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));0>a&&(a=255+a+1);this[c]=a&255;return c+1};e.prototype.writeInt16LE=function(a,c,b){a=+a;c|=0;b||A(this,a,c,2,32767,-32768);e.TYPED_ARRAY_SUPPORT?
(this[c]=a&255,this[c+1]=a>>>8):F(this,a,c,!0);return c+2};e.prototype.writeInt16BE=function(a,c,b){a=+a;c|=0;b||A(this,a,c,2,32767,-32768);e.TYPED_ARRAY_SUPPORT?(this[c]=a>>>8,this[c+1]=a&255):F(this,a,c,!1);return c+2};e.prototype.writeInt32LE=function(a,b,d){a=+a;b|=0;d||A(this,a,b,4,2147483647,-2147483648);e.TYPED_ARRAY_SUPPORT?(this[b]=a&255,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):c(this,a,b,!0);return b+4};e.prototype.writeInt32BE=function(a,b,d){a=+a;b|=0;d||A(this,a,b,4,2147483647,
-2147483648);0>a&&(a=4294967295+a+1);e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a&255):c(this,a,b,!1);return b+4};e.prototype.writeFloatLE=function(a,c,b){return z(this,a,c,!0,b)};e.prototype.writeFloatBE=function(a,c,b){return z(this,a,c,!1,b)};e.prototype.writeDoubleLE=function(a,c,b){return J(this,a,c,!0,b)};e.prototype.writeDoubleBE=function(a,c,b){return J(this,a,c,!1,b)};e.prototype.copy=function(a,c,b,d){b||(b=0);d||0===d||(d=this.length);c>=a.length&&
(c=a.length);c||(c=0);0<d&&d<b&&(d=b);if(d===b||0===a.length||0===this.length)return 0;if(0>c)throw new RangeError("targetStart out of bounds");if(0>b||b>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length);a.length-c<d-b&&(d=a.length-c+b);var g=d-b;if(this===a&&b<c&&c<d)for(d=g-1;0<=d;--d)a[d+c]=this[d+b];else if(1E3>g||!e.TYPED_ARRAY_SUPPORT)for(d=0;d<g;++d)a[d+c]=this[d+b];else Uint8Array.prototype.set.call(a,
this.subarray(b,b+g),c);return g};e.prototype.fill=function(a,c,b,d){if("string"===typeof a){"string"===typeof c?(d=c,c=0,b=this.length):"string"===typeof b&&(d=b,b=this.length);if(1===a.length){var g=a.charCodeAt(0);256>g&&(a=g)}if(void 0!==d&&"string"!==typeof d)throw new TypeError("encoding must be a string");if("string"===typeof d&&!e.isEncoding(d))throw new TypeError("Unknown encoding: "+d);}else"number"===typeof a&&(a&=255);if(0>c||this.length<c||this.length<b)throw new RangeError("Out of range index");
if(b<=c)return this;c>>>=0;b=void 0===b?this.length:b>>>0;a||(a=0);if("number"===typeof a)for(d=c;d<b;++d)this[d]=a;else for(a=e.isBuffer(a)?a:I((new e(a,d)).toString()),g=a.length,d=0;d<b-c;++d)this[d+c]=a[d%g];return this};var ba=/[^+\/0-9A-Za-z-_]/g}).call(r,p(20))},function(l,r,p){function f(e,a){this.test=a;this.statsGatheringRunning=!1;this.pc1=new RTCPeerConnection(e);this.pc2=new RTCPeerConnection(e);this.pc1.addEventListener("icecandidate",this.onIceCandidate_.bind(this,this.pc2));this.pc2.addEventListener("icecandidate",
this.onIceCandidate_.bind(this,this.pc1));this.iceCandidateFilter_=f.noFilter}var q=p(13),k=p(1);f.prototype={establishConnection:function(){this.pc1.createOffer().then(this.gotOffer_.bind(this),this.test.reportFatal.bind(this.test))},close:function(){this.pc1.close();this.pc2.close()},setIceCandidateFilter:function(e){this.iceCandidateFilter_=e},constrainVideoBitrate:function(e){this.constrainVideoBitrateKbps_=e},disableVideoFec:function(){this.constrainOfferToRemoveVideoFec_=!0},gatherStats:function(e,
a,b,h){function f(){"closed"===e.signalingState?(v.statsGatheringRunning=!1,h(n,w,l,t)):(e.getStats().then(k).catch(function(a){v.test.reportError("Could not gather stats: "+a);v.statsGatheringRunning=!1;h(n,w)}),a&&a.getStats().then(d))}function d(a){"chrome"===adapter.browserDetails.browser?(a=q.enumerateStats(a,v.localTrackIds,v.remoteTrackIds),l.push(a),t.push(Date.now())):"firefox"===adapter.browserDetails.browser?(a=q.enumerateStatsFirefox(a),l.push(a),t.push(Date.now())):v.test.reportError("Only Firefox and Chrome getStats implementations are supported.")}
function k(a){"chrome"===adapter.browserDetails.browser?(a=q.enumerateStats(a,v.localTrackIds,v.remoteTrackIds),n.push(a),w.push(Date.now())):"firefox"===adapter.browserDetails.browser?(a=q.enumerateStatsFirefox(a),n.push(a),w.push(Date.now())):v.test.reportError("Only Firefox and Chrome getStats implementations are supported.");setTimeout(f,100)}var n=[],l=[],w=[],t=[],v=this;v.localTrackIds={audio:"",video:""};v.remoteTrackIds={audio:"",video:""};e.getSenders().forEach(function(a){"audio"===a.track.kind?
v.localTrackIds.audio=a.track.id:"video"===a.track.kind&&(v.localTrackIds.video=a.track.id)});a&&a.getReceivers().forEach(function(a){"audio"===a.track.kind?v.remoteTrackIds.audio=a.track.id:"video"===a.track.kind&&(v.remoteTrackIds.video=a.track.id)});this.statsGatheringRunning=!0;f()},gotOffer_:function(e){this.constrainOfferToRemoveVideoFec_&&(e.sdp=e.sdp.replace(/(m=video 1 [^\r]+)(116 117)(\r\n)/g,"$1\r\n"),e.sdp=e.sdp.replace(/a=rtpmap:116 red\/90000\r\n/g,""),e.sdp=e.sdp.replace(/a=rtpmap:117 ulpfec\/90000\r\n/g,
""),e.sdp=e.sdp.replace(/a=rtpmap:98 rtx\/90000\r\n/g,""),e.sdp=e.sdp.replace(/a=fmtp:98 apt=116\r\n/g,""));this.pc1.setLocalDescription(e);this.pc2.setRemoteDescription(e);this.pc2.createAnswer().then(this.gotAnswer_.bind(this),this.test.reportFatal.bind(this.test))},gotAnswer_:function(e){this.constrainVideoBitrateKbps_&&(e.sdp=e.sdp.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+this.constrainVideoBitrateKbps_+"\r\n"));this.pc2.setLocalDescription(e);this.pc1.setRemoteDescription(e)},onIceCandidate_:function(e,
a){if(a.candidate){var b=f.parseCandidate(a.candidate.candidate);this.iceCandidateFilter_(b)&&e.addIceCandidate(a.candidate)}}};f.noFilter=function(){return!0};f.isRelay=function(e){return"relay"===e.type};f.isNotHostCandidate=function(e){return"host"!==e.type};f.isReflexive=function(e){return"srflx"===e.type};f.isHost=function(e){return"host"===e.type};f.isIpv6=function(e){return void 0!==e.address&&-1!==e.address.indexOf(":")};f.parseCandidate=function(e){var a=e.indexOf("candidate:")+10;e=e.substr(a).split(" ");
return{type:e[7],protocol:e[2],address:e[4]}};f.cachedIceServers_=null;f.cachedIceConfigFetchTime_=null;f.asyncCreateTurnConfig=function(e,a,b){a=k.ice_servers[b];""!==a.turnURI&&setTimeout(e.bind(null,{iceServers:[{username:a.turnUsername,credential:a.turnCredential,urls:a.turnURI}]}),0)};f.asyncCreateStunConfig=function(e,a,b){a=k.ice_servers[b];""!==a.stunURI&&setTimeout(e.bind(null,{iceServers:[{urls:a.stunURI}]}),0)};l.exports=f},function(l,r,p){l=function(){for(var f,q,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),
e=[],a=0;a<k.length;a+=1)e[k[a]]=a;var b=function(){if(!f||q>=f.length)return-1;var a=f.charCodeAt(q)&255;q+=1;return a},h=function(){if(!f)return-1;for(;;){if(q>=f.length)return-1;var a=f.charAt(q);q+=1;if(e[a])return e[a];if("A"===a)return 0}},x=function(a){a=a.toString(16);1===a.length&&(a="0"+a);return unescape("%"+a)};return{encodeBase64:function(a){var d;f=a;q=0;a="";var e=Array(3);var h=0;for(d=!1;!d&&-1!==(e[0]=b());)e[1]=b(),e[2]=b(),a+=k[e[0]>>2],-1!==e[1]?(a+=k[e[0]<<4&48|e[1]>>4],-1!==
e[2]?(a+=k[e[1]<<2&60|e[2]>>6],a+=k[e[2]&63]):(a+=k[e[1]<<2&60],a+="=",d=!0)):(a+=k[e[0]<<4&48],a+="=",a+="=",d=!0),h+=4,76<=h&&(a+="\n",h=0);return a},decodeBase64:function(a){var b;f=a;q=0;a="";var d=Array(4);for(b=!1;!b&&-1!==(d[0]=h())&&-1!==(d[1]=h());)d[2]=h(),d[3]=h(),a+=x(d[0]<<2&255|d[1]>>4),-1!==d[2]?(a+=x(d[1]<<4&255|d[2]>>2),-1!==d[3]?a+=x(d[2]<<6&255|d[3]):b=!0):b=!0;return a}}}();r.a=l},function(l,r){r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(p){"object"===
typeof window&&(r=window)}l.exports=r},function(l,r,p){r.c=function(f,e,a){try{return f.pipeThrough(new TransformStream(e))}catch(h){var b=f.getReader();return new ReadableStream({start:function(a){if(e.start)return e.start(a)},pull:function(a){var d,h,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){switch(k.nextAddress){case 1:d=!1,h={enqueue:function(b){d=!0;a.enqueue(b)}};case 2:if(d){k.jumpTo(0);break}return k.yield(b.read(),4);case 4:f=k.yieldResult;if(!f.done){k.jumpTo(5);break}if(!e.flush){k.jumpTo(6);
break}return k.yield(e.flush(a),6);case 6:return k.return(a.close());case 5:return k.yield(e.transform(f.value,h),2)}})},cancel:function(b){f.cancel(b);a&&a(b)}})}};r.a=function(k,e){return new ReadableStream(new f(k,e))};r.b=function(f){return new ReadableStream(new q(f))};var f=function(f,e){this.blob=f;this.index=0;this.chunkSize=e||65536};f.prototype.pull=function(f){var e=this;return new Promise(function(a,b){var h=e.blob.size-e.index;if(0>=h)return f.close(),a();h=Math.min(e.chunkSize,h);var k=
e.blob.slice(e.index,e.index+h),d=new FileReader;d.onload=function(){f.enqueue(new Uint8Array(d.result));a()};d.onerror=b;d.readAsArrayBuffer(k);e.index+=h})};var q=function(f){this.streams=f;this.index=0;this.reader=null;this.nextReader()};q.prototype.nextReader=function(){var f=this.streams[this.index++];this.reader=f&&f.getReader()};q.prototype.pull=function(f){var e=this,a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){if(1==b.nextAddress)return e.reader?b.yield(e.reader.read(),
2):b.return(f.close());a=b.yieldResult;if(a.done)return e.nextReader(),b.return(e.pull(f));f.enqueue(a.value);b.jumpToEnd()})}},function(l,r){function p(f,q){if(!f)throw Error(q||"AssertionError");}p.notEqual=function(f,q,k){p(f!=q,k)};p.notOk=function(f,q){p(!f,q)};p.equal=function(f,q,k){p(f==q,k)};p.ok=p;l.exports=p},function(l,r,p){var f=p(12);p.n(f);var q=p(31),k=new TextEncoder,e=new TextDecoder;l=function(a,b){this._nonce=b||"yRCdyQ1EMSA3mo4rqSkuNQ==";this.rawSecret=a?Object(f.b64ToArray)(a):
crypto.getRandomValues(new Uint8Array(16));this.secretKeyPromise=crypto.subtle.importKey("raw",this.rawSecret,"HKDF",!1,["deriveKey"]);this.metaKeyPromise=this.secretKeyPromise.then(function(a){return crypto.subtle.deriveKey({name:"HKDF",salt:new Uint8Array,info:k.encode("metadata"),hash:"SHA-256"},a,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])});this.authKeyPromise=this.secretKeyPromise.then(function(a){return crypto.subtle.deriveKey({name:"HKDF",salt:new Uint8Array,info:k.encode("authentication"),
hash:"SHA-256"},a,{name:"HMAC",hash:{name:"SHA-256"}},!0,["sign"])})};l.prototype.setPassword=function(a,b){this.authKeyPromise=crypto.subtle.importKey("raw",k.encode(a),{name:"PBKDF2"},!1,["deriveKey"]).then(function(a){return crypto.subtle.deriveKey({name:"PBKDF2",salt:k.encode(b),iterations:100,hash:"SHA-256"},a,{name:"HMAC",hash:"SHA-256"},!0,["sign"])})};l.prototype.setAuthKey=function(a){this.authKeyPromise=crypto.subtle.importKey("raw",Object(f.b64ToArray)(a),{name:"HMAC",hash:"SHA-256"},!0,
["sign"])};l.prototype.authKeyB64=function(){var a=this,b,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.yield(a.authKeyPromise,2);if(3!=h.nextAddress)return b=h.yieldResult,h.yield(crypto.subtle.exportKey("raw",b),3);e=h.yieldResult;return h.return(Object(f.arrayToB64)(new Uint8Array(e)))})};l.prototype.authHeader=function(){var a=this,b,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.yield(a.authKeyPromise,
2);if(3!=h.nextAddress)return b=h.yieldResult,h.yield(crypto.subtle.sign({name:"HMAC"},b,Object(f.b64ToArray)(a.nonce)),3);e=h.yieldResult;return h.return("send-v1 "+Object(f.arrayToB64)(new Uint8Array(e)))})};l.prototype.encryptMetadata=function(a){var b=this,e,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(b.metaKeyPromise,2);if(3!=d.nextAddress)return e=d.yieldResult,d.yield(crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(12),tagLength:128},
e,k.encode(JSON.stringify({name:a.name,size:a.size,type:a.type||"application/octet-stream",manifest:a.manifest||{},roomMeta:a.roomMeta||{}}))),3);f=d.yieldResult;return d.return(f)})};l.prototype.encryptStream=function(a){return Object(q.c)(a,this.rawSecret)};l.prototype.decryptStream=function(a){return Object(q.b)(a,this.rawSecret)};l.prototype.decryptMetadata=function(a){var b=this,h,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(b.metaKeyPromise,
2);if(3!=d.nextAddress)return h=d.yieldResult,d.yield(crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(12),tagLength:128},h,a),3);f=d.yieldResult;return d.return(JSON.parse(e.decode(f)))})};$jscomp.global.Object.defineProperties(l.prototype,{nonce:{configurable:!0,enumerable:!0,get:function(){return this._nonce},set:function(a){a&&a!==this._nonce&&(this._nonce=a)}}});r.a=l},function(l,r){function p(){throw Error("setTimeout has not been defined");}function f(){throw Error("clearTimeout has not been defined");
}function q(a){if(x===setTimeout)return setTimeout(a,0);if((x===p||!x)&&setTimeout)return x=setTimeout,setTimeout(a,0);try{return x(a,0)}catch(v){try{return x.call(null,a,0)}catch(D){return x.call(this,a,0)}}}function k(a){if(d===clearTimeout)return clearTimeout(a);if((d===f||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(a);try{return d(a)}catch(v){try{return d.call(null,a)}catch(D){return d.call(this,a)}}}function e(){n&&B&&(n=!1,B.length?u=B.concat(u):w=-1,u.length&&a())}function a(){if(!n){var a=
q(e);n=!0;for(var b=u.length;b;){B=u;for(u=[];++w<b;)B&&B[w].run();w=-1;b=u.length}B=null;n=!1;k(a)}}function b(a,b){this.fun=a;this.array=b}function h(){}l=l.exports={};try{var x="function"===typeof setTimeout?setTimeout:p}catch(t){x=p}try{var d="function"===typeof clearTimeout?clearTimeout:f}catch(t){d=f}var u=[],n=!1,B,w=-1;l.nextTick=function(d){var e=Array(arguments.length-1);if(1<arguments.length)for(var h=1;h<arguments.length;h++)e[h-1]=arguments[h];u.push(new b(d,e));1!==u.length||n||q(a)};
b.prototype.run=function(){this.fun.apply(null,this.array)};l.title="browser";l.browser=!0;l.env={};l.argv=[];l.version="";l.versions={};l.on=h;l.addListener=h;l.once=h;l.off=h;l.removeListener=h;l.removeAllListeners=h;l.emit=h;l.prependListener=h;l.prependOnceListener=h;l.listeners=function(a){return[]};l.binding=function(a){throw Error("process.binding is not supported");};l.cwd=function(){return"/"};l.chdir=function(a){throw Error("process.chdir is not supported");};l.umask=function(){return 0}},
function(l,r,p){var f=p(26),q=p(0),k=p(7),e=p(5);p(8);p(9);l=p(1);var a=p.n(l);r.a=function(b){function h(){return document.getElementById("WebrtcEverywherePluginId")}function x(a,b,d){a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())if(c=c.value,c.media.toLowerCase()===b.toLowerCase()){c=$jscomp.makeIterator(c.codecs);for(var e=c.next();!e.done;e=c.next())if(e=e.value,e.name.toLowerCase()===d.toLowerCase())return e}}var d={},u;d.remoteDesc=void 0;q.a.info("Starting Base stack",b);
d.pcConfig={iceServers:[]};d.con={};void 0!==b.iceServers&&(d.pcConfig.iceServers=b.iceServers);!0===b.forceTurn&&(d.pcConfig.iceTransportPolicy="relay");void 0===b.audio&&(b.audio=!0);void 0===b.video&&(b.video=!0);b.remoteCandidates=[];b.localCandidates=[];b.remoteDescriptionSet=!1;d.mediaConstraints={offerToReceiveVideo:void 0!==b.video&&!1!==b.video,offerToReceiveAudio:void 0!==b.audio&&!1!==b.audio};var n=function(a){return h().createSessionDescription(a)},l=function(a,b){return h().createPeerConnection(a,
b)};"IE"===k.a.browserEngineCheck()?d.peerConnection=l(d.pcConfig,d.con):d.peerConnection=new RTCPeerConnection(d.pcConfig,d.con);var w=function(a){u=a;u.sdp=u.sdp.replace("a=sendrecv","a=sendonly");p(!1,a)},t=function(a){u=a;p(!0,a)},v=function(a,b,d){q.a.error("message:",d,"in baseStack at",a);void 0!==b&&b("error")},p=function(a,e){u=e;a||(u.sdp=d.enableSimulcast(u.sdp));a||"safari"!==k.a.browserEngineCheck()||(u.sdp=u.sdp.replace("a=sendrecv","a=sendonly"));u.sdp=f.a.setMaxBW(u.sdp,b);b.callback({type:u.type,
sdp:u.sdp})},r=function(a,b){var c={};c.sdp=a.sdp;c.type=a.type;if(b===e.a.constant.H264_CODEC)b=x(a.media,"video","vp8"),a=x(a.media,"video","h264");else if(b===e.a.constant.default)b=x(a.media,"video","h264"),a=x(a.media,"video","vp8"),void 0!=b&&(c.sdp=c.sdp.replace("a=fmtp:"+b.payload+" level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f\r\n",""));else return c;void 0!=b&&(c.sdp=c.sdp.replace("a=rtpmap:"+b.payload+" "+b.name+"/90000\r\n",""),c.sdp=c.sdp.replace("m=video 1 UDP/TLS/RTP/SAVPF "+
a.payload+" "+b.payload+"\r\n","m=video 1 UDP/TLS/RTP/SAVPF "+a.payload+"\r\n"),c.sdp=c.sdp.replace("m=video 1 UDP/TLS/RTP/SAVPF "+b.payload+" "+a.payload+"\r\n","m=video 1 UDP/TLS/RTP/SAVPF "+a.payload+"\r\n"),c.sdp=c.sdp.replace("a=rtcp-fb:"+b.payload+" ccm fir\r\n",""),c.sdp=c.sdp.replace("a=rtcp-fb:"+b.payload+" nack\r\n",""),c.sdp=c.sdp.replace("a=rtcp-fb:"+b.payload+" nack pli\r\n",""),c.sdp=c.sdp.replace("a=rtcp-fb:"+b.payload+" goog-remb\r\n",""));return c};d.resetSDP=function(a){var c=r(d.remoteDesc,
a);d.peerConnection.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!0,iceRestart:!1}).then(function(a){q.a.info("OFFER: - \n"+a.sdp);q.a.info("RECVD ANSWER B4: - \n"+d.remoteDesc.sdp);d.peerConnection.setLocalDescription(a).then(function(){q.a.info("ANSWER: - \n"+c.sdp);d.peerConnection.setRemoteDescription(new RTCSessionDescription(c))}).catch(v.bind(null,"processAnswer",void 0))}).catch(function(a){q.a.info(a)})};var A=function(c,h){var t=c;q.a.info("Set remote and local description");
q.a.debug("Remote Description",t.sdp);q.a.debug("Local Description",u.sdp);t.sdp=f.a.setMaxBW(t.sdp,b);d.remoteDesc=JSON.parse(JSON.stringify(t));if("IE"===k.a.browserEngineCheck()){d.peerConnection.setLocalDescription(u);q.a.info("Remote msg details for sdp:- "+JSON.stringify(t));d.peerConnection.setRemoteDescription(n(t));b.remoteDescriptionSet=!0;for(q.a.info("Candidates to be added: ",b.remoteCandidates.length,b.remoteCandidates);0<b.remoteCandidates.length;)d.peerConnection.addIceCandidate(b.remoteCandidates.shift());
for(q.a.info("Local candidates to send:",b.localCandidates.length);0<b.localCandidates.length&&!d.peerConnection;)b.callback({type:"candidate",candidate:b.localCandidates.shift()})}else q.a.debug("Remote Description",d.remoteDesc.sdp),d.peerConnection.setLocalDescription(u).then(function(){t="safari"===a.a.browser_info.name&&a.a.browser_info.version>=e.a.constant.SAFARI_VERSION_SUPPORTING_VP8&&h!==e.a.constant.H264_CODEC?r(t,e.a.constant.default):"safari"===a.a.browser_info.name&&a.a.browser_info.version<=
e.a.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8&&h!==e.a.constant.H264_CODEC?r(t,e.a.constant.H264_CODEC):r(t,e.a.constant.default);q.a.debug("Remote Description",d.remoteDesc.sdp);d.peerConnection.setRemoteDescription(new RTCSessionDescription(t)).then(function(){b.remoteDescriptionSet=!0;q.a.info("Candidates to be added: ",b.remoteCandidates.length,b.remoteCandidates);for(var a={};0<b.remoteCandidates.length;)a.$jscomp$loop$prop$cand$205=b.remoteCandidates.shift(),d.peerConnection.addIceCandidate(a.$jscomp$loop$prop$cand$205).then(function(a){return function(){q.a.info("process answer adding remote ice cand Success: "+
JSON.stringify(a.$jscomp$loop$prop$cand$205))}}(a)).catch(function(a){return function(c){q.a.error("process answer Failed addIceCandidate(): "+c+" cand: "+JSON.stringify(a.$jscomp$loop$prop$cand$205))}}(a)),a={$jscomp$loop$prop$cand$205:a.$jscomp$loop$prop$cand$205};for(q.a.info("Local candidates to send:",b.localCandidates.length);0<b.localCandidates.length;)b.callback({type:"candidate",candidate:b.localCandidates.shift()})}).catch(v.bind(null,"processAnswer",void 0))}).catch(v.bind(null,"processAnswer",
void 0))},F=function(a){try{var c="object"===typeof a.candidate?a.candidate:JSON.parse(a.candidate);if("end"===c.candidate)console.log("end candidates: ignore");else{c.candidate=c.candidate.replace(/a=/g,"");c.sdpMLineIndex=parseInt(c.sdpMLineIndex,10);c.sdpMid="audio"==c.sdpMid?0:1;var e=new RTCIceCandidate(c);b.remoteDescriptionSet?d.peerConnection.addIceCandidate(e).then(function(){q.a.info("IN adding remote ice candidate Success: "+JSON.stringify(c))}).catch(function(a){q.a.error("addIceCandidate() Failed err: "+
a+" cand: "+JSON.stringify(c))}):(q.a.debug("queuing candidates since remote description not set: "+JSON.stringify(c)),b.remoteCandidates.push(e))}}catch(J){q.a.error("Error parsing candidate error: "+J+" cand:"+a.candidate)}};d.peerConnection.onicecandidate=function(a){(a=a.candidate)?a={sdpMLineIndex:a.sdpMLineIndex,sdpMid:a.sdpMid,candidate:"a="+a.candidate}:(q.a.info("Gathered all candidates. Sending END candidate"),a={sdpMLineIndex:-1,sdpMid:"end",candidate:"end"});b.remoteDescriptionSet?b.callback({type:"candidate",
candidate:a}):(b.localCandidates.push(a),q.a.info("Storing candidate: ",b.localCandidates.length,a))};d.peerConnection.onaddstream=function(a){if(d.onaddstream)d.onaddstream(a)};d.peerConnection.onremovestream=function(a){if(d.onremovestream)d.onremovestream(a)};d.peerConnection.oniceconnectionstatechange=function(a){d.oniceconnectionstatechange&&(q.a.debug("ICE connection state changed",a.currentTarget.iceConnectionState),q.a.debug("ICE gathering state changed",a.currentTarget.iceGatheringState),
d.oniceconnectionstatechange(a.currentTarget.iceConnectionState))};d.peerConnection.onconnectionstatechange=function(a){d.onconnectionstatechange&&(q.a.debug("Peer connection state changed",d.peerConnection.connectionState),d.onconnectionstatechange(d.peerConnection.connectionState))};d.enableSimulcast=function(a){q.a.error("Simulcast not implemented");return a};d.updateSimulcastLayersBitrate=function(a){d.simulcast&&(d.simulcast.spatialLayerBitrates=a,d.setSimulcastLayersBitrate())};d.setSimulcastLayersBitrate=
function(){q.a.error("Simulcast not implemented")};d.setSimulcast=function(a){d.simulcast=a};d.close=function(){d.state="closed";d.peerConnection.close()};d.updateSpec=function(a,e){e=void 0===e?function(){}:e;if(a.maxVideoBW||a.maxAudioBW)a.maxVideoBW&&(q.a.debug("Maxvideo Requested:",a.maxVideoBW,"limit:",b.limitMaxVideoBW),a.maxVideoBW>b.limitMaxVideoBW&&(a.maxVideoBW=b.limitMaxVideoBW),b.maxVideoBW=a.maxVideoBW,q.a.debug("Result",b.maxVideoBW)),a.maxAudioBW&&(a.maxAudioBW>b.limitMaxAudioBW&&(a.maxAudioBW=
b.limitMaxAudioBW),b.maxAudioBW=a.maxAudioBW),u.sdp=f.a.setMaxBW(u.sdp,b),a.Sdp||a.maxAudioBW?(q.a.debug("Updating with SDP renegotiation",b.maxVideoBW,b.maxAudioBW),d.peerConnection.setLocalDescription(u).then(function(){d.remoteDesc.sdp=f.a.setMaxBW(d.remoteDesc.sdp,b);return d.peerConnection.setRemoteDescription(new RTCSessionDescription(d.remoteDesc))}).then(function(){b.remoteDescriptionSet=!0;b.callback({type:"updatestream",sdp:u.sdp})}).catch(v.bind(null,"updateSpec",e))):(q.a.debug("Updating without SDP renegotiation, newVideoBW:",
b.maxVideoBW,"newAudioBW:",b.maxAudioBW),b.callback({type:"updatestream",sdp:u.sdp}));if(a.minVideoBW||void 0!==a.slideShowMode||void 0!==a.muteStream||void 0!==a.qualityLayer||void 0!==a.video)q.a.debug("MinVideo Changed to ",a.minVideoBW),q.a.debug("SlideShowMode Changed to ",a.slideShowMode),q.a.debug("muteStream changed to ",a.muteStream),q.a.debug("Video Constraints",a.video),b.callback({type:"updatestream",config:a})};d.createOffer=function(a,b){!0!==a&&(d.mediaConstraints={offerToReceiveVideo:!1,
offerToReceiveAudio:!1});b&&(d.mediaConstraints.iceRestart=b);q.a.debug("Creating offer :-"+JSON.stringify(d.mediaConstraints));"IE"===k.a.browserEngineCheck()?!0!==a?d.peerConnection.createOffer(w,v):d.peerConnection.createOffer(t,v,{optional:[{OfferToReceiveAudio:!0},{OfferToReceiveVideo:!0}]}):d.peerConnection.createOffer(d.mediaConstraints).then(p.bind(null,a)).catch(v.bind(null,"Create Offer",void 0))};d.addStream=function(a){d.peerConnection.addStream(a)};d.addTrack=function(a){d.peerConnection.addTrack(a)};
d.processSignalingMessage=function(a,b){"answer"===a.type?A(a,b):"candidate"===a.type&&F(a)};return d}},function(l,r,p){r.a={addSim:function(f){var q="a=ssrc-group:SIM";f.forEach(function(f){q+=" "+f});return q+"\r\n"},addGroup:function(f,q){return"a=ssrc-group:FID "+f+" "+q+"\r\n"},addSpatialLayer:function(f,q,k,e,a,b){return"a=ssrc:"+a+" cname:"+f+"\r\na=ssrc:"+(a+" msid:"+q+"\r\na=ssrc:")+(a+" mslabel:"+k+"\r\na=ssrc:")+(a+" label:"+e+"\r\na=ssrc:")+(b+" cname:"+f+"\r\na=ssrc:")+(b+" msid:"+q+
"\r\na=ssrc:")+(b+" mslabel:"+k+"\r\na=ssrc:")+(b+" label:"+e+"\r\n")},setMaxBW:function(f,q){var k=f;if(q.video&&q.maxVideoBW){k=k.replace(/b=AS:.*\r\n/g,"");var e=k.match(/m=video.*\r\n/);null==e&&(e=k.match(/m=video.*\n/));e&&0<e.length&&(f=e[0]+"b=AS:"+q.maxVideoBW+"\r\n",k=k.replace(e[0],f))}q.audio&&q.maxAudioBW&&(e=k.match(/m=audio.*\r\n/),null==e&&(e=k.match(/m=audio.*\n/)),e&&0<e.length&&(f=e[0]+"b=AS:"+q.maxAudioBW+"\r\n",k=k.replace(e[0],f)));return k},enableOpusNacks:function(f){var q=
f.match(/a=rtpmap:(.*)opus.*\r\n/);null!==q&&(f=f.replace(q[0],q[0]+"a=rtcp-fb:"+q[1]+"nack\r\n"));return f}}},function(l,r,p){var f=p(6);r.a=function(q){return"OverconstrainedError"===q.name&&"deviceId"===q.constraint?f.a.error_1142:"OverconstrainedError"!=q.name&&"ConstraintNotSatisfiedError"!=q.name||"width"!==q.constraint?"OverconstrainedError"!=q.name&&"ConstraintNotSatisfiedError"!=q.name||"height"!==q.constraint?"OverconstrainedError"!=q.name&&"ConstraintNotSatisfiedError"!=q.name||q.constraint?
"NotFoundError"==q.name||"DevicesNotFoundError"==q.name?f.a.error_1143:"NotReadableError"==q.name||"TrackStartError"==q.name?f.a.error_1145:"NotAllowedError"==q.name||"PermissionDeniedError"==q.name?f.a.error_1144:"TypeError"==q.name||"TypeError"==q.name?f.a.error_1146:f.a.error_1150:f.a.error_1149:f.a.error_1148:f.a.error_1147}},function(l,r,p){var f=p(2),q=p(15),k=p(3),e=p(29);l=p(1);var a=p.n(l);r.a=function(b){var h=Object(f.a)({}),x=Object(q.a)().player.default;if(k.a.checkParam(b.options)&&
k.a.checkParam(b.options.player)){var d=b.options.player;k.a.checkParam(d.autoplay)&&(x.autoplay=d.autoplay);k.a.checkParam(d.name)&&(x.name=d.name);k.a.checkParam(d.nameDisplayMode)&&(x.nameDisplayMode=d.nameDisplayMode);k.a.checkParam(d.frameFitMode)&&(x.frameFitMode=d.frameFitMode);k.a.checkParam(d.skin)&&(x.skin=d.skin);k.a.checkParam(d.class)&&(x.class=d.class);k.a.checkParam(d.height)&&(x.height=d.height);k.a.checkParam(d.width)&&(x.width=d.width);k.a.checkParam(d.minHeight)&&(x.minHeight=d.minHeight);
k.a.checkParam(d.minWidth)&&(x.minWidth=d.minWidth);k.a.checkParam(d.aspectRatio)&&(x.aspectRatio=d.aspectRatio);k.a.checkParam(d.volume)&&(x.volume=d.volume);k.a.checkParam(d.backgroundImg)&&(x.backgroundImg=d.backgroundImg);k.a.checkParam(d.media)&&(x.media=d.media);k.a.checkParam(d.loader)&&(d=d.loader,k.a.checkParam(d.url)&&(x.loader.url=d.url),x.loader.show=d.show,k.a.checkParam(d.class)&&(x.loader.class=d.class),k.a.checkParam(d.style)&&(x.loader.style=d.style))}h.id=b.id;h.stream=b.videoSource;
h.elementID=b.elementID;h.abwd={};h.abwd.notification=!0;h.abwd.lang="en";k.a.checkParam(b.options)&&k.a.checkParam(b.options.player)&&k.a.checkParam(b.options.player.abwd)&&(d=b.options.player.abwd,!1===d.enabled?h.abwd.notification=!1:!0===d.enabled&&"sdk"===d.notification?(h.abwd.notification=!0,h.abwd.lang="en"===d.language||"zh"===d.language?d.language:"en"):!0===d.enabled&&"app"===d.notification&&(h.abwd.notification=!1,h.abwd.lang=""));d=k.a.getById(b.elementID);d.style.height=x.height;d.style.width=
x.width;d.style.minHeight=x.minHeight;d.style.minWidth=x.minWidth;var u=function(a,c,b,d){(d?1/a*c>b:1/a*c<b)?(h.video.style.width=c+"px",h.video.style.height=1/a*c+"px",h.video.style.top=-(1/a*c/2-b/2)+"px",h.video.style.left="0px"):(h.video.style.height=b+"px",h.video.style.width=a*b+"px",h.video.style.left=-(a*b/2-c/2)+"px",h.video.style.top="0px");h.video.style.overflow="hidden"};h.destroy=function(){console.log("video player destroy ");h.video.pause();if(a.a.csp_enabled)h.container.removeChild(h.div);
else{delete h.resizer;try{h.div.removeChild(n),h.div.removeChild(t)}catch(F){console.log("error videoplayer.destroy() removeChild err: "+F)}}};h.resize=function(){var a=h.container.offsetWidth,c=h.container.offsetHeight;b.stream.screen||!1===b.options.crop||b.stream.canvas?u(16/9,a,c,!1):(a!==h.containerWidth||c!==h.containerHeight)&&u(4/3,a,c,!0);h.containerWidth=a;h.containerHeight=c};d=b.stream.getPlayerId(b.vroom?b.vroom:b.stream.room);h.div=Object(k.a)({name:"div",id:""+d.player,class:"vcx_player "+
x.skin+"_vcx_player",style:{"object-position":"65% 50%"}});x.loader.url&&(h.loader=Object(k.a)({name:"img",src:x.loader.url,id:"back_"+h.id,class:"vcx_player_loader "+x.loader.class+" "+x.skin+"_vcx_player_loader"}),x.loader.show||(h.loader.style.display="none"));x.backgroundImg&&(h.screenSaver=Object(k.a)({name:"img",src:x.backgroundImg,id:"screen_saver_"+h.id,class:"vcx_player_screen_saver "+x.skin+"_vcx_player_screen_saver"}),h.screenSaver.style.display="none");x={name:"video",id:""+d.stream,class:"vcx_stream "+
x.skin+"_vcx_stream"};b.extraPlayerOptions.autoplay&&(x.autoplay=b.extraPlayerOptions.autoplay);b.extraPlayerOptions.playsinline&&(x.playsinline=b.extraPlayerOptions.playsinline);h.video=Object(k.a)(x);b.stream.local&&(h.video.volume=0);h.container=void 0!==h.elementID?"object"===typeof h.elementID&&"function"===typeof h.elementID.appendChild?h.elementID:k.a.getById(h.elementID):document.body;h.container.appendChild(h.div);h.parentNode=h.div.parentNode;var n=void 0,l=void 0,w=void 0,t=void 0,v=void 0,
p=void 0,r=void 0;if(!a.a.csp_enabled){l=document.createElement("div");l.setAttribute("id","stats-container-"+h.id);l.setAttribute("class","stats-container");l.setAttribute("style","display:none;");n=document.createElement("div");n.setAttribute("id","bw-notif-"+h.id);n.setAttribute("class","bw-notification");n.setAttribute("style","display:none;");if(a.a.alertNotifyInfo&&a.a.alertNotifyInfo.mode&&"image"==a.a.alertNotifyInfo.mode){var A=document.createElement("div");A.setAttribute("id","icon-bw-low-"+
h.id);A.setAttribute("class","icon-bw");A.innerHTML=window.lowBwIcon;n.appendChild(A)}w=document.createElement("div");w.setAttribute("id","stats-button-"+h.id);w.setAttribute("class","stats-button");w.setAttribute("title","Click to see stats");w.innerHTML=window.statsIcon;l.appendChild(w);t=document.createElement("div");t.setAttribute("class","stats-overlay");t.setAttribute("id","stats-overlay-"+h.id);t.setAttribute("style","display: none;\n            position: absolute;z-index: 3;\n            padding: 5px;top: 0px;right: 0px;\n            background: linear-gradient(90deg,rgb(204 41 42 / 62%),#a20a90b0);\n            border-radius: 5px;color: #fff;width: 100%;");
v=document.createElement("div");v.setAttribute("class","stats-overlay-inner");v.setAttribute("id","stats-overlay-inner-"+h.id);p=document.createElement("div");r=document.createElement("div");p.setAttribute("class","stats-left-partition");p.setAttribute("id","stats-left-part-"+h.id);r.setAttribute("class","stats-right-partition");r.setAttribute("id","stats-right-part-"+h.id);w.addEventListener("click",function(){t.style.display="none"===t.style.display?"block":"none"});h.div.parentNode.style.position=
"relative";h.div.appendChild(l);h.div.appendChild(t);t.appendChild(v);h.div.appendChild(n);v.appendChild(p);v.appendChild(r)}h.loader&&h.div.appendChild(h.loader);h.screenSaver&&h.div.appendChild(h.screenSaver);h.div.appendChild(h.video);h.containerWidth=0;h.containerHeight=0;!a.a.csp_enabled&&b.options&&!1!==b.options.resizer&&(h.resizer=L.ResizeSensor(h.container,h.resize),h.resize());!1===b.options.bar&&(h.media=h.video);h.video.srcObject=h.stream;h.ShowSessionStats=function(b){a.a.csp_enabled||
(!0===b?(l.setAttribute("style","display:block;"),t.setAttribute("style","display:block;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")):(l.setAttribute("style","display:none;"),t.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")))};h.streamUpdated=function(a){a!=h.id&&(h.id=a,h.video&&(a=b.stream.getPlayerId(b.vroom?b.vroom:b.stream.room),h.div.setAttribute("id",""+a.player),
h.video.setAttribute("id",""+a.stream),void 0!=h.loader&&h.loader.setAttribute("id","back_"+h.id),void 0!=h.screenSaver&&h.screenSaver.setAttribute("id","screen_saver_"+h.id),void 0!=l&&l.setAttribute("id","stats-container-"+h.id),void 0!=n&&n.setAttribute("id","bw-notif-"+h.id),void 0!=A&&A.setAttribute("id","icon-bw-low-"+h.id),void 0!=w&&w.setAttribute("id","bw-notif-"+h.id),void 0!=t&&t.setAttribute("id","stats-overlay-"+h.id),void 0!=v&&v.setAttribute("id","stats-overlay-inner-"+h.id),void 0!=
p&&p.setAttribute("id","stats-left-part-"+h.id),void 0!=r&&r.setAttribute("id","stats-right-part-"+h.id)))};h.setBwAlert=function(b,c,d){!1===h.abwd.notification||a.a.csp_enabled||(!0===b?(b="Low Bandwidth",a.a.alertNotifyInfo.customLowBw?b=a.a.alertNotifyInfo.customLowBw:h.abwd.lang&&""!=h.abwd.lang&&(b="subscriber"===c?e.a.abwd[h.abwd.lang].bw_alert_subscriber:d+e.a.abwd[h.abwd.lang].bw_alert_publisher),"text"==a.a.alertNotifyInfo.mode?(console.log("videoPlayer - setBwAlert(): setting  text id: "+
h.id),n.innerText=b,n.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px 10px;top:50%;right:50%"),n.setAttribute("style","transform:translateX(50%);background:rgba(0,0,0,0.29)"),n.setAttribute("style","border-radius:5px;color:rgb(255,255,255)")):"image"==a.a.alertNotifyInfo.mode&&(console.log("videoPlayer - setBwAlert(): setting  image id: "+h.id),A.setAttribute("title",b),n.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px;bottom:5%;right:5%"))):
(console.log("videoPlayer - setBwAlert(): removing image/text  id: "+h.id),n.setAttribute("style","display:none")))};h.setVideoMutedMsg=function(b){if(!1!==h.abwd.notification&&!a.a.csp_enabled)if(!0===b.videomuted&&"bw"===b.reason){var c="Video Muted";a.a.alertNotifyInfo.customVideoMute?c=a.a.alertNotifyInfo.customVideoMute:h.abwd.lang&&""!=h.abwd.lang&&(c=b.name+" "+e.a.abwd[h.abwd.lang].video_muted);"text"==a.a.alertNotifyInfo.mode?(n.innerText=c,n.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px 10px;top:50%;right:50%"),
n.setAttribute("style","transform:translateX(50%);background:rgba(0,0,0,0.29)"),n.setAttribute("style","border-radius:5px;color:rgb(255,255,255)")):"image"==a.a.alertNotifyInfo.mode&&(A.setAttribute("title",c),n.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px"))}else n.setAttribute("style","display:none")};return h}},function(l,r,p){r.a={abwd:{en:{bw_alert_publisher:" Low upload bandwidth",bw_alert_subscriber:" Low Download bandwidth",video_muted:" Video muted due to low bandwidth"},
zh:{bw_alert_publisher:" \u7f51\u7edc\u4e0d\u597d",bw_alert_subscriber:"\u4f60\u7684\u4e0b\u8f7d\u5e26\u5bbd\u5f88\u4f4e",video_muted:" \u60a8\u7684\u89c6\u9891\u56e0\u5e26\u5bbd\u800c\u9759\u97f3"}}}},function(l,r,p){function f(a){var b=a.length;if(0<b%4)throw Error("Invalid string. Length must be a multiple of 4");a=a.indexOf("=");-1===a&&(a=b);return[a,a===b?0:4-a%4]}function q(a,e,f){for(var b=[],h=e;h<f;h+=3)e=(a[h]<<16&16711680)+(a[h+1]<<8&65280)+(a[h+2]&255),b.push(k[e>>18&63]+k[e>>12&63]+
k[e>>6&63]+k[e&63]);return b.join("")}r.byteLength=function(a){a=f(a);var b=a[1];return 3*(a[0]+b)/4-b};r.toByteArray=function(b){var h=f(b);var k=h[0];h=h[1];var d=new a(3*(k+h)/4-h),u=0,n=0<h?k-4:k,q;for(q=0;q<n;q+=4)k=e[b.charCodeAt(q)]<<18|e[b.charCodeAt(q+1)]<<12|e[b.charCodeAt(q+2)]<<6|e[b.charCodeAt(q+3)],d[u++]=k>>16&255,d[u++]=k>>8&255,d[u++]=k&255;2===h&&(k=e[b.charCodeAt(q)]<<2|e[b.charCodeAt(q+1)]>>4,d[u++]=k&255);1===h&&(k=e[b.charCodeAt(q)]<<10|e[b.charCodeAt(q+1)]<<4|e[b.charCodeAt(q+
2)]>>2,d[u++]=k>>8&255,d[u++]=k&255);return d};r.fromByteArray=function(a){for(var b=a.length,e=b%3,d=[],f=0,n=b-e;f<n;f+=16383)d.push(q(a,f,f+16383>n?n:f+16383));1===e?(a=a[b-1],d.push(k[a>>2]+k[a<<4&63]+"==")):2===e&&(a=(a[b-2]<<8)+a[b-1],d.push(k[a>>10]+k[a>>4&63]+k[a<<2&63]+"="));return d.join("")};var k=[],e=[],a="undefined"!==typeof Uint8Array?Uint8Array:Array;for(l=0;64>l;++l)k[l]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[l],e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(l)]=
l;e[45]=62;e[95]=63},function(l,r,p){(function(f){r.c=function(e,f,d,u){d=void 0===d?65536:d;void 0===u&&(u=new Uint8Array(16),crypto.getRandomValues(u),u=u.buffer);e=Object(k.c)(e,new b(d,"encrypt"));return Object(k.c)(e,new a("encrypt",f,d,u))};r.b=function(e,f,d){d=void 0===d?65536:d;e=Object(k.c)(e,new b(d,"decrypt"));return Object(k.c)(e,new a("decrypt",f,d))};var q=p(17);p.n(q);var k=p(21);r.a=65536;var e=new TextEncoder,a=function(a,b,d,e){this.mode=a;this.prevChunk;this.seq=0;this.firstchunk=
!0;this.rs=d;this.ikm=b.buffer;this.salt=e};a.prototype.generateKey=function(){var a=this,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(crypto.subtle.importKey("raw",a.ikm,"HKDF",!1,["deriveKey"]),2);b=d.yieldResult;return d.return(crypto.subtle.deriveKey({name:"HKDF",salt:a.salt,info:e.encode("Content-Encoding: aes128gcm\x00"),hash:"SHA-256"},b,{name:"AES-GCM",length:128},!0,["encrypt","decrypt"]))})};a.prototype.generateNonceBase=function(){var a=
this,b,d,k,n;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){switch(h.nextAddress){case 1:return h.yield(crypto.subtle.importKey("raw",a.ikm,"HKDF",!1,["deriveKey"]),2);case 2:return b=h.yieldResult,d=crypto.subtle,k=d.exportKey,h.yield(crypto.subtle.deriveKey({name:"HKDF",salt:a.salt,info:e.encode("Content-Encoding: nonce\x00"),hash:"SHA-256"},b,{name:"AES-GCM",length:128},!0,["encrypt","decrypt"]),4);case 4:return h.yield(k.call(d,"raw",h.yieldResult),3);case 3:return n=h.yieldResult,
h.return(f.from(n.slice(0,12)))}})};a.prototype.generateNonce=function(a){if(4294967295<a)throw Error("record sequence number exceeds limit");var b=f.from(this.nonceBase),d=b.readUIntBE(b.length-4,4);b.writeUIntBE((d^a)>>>0,b.length-4,4);return b};a.prototype.pad=function(a,b){var d=a.length;if(d+16>=this.rs)throw Error("data too large for record size");if(b)return b=f.alloc(1),b.writeUInt8(2,0),f.concat([a,b]);b=f.alloc(this.rs-d-16);b.fill(0);b.writeUInt8(1,0);return f.concat([a,b])};a.prototype.unpad=
function(a,b){for(var d=a.length-1;0<=d;d--)if(a[d]){if(b){if(2!==a[d])throw Error("delimiter of final record is not 2");}else if(1!==a[d])throw Error("delimiter of not final record is not 1");return a.slice(0,d)}throw Error("no delimiter found");};a.prototype.createHeader=function(){var a=f.alloc(5);a.writeUIntBE(this.rs,0,4);a.writeUIntBE(0,4,1);return f.concat([f.from(this.salt),a])};a.prototype.readHeader=function(a){if(21>a.length)throw Error("chunk too small for reading header");var b={};b.salt=
a.buffer.slice(0,16);b.rs=a.readUIntBE(16,4);a=a.readUInt8(20);b.length=a+16+5;return b};a.prototype.encryptRecord=function(a,b,d){var e=this,h,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==n.nextAddress)return h=e.generateNonce(b),n.yield(crypto.subtle.encrypt({name:"AES-GCM",iv:h},e.key,e.pad(a,d)),2);k=n.yieldResult;return n.return(f.from(k))})};a.prototype.decryptRecord=function(a,b,d){var e=this,h,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==
n.nextAddress)return h=e.generateNonce(b),n.yield(crypto.subtle.decrypt({name:"AES-GCM",iv:h,tagLength:128},e.key,a),2);k=n.yieldResult;return n.return(e.unpad(f.from(k),d))})};a.prototype.start=function(a){var b=this,d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress){if("encrypt"!==b.mode){if("decrypt"!==b.mode)throw Error("mode must be either encrypt or decrypt");return h.jumpTo(0)}d=b;return h.yield(b.generateKey(),3)}if(4!=h.nextAddress)return d.key=h.yieldResult,
e=b,h.yield(b.generateNonceBase(),4);e.nonceBase=h.yieldResult;a.enqueue(b.createHeader());h.jumpToEnd()})};a.prototype.transformPrevChunk=function(a,b){var d=this,e,h,f,k,t,q,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){switch(n.nextAddress){case 1:if("encrypt"===d.mode)return q=b,l=q.enqueue,n.yield(d.encryptRecord(d.prevChunk,d.seq,a),9);if(0===d.seq)return f=d.readHeader(d.prevChunk),d.salt=f.salt,d.rs=f.rs,k=d,n.yield(d.generateKey(),7);e=b;h=e.enqueue;return n.yield(d.decryptRecord(d.prevChunk,
d.seq-1,a),6);case 6:h.call(e,n.yieldResult);n.jumpTo(5);break;case 7:return k.key=n.yieldResult,t=d,n.yield(d.generateNonceBase(),8);case 8:t.nonceBase=n.yieldResult;case 5:d.seq++;n.jumpTo(0);break;case 9:l.call(q,n.yieldResult),d.seq++,n.jumpToEnd()}})};a.prototype.transform=function(a,b){var d=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return d.firstchunk?e.jumpTo(2):e.yield(d.transformPrevChunk(!1,b),2);d.firstchunk=!1;d.prevChunk=f.from(a.buffer);
e.jumpToEnd()})};a.prototype.flush=function(a){var b=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){return b.prevChunk?d.yield(b.transformPrevChunk(!0,a),0):d.jumpTo(0)})};var b=function(a,b){this.mode=b;this.rs=a;this.chunkSize="encrypt"===b?a-17:21;this.partialChunk=new Uint8Array(this.chunkSize);this.offset=0};b.prototype.send=function(a,b){b.enqueue(a);21===this.chunkSize&&"decrypt"===this.mode&&(this.chunkSize=this.rs);this.partialChunk=new Uint8Array(this.chunkSize);this.offset=
0};b.prototype.transform=function(a,b){var d=0;if(0<this.offset){var e=Math.min(a.byteLength,this.chunkSize-this.offset);this.partialChunk.set(a.slice(0,e),this.offset);this.offset+=e;d+=e;this.offset===this.chunkSize&&this.send(this.partialChunk,b)}for(;d<a.byteLength;)e=a.byteLength-d,e>=this.chunkSize?(e=a.slice(d,d+this.chunkSize),d+=this.chunkSize,this.send(e,b)):(e=a.slice(d,d+e),d+=e.byteLength,this.partialChunk.set(e),this.offset=e.byteLength)};b.prototype.flush=function(a){0<this.offset&&
a.enqueue(this.partialChunk.slice(0,this.offset))}}).call(r,p(17).Buffer)},function(l,r,p){function f(a){if(!(this instanceof f))return new f(a);this._name=a||"nanobus";this._starListeners=[];this._listeners={}}var q=p(57),k=p(58),e=p(22);l.exports=f;f.prototype.emit=function(a){e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.emit: eventName should be type string or symbol");for(var b=[],f=1,q=arguments.length;f<q;f++)b.push(arguments[f]);f=k(this._name+"('"+a.toString()+"')");(q=this._listeners[a])&&
0<q.length&&this._emit(this._listeners[a],b);0<this._starListeners.length&&this._emit(this._starListeners,a,b,f.uuid);f();return this};f.prototype.on=f.prototype.addListener=function(a,b){e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.on: eventName should be type string or symbol");e.equal(typeof b,"function","nanobus.on: listener should be type function");"*"===a?this._starListeners.push(b):(this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].push(b));return this};f.prototype.prependListener=
function(a,b){e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.prependListener: eventName should be type string or symbol");e.equal(typeof b,"function","nanobus.prependListener: listener should be type function");"*"===a?this._starListeners.unshift(b):(this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].unshift(b));return this};f.prototype.once=function(a,b){function f(){b.apply(k,arguments);k.removeListener(a,f)}e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.once: eventName should be type string or symbol");
e.equal(typeof b,"function","nanobus.once: listener should be type function");var k=this;this.on(a,f);return this};f.prototype.prependOnceListener=function(a,b){function f(){b.apply(k,arguments);k.removeListener(a,f)}e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.prependOnceListener: eventName should be type string or symbol");e.equal(typeof b,"function","nanobus.prependOnceListener: listener should be type function");var k=this;this.prependListener(a,f);return this};f.prototype.removeListener=
function(a,b){function f(a,b){if(a&&(b=a.indexOf(b),-1!==b))return q(a,b,1),!0}e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.removeListener: eventName should be type string or symbol");e.equal(typeof b,"function","nanobus.removeListener: listener should be type function");if("*"===a)return this._starListeners=this._starListeners.slice(),f(this._starListeners,b);"undefined"!==typeof this._listeners[a]&&(this._listeners[a]=this._listeners[a].slice());return f(this._listeners[a],b)};f.prototype.removeAllListeners=
function(a){a?"*"===a?this._starListeners=[]:this._listeners[a]=[]:(this._starListeners=[],this._listeners={});return this};f.prototype.listeners=function(a){a="*"!==a?this._listeners[a]:this._starListeners;var b=[];if(a)for(var e=a.length,f=0;f<e;f++)b.push(a[f]);return b};f.prototype._emit=function(a,b,e,f){if("undefined"!==typeof a&&0!==a.length)for(void 0===e&&(e=b,b=null),b&&(e=void 0!==f?[b].concat(e,f):[b].concat(e)),b=a.length,f=0;f<b;f++){var d=a[f];d.apply(d,e)}}},function(l,r,p){Object.defineProperty(r,
"__esModule",{value:!0});l=p(0);var f=p(11),q=p(4),k=p(14),e=p(15),a=p(28),b=p(68),h=p(1);h=p.n(h);var x=p(69),d=p(78),u=p(79);u=p.n(u);p(80);h.a.csp_enabled||p(82);p={Logger:l.a,clientDiagnostics:x.a.clientDiagnostics,clientBitrate:x.a.clientBitrate,appData:d.a,audience:u.a,EnxRoom:f.a.bind(null,void 0,void 0),Event:q.b,RoomEvent:q.e,StreamEvent:q.f,EnxStream:k.a.bind(null,void 0),VideoPlayer:a.a,ViewProperties:e.a,isSupported:h.a.is_supported,version:h.a.product.version,getDevices:b.a.getDevice,
switchMediaDevice:b.a.switchMediaDevice,notifyDeviceUpdate:b.a.notifyDeviceUpdate,joinRoom:b.a.joinRoom,listParticipants:b.a.listParticipants,getRoom:b.a.getRoom,browserInfo:h.a.browser_info};r["default"]=p},function(l,r,p){!function(f,q){l.exports=q()}(this,function(){var f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,q=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,k=function(a,b,d){var e=String(a);return!e||
e.length>=b?a:""+Array(b+1-e.length).join(d)+a},e={s:k,z:function(a){a=-a.utcOffset();var b=Math.abs(a),d=b%60;return(0>=a?"+":"-")+k(Math.floor(b/60),2,"0")+":"+k(d,2,"0")},m:function v(a,b){if(a.date()<b.date())return-v(b,a);var d=12*(b.year()-a.year())+(b.month()-a.month()),e=a.clone().add(d,"month"),f=0>b-e;a=a.clone().add(d+(f?-1:1),"month");return+(-(d+(b-e)/(f?e-a:a-e))||0)},a:function(a){return 0>a?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:"month",y:"year",w:"week",d:"day",D:"date",
h:"hour",m:"minute",s:"second",ms:"millisecond",Q:"quarter"}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return void 0===a}},a="en",b={};b[a]={name:"en",weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),months:"January February March April May June July August September October November December".split(" "),ordinal:function(a){var b=["th","st","nd","rd"],d=a%100;return"["+a+(b[(d-20)%10]||b[d]||b[0])+"]"}};var h=function(a){return a instanceof u},l=
function G(d,e,f){var h;if(!d)return a;if("string"==typeof d){var k=d.toLowerCase();b[k]&&(h=k);e&&(b[k]=e,h=k);d=d.split("-");if(!h&&1<d.length)return G(d[0])}else h=d.name,b[h]=d;return!f&&h&&(a=h),h||!f&&a},d=function(a,b){if(h(a))return a.clone();var d="object"==typeof b?b:{};return d.date=a,d.args=arguments,new u(d)};e.l=l;e.i=h;e.w=function(a,b){return d(a,{locale:b.$L,utc:b.$u,x:b.$x,$offset:b.$offset})};var u=function(){function a(a){this.$L=l(a.locale,null,!0);this.parse(a)}var h=a.prototype;
return h.parse=function(a){this.$d=function(a){var b=a.date;a=a.utc;if(null===b)return new Date(NaN);if(e.u(b))return new Date;if(b instanceof Date)return new Date(b);if("string"==typeof b&&!/Z$/i.test(b)){var d=b.match(f);if(d){b=d[2]-1||0;var c=(d[7]||"0").substring(0,3);return a?new Date(Date.UTC(d[1],b,d[3]||1,d[4]||0,d[5]||0,d[6]||0,c)):new Date(d[1],b,d[3]||1,d[4]||0,d[5]||0,d[6]||0,c)}}return new Date(b)}(a);this.$x=a.x||{};this.init()},h.init=function(){var a=this.$d;this.$y=a.getFullYear();
this.$M=a.getMonth();this.$D=a.getDate();this.$W=a.getDay();this.$H=a.getHours();this.$m=a.getMinutes();this.$s=a.getSeconds();this.$ms=a.getMilliseconds()},h.$utils=function(){return e},h.isValid=function(){return"Invalid Date"!==this.$d.toString()},h.isSame=function(a,b){a=d(a);return this.startOf(b)<=a&&a<=this.endOf(b)},h.isAfter=function(a,b){return d(a)<this.startOf(b)},h.isBefore=function(a,b){return this.endOf(b)<d(a)},h.$g=function(a,b,d){return e.u(a)?this[b]:this.set(d,a)},h.unix=function(){return Math.floor(this.valueOf()/
1E3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(a,b){var d=this,f=!!e.u(b)||b,c=e.p(a);a=function(a,c){a=e.w(d.$u?Date.UTC(d.$y,c,a):new Date(d.$y,c,a),d);return f?a:a.endOf("day")};var h=function(a,c){return e.w(d.toDate()[a].apply(d.toDate("s"),(f?[0,0,0,0]:[23,59,59,999]).slice(c)),d)},k=this.$W;b=this.$M;var n=this.$D,u="set"+(this.$u?"UTC":"");switch(c){case "year":return f?a(1,0):a(31,11);case "month":return f?a(1,b):a(0,b+1);case "week":return c=this.$locale().weekStart||
0,k=(k<c?k+7:k)-c,a(f?n-k:n+(6-k),b);case "day":case "date":return h(u+"Hours",0);case "hour":return h(u+"Minutes",1);case "minute":return h(u+"Seconds",2);case "second":return h(u+"Milliseconds",3);default:return this.clone()}},h.endOf=function(a){return this.startOf(a,!1)},h.$set=function(a,b){var d;a=e.p(a);var f="set"+(this.$u?"UTC":"");f=(d={},d.day=f+"Date",d.date=f+"Date",d.month=f+"Month",d.year=f+"FullYear",d.hour=f+"Hours",d.minute=f+"Minutes",d.second=f+"Seconds",d.millisecond=f+"Milliseconds",
d)[a];b="day"===a?this.$D+(b-this.$W):b;"month"===a||"year"===a?(d=this.clone().set("date",1),d.$d[f](b),d.init(),this.$d=d.set("date",Math.min(this.$D,d.daysInMonth())).$d):f&&this.$d[f](b);return this.init(),this},h.set=function(a,b){return this.clone().$set(a,b)},h.get=function(a){return this[e.p(a)]()},h.add=function(a,b){var f,h=this;a=Number(a);b=e.p(b);var c=function(c){var b=d(h);return e.w(b.date(b.date()+Math.round(c*a)),h)};if("month"===b)return this.set("month",this.$M+a);if("year"===
b)return this.set("year",this.$y+a);if("day"===b)return c(1);if("week"===b)return c(7);b=(f={},f.minute=6E4,f.hour=36E5,f.second=1E3,f)[b]||1;f=this.$d.getTime()+a*b;return e.w(f,this)},h.subtract=function(a,b){return this.add(-1*a,b)},h.format=function(a){var b=this,d=this.$locale();if(!this.isValid())return d.invalidDate||"Invalid Date";var f=a||"YYYY-MM-DDTHH:mm:ssZ",c=e.z(this);a=this.$H;var h=this.$m,k=this.$M,n=d.weekdays,u=d.months,t=function(a,c,d,e){return a&&(a[c]||a(b,f))||d[c].slice(0,
e)},l=d.meridiem||function(a,c,b){a=12>a?"AM":"PM";return b?a.toLowerCase():a},v={YY:String(this.$y).slice(-2),YYYY:this.$y,M:k+1,MM:e.s(k+1,2,"0"),MMM:t(d.monthsShort,k,u,3),MMMM:t(u,k),D:this.$D,DD:e.s(this.$D,2,"0"),d:String(this.$W),dd:t(d.weekdaysMin,this.$W,n,2),ddd:t(d.weekdaysShort,this.$W,n,3),dddd:n[this.$W],H:String(a),HH:e.s(a,2,"0"),h:e.s(a%12||12,1,"0"),hh:e.s(a%12||12,2,"0"),a:l(a,h,!0),A:l(a,h,!1),m:String(h),mm:e.s(h,2,"0"),s:String(this.$s),ss:e.s(this.$s,2,"0"),SSS:e.s(this.$ms,
3,"0"),Z:c};return f.replace(q,function(a,b){return b||v[a]||c.replace(":","")})},h.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},h.diff=function(a,b,f){var h;b=e.p(b);var c=d(a);a=6E4*(c.utcOffset()-this.utcOffset());var k=this-c;c=e.m(this,c);return c=(h={},h.year=c/12,h.month=c,h.quarter=c/3,h.week=(k-a)/6048E5,h.day=(k-a)/864E5,h.hour=k/36E5,h.minute=k/6E4,h.second=k/1E3,h)[b]||k,f?c:e.a(c)},h.daysInMonth=function(){return this.endOf("month").$D},h.$locale=function(){return b[this.$L]},
h.locale=function(a,b){if(!a)return this.$L;var d=this.clone();a=l(a,b,!0);return a&&(d.$L=a),d},h.clone=function(){return e.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},a}(),n=u.prototype;return d.prototype=n,[["$ms","millisecond"],["$s","second"],["$m","minute"],["$H","hour"],["$W","day"],["$M","month"],
["$y","year"],["$D","date"]].forEach(function(a){n[a[1]]=function(b){return this.$g(b,a[0],a[1])}}),d.extend=function(a,b){return a.$i||(a(b,u,d),a.$i=!0),d},d.locale=l,d.isDayjs=h,d.unix=function(a){return d(1E3*a)},d.en=b[a],d.Ls=b,d.p={},d})},function(l,r,p){(function(f){function q(a,b){for(var e=0,f=a.length-1;0<=f;f--){var d=a[f];"."===d?a.splice(f,1):".."===d?(a.splice(f,1),e++):e&&(a.splice(f,1),e--)}if(b)for(;e--;e)a.unshift("..");return a}function k(a,b){if(a.filter)return a.filter(b);for(var e=
[],f=0;f<a.length;f++)b(a[f],f,a)&&e.push(a[f]);return e}r.resolve=function(){for(var a="",b=!1,e=arguments.length-1;-1<=e&&!b;e--){var l=0<=e?arguments[e]:f.cwd();if("string"!==typeof l)throw new TypeError("Arguments to path.resolve must be strings");l&&(a=l+"/"+a,b="/"===l.charAt(0))}a=q(k(a.split("/"),function(a){return!!a}),!b).join("/");return(b?"/":"")+a||"."};r.normalize=function(a){var b=r.isAbsolute(a),f="/"===e(a,-1);(a=q(k(a.split("/"),function(a){return!!a}),!b).join("/"))||b||(a=".");
a&&f&&(a+="/");return(b?"/":"")+a};r.isAbsolute=function(a){return"/"===a.charAt(0)};r.join=function(){var a=Array.prototype.slice.call(arguments,0);return r.normalize(k(a,function(a,e){if("string"!==typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))};r.relative=function(a,b){function e(a){for(var b=0;b<a.length&&""===a[b];b++);for(var d=a.length-1;0<=d&&""===a[d];d--);return b>d?[]:a.slice(b,d-b+1)}a=r.resolve(a).substr(1);b=r.resolve(b).substr(1);a=e(a.split("/"));
b=e(b.split("/"));for(var f=Math.min(a.length,b.length),d=f,k=0;k<f;k++)if(a[k]!==b[k]){d=k;break}f=[];for(k=d;k<a.length;k++)f.push("..");f=f.concat(b.slice(d));return f.join("/")};r.sep="/";r.delimiter=":";r.dirname=function(a){"string"!==typeof a&&(a+="");if(0===a.length)return".";for(var b=a.charCodeAt(0),e=47===b,f=-1,d=!0,k=a.length-1;1<=k;--k)if(b=a.charCodeAt(k),47===b){if(!d){f=k;break}}else d=!1;return-1===f?e?"/":".":e&&1===f?"/":a.slice(0,f)};r.basename=function(a,b){"string"!==typeof a&&
(a+="");var e=0,f=-1,d=!0,k;for(k=a.length-1;0<=k;--k)if(47===a.charCodeAt(k)){if(!d){e=k+1;break}}else-1===f&&(d=!1,f=k+1);a=-1===f?"":a.slice(e,f);b&&a.substr(-1*b.length)===b&&(a=a.substr(0,a.length-b.length));return a};r.extname=function(a){"string"!==typeof a&&(a+="");for(var b=-1,e=0,f=-1,d=!0,k=0,n=a.length-1;0<=n;--n){var q=a.charCodeAt(n);if(47===q){if(!d){e=n+1;break}}else-1===f&&(d=!1,f=n+1),46===q?-1===b?b=n:1!==k&&(k=1):-1!==b&&(k=-1)}return-1===b||-1===f||0===k||1===k&&b===f-1&&b===
e+1?"":a.slice(b,f)};var e="b"==="ab".substr(-1)?function(a,b,e){return a.substr(b,e)}:function(a,b,e){0>b&&(b=a.length+b);return a.substr(b,e)}}).call(r,p(24))},function(l,r){l.exports=function(l){if(!l.webpackPolyfill){var f=Object.create(l);f.children||(f.children=[]);Object.defineProperty(f,"loaded",{enumerable:!0,get:function(){return f.l}});Object.defineProperty(f,"id",{enumerable:!0,get:function(){return f.i}});Object.defineProperty(f,"exports",{enumerable:!0});f.webpackPolyfill=1}return f}},
function(l,r,p){var f=p(25),q=p(26),k=p(0);r.a=function(e){k.a.info("Starting Chrome stable stack",e);var a=Object(f.a)(e);a.enableSimulcast=function(b){var f=b;if(!e.video||!e.simulcast)return f;a.simulcast=e.simulcast;b=f.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/);if(!b||0>=b.length)return f;var d=e.simulcast.numSpatialLayers||2;var h=parseInt(b[1],10),k=parseInt(b[2],10),l=f.match(new RegExp("a=ssrc:"+b[1]+" cname:(.*)\r?\n"))[1],w=f.match(new RegExp("a=ssrc:"+b[1]+" msid:(.*)\r?\n"))[1],
t=f.match(new RegExp("a=ssrc:"+b[1]+" mslabel:(.*)\r?\n"))[1],v=f.match(new RegExp("a=ssrc:"+b[1]+" label:(.*)\r?\n"))[1];f.match(new RegExp("a=ssrc:"+b[1]+".*\r?\n","g")).forEach(function(a){f=f.replace(a,"")});f.match(new RegExp("a=ssrc:"+b[2]+".*\r?\n","g")).forEach(function(a){f=f.replace(a,"")});for(var p=[h],r=[k],A=1;A<d;A+=1)p.push(h+1E3*A),r.push(k+1E3*A);d=q.a.addSim(p);for(A=0;A<p.length;A+=1)h=p[A],k=r[A],d+=q.a.addGroup(h,k);for(A=0;A<p.length;A+=1)h=p[A],k=r[A],d+=q.a.addSpatialLayer(l,
w,t,v,h,k);return f.replace(b[0],d+"a=x-google-flag:conference\r\n")};var b=function(b){if("function"!==typeof b.getParameters||"function"!==typeof b.setParameters)k.a.warning("Cannot set simulcast layers bitrate: getParameters or setParameters is not available");else{var e=b.getParameters();Object.keys(a.simulcast.spatialLayerBitrates).forEach(function(b){void 0!==e.encodings[b]&&(k.a.error("Setting bitrate for layer "+b+", bps: "+a.simulcast.spatialLayerBitrates[b]),e.encodings[b].maxBitrate=a.simulcast.spatialLayerBitrates[b],
console.log("setting bitrate for layer "+b+" bitratebps: "+JSON.stringify(a.simulcast.spatialLayerBitrates[b])))});b.setParameters(e).then(function(a){k.a.info("Success setting simulcast layer bitrates",a)}).catch(function(a){k.a.warning("Error setting simulcast layer bitrates",a)})}};a.setSimulcastLayersBitrate=function(){a.simulcast&&a.simulcast.spatialLayerBitrates&&a.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&b(a)})};a.setStartVideoBW=function(b){a.video&&e.startVideoBW&&
(k.a.debug("startVideoBW requested: "+e.startVideoBW),q.a.setParamForCodecs(b,"video","x-google-start-bitrate",e.startVideoBW))};a.setHardMinVideoBW=function(b){a.video&&e.hardMinVideoBW&&(k.a.debug("hardMinVideoBW requested: "+e.hardMinVideoBW),q.a.setParamForCodecs(b,"video","x-google-min-bitrate",e.hardMinVideoBW))};return a}},function(l,r,p){var f=p(0),q=p(25);r.a=function(k){f.a.info("Starting Firefox stack");var e=Object(q.a)(k);e.enableSimulcast=function(a){if(!k.video||!k.simulcast)return a;
e.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&(a.getParameters(),a.setParameters({encodings:[{rid:"spam",active:!0,priority:"high",maxBitrate:4E4,maxHeight:640,maxWidth:480},{rid:"egg",active:!0,priority:"medium",maxBitrate:1E4,maxHeight:320,maxWidth:240}]}))});return a};return e}},function(l,r,p){var f=p(0);r.a=function(q){var k={pcConfig:{},peerConnection:{},desc:{},signalCallback:void 0,close:function(){f.a.info("Close FcStack")},createOffer:function(){f.a.debug("FCSTACK: CreateOffer")},
addStream:function(e){f.a.debug("FCSTACK: addStream",e)},addTrack:function(e){f.a.debug("FCSTACK: addTrack",stream)},processSignalingMessage:function(e){f.a.debug("FCSTACK: processSignaling",e);void 0!==k.signalCallback&&k.signalCallback(e)},sendSignalingMessage:function(e){f.a.debug("FCSTACK: Sending signaling Message",e);q.callback(e)},setSignalingCallback:function(e){e=void 0===e?function(){}:e;f.a.debug("FCSTACK: Setting signalling callback");k.signalCallback=e}};return k}},function(l,r,p){p.d(r,
"a",function(){return d});var f=p(5),q=p(41),k=p(0),e=p(8),a=p(9),b=p(6),h=p(4),x=function(a,b){a=Object(h.b)({type:a});a.args=b.args;return a},d=function(d){var n=Object(h.c)(),u=function(){},l=[];$jscomp.initSymbol();n.CONNECTING=Symbol("connecting");$jscomp.initSymbol();n.CONNECTED=Symbol("connected");$jscomp.initSymbol();n.RECONNECTING=Symbol("reconnecting");$jscomp.initSymbol();n.DISCONNECTED=Symbol("disconnected");n.state=n.DISCONNECTED;n.IO=void 0===d?q.a:d;var t,v=function(a,b){for(var d=
[],c=1;c<arguments.length;++c)d[c-1]=arguments[c];n.emit(x(a,{args:d}))},p=function(){k.a.info("execute buffer");n.state===n.CONNECTED&&l.forEach(function(a){n.sendMessage.apply(n,$jscomp.arrayFromIterable(a))})};n.connect=function(d,h,q){h=void 0===h?u:h;q=void 0===q?u:q;var c={timeout:3E4,reconnection:!1,path:"/v3/socket.io/",secure:d.secure,forceNew:!0,allowEIO4:!0,transports:["websocket"],rejectUnauthorized:!0},l="https:"==window.location.protocol?"wss://":"ws://",w=d.host;void 0==d.gateway||
null==d.gateway||""==d.gateway?w=d.host:(w=d.gateway,c.query="X-Forwarded-Host="+d.host);k.a.info("Connecting socket with option:- "+JSON.stringify(c));console.log("Connecting socket with host:- "+w);n.state=n.CONNECTING;t=n.IO.connect(l+w,c);var x=t.io.engine.transport.ws.onclose;t.io.engine.transport.ws.onclose=function(a){k.a.warning("WebSocket closed, code:",a.code);x(a);v(f.a.SocketEvent.error);n.state==n.CONNECTING&&h(b.a.error_1161);n.state=n.DISCONNECTED};t.io.engine.transport.ws.onerror=
function(a){};n.socket=t;t.on(f.a.UserEvent.user_awaited,v.bind(n,f.a.UserEvent.user_awaited));t.on(f.a.UserEvent.user_joined,v.bind(n,f.a.UserEvent.user_joined));t.on(f.a.RoomEvent.room_connected,v.bind(n,f.a.RoomEvent.room_connected));t.on(f.a.RoomEvent.room_disconnected,v.bind(n,f.a.RoomEvent.room_disconnected));t.on(f.a.RoomEvent.new_active_talker,v.bind(n,f.a.RoomEvent.new_active_talker));t.on(f.a.SocketEvent.onAddStream,v.bind(n,f.a.SocketEvent.onAddStream));t.on(f.a.SocketEvent.signaling_message_peer,
v.bind(n,f.a.SocketEvent.signaling_message_peer));t.on(f.a.SocketEvent.publish_me,v.bind(n,f.a.SocketEvent.publish_me));t.on(f.a.SocketEvent.unpublish_me,v.bind(n,f.a.SocketEvent.unpublish_me));t.on(f.a.SocketEvent.onBandwidthAlert,v.bind(n,f.a.SocketEvent.onBandwidthAlert));t.on(f.a.SocketEvent.onBandwidthEvents,v.bind(n,f.a.SocketEvent.onBandwidthEvents));t.on(f.a.SocketEvent.onSelfBandwidthAlert,v.bind(n,f.a.SocketEvent.onSelfBandwidthAlert));t.on(f.a.SocketEvent.onRemoveTrack,v.bind(n,f.a.SocketEvent.onRemoveTrack));
t.on(f.a.SocketEvent.onDataStream,v.bind(n,f.a.SocketEvent.onDataStream));t.on(f.a.RoomEvent.room_awaited,v.bind(n,f.a.RoomEvent.room_awaited));t.on(f.a.RoomEvent.room_record_on,v.bind(n,f.a.RoomEvent.room_record_on));t.on(f.a.RoomEvent.room_record_off,v.bind(n,f.a.RoomEvent.room_record_off));t.on(f.a.RoomEvent.hard_mute_audio,v.bind(n,f.a.RoomEvent.hard_mute_audio));t.on(f.a.RoomEvent.hard_unmute_audio,v.bind(n,f.a.RoomEvent.hard_unmute_audio));t.on(f.a.RoomEvent.hard_mute_video,v.bind(n,f.a.RoomEvent.hard_mute_video));
t.on(f.a.RoomEvent.hard_unmute_video,v.bind(n,f.a.RoomEvent.hard_unmute_video));t.on(f.a.RoomEvent.share_started,v.bind(n,f.a.RoomEvent.share_started));t.on(f.a.RoomEvent.share_stopped,v.bind(n,f.a.RoomEvent.share_stopped));t.on(f.a.RoomEvent.screen_share_override,v.bind(n,f.a.RoomEvent.screen_share_override));t.on(f.a.RoomEvent.stop_sharing,v.bind(n,f.a.RoomEvent.stop_sharing));t.on(f.a.RoomEvent.update_layout,v.bind(n,f.a.RoomEvent.update_layout));t.on(f.a.RoomEvent.custom_data_saved,v.bind(n,f.a.RoomEvent.custom_data_saved));
t.on(f.a.RoomEvent.custom_data_updated,v.bind(n,f.a.RoomEvent.custom_data_updated));t.on(f.a.RoomEvent.streaming_uri,v.bind(n,f.a.RoomEvent.streaming_uri));t.on(f.a.RoomEvent.canvas_started,v.bind(n,f.a.RoomEvent.canvas_started));t.on(f.a.RoomEvent.canvas_stopped,v.bind(n,f.a.RoomEvent.canvas_stopped));t.on(f.a.RoomEvent.invite_breakout_room,v.bind(n,f.a.RoomEvent.invite_breakout_room));t.on(f.a.RoomEvent.user_joined_breakout_room,v.bind(n,f.a.RoomEvent.user_joined_breakout_room));t.on(f.a.RoomEvent.user_left_breakout_room,
v.bind(n,f.a.RoomEvent.user_left_breakout_room));t.on(f.a.RoomEvent.breakout_room_destroyed,v.bind(n,f.a.RoomEvent.breakout_room_destroyed));t.on(f.a.RoomEvent.transcription_events,v.bind(n,f.a.RoomEvent.transcription_events));t.on(f.a.SocketEvent.dial_state_events,v.bind(n,f.a.SocketEvent.dial_state_events));t.on(f.a.UserEvent.user_audio_muted,v.bind(n,f.a.UserEvent.user_audio_muted));t.on(f.a.UserEvent.user_audio_unmuted,v.bind(n,f.a.UserEvent.user_audio_unmuted));t.on(f.a.UserEvent.user_video_muted,
v.bind(n,f.a.UserEvent.user_video_muted));t.on(f.a.UserEvent.user_video_unmuted,v.bind(n,f.a.UserEvent.user_video_unmuted));t.on(f.a.SocketEvent.media_engine_connecting,v.bind(n,f.a.SocketEvent.media_engine_connecting));t.on(f.a.SocketEvent.onUpdateAttributeStream,v.bind(n,f.a.SocketEvent.onUpdateAttributeStream));t.on(f.a.SocketEvent.onRemoveStream,v.bind(n,f.a.SocketEvent.onRemoveStream));t.on(f.a.SocketEvent.user_connected,v.bind(n,f.a.SocketEvent.user_connected));t.on(f.a.SocketEvent.user_updated,
v.bind(n,f.a.SocketEvent.user_updated));t.on(f.a.SocketEvent.user_disconnected,v.bind(n,f.a.SocketEvent.user_disconnected));t.on(f.a.SocketEvent.user_subscribed,v.bind(n,f.a.SocketEvent.user_subscribed));t.on(f.a.SocketEvent.floor_requested,v.bind(n,f.a.SocketEvent.floor_requested));t.on(f.a.SocketEvent.floor_granted,v.bind(n,f.a.SocketEvent.floor_granted));t.on(f.a.SocketEvent.floor_not_granted,v.bind(n,f.a.SocketEvent.floor_not_granted));t.on(f.a.SocketEvent.floor_released,v.bind(n,f.a.SocketEvent.floor_released));
t.on(f.a.SocketEvent.hard_mute,v.bind(n,f.a.SocketEvent.hard_mute));t.on(f.a.SocketEvent.hard_mute_room,v.bind(n,f.a.SocketEvent.hard_mute_room));t.on(f.a.SocketEvent.hard_unmute_room,v.bind(n,f.a.SocketEvent.hard_unmute_room));t.on(f.a.SocketEvent.switched_room,v.bind(n,f.a.SocketEvent.switched_room));t.on(f.a.SocketEvent.data_stream_room,v.bind(n,f.a.SocketEvent.data_stream_room));t.on(f.a.RoomEvent.user_role_changed,v.bind(n,f.a.RoomEvent.user_role_changed));t.on(f.a.SocketEvent.onStatSubscription,
v.bind(n,f.a.SocketEvent.onStatSubscription));t.on(f.a.SocketEvent.onStreamingNotification,v.bind(n,f.a.SocketEvent.onStreamingNotification));t.on(f.a.SocketEvent.onHlsStreamingNotification,v.bind(n,f.a.SocketEvent.onHlsStreamingNotification));t.on(f.a.SocketEvent.onHlsStreamingNotificationToPublisher,v.bind(n,f.a.SocketEvent.onHlsStreamingNotificationToPublisher));t.on(f.a.SocketEvent.onLiveRecordingNotification,v.bind(n,f.a.SocketEvent.onLiveRecordingNotification));t.on(f.a.SocketEvent.onRoomLiveRecordingOn,
v.bind(n,f.a.SocketEvent.onRoomLiveRecordingOn));t.on(f.a.SocketEvent.onRoomLiveRecordingOff,v.bind(n,f.a.SocketEvent.onRoomLiveRecordingOff));t.on(f.a.SocketEvent.onRoomLiveRecordingFailed,v.bind(n,f.a.SocketEvent.onRoomLiveRecordingFailed));t.on(f.a.RoomEvent.switch_codec,v.bind(n,f.a.RoomEvent.switch_codec));t.on(f.a.RoomEvent.generic_events,v.bind(n,f.a.RoomEvent.generic_events));t.on(f.a.SocketEvent.room_management_events,v.bind(n,f.a.SocketEvent.room_management_events));t.on(f.a.SocketEvent.floor_management_events,
v.bind(n,f.a.SocketEvent.floor_management_events));t.on(f.a.RoomEvent.room_transcription_on,v.bind(n,f.a.RoomEvent.room_transcription_on));t.on(f.a.RoomEvent.room_transcription_on,v.bind(n,f.a.RoomEvent.room_transcription_on));t.on(f.a.RoomEvent.room_transcription_off,v.bind(n,f.a.RoomEvent.room_transcription_off));t.on(f.a.RoomEvent.self_transcription_on,v.bind(n,f.a.RoomEvent.self_transcription_on));t.on(f.a.RoomEvent.self_transcription_off,v.bind(n,f.a.RoomEvent.self_transcription_off));t.on(f.a.SocketEvent.disconnect,
function(a){k.a.debug(f.a.SocketEvent.disconnect,n.id,a);t.close();v(f.a.SocketEvent.disconnect,a)});t.on(f.a.SocketEvent.connect_timeout,function(a){k.a.warning(f.a.SocketEvent.connect_timeout+", id:",n.id,", error:",a.message);t.close();v(f.a.SocketEvent.disconnect,a.message)});t.on(f.a.SocketEvent.connection_failed,function(){k.a.error(f.a.SocketEvent.connection_failed+", id:",n.id);v(f.a.SocketEvent.connection_failed,{streamId:n.id})});t.on(f.a.SocketEvent.connect_error,function(a){k.a.warning(f.a.SocketEvent.connect_error+
", id:",n.id,", error:",a.message)});t.on(f.a.SocketEvent.error,function(a){k.a.warning(f.a.SocketEvent.error+", id:",n.id,", error:",a.message);v(f.a.SocketEvent.error)});t.on(f.a.SocketEvent.reconnecting,function(a){k.a.debug(f.a.SocketEvent.reconnecting+", id:",n.id,", attempt:",a)});t.on(f.a.SocketEvent.reconnect,function(c){k.a.debug(f.a.SocketEvent.reconnected+", id:",n.id,", attempt:",c);n.state=n.CONNECTED;t.emit(f.a.SocketEvent.reconnected,n.id);a.a.info("socket-event",e.a.event_reconnect_socket_success,
{error:{}});p()});t.on(f.a.SocketEvent.reconnect_attempt,function(a){k.a.debug(f.a.SocketEvent.reconnect_attempt+", id:",n.id,", attempt:",a)});t.on(f.a.SocketEvent.reconnect_failed,function(){k.a.warning(f.a.SocketEvent.reconnect_failed+", id:",n.id);n.state=n.DISCONNECTED;v(f.a.SocketEvent.disconnect,f.a.SocketEvent.reconnect_failed);a.a.error("socket-event",e.a.event_reconnect_socket_failed,{error:{}})});t.on(f.a.SocketEvent.reconnect_error,function(a){k.a.debug(f.a.SocketEvent.reconnect_error+
", id:",n.id,", error:",a.message)});n.sendMessage("token",d,function(a){n.state=n.CONNECTED;n.id=a.clientId;h(a)},q)};n.disconnect=function(){k.a.debug("socket js disconnect the socket");n.state=n.DISCONNECTED;t.disconnect()};n.sendMessage=function(d,f,h,c){h=void 0===h?u:h;c=void 0===c?u:c;n.state===n.DISCONNECTED&&"token"!==d?(k.a.error("Trying to send a message over a disconnected Socket"),h(b.a.error_1163)):n.state===n.RECONNECTING?(k.a.debug("sendmessage socket state is reconnecting"),l.push([d,
f,h,c]),h(b.a.error_1164)):f?t.emit(d,f,function(f,n){"success"===f?h(n):"error"===f?(a.a.error("socket-event",e.a.event_send_message_failed,{type:d,respType:f,resp:n}),c(n)):void 0!=n&&null!=n||void 0==f||!0!==f&&("object"!=typeof f||void 0==f.result||f.result!=b.a.error_000.result)&&void 0==f.status?(k.a.debug(" sendMessage() not sucess : respType: "+JSON.stringify(f)+" resp: "+JSON.stringify(n)),h(void 0==n?f:n)):(k.a.debug(" sendMessage() resp undefined but respType has result with sucees: "+
JSON.stringify(f)),h(f))}):c(b.a.error_1155)};n.sendSDP=function(b,d,f,c){c=void 0===c?u:c;n.state===n.DISCONNECTED?(k.a.error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",e.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):t.emit(b,d,f,function(a,b){c(a,b)})};n.emitEvent=function(b,d,f){f=void 0===f?u:f;n.state===n.DISCONNECTED?(k.a.error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",e.a.event_send_message_failed,
{error:"Trying to send a message over a disconnected Socket"})):t.emit(b,d,function(a,b){f(a,b)})};n.sendEvent=function(b,d){d=void 0===d?u:d;n.state===n.DISCONNECTED?(k.a.error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",e.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):t.emit(b,function(a){d(a)})};n.sendParamEvent=function(b,d,f){f=void 0===f?u:f;n.state===n.DISCONNECTED?(k.a.error("Trying to send a message over a disconnected Socket"),
a.a.info("socket-event",e.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):t.emit(b,d,function(a){f(a)})};return n}},function(l,r,p){function f(a){a=a.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!a||F))return new XMLHttpRequest}catch(Ea){}if(!a)try{return new (c[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(Ea){}}function q(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];return b.reduce(function(c,b){return a.hasOwnProperty(b)&&
(c[b]=a[b]),c},{})}function k(a,b){b.useNativeTimers?(a.setTimeoutFn=Q.bind(c),a.clearTimeoutFn=z.bind(c)):(a.setTimeoutFn=setTimeout.bind(c),a.clearTimeoutFn=clearTimeout.bind(c))}function e(a){if(a){for(var c in e.prototype)a[c]=e.prototype[c];return a}}function a(a){var c="";do c=y[a%64]+c,a=Math.floor(a/64);while(0<a);return c}function b(){var c=a(+new Date);return c!==O?(ia=0,O=c):c+"."+a(ia++)}function h(){}function x(){for(var a in aa.requests)aa.requests.hasOwnProperty(a)&&aa.requests[a].abort()}
function d(a){var c;if(c=ma)(c=a instanceof ArrayBuffer)||(c="function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):a.buffer instanceof ArrayBuffer);return c||Z&&a instanceof Blob||ra&&a instanceof File}function u(a,c){if(!a||"object"!=typeof a)return!1;if(Array.isArray(a)){for(var b=0,e=a.length;b<e;b++)if(u(a[b]))return!0;return!1}if(d(a))return!0;if(a.toJSON&&"function"==typeof a.toJSON&&1===arguments.length)return u(a.toJSON(),!0);for(b in a)if(Object.prototype.hasOwnProperty.call(a,b)&&
u(a[b]))return!0;return!1}function n(a,c){if(!a)return a;if(d(a)){var b={_placeholder:!0,num:c.length};return c.push(a),b}if(Array.isArray(a)){b=Array(a.length);for(var e=0;e<a.length;e++)b[e]=n(a[e],c);return b}if("object"==typeof a&&!(a instanceof Date)){b={};for(e in a)a.hasOwnProperty(e)&&(b[e]=n(a[e],c));return b}return a}function B(a,c){if(!a)return a;if(a&&a._placeholder)return c[a.num];if(Array.isArray(a))for(var b=0;b<a.length;b++)a[b]=B(a[b],c);else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&
(a[b]=B(a[b],c));return a}function w(a,c,b){return a.on(c,b),function(){a.off(c,b)}}function t(a){a=a||{};this.ms=a.min||100;this.max=a.max||1E4;this.factor=a.factor||2;this.jitter=0<a.jitter&&1>=a.jitter?a.jitter:0;this.attempts=0}function v(a,c){"object"==typeof a&&(c=a,a=void 0);var b=a;a=(c=c||{}).path||"/socket.io";a=void 0===a?"":a;var d=b;var e="undefined"!=typeof location&&location;null==b&&(b=e.protocol+"//"+e.host);"string"==typeof b&&("/"===b.charAt(0)&&(b="/"===b.charAt(1)?e.protocol+
b:e.host+b),/^(https?|wss?):\/\//.test(b)||(b=void 0!==e?e.protocol+"//"+b:"https://"+b),d=A(b));d.port||(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443"));d.path=d.path||"/";b=-1!==d.host.indexOf(":")?"["+d.host+"]":d.host;a=(d.id=d.protocol+"://"+b+":"+d.port+a,d.href=d.protocol+"://"+b+(e&&e.port===d.port?"":":"+d.port),d);e=a.source;d=a.id;b=a.path;b=wa[d]&&b in wa[d].nsps;var g;return c.forceNew||c["force new connection"]||!1===c.multiplex||b?g=new Y(e,
c):(wa[d]||(wa[d]=new Y(e,c)),g=wa[d]),a.query&&!c.query&&(c.query=a.queryKey),g.socket(a.path,c)}p.d(r,"a",function(){return v});var D=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,G="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),A=function(a){var c=
a,b=a.indexOf("["),d=a.indexOf("]");-1!=b&&-1!=d&&(a=a.substring(0,b)+a.substring(b,d).replace(/:/g,";")+a.substring(d,a.length));var e,g;a=D.exec(a||"");for(var f={},h=14;h--;)f[G[h]]=a[h]||"";return-1!=b&&-1!=d&&(f.source=c,f.host=f.host.substring(1,f.host.length-1).replace(/;/g,":"),f.authority=f.authority.replace("[","").replace("]","").replace(/;/g,":"),f.ipv6uri=!0),f.pathNames=function(a,c){a=c.replace(/\/{2,9}/g,"/").split("/");"/"!=c.substr(0,1)&&0!==c.length||a.splice(0,1);"/"==c.substr(c.length-
1,1)&&a.splice(a.length-1,1);return a}(0,f.path),f.queryKey=(e=f.query,g={},e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,c,b){c&&(g[c]=b)}),g),f};l={};try{l="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(ka){l=!1}var F=l,c="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")(),Q=setTimeout,z=clearTimeout;e.prototype.on=e.prototype.addEventListener=function(a,c){return this._callbacks=this._callbacks||{},(this._callbacks["$"+
a]=this._callbacks["$"+a]||[]).push(c),this};e.prototype.once=function(a,c){function b(){this.off(a,b);c.apply(this,arguments)}return b.fn=c,this.on(a,b),this};e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(a,c){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var b,d=this._callbacks["$"+a];if(!d)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var e=0;e<d.length;e++)if((b=
d[e])===c||b.fn===c){d.splice(e,1);break}return 0===d.length&&delete this._callbacks["$"+a],this};e.prototype.emit=function(a){this._callbacks=this._callbacks||{};for(var c=Array(arguments.length-1),b=this._callbacks["$"+a],d=1;d<arguments.length;d++)c[d-1]=arguments[d];if(b){d=0;for(var e=(b=b.slice(0)).length;d<e;++d)b[d].apply(this,c)}return this};e.prototype.emitReserved=e.prototype.emit;e.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]};e.prototype.hasListeners=
function(a){return!!this.listeners(a).length};var J=Object.create(null);J.open="0";J.close="1";J.ping="2";J.pong="3";J.message="4";J.upgrade="5";J.noop="6";var M=Object.create(null);Object.keys(J).forEach(function(a){M[J[a]]=a});var I={type:"error",data:"parser error"},U="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),ca="function"==typeof ArrayBuffer,g=function(a,c,b){var d=a.type;a=a.data;return U&&a instanceof Blob?c?b(a):ea(a,
b):ca&&(a instanceof ArrayBuffer||(e=a,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer))?c?b(a):ea(new Blob([a]),b):b(J[d]+(a||""));var e},ea=function(a,c){var b=new FileReader;return b.onload=function(){var a=b.result.split(",")[1];c("b"+a)},b.readAsDataURL(a)},P="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(l=0;64>l;l++)P["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(l)]=l;var la="function"==typeof ArrayBuffer,
ba=function(a,c){if("string"!=typeof a)return{type:"message",data:K(a,c)};var b=a.charAt(0);if("b"===b){a=a.substring(1);if(la){var d=.75*a.length;b=a.length;var e=0;"="===a[a.length-1]&&(d--,"="===a[a.length-2]&&d--);var g=new ArrayBuffer(d),f=new Uint8Array(g);for(d=0;d<b;d+=4){var h=P[a.charCodeAt(d)];var k=P[a.charCodeAt(d+1)];var n=P[a.charCodeAt(d+2)];var u=P[a.charCodeAt(d+3)];f[e++]=h<<2|k>>4;f[e++]=(15&k)<<4|n>>2;f[e++]=(3&n)<<6|63&u}c=K(g,c)}else c={base64:!0,data:a};c={type:"message",data:c}}else c=
M[b]?1<a.length?{type:M[b],data:a.substring(1)}:{type:M[b]}:I;return c},K=function(a,c){return"blob"===c&&a instanceof ArrayBuffer?new Blob([a]):a},V=String.fromCharCode(30),R=function(a){var c=e.call(this)||this;c.writable=!1;k(c,a);c.opts=a;c.query=a.query;c.readyState="";c.socket=a.socket;return c};$jscomp.inherits(R,e);R.prototype.onError=function(a,c){a=Error(a);return a.type="TransportError",a.description=c,e.prototype.emit.call(this,"error",a),this};R.prototype.open=function(){return"closed"!==
this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this};R.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this};R.prototype.send=function(a){"open"===this.readyState&&this.write(a)};R.prototype.onOpen=function(){this.readyState="open";this.writable=!0;e.prototype.emit.call(this,"open")};R.prototype.onData=function(a){a=ba(a,this.socket.binaryType);this.onPacket(a)};R.prototype.onPacket=function(a){e.prototype.emit.call(this,
"packet",a)};R.prototype.onClose=function(){this.readyState="closed";e.prototype.emit.call(this,"close")};for(var O,y="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),W={},ia=0,X=0;64>X;X++)W[y[X]]=X;b.encode=a;b.decode=function(a){var c=0;for(X=0;X<a.length;X++)c=64*c+W[a.charAt(X)];return c};var E={encode:function(a){var c="",b;for(b in a)a.hasOwnProperty(b)&&(c.length&&(c+="&"),c+=encodeURIComponent(b)+"="+encodeURIComponent(a[b]));return c},decode:function(a){var c=
{};a=a.split("&");for(var b=0,d=a.length;b<d;b++){var e=a[b].split("=");c[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return c}},da=function(){var a=R.apply(this,arguments)||this;a.polling=!1;return a};$jscomp.inherits(da,R);da.prototype.doOpen=function(){this.poll()};da.prototype.pause=function(a){var c=this;this.readyState="pausing";var b=function(){c.readyState="paused";a()};if(this.polling||!this.writable){var d=0;this.polling&&(d++,this.once("pollComplete",function(){--d||b()}));this.writable||
(d++,this.once("drain",function(){--d||b()}))}else b()};da.prototype.poll=function(){this.polling=!0;this.doPoll();this.emit("poll")};da.prototype.onData=function(a){var c=this;(function(a,c){a=a.split(V);for(var b=[],d=0;d<a.length;d++){var e=ba(a[d],c);if(b.push(e),"error"===e.type)break}return b})(a,this.socket.binaryType).forEach(function(a){if("opening"===c.readyState&&"open"===a.type&&c.onOpen(),"close"===a.type)return c.onClose(),!1;c.onPacket(a)});"closed"!==this.readyState&&(this.polling=
!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())};da.prototype.doClose=function(){var a=this,c=function(){a.write([{type:"close"}])};"open"===this.readyState?c():this.once("open",c)};da.prototype.write=function(a){var c=this;this.writable=!1;(function(a,c){var b=a.length,d=Array(b),e=0;a.forEach(function(a,f){g(a,!1,function(a){d[f]=a;++e===b&&c(d.join(V))})})})(a,function(a){c.doWrite(a,function(){c.writable=!0;c.emit("drain")})})};da.prototype.uri=function(){var a=this.query||
{},c=this.opts.secure?"https":"http",d="";!1!==this.opts.timestampRequests&&(a[this.opts.timestampParam]=b());this.supportsBinary||a.sid||(a.b64=1);this.opts.port&&("https"===c&&443!==Number(this.opts.port)||"http"===c&&80!==Number(this.opts.port))&&(d=":"+this.opts.port);a=E.encode(a);return c+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+d+this.opts.path+(a.length?"?"+a:"")};$jscomp.global.Object.defineProperties(da.prototype,{name:{configurable:!0,enumerable:!0,
get:function(){return"polling"}}});var ha=null!=(new f({xdomain:!1})).responseType,aa=function(a,c){var b=e.call(this)||this;k(b,c);b.opts=c;b.method=c.method||"GET";b.uri=a;b.async=!1!==c.async;b.data=void 0!==c.data?c.data:null;b.create();return b};$jscomp.inherits(aa,e);aa.prototype.create=function(){var a=this,c=q(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");c.xdomain=!!this.opts.xd;c.xscheme=!!this.opts.xs;var b=this.xhr=new f(c);try{b.open(this.method,
this.uri,this.async);try{if(this.opts.extraHeaders){b.setDisableHeaderCheck&&b.setDisableHeaderCheck(!0);for(var d in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(d)&&b.setRequestHeader(d,this.opts.extraHeaders[d])}}catch(sa){}if("POST"===this.method)try{b.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(sa){}try{b.setRequestHeader("Accept","*/*")}catch(sa){}"withCredentials"in b&&(b.withCredentials=this.opts.withCredentials);this.opts.requestTimeout&&(b.timeout=this.opts.requestTimeout);
b.onreadystatechange=function(){4===b.readyState&&(200===b.status||1223===b.status?a.onLoad():a.setTimeoutFn(function(){a.onError("number"==typeof b.status?b.status:0)},0))};b.send(this.data)}catch(sa){return void this.setTimeoutFn(function(){a.onError(sa)},0)}"undefined"!=typeof document&&(this.index=aa.requestsCount++,aa.requests[this.index]=this)};aa.prototype.onSuccess=function(){this.emit("success");this.cleanup()};aa.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};aa.prototype.onError=
function(a){this.emit("error",a);this.cleanup(!0)};aa.prototype.cleanup=function(a){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=h,a)try{this.xhr.abort()}catch(Ea){}"undefined"!=typeof document&&delete aa.requests[this.index];this.xhr=null}};aa.prototype.onLoad=function(){var a=this.xhr.responseText;null!==a&&this.onData(a)};aa.prototype.abort=function(){this.cleanup()};if(aa.requestsCount=0,aa.requests={},"undefined"!=typeof document)"function"==typeof attachEvent?attachEvent("onunload",
x):"function"==typeof addEventListener&&addEventListener("onpagehide"in c?"pagehide":"unload",x,!1);var za="function"==typeof Promise&&"function"==typeof Promise.resolve?function(a){return Promise.resolve().then(a)}:function(a,c){return c(a,0)},na=c.WebSocket||c.MozWebSocket,va="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),ja=function(a){var c=R.call(this,a)||this;c.supportsBinary=!a.forceBase64;return c};$jscomp.inherits(ja,R);
ja.prototype.doOpen=function(){if(this.check()){var a=this.uri(),c=this.opts.protocols,b=va?{}:q(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(b.headers=this.opts.extraHeaders);try{this.ws=va?new na(a,c,b):c?new na(a,c):new na(a)}catch(Aa){return this.emit("error",Aa)}this.ws.binaryType=this.socket.binaryType||"arraybuffer";this.addEventListeners()}};
ja.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.opts.autoUnref&&a.ws._socket.unref();a.onOpen()};this.ws.onclose=this.onClose.bind(this);this.ws.onmessage=function(c){return a.onData(c.data)};this.ws.onerror=function(c){return a.onError("websocket error",c)}};ja.prototype.write=function(a){var c=this;this.writable=!1;for(var b={},d=0;d<a.length;b={$jscomp$loop$prop$n$121$207:b.$jscomp$loop$prop$n$121$207},d++){var e=a[d];b.$jscomp$loop$prop$n$121$207=d===a.length-
1;g(e,this.supportsBinary,function(a){return function(b){try{c.ws.send(b)}catch(Ya){}a.$jscomp$loop$prop$n$121$207&&za(function(){c.writable=!0;c.emit("drain")},c.setTimeoutFn)}}(b))}};ja.prototype.doClose=function(){void 0!==this.ws&&(this.ws.close(),this.ws=null)};ja.prototype.uri=function(){var a=this.query||{},c=this.opts.secure?"wss":"ws",d="";this.opts.port&&("wss"===c&&443!==Number(this.opts.port)||"ws"===c&&80!==Number(this.opts.port))&&(d=":"+this.opts.port);this.opts.timestampRequests&&
(a[this.opts.timestampParam]=b());this.supportsBinary||(a.b64=1);a=E.encode(a);return c+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+d+this.opts.path+(a.length?"?"+a:"")};ja.prototype.check=function(){return!(!na||"__initialize"in na&&this.name===ja.prototype.name)};$jscomp.global.Object.defineProperties(ja.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"websocket"}}});l=function(a){var c;if(c=da.call(this,a)||this,"undefined"!=typeof location){var b=
"https:"===location.protocol,d=location.port;d||(d=b?"443":"80");c.xd="undefined"!=typeof location&&a.hostname!==location.hostname||d!==a.port;c.xs=a.secure!==b}a=a&&a.forceBase64;c.supportsBinary=ha&&!a;return c};$jscomp.inherits(l,da);l.prototype.request=function(a){a=void 0===a?{}:a;return Object.assign(a,{xd:this.xd,xs:this.xs},this.opts),new aa(this.uri(),a)};l.prototype.doWrite=function(a,c){var b=this;a=this.request({method:"POST",data:a});a.on("success",c);a.on("error",function(a){b.onError("xhr post error",
a)})};l.prototype.doPoll=function(){var a=this,c=this.request();c.on("data",this.onData.bind(this));c.on("error",function(c){a.onError("xhr poll error",c)});this.pollXhr=c};var Da={websocket:ja,polling:l},S=function(a,c){c=void 0===c?{}:c;var b=e.call(this)||this;a&&"object"==typeof a&&(c=a,a=null);a?(a=A(a),c.hostname=a.host,c.secure="https"===a.protocol||"wss"===a.protocol,c.port=a.port,a.query&&(c.query=a.query)):c.host&&(c.hostname=A(c.host).host);k(b,c);b.secure=null!=c.secure?c.secure:"undefined"!=
typeof location&&"https:"===location.protocol;c.hostname&&!c.port&&(c.port=b.secure?"443":"80");b.hostname=c.hostname||("undefined"!=typeof location?location.hostname:"localhost");b.port=c.port||("undefined"!=typeof location&&location.port?location.port:b.secure?"443":"80");b.transports=c.transports||["polling","websocket"];b.readyState="";b.writeBuffer=[];b.prevBufferLen=0;b.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,
perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},c);b.opts.path=b.opts.path.replace(/\/$/,"")+"/";"string"==typeof b.opts.query&&(b.opts.query=E.decode(b.opts.query));b.id=null;b.upgrades=null;b.pingInterval=null;b.pingTimeout=null;b.pingTimeoutTimer=null;"function"==typeof addEventListener&&(b.opts.closeOnBeforeunload&&addEventListener("beforeunload",function(){d.transport&&(d.transport.removeAllListeners(),d.transport.close())},!1),"localhost"!==b.hostname&&(b.offlineEventListener=
function(){d.onClose("transport close")},addEventListener("offline",b.offlineEventListener,!1)));b.open();var d=b;return b};$jscomp.inherits(S,e);S.prototype.createTransport=function(a){var c=this.opts.query,b={},d;for(d in c)c.hasOwnProperty(d)&&(b[d]=c[d]);b.EIO=4;b.transport=a;this.id&&(b.sid=this.id);c=Object.assign({},this.opts.transportOptions[a],this.opts,{query:b,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Da[a](c)};S.prototype.open=function(){var a=this;
if(this.opts.rememberUpgrade&&S.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var c="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(function(){a.emitReserved("error","No transports available")},0);c=this.transports[0]}this.readyState="opening";try{c=this.createTransport(c)}catch(Na){return this.transports.shift(),void this.open()}c.open();this.setTransport(c)};S.prototype.setTransport=function(a){var c=this;this.transport&&this.transport.removeAllListeners();
this.transport=a;a.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",function(){c.onClose("transport close")})};S.prototype.probe=function(a){function c(){h||(h=!0,u(),f.close(),f=null)}function b(){n("transport closed")}function d(){n("socket closed")}function e(a){f&&a.name!==f.name&&c()}var g=this,f=this.createTransport(a),h=!1;S.priorWebsocketSuccess=!1;var k=function(){h||(f.send([{type:"ping",data:"probe"}]),f.once("packet",
function(a){if(!h)if("pong"===a.type&&"probe"===a.data){if(g.upgrading=!0,g.emitReserved("upgrading",f),f)S.priorWebsocketSuccess="websocket"===f.name,g.transport.pause(function(){h||"closed"!==g.readyState&&(u(),g.setTransport(f),f.send([{type:"upgrade"}]),g.emitReserved("upgrade",f),f=null,g.upgrading=!1,g.flush())})}else a=Error("probe error"),a.transport=f.name,g.emitReserved("upgradeError",a)}))},n=function(a){a=Error("probe error: "+a);a.transport=f.name;c();g.emitReserved("upgradeError",a)},
u=function(){f.removeListener("open",k);f.removeListener("error",n);f.removeListener("close",b);g.off("close",d);g.off("upgrading",e)};f.once("open",k);f.once("error",n);f.once("close",b);this.once("close",d);this.once("upgrading",e);f.open()};S.prototype.onOpen=function(){if(this.readyState="open",S.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause)for(var a=0,c=this.upgrades.length;a<c;a++)this.probe(this.upgrades[a])};
S.prototype.onPacket=function(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",a),this.emitReserved("heartbeat"),a.type){case "open":this.onHandshake(JSON.parse(a.data));break;case "ping":this.resetPingTimeout();this.sendPacket("pong");this.emitReserved("ping");this.emitReserved("pong");break;case "error":var c=Error("server error");c.code=a.data;this.onError(c);break;case "message":this.emitReserved("data",a.data),this.emitReserved("message",
a.data)}};S.prototype.onHandshake=function(a){this.emitReserved("handshake",a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);this.pingInterval=a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!==this.readyState&&this.resetPingTimeout()};S.prototype.resetPingTimeout=function(){var a=this;this.clearTimeoutFn(this.pingTimeoutTimer);this.pingTimeoutTimer=this.setTimeoutFn(function(){a.onClose("ping timeout")},this.pingInterval+this.pingTimeout);
this.opts.autoUnref&&this.pingTimeoutTimer.unref()};S.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()};S.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))};S.prototype.write=function(a,c,b){return this.sendPacket("message",
a,c,b),this};S.prototype.send=function(a,c,b){return this.sendPacket("message",a,c,b),this};S.prototype.sendPacket=function(a,c,b,d){if("function"==typeof c&&(d=c,c=void 0),"function"==typeof b&&(d=b,b=null),"closing"!==this.readyState&&"closed"!==this.readyState)(b=b||{}).compress=!1!==b.compress,a={type:a,data:c,options:b},this.emitReserved("packetCreate",a),this.writeBuffer.push(a),d&&this.once("flush",d),this.flush()};S.prototype.close=function(){var a=this,c=function(){a.onClose("forced close");
a.transport.close()},b=function(){a.off("upgrade",b);a.off("upgradeError",b);c()},d=function(){a.once("upgrade",b);a.once("upgradeError",b)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){a.upgrading?d():c()}):this.upgrading?d():c()),this};S.prototype.onError=function(a){S.priorWebsocketSuccess=!1;this.emitReserved("error",a);this.onClose("transport error",a)};S.prototype.onClose=function(a,c){"opening"!==
this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",a,c),this.writeBuffer=[],this.prevBufferLen=0)};S.prototype.filterUpgrades=function(a){for(var c=[],b=0,d=a.length;b<d;b++)~this.transports.indexOf(a[b])&&
c.push(a[b]);return c};S.protocol=4;S.protocol;var ma="function"==typeof ArrayBuffer;l=Object.prototype.toString;var Z="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===l.call(Blob),ra="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===l.call(File),N;!function(a){a[a.CONNECT=0]="CONNECT";a[a.DISCONNECT=1]="DISCONNECT";a[a.EVENT=2]="EVENT";a[a.ACK=3]="ACK";a[a.CONNECT_ERROR=4]="CONNECT_ERROR";a[a.BINARY_EVENT=5]="BINARY_EVENT";a[a.BINARY_ACK=
6]="BINARY_ACK"}(N||(N={}));var T=function(){return e.call(this)||this};$jscomp.inherits(T,e);T.prototype.add=function(a){if("string"==typeof a)a=this.decodeString(a),a.type===N.BINARY_EVENT||a.type===N.BINARY_ACK?(this.reconstructor=new fa(a),0===a.attachments&&e.prototype.emitReserved.call(this,"decoded",a)):e.prototype.emitReserved.call(this,"decoded",a);else{if(!d(a)&&!a.base64)throw Error("Unknown type: "+a);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");
(a=this.reconstructor.takeBinaryData(a))&&(this.reconstructor=null,e.prototype.emitReserved.call(this,"decoded",a))}};T.prototype.decodeString=function(a){var c=0,b={type:Number(a.charAt(0))};if(void 0===N[b.type])throw Error("unknown packet type "+b.type);if(b.type===N.BINARY_EVENT||b.type===N.BINARY_ACK){for(var d=c+1;"-"!==a.charAt(++c)&&c!=a.length;);d=a.substring(d,c);if(d!=Number(d)||"-"!==a.charAt(c))throw Error("Illegal attachments");b.attachments=Number(d)}if("/"===a.charAt(c+1)){for(d=c+
1;++c&&","!==a.charAt(c)&&c!==a.length;);b.nsp=a.substring(d,c)}else b.nsp="/";d=a.charAt(c+1);if(""!==d&&Number(d)==d){for(d=c+1;++c;){var e=a.charAt(c);if(null==e||Number(e)!=e){--c;break}if(c===a.length)break}b.id=Number(a.substring(d,c+1))}if(a.charAt(++c)){a=a.substr(c);try{var g=JSON.parse(a)}catch(Oa){g=!1}if(!T.isPayloadValid(b.type,g))throw Error("invalid payload");b.data=g}return b};T.isPayloadValid=function(a,c){switch(a){case N.CONNECT:return"object"==typeof c;case N.DISCONNECT:return void 0===
c;case N.CONNECT_ERROR:return"string"==typeof c||"object"==typeof c;case N.EVENT:case N.BINARY_EVENT:return Array.isArray(c)&&0<c.length;case N.ACK:case N.BINARY_ACK:return Array.isArray(c)}};T.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};var fa=function(a){this.packet=a;this.buffers=[];this.reconPack=a};fa.prototype.takeBinaryData=function(a){return(this.buffers.push(a),this.buffers.length===this.reconPack.attachments)?(a=this.reconPack,a=(a.data=
B(a.data,this.buffers),a.attachments=void 0,a),this.finishedReconstruction(),a):null};fa.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]};l=function(){};l.prototype.encode=function(a){return a.type!==N.EVENT&&a.type!==N.ACK||!u(a)?[this.encodeAsString(a)]:(a.type=a.type===N.EVENT?N.BINARY_EVENT:N.BINARY_ACK,this.encodeAsBinary(a))};l.prototype.encodeAsString=function(a){var c=""+a.type;return a.type!==N.BINARY_EVENT&&a.type!==N.BINARY_ACK||(c+=a.attachments+"-"),a.nsp&&
"/"!==a.nsp&&(c+=a.nsp+","),null!=a.id&&(c+=a.id),null!=a.data&&(c+=JSON.stringify(a.data)),c};l.prototype.encodeAsBinary=function(a){var c=[];c=(a.data=n(a.data,c),a.attachments=c.length,{packet:a,buffers:c});a=this.encodeAsString(c.packet);c=c.buffers;return c.unshift(a),c};var oa=Object.freeze({__proto__:null,protocol:5,get PacketType(){return N},Encoder:l,Decoder:T}),Ma=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),H=function(a,c,b){var d=
e.call(this)||this;d.connected=!1;d.disconnected=!0;d.receiveBuffer=[];d.sendBuffer=[];d.ids=0;d.acks={};d.flags={};d.io=a;d.nsp=c;b&&b.auth&&(d.auth=b.auth);d.io._autoConnect&&d.open();return d};$jscomp.inherits(H,e);H.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=[w(a,"open",this.onopen.bind(this)),w(a,"packet",this.onpacket.bind(this)),w(a,"error",this.onerror.bind(this)),w(a,"close",this.onclose.bind(this))]}};H.prototype.connect=function(){return this.connected||(this.subEvents(),
this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this};H.prototype.open=function(){return this.connect()};H.prototype.send=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];return c.unshift("message"),this.emit.apply(this,c),this};H.prototype.emit=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];if(Ma.hasOwnProperty(a))throw Error('"'+a+'" is a reserved event name');b.unshift(a);d={type:N.EVENT,data:b,options:{}};if(d.options.compress=
!1!==this.flags.compress,"function"==typeof b[b.length-1]){var e=this.ids++;b=b.pop();this._registerAckCallback(e,b);d.id=e}b=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!b||!this.connected)||(this.connected?this.packet(d):this.sendBuffer.push(d)),this.flags={},this};H.prototype._registerAckCallback=function(a,c){var b=this,d=this.flags.timeout;if(void 0===d)return void(this.acks[a]=c);var e=this.io.setTimeoutFn(function(){delete b.acks[a];
for(var d=0;d<b.sendBuffer.length;d++)b.sendBuffer[d].id===a&&b.sendBuffer.splice(d,1);c.call(b,Error("operation has timed out"))},d);this.acks[a]=function(a){for(var d=[],g=0;g<arguments.length;++g)d[g-0]=arguments[g];b.io.clearTimeoutFn(e);c.apply(b,[null].concat($jscomp.arrayFromIterable(d)))}};H.prototype.packet=function(a){a.nsp=this.nsp;this.io._packet(a)};H.prototype.onopen=function(){var a=this;"function"==typeof this.auth?this.auth(function(c){a.packet({type:N.CONNECT,data:c})}):this.packet({type:N.CONNECT,
data:this.auth})};H.prototype.onerror=function(a){this.connected||this.emitReserved("connect_error",a)};H.prototype.onclose=function(a){this.connected=!1;this.disconnected=!0;delete this.id;this.emitReserved("disconnect",a)};H.prototype.onpacket=function(a){if(a.nsp===this.nsp)switch(a.type){case N.CONNECT:if(a.data&&a.data.sid)this.onconnect(a.data.sid);else this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));
break;case N.EVENT:case N.BINARY_EVENT:this.onevent(a);break;case N.ACK:case N.BINARY_ACK:this.onack(a);break;case N.DISCONNECT:this.ondisconnect();break;case N.CONNECT_ERROR:this.destroy();var c=Error(a.data.message);c.data=a.data.data;this.emitReserved("connect_error",c)}};H.prototype.onevent=function(a){var c=a.data||[];null!=a.id&&c.push(this.ack(a.id));this.connected?this.emitEvent(c):this.receiveBuffer.push(Object.freeze(c))};H.prototype.emitEvent=function(a){if(this._anyListeners&&this._anyListeners.length){var c=
this._anyListeners.slice();c=$jscomp.makeIterator(c);for(var b=c.next();!b.done;b=c.next())b.value.apply(this,a)}e.prototype.emit.apply(this,a)};H.prototype.ack=function(a){var c=this,b=!1;return function(d){for(var e=[],g=0;g<arguments.length;++g)e[g-0]=arguments[g];b||(b=!0,c.packet({type:N.ACK,id:a,data:e}))}};H.prototype.onack=function(a){var c=this.acks[a.id];"function"==typeof c&&(c.apply(this,a.data),delete this.acks[a.id])};H.prototype.onconnect=function(a){this.id=a;this.connected=!0;this.disconnected=
!1;this.emitBuffered();this.emitReserved("connect")};H.prototype.emitBuffered=function(){var a=this;this.receiveBuffer.forEach(function(c){return a.emitEvent(c)});this.receiveBuffer=[];this.sendBuffer.forEach(function(c){return a.packet(c)});this.sendBuffer=[]};H.prototype.ondisconnect=function(){this.destroy();this.onclose("io server disconnect")};H.prototype.destroy=function(){this.subs&&(this.subs.forEach(function(a){return a()}),this.subs=void 0);this.io._destroy(this)};H.prototype.disconnect=
function(){return this.connected&&this.packet({type:N.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this};H.prototype.close=function(){return this.disconnect()};H.prototype.compress=function(a){return this.flags.compress=a,this};H.prototype.timeout=function(a){return this.flags.timeout=a,this};H.prototype.onAny=function(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(a),this};H.prototype.prependAny=function(a){return this._anyListeners=
this._anyListeners||[],this._anyListeners.unshift(a),this};H.prototype.offAny=function(a){if(!this._anyListeners)return this;if(a)for(var c=this._anyListeners,b=0;b<c.length;b++){if(a===c[b])return c.splice(b,1),this}else this._anyListeners=[];return this};H.prototype.listenersAny=function(){return this._anyListeners||[]};$jscomp.global.Object.defineProperties(H.prototype,{active:{configurable:!0,enumerable:!0,get:function(){return!!this.subs}},volatile:{configurable:!0,enumerable:!0,get:function(){return this.flags.volatile=
!0,this}}});t.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var c=Math.random(),b=Math.floor(c*this.jitter*a);a=0==(1&Math.floor(10*c))?a-b:a+b}return 0|Math.min(a,this.max)};t.prototype.reset=function(){this.attempts=0};t.prototype.setMin=function(a){this.ms=a};t.prototype.setMax=function(a){this.max=a};t.prototype.setJitter=function(a){this.jitter=a};var Y=function(a,c){var b;var d=e.call(this)||this;d.nsps={};d.subs=[];a&&"object"==typeof a&&
(c=a,a=void 0);(c=c||{}).path=c.path||"/socket.io";d.opts=c;k(d,c);d.reconnection(!1!==c.reconnection);d.reconnectionAttempts(c.reconnectionAttempts||1/0);d.reconnectionDelay(c.reconnectionDelay||1E3);d.reconnectionDelayMax(c.reconnectionDelayMax||5E3);d.randomizationFactor(null!==(b=c.randomizationFactor)&&void 0!==b?b:.5);d.backoff=new t({min:d.reconnectionDelay(),max:d.reconnectionDelayMax(),jitter:d.randomizationFactor()});d.timeout(null==c.timeout?2E4:c.timeout);d._readyState="closed";d.uri=
a;a=c.parser||oa;d.encoder=new a.Encoder;d.decoder=new a.Decoder;d._autoConnect=!1!==c.autoConnect;d._autoConnect&&d.open();return d};$jscomp.inherits(Y,e);Y.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection};Y.prototype.reconnectionAttempts=function(a){return void 0===a?this._reconnectionAttempts:(this._reconnectionAttempts=a,this)};Y.prototype.reconnectionDelay=function(a){var c;return void 0===a?this._reconnectionDelay:(this._reconnectionDelay=
a,null===(c=this.backoff)||void 0===c||c.setMin(a),this)};Y.prototype.randomizationFactor=function(a){var c;return void 0===a?this._randomizationFactor:(this._randomizationFactor=a,null===(c=this.backoff)||void 0===c||c.setJitter(a),this)};Y.prototype.reconnectionDelayMax=function(a){var c;return void 0===a?this._reconnectionDelayMax:(this._reconnectionDelayMax=a,null===(c=this.backoff)||void 0===c||c.setMax(a),this)};Y.prototype.timeout=function(a){return arguments.length?(this._timeout=a,this):
this._timeout};Y.prototype.maybeReconnectOnOpen=function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};Y.prototype.open=function(a){var c=this;if(~this._readyState.indexOf("open"))return this;var b=this.engine=new S(this.uri,this.opts),d=this;this._readyState="opening";this.skipReconnect=!1;var e=w(b,"open",function(){d.onopen();a&&a()}),g=w(b,"error",function(b){d.cleanup();d._readyState="closed";c.emitReserved("error",b);a?a(b):d.maybeReconnectOnOpen()});
if(!1!==this._timeout){var f=this._timeout;0===f&&e();var h=this.setTimeoutFn(function(){e();b.close();b.emit("error",Error("timeout"))},f);this.opts.autoUnref&&h.unref();this.subs.push(function(){clearTimeout(h)})}return this.subs.push(e),this.subs.push(g),this};Y.prototype.connect=function(a){return this.open(a)};Y.prototype.onopen=function(){this.cleanup();this._readyState="open";this.emitReserved("open");var a=this.engine;this.subs.push(w(a,"ping",this.onping.bind(this)),w(a,"data",this.ondata.bind(this)),
w(a,"error",this.onerror.bind(this)),w(a,"close",this.onclose.bind(this)),w(this.decoder,"decoded",this.ondecoded.bind(this)))};Y.prototype.onping=function(){this.emitReserved("ping")};Y.prototype.ondata=function(a){this.decoder.add(a)};Y.prototype.ondecoded=function(a){this.emitReserved("packet",a)};Y.prototype.onerror=function(a){this.emitReserved("error",a)};Y.prototype.socket=function(a,c){var b=this.nsps[a];return b||(b=new H(this,a,c),this.nsps[a]=b),b};Y.prototype._destroy=function(a){a=Object.keys(this.nsps);
a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())if(this.nsps[c.value].active)return;this._close()};Y.prototype._packet=function(a){for(var c=this.encoder.encode(a),b=0;b<c.length;b++)this.engine.write(c[b],a.options)};Y.prototype.cleanup=function(){this.subs.forEach(function(a){return a()});this.subs.length=0;this.decoder.destroy()};Y.prototype._close=function(){this.skipReconnect=!0;this._reconnecting=!1;this.onclose("forced close");this.engine&&this.engine.close()};Y.prototype.disconnect=
function(){return this._close()};Y.prototype.onclose=function(a){this.cleanup();this.backoff.reset();this._readyState="closed";this.emitReserved("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};Y.prototype.reconnect=function(){var a=this;if(this._reconnecting||this.skipReconnect)return this;var c=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var b=this.backoff.duration();this._reconnecting=
!0;var d=this.setTimeoutFn(function(){c.skipReconnect||(a.emitReserved("reconnect_attempt",c.backoff.attempts),c.skipReconnect||c.open(function(b){b?(c._reconnecting=!1,c.reconnect(),a.emitReserved("reconnect_error",b)):c.onreconnect()}))},b);this.opts.autoUnref&&d.unref();this.subs.push(function(){clearTimeout(d)})}};Y.prototype.onreconnect=function(){var a=this.backoff.attempts;this._reconnecting=!1;this.backoff.reset();this.emitReserved("reconnect",a)};var wa={};Object.assign(v,{Manager:Y,Socket:H,
io:v,connect:v})},function(l,r,p){var f=p(2),q=p(43);l=p(1);var k=p.n(l);r.a=function(e){var a=Object(f.a)({});a.id=e.id;a.stream=e.stream.stream;a.elementID=e.elementID;var b=e.stream.getPlayerId(e.vroom?e.vroom:e.stream.room);a.audio=document.createElement("audio");a.audio.setAttribute("id",""+b.stream);a.audio.setAttribute("class","vcx_stream");a.audio.setAttribute("style","width: 100%; height: 100%; position: absolute");a.audio.setAttribute("autoplay","autoplay");e.stream.local&&(a.audio.volume=
0);void 0!==a.elementID?(a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.div)},a.div=document.createElement("div"),a.div.setAttribute("id",""+b.player),a.div.setAttribute("class","vcx_player"),a.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),a.container="object"===typeof a.elementID&&"function"===typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID),a.container.appendChild(a.div),a.parentNode=a.div.parentNode,
a.div.appendChild(a.audio),!1!==e.options.bar?(a.bar=Object(q.a)({elementID:""+b.player,id:a.id,stream:e.stream,media:a.audio,options:e.options}),a.div.onmouseover=void 0,a.div.onmouseout=void 0):a.media=a.audio):(a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.audio)},document.body.appendChild(a.audio),a.parentNode=document.body);var h=void 0,l=e=void 0,d=b=void 0,u=void 0;k.a.csp_enabled||(h=document.createElement("div"),h.setAttribute("id","stats-container-"+a.id),h.setAttribute("class",
"stats-container"),h.setAttribute("style","display:none;"),e=document.createElement("div"),e.setAttribute("id","stats-button-"+a.id),e.setAttribute("class","stats-button"),e.setAttribute("title","Click to see stats"),e.innerHTML=window.statsIcon,h.appendChild(e),l=document.createElement("div"),l.setAttribute("class","stats-overlay"),l.setAttribute("id","stats-overlay-"+a.id),l.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);"),
b=document.createElement("div"),b.setAttribute("class","stats-overlay-inner"),b.setAttribute("id","stats-overlay-inner-"+a.id),d=document.createElement("div"),u=document.createElement("div"),d.setAttribute("class","stats-left-partition"),d.setAttribute("id","stats-left-part-"+a.id),u.setAttribute("class","stats-right-partition"),u.setAttribute("id","stats-right-part-"+a.id),e.addEventListener("click",function(){l.style.display="none"===l.style.display?"block":"none"}),a.div.parentNode.style.position=
"relative",a.div.parentNode.appendChild(h),a.div.parentNode.appendChild(l),l.appendChild(b),b.appendChild(d),b.appendChild(u));a.audio.srcObject=a.stream;a.ShowSessionStats=function(a){a?(h.setAttribute("style","display:block;"),l.setAttribute("style","display:block;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")):(h.setAttribute("style","display:none;"),l.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);"))};
return a}},function(l,r,p){var f=p(15),q=p(2),k=p(3),e=p(44),a=p(45),b=p(46),h=p(47),x=p(48),d=p(49),u=p(50),n=p(10);r.a=function(l){var w=Object(q.a)({});var t=Object(f.a)().toolbar.default;var v=!1;void 0!==l.options&&void 0!==l.options.player&&(w.playerProperties=l.options.player);if(l.options.toolbar){var p=l.options.toolbar;k.a.checkParam(p.position)&&(t.position=p.position);k.a.checkParam(p.class)&&(t.class=p.class);k.a.checkParam(p.skin)&&(t.skin=p.skin,v="default"===t.skin);k.a.checkParam(p.displayMode);
t.displayMode=p.displayMode;k.a.checkParam(p.autoDisplayTimeout)&&(t.autoDisplayTimeout=p.autoDisplayTimeout);p.buttons&&(t.buttons=p.buttons)}w.elementID=l.elementID;w.id=l.id;w.div=v?Object(k.a)({name:"div",id:"bar_"+w.id,class:"vcx_bar",style:n.a.vcx_bar}):Object(k.a)({name:"div",id:"bar_"+w.id,class:"vcx_bar "+t.skin+"_vcx_bar"});k.a.getById(w.elementID).appendChild(w.div);w.bar=v?Object(k.a)({name:"div",id:"subbar_"+w.id,class:"vcx_subbar "+t.class,style:n.a["vcx_subbar_"+t.position]}):Object(k.a)({name:"div",
id:"subbar_"+w.id,class:"vcx_subbar "+t.skin+"_vcx_subbar_"+t.position+" "+t.class});w.div.appendChild(w.bar);(function(a){function b(a){a=a||window.event;h=a.clientX;k=a.clientY;document.onmouseup=c;document.onmousemove=d}function d(c){c=c||window.event;e=h-c.clientX;f=k-c.clientY;h=c.clientX;k=c.clientY;a.style.top=a.offsetTop-f+"px";a.style.left=a.offsetLeft-e+"px"}function c(){document.onmouseup=null;document.onmousemove=null}var e=0,f=0,h=0,k=0;document.getElementById(a.id)?document.getElementById(a.id).onmousedown=
b:a.onmousedown=b})(w.bar);t.buttons.play&&(w.playIcon=Object(d.a)({stream:l.stream,skin:t.skin}),w.bar.appendChild(w.playIcon));t.buttons.zoom&&(w.zoomIcon=Object(a.a)({skin:t.skin,player:w.playerProperties}),w.bar.appendChild(w.zoomIcon));t.buttons.record&&(w.recIcon=Object(h.a)({skin:t.skin,stream:l.stream}),w.bar.appendChild(w.recIcon));t.buttons.share&&(w.shareIcon=Object(x.a)({skin:t.skin,stream:l.stream}),w.bar.appendChild(w.shareIcon));t.buttons.mic&&(w.micIcon=Object(u.a)({skin:t.skin,stream:l.stream}),
w.bar.appendChild(w.micIcon));v={};l.options&&l.options.toolbar&&l.options.toolbar.branding&&(v=l.options.toolbar.branding);v.skin=t.skin;w.brand=Object(b.a)(v);w.bar.appendChild(w.brand);!t.buttons.volume||l.stream.screen||void 0!==l.options&&void 0!==l.options.speaker&&!0!==l.options.speaker||(w.speaker=Object(e.a)({elementID:"subbar_"+w.id,id:w.id,stream:l.stream,media:l.media,position:t.position,skin:t.skin}));t.displayMode?"auto"==t.displayMode?(w.div.onmouseover=function(a){var b=a.currentTarget;
setTimeout(function(){k.a.getByClass("vcx_subbar",b).style.display="block"},1E3*parseInt(t.autoDisplayTimeout))},w.div.onmouseout=function(a){var b=a.currentTarget;setTimeout(function(){k.a.getByClass("vcx_subbar",b).style.display="none"},1E3*parseInt(t.autoDisplayTimeout))},k.a.getByClass("vcx_subbar",w.div).style.display="none"):k.a.getByClass("vcx_subbar",w.div).style.display="block":k.a.getByClass("vcx_subbar",w.div).style.display="none";return w}},function(l,r,p){var f=p(3),q=p(2),k=p(10);r.a=
function(e){var a=Object(q.a)({}),b=50,h="default"===e.skin;a.elementID=e.elementID;a.media=e.media;a.id=e.id;a.stream=e.stream;a.div=h?Object(f.a)({name:"i",class:"fa fa-volume-up fa-fw fa-lg",style:Object.assign(k.a.icon,k.a.icon_volume),id:"volume_"+a.id}):Object(f.a)({name:"i",class:"fa fa-volume-up fa-fw fa-lg "+e.skin+"_icon "+e.skin+"_icon_volume",id:"volume_"+a.id});f.a.setStyle(a.div,e.position,"0");a.div.onclick=function(){a.media.muted?(a.media.muted=!1,a.div.classList.remove("fa-volume-off"),
a.div.classList.add("fa-volume-up"),a.stream.local?a.stream.stream.getAudioTracks()[0].enabled=!0:(a.picker.value=b,a.media.volume=a.picker.value/100)):(a.media.muted=!0,a.div.classList.remove("fa-volume-up"),a.div.classList.add("fa-volume-off"),a.stream.local?a.stream.stream.getAudioTracks()[0].enabled=!1:(b=a.picker.value,a.picker.value=0,a.media.volume=0))};if(!a.stream.local){a.picker=document.createElement("input");a.picker.setAttribute("id","picker_"+a.id);a.picker.setAttribute("style","position: absolute;max-width: 50px;margin: 1.1%;top:0;");
a.picker.type="range";a.picker.min=0;a.picker.max=1;a.picker.step=.1;a.picker.value=b;a.picker.setAttribute("orient","vertical");a.div.appendChild(a.picker);a.media.volume=a.picker.value;a.media.muted=!1;a.picker.onclick=function(){0<a.picker.value?(a.media.muted=!1,a.div.classList.remove("fa-volume-off"),a.div.classList.add("fa-volume-up")):(a.media.muted=!0,a.div.classList.remove("fa-volume-up"),a.div.classList.add("fa-volume-off"));a.media.volume=a.picker.value};var l=function(b){a.picker.setAttribute("style",
"position: absolute;max-width: 50px;margin: 1.1%;margin-left:32px;top:0;display: "+b)};a.div.onmouseover=function(){l("block")};a.picker.onmouseout=function(){l("none")};l("none")}document.getElementById(a.elementID).appendChild(a.div);return a}},function(l,r,p){var f=p(3);p(2);var q=p(10),k=!1,e=function(a){var b=(k="default"===a.skin)?Object(f.a)({name:"i",title:"zoom",class:"fa fa-expand  fa-lg icon_zoom ",style:Object.assign(q.a.icon,q.a.icon_zoom)}):Object(f.a)({name:"i",title:"zoom",class:"fa fa-expand icon_zoom "+
a.skin+"_icon fa-lg "+a.skin+"_icon_zoom"});b.onclick=function(b){b.stopPropagation();e.click(b,a)};return b};e.click=function(a,b){var e=b.skin;b={height:b.player.height,width:b.player.width,position:"relative"};var l=a.currentTarget.classList;l.contains("fa-expand")?(a.currentTarget.classList.remove("fa-expand"),a.currentTarget.classList.add("fa-arrows-alt"),k?a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",f.a.getStyle(q.a.full_view)):a.currentTarget.parentNode.parentNode.parentNode.classList.add(e+
"_theater_view")):l.contains("fa-arrows-alt")?(a.currentTarget.classList.remove("fa-arrows-alt"),a.currentTarget.classList.add("fa-compress"),k?(a.currentTarget.parentNode.parentNode.parentNode.parentNode.removeAttribute("style"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",f.a.getStyle(q.a.full_view))):(a.currentTarget.parentNode.parentNode.parentNode.parentNode.classList.remove(e+"_theater_view"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.classList.add(e+
"_full_view"))):l.contains("fa-compress")&&(a.currentTarget.classList.remove("fa-compress"),a.currentTarget.classList.add("fa-expand"),k?(a.currentTarget.parentNode.parentNode.parentNode.parentNode.removeAttribute("style"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",f.a.getStyle(b))):a.currentTarget.parentNode.parentNode.parentNode.classList.remove(e+"_full_view"))};r.a=e},function(l,r,p){var f=p(15),q=p(3),k=p(2),e=p(10);r.a=function(a){Object(k.a)({});var b=
!1,h=Object(f.a)().brand.default;a&&(q.a.checkParam(a.clickthru)&&(h.url=a.clickthru),a.target&&"current"==a.target&&(h.target="_self"),q.a.checkParam(a.logo)&&(h.logo=a.logo),q.a.checkParam(a.title)&&(h.title=a.title),void 0!==a.display&&(h.display=a.display),b="default"===a.skin);var l=Object(q.a)({name:"a",title:h.title,href:h.url,target:h.target});a=b?Object(q.a)({name:"img",src:h.logo,style:e.a.brand_logo}):Object(q.a)({name:"img",class:a.skin+"_brand_logo",src:h.logo});l.appendChild(a);q.a.checkParam(h.display)||
(l.style.display="none");return l}},function(l,r,p){var f=p(3),q=p(2),k=function(e){Object(q.a)({});var a=Object(f.a)({name:"i",title:"record",class:"fa fa-circle fa-fw fa-lg icon_record "+e.skin+"_icon "+e.skin+"_icon_record"});a.onclick=function(a){k.click(a,e.stream)};return a};k.click=function(e,a){var b=e.currentTarget.classList;b.contains("fa-circle")?(e.currentTarget.classList.remove("fa-circle"),e.currentTarget.classList.add("fa-stop-circle"),a.local||a.room.startRecording(a,function(a){})):
b.contains("fa-stop-circle")&&(e.currentTarget.classList.remove("fa-stop-circle"),e.currentTarget.classList.add("fa-circle"),a.recordingId&&a.room.stopRecording(a.recordingId,function(b){b&&(a.recordingId=void 0)}))};r.a=k},function(l,r,p){var f=p(3),q=p(2),k=function(e){Object(q.a)({});var a=e.stream;e=Object(f.a)({name:"i",title:"share screen",class:"fa fa-share-alt fa-fw fa-lg icon_share "+e.skin+"_icon "+e.skin+"_icon_share"});e.onclick=function(b){k.click(b,a)};return e};k.click=function(e,a){var b=
VcxRtc.Stream({screen:!0,data:!0,attributes:{name:"shareStream"}});b.init();b.addEventListener("media-access-allowed",function(){a.room.publish(b,{maxVideoBW:300},function(a,b){})});b.addEventListener("media-access-denied",function(a){})};r.a=k},function(l,r,p){var f=p(3),q=p(2);p(11);var k=p(10),e=function(a){Object(q.a)({});a="default"===a.skin?Object(f.a)({name:"i",title:"pause",class:"fa fa-pause fa-lg icon_play",style:Object.assign(k.a.icon,k.a.icon_play)}):Object(f.a)({name:"i",title:"pause",
class:"fa fa-pause fa-lg "+a.skin+"_icon icon_play "+a.skin+"_icon_play"});a.onclick=function(a){e.click(a)};return a};e.toggleVideo=function(a){a.srcObject.getTracks().forEach(function(a){return a.enabled=!a.enabled})};e.click=function(a){var b=a.currentTarget.classList;b.contains("fa-pause")?(a.currentTarget.classList.remove("fa-pause"),a.currentTarget.classList.add("fa-play"),b=a.currentTarget.parentNode.parentNode.parentNode,a=f.a.getById("stream"+b.id.split("_")[1]),b=f.a.getById("screen_saver_"+
b.id.split("_")[1]),e.toggleVideo(a),""!==b.src?b.style.display="block":a.pause()):b.contains("fa-play")&&(a.currentTarget.classList.remove("fa-play"),a.currentTarget.classList.add("fa-pause"),b=a.currentTarget.parentNode.parentNode.parentNode,a=f.a.getById("stream"+b.id.split("_")[1]),b=f.a.getById("screen_saver_"+b.id.split("_")[1]),e.toggleVideo(a),""!==b.src?b.style.display="none":a.play())};r.a=e},function(l,r,p){var f=p(3),q=p(2),k=p(10),e=function(a){Object(q.a)({});var b="default"===a.skin;
var h=a.stream;a=b?Object(f.a)({name:"i",title:"microphone",class:"fa fa-microphone fa-fw fa-lg icon_mic",style:Object.assign(k.a.icon,k.a.icon_mic)}):Object(f.a)({name:"i",title:"microphone",class:"fa fa-microphone fa-fw fa-lg icon_mic "+a.skin+"_icon "+a.skin+"_icon_mic"});a.onclick=function(a){e.click(a,h)};return a};e.click=function(a,b){var e=a.currentTarget.classList;e.contains("fa-microphone")?(b.muteAudio(),a.currentTarget.classList.remove("fa-microphone"),a.currentTarget.classList.add("fa-microphone-slash")):
e.contains("fa-microphone-slash")&&(b.unmuteAudio(),a.currentTarget.classList.remove("fa-microphone-slash"),a.currentTarget.classList.add("fa-microphone"))};r.a=e},function(l,r,p){(function(f){f=function(){var f="undefined"!==typeof document&&document.currentScript?document.currentScript.src:void 0;return function(k){function e(a){return k.locateFile?k.locateFile(a,r):r+a}function a(a,c){0<a%c&&(a+=c-a%c);return a}function b(a){ca=a;k.HEAP8=new Int8Array(a);k.HEAP16=new Int16Array(a);k.HEAP32=I=new Int32Array(a);
k.HEAPU8=M=new Uint8Array(a);k.HEAPU16=new Uint16Array(a);k.HEAPU32=new Uint32Array(a);k.HEAPF32=new Float32Array(a);k.HEAPF64=new Float64Array(a)}function h(a){for(;0<a.length;){var c=a.shift();if("function"==typeof c)c(k);else{var b=c.func;"number"===typeof b?void 0===c.arg?k.dynCall_v(b):k.dynCall_vi(b,c.arg):b(void 0===c.arg?null:c.arg)}}}function l(a){if(k.onAbort)k.onAbort(a);a+="";F(a);c(a);J=!0;throw new WebAssembly.RuntimeError("abort("+a+"). Build with -s ASSERTIONS=1 for more info.");}
function d(a,c){return String.prototype.startsWith?a.startsWith(c):0===a.indexOf(c)}function u(){try{if(Q)return new Uint8Array(Q);if(A)return A(R);throw"both async and sync fetching of the wasm failed";}catch(ia){l(ia)}}function n(){return Q||!v&&!p||"function"!==typeof fetch?new Promise(function(a,c){a(u())}):fetch(R,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+R+"'";return a.arrayBuffer()}).catch(function(){return u()})}function q(a){function c(){if(!W&&
(W=!0,k.calledRun=!0,!J)){h(ea);h(P);w(k);if(k.onRuntimeInitialized)k.onRuntimeInitialized();if(k.postRun)for("function"==typeof k.postRun&&(k.postRun=[k.postRun]);k.postRun.length;)la.unshift(k.postRun.shift());h(la)}}if(!(0<ba)){if(k.preRun)for("function"==typeof k.preRun&&(k.preRun=[k.preRun]);k.preRun.length;)g.unshift(k.preRun.shift());h(g);0<ba||(k.setStatus?(k.setStatus("Running..."),setTimeout(function(){setTimeout(function(){k.setStatus("")},1);c()},1)):c())}}k=k||{};null;k="undefined"!==
typeof k?k:{};var w;k.ready=new Promise(function(a,c){w=a});var t={};for(U in k)k.hasOwnProperty(U)&&(t[U]=k[U]);var v=!1,p=!1;v="object"===typeof window;p="function"===typeof importScripts;var r="",A;if(v||p)p?r=self.location.href:document.currentScript&&(r=document.currentScript.src),f&&(r=f),r=0!==r.indexOf("blob:")?r.substr(0,r.lastIndexOf("/")+1):"",p&&(A=function(a){var c=new XMLHttpRequest;c.open("GET",a,!1);c.responseType="arraybuffer";c.send(null);return new Uint8Array(c.response)});var F=
k.print||console.log.bind(console),c=k.printErr||console.warn.bind(console);for(U in t)t.hasOwnProperty(U)&&(k[U]=t[U]);t=null;var Q;k.wasmBinary&&(Q=k.wasmBinary);"object"!==typeof WebAssembly&&c("no native wasm support detected");var z;t=new WebAssembly.Table({initial:1,maximum:1,element:"anyfunc"});var J=!1,M,I;var U=k.INITIAL_MEMORY||16777216;if(z=k.wasmMemory?k.wasmMemory:new WebAssembly.Memory({initial:U/65536,maximum:32768}))var ca=z.buffer;U=ca.byteLength;b(ca);I[24364]=5340496;var g=[],ea=
[],P=[],la=[],ba=0,K=null,V=null;k.preloadedImages={};k.preloadedAudios={};var R="rnnoise.wasm";d(R,"data:application/octet-stream;base64,")||(R=e(R));ea.push({func:function(){y()}});var O={a:function(a,c,b){M.copyWithin(a,c,c+b)},b:function(c){c>>>=0;var d=M.length;if(2147483648<c)return!1;for(var e=1;4>=e;e*=2){var g=d*(1+.2/e);g=Math.min(g,c+100663296);g=Math.min(2147483648,a(Math.max(16777216,c,g),65536));a:{try{z.grow(g-ca.byteLength+65535>>>16);b(z.buffer);var f=1;break a}catch(aa){}f=void 0}if(f)return!0}return!1},
memory:z,table:t};(function(){function a(a,c){k.asm=a.exports;ba--;k.monitorRunDependencies&&k.monitorRunDependencies(ba);0==ba&&(null!==K&&(clearInterval(K),K=null),V&&(a=V,V=null,a()))}function b(c){a(c.instance)}function e(a){return n().then(function(a){return WebAssembly.instantiate(a,g)}).then(a,function(a){c("failed to asynchronously prepare wasm: "+a);l(a)})}var g={a:O};ba++;k.monitorRunDependencies&&k.monitorRunDependencies(ba);if(k.instantiateWasm)try{return k.instantiateWasm(g,a)}catch(ha){return c("Module.instantiateWasm callback failed with error: "+
ha),!1}(function(){if(Q||"function"!==typeof WebAssembly.instantiateStreaming||d(R,"data:application/octet-stream;base64,")||"function"!==typeof fetch)return e(b);fetch(R,{credentials:"same-origin"}).then(function(a){return WebAssembly.instantiateStreaming(a,g).then(b,function(a){c("wasm streaming compile failed: "+a);c("falling back to ArrayBuffer instantiation");return e(b)})})})();return{}})();var y=k.___wasm_call_ctors=function(){return(y=k.___wasm_call_ctors=k.asm.c).apply(null,arguments)};k._rnnoise_init=
function(){return(k._rnnoise_init=k.asm.d).apply(null,arguments)};k._rnnoise_create=function(){return(k._rnnoise_create=k.asm.e).apply(null,arguments)};k._malloc=function(){return(k._malloc=k.asm.f).apply(null,arguments)};k._rnnoise_destroy=function(){return(k._rnnoise_destroy=k.asm.g).apply(null,arguments)};k._free=function(){return(k._free=k.asm.h).apply(null,arguments)};k._rnnoise_process_frame=function(){return(k._rnnoise_process_frame=k.asm.i).apply(null,arguments)};var W;V=function X(){W||q();
W||(V=X)};k.run=q;if(k.preInit)for("function"==typeof k.preInit&&(k.preInit=[k.preInit]);0<k.preInit.length;)k.preInit.pop()();q();return k.ready}}();r.a=f}).call(r,p(24))},function(l,r,p){var f=p(0),q=p(7),k=p(11),e=p(19);p(14);l=p(1);var a=p.n(l),b=p(4);p(6);p(5);r.a=function(h,l){var d=Object(b.c)(l);d.rooms=new Map;d.currentBreakOutRoom=null;d.joinRoom=function(h,n,l,w){w=void 0===w?{allow_reconnect:!0,number_of_attempts:3,timeout_interval:45E3}:w;var u=null,v=null;f.a.info("SDK version is: ",
a.a.product.version);if(null!=h){f.a.info("=========== port of hope");h=JSON.parse(window.atob(h));h.version=a.a.product.version;var p=Object(k.a)(void 0,void 0,{token:e.a.encodeBase64(JSON.stringify(h)),reconnectInfo:w});h=function(){if("IE"===q.a.browserEngineCheck()){n.video=!1;var a=document.getElementById("WebrtcEverywherePluginId");a.addEventListener("room-connected",function(a){d.rooms.set(p.roomID,p);v={streams:a.data.streams,room:p,roomData:a.data.room,localStream:A};p.publish(A,function(a){0===
a.result?(v.publishId=a.id,l(v,null)):l(null,a)})});a.addEventListener("room-error",function(a){l(v,a.data)});a.addEventListener("stream-added",function(a){p.subscribe(a.data.stream)})}else p.addEventListener("room-connected",function(a){n.video=!1;f.a.info("-----------BreakoutRoom-Connected--------");v={streams:a.streams,room:p,roomData:a.room,localStream:A};l(v,null);p.publish(A,function(a){0===a.result?v.publishId=a.id:p.dispatchEvent(Object(b.e)({type:"room-error",message:a}))});for(a=0;a<v.streams.length;a++)p.subscribe(v.streams[a],
{},function(a){!0===a?f.a.info("breakout room-subscribe callback success"):(f.a.info("breakout room-subscribe callback failed, could not subscribe streams",a),p.dispatchEvent(Object(b.e)({type:"room-error",message:a})))});d.rooms.set(p.roomID,p);a=Object(b.e)({type:"breakout-room-connected",success:v});d.dispatchEvent(a)}),p.addEventListener("room-error",function(a){l(null,a)}),p.addEventListener("stream-added",function(a){p.subscribe(a.stream)}),p.addEventListener("room-disconnected",d.onBreakOutRoomDisconnect.bind(p));
!1===p.reconnectionState&&0==p.reconnectAttempt?(f.a.info("-----------BreakoutRoom-Connecting--------"),p.connect(w)):f.a.debug(" Reconnection case in join room public api")};var x=function(a){u=a;l(v,u)};if(n.audio||n.video)var A=p.initPublishStream(n.div,n,h,x);else f.a.info(" No publish stream. audio and video are disabled.."),h()}return A};d.endBreakOutRoom=function(a){f.a.info("Breakout Room ended, Disconnecting the room");d.rooms.get(a).disconnect()};d.onBreakOutRoomDisconnect=function(a){var e=
Object(b.e)({type:"breakout-room-disconnect",message:{room_id:a.id}});d.rooms.delete(a.roomID);d.dispatchEvent(e)};d.onUserLeft=function(a,b){a=UserEvent({type:"user-disconnected",room_id:a.roomID,name:b.name,clientId:b.clientId,role:b.role,permission:b.permissions});d.dispatchEvent(a)};d.onUserJoined=function(a,b){a=b.name;var e=b.role,f=b.permissions,h={name:b.name,permissions:b.permissions,role:b.role,user_ref:b.user_ref,videoMuted:b.videoMuted,audioMuted:b.audioMuted};d.userList.set(b.clientId,
h);b=UserEvent({type:"user-connected",name:a,clientId:b.clientId,role:e,permission:f,user:h});d.dispatchEvent(b)};d.disconnectAll=function(){d.rooms.forEach(function(a,b){a&&a.disconnect()})};return d}},function(l,r,p){r.a=function(){var f={},l={};f.add=function(f,e){l[f]=e};f.get=function(f){return l[f]};f.getAll=function(){return l};f.has=function(f){return void 0!==l[f]};f.forEach=function(f){for(var e=Object.keys(l),a=0;a<e.length;a+=1){var b=e[a];f(l[b],b)}};f.keys=function(){return Object.keys(l)};
f.remove=function(f){delete l[f]};f.size=function(){var f=0,e;for(e in l)l.hasOwnProperty(e)&&f++;return f};return f}},function(l,r){r.read=function(l,f,q,k,e){var a=8*e-k-1;var b=(1<<a)-1,h=b>>1,p=-7;e=q?e-1:0;var d=q?-1:1,u=l[f+e];e+=d;q=u&(1<<-p)-1;u>>=-p;for(p+=a;0<p;q=256*q+l[f+e],e+=d,p-=8);a=q&(1<<-p)-1;q>>=-p;for(p+=k;0<p;a=256*a+l[f+e],e+=d,p-=8);if(0===q)q=1-h;else{if(q===b)return a?NaN:Infinity*(u?-1:1);a+=Math.pow(2,k);q-=h}return(u?-1:1)*a*Math.pow(2,q-k)};r.write=function(l,f,q,k,e,
a){var b,h=8*a-e-1,p=(1<<h)-1,d=p>>1,u=23===e?Math.pow(2,-24)-Math.pow(2,-77):0;a=k?0:a-1;var n=k?1:-1,r=0>f||0===f&&0>1/f?1:0;f=Math.abs(f);isNaN(f)||Infinity===f?(f=isNaN(f)?1:0,k=p):(k=Math.floor(Math.log(f)/Math.LN2),1>f*(b=Math.pow(2,-k))&&(k--,b*=2),f=1<=k+d?f+u/b:f+u*Math.pow(2,1-d),2<=f*b&&(k++,b/=2),k+d>=p?(f=0,k=p):1<=k+d?(f=(f*b-1)*Math.pow(2,e),k+=d):(f=f*Math.pow(2,d-1)*Math.pow(2,e),k=0));for(;8<=e;l[q+a]=f&255,a+=n,f/=256,e-=8);k=k<<e|f;for(h+=e;0<h;l[q+a]=k&255,a+=n,k/=256,h-=8);l[q+
a-n]|=128*r}},function(l,r){var p={}.toString;l.exports=Array.isArray||function(f){return"[object Array]"==p.call(f)}},function(l,r,p){l=p(32);var f=p.n(l),q=p(60),k=p(23),e=p(12);p.n(e);var a=p(16),b=p(0);p=function(){var a=f.a.call(this,"FileSender")||this;a.keychain=new k.a;a.reset();return a};$jscomp.inherits(p,f.a);p.prototype.reset=function(){this.uploadRequest=null;this.msg="importingFile";this.progress=[0,1];this.cancelled=!1};p.prototype.cancel=function(){this.cancelled=!0;this.uploadRequest&&
this.uploadRequest.cancel()};p.prototype.upload=function(f,k){var d=this,h,n,l,w,t,v,p,x,A;return $jscomp.asyncExecutePromiseGeneratorProgram(function(u){switch(u.nextAddress){case 1:if(d.cancelled)throw Error(0);d.msg="encryptingFile";d.emit("encrypting");h=Object(e.encryptedSize)(f.size);return u.yield(d.keychain.encryptStream(f.stream),2);case 2:return n=u.yieldResult,u.yield(d.keychain.encryptMetadata(f),3);case 3:return l=u.yieldResult,u.yield(d.keychain.authKeyB64(),4);case 4:w=u.yieldResult;
t={name:f.name,plainSize:f.size,type:f.type,totalSize:h};d.uploadRequest=Object(a.i)(n,l,w,f.timeLimit,f.dlimit,k,t,function(a){d.progress=[a,h];d.emit("progress")});if(d.cancelled)throw Error(0);d.msg="fileSizeProgress";d.emit("progress");u.setCatchFinallyBlocks(5);return u.yield(d.uploadRequest.result,7);case 7:return v=u.yieldResult,d.msg="notifyUploadEncryptDone",d.uploadRequest=null,d.progress=[1,1],p=Object(e.arrayToB64)(d.keychain.rawSecret),x=new q.a({id:v.id,url:v.url+"#"+p,name:f.name,size:f.size,
manifest:f.manifest,time:v.duration,speed:f.size/(v.duration/1E3),createdAt:Date.now(),expiresAt:Date.now()+1E3*f.timeLimit,secretKey:p,nonce:d.keychain.nonce,ownerToken:v.ownerToken,dlimit:f.dlimit,timeLimit:f.timeLimit,mnounce:v.mnounce}),u.return(x);case 5:throw A=u.enterCatchBlock(),b.a.info("upload request failed",A),d.msg="errorPageHeader",d.uploadRequest=null,A;}})};$jscomp.global.Object.defineProperties(p.prototype,{progressRatio:{configurable:!0,enumerable:!0,get:function(){return this.progress[0]/
this.progress[1]}},progressIndefinite:{configurable:!0,enumerable:!0,get:function(){return-1===["fileSizeProgress","notifyUploadEncryptDone"].indexOf(this.msg)}},sizes:{configurable:!0,enumerable:!0,get:function(){return{partialSize:Object(e.bytes)(this.progress[0]),totalSize:Object(e.bytes)(this.progress[1])}}}});r.a=p},function(l,r,p){l.exports=function(f,l,k){var e=f.length;if(!(l>=e||0===k)){k=l+k>e?e-l:k;for(e-=k;l<e;++l)f[l]=f[l+k];f.length=e}}},function(l,r,p){function f(b){function h(e){var f=
"end-"+l+"-"+b;a.mark(f);k.push(function(){var h=null;try{a.measure(b+" ["+l+"]",d,f),a.clearMarks(d),a.clearMarks(f)}catch(w){h=w}e&&e(h,b)})}e.equal(typeof b,"string","nanotiming: name should be type string");if(f.disabled)return q;var l=(1E4*a.now()).toFixed()%Number.MAX_SAFE_INTEGER,d="start-"+l+"-"+b;a.mark(d);h.uuid=l;return h}function q(a){a&&k.push(function(){a(Error("nanotiming: performance API unavailable"))})}var k=p(59)(),e=p(22);f.disabled=!0;try{var a=window.performance;f.disabled="true"===
window.localStorage.DISABLE_NANOTIMING||!a.mark}catch(b){}l.exports=f},function(l,r,p){function f(e){this.method=(this.hasIdle=(this.hasWindow=e)&&window.requestIdleCallback)?window.requestIdleCallback.bind(window):this.setTimeout;this.scheduled=!1;this.queue=[]}var q=p(22),k="undefined"!==typeof window;f.prototype.push=function(e){q.equal(typeof e,"function","nanoscheduler.push: cb should be type function");this.queue.push(e);this.schedule()};f.prototype.schedule=function(){if(!this.scheduled){this.scheduled=
!0;var e=this;this.method(function(a){for(var b;e.queue.length&&0<a.timeRemaining();)b=e.queue.shift(),b(a);e.scheduled=!1;e.queue.length&&e.schedule()})}};f.prototype.setTimeout=function(e){setTimeout(e,0,{timeRemaining:function(){return 1}})};l.exports=function(){if(k){window._nanoScheduler||(window._nanoScheduler=new f(!0));var e=window._nanoScheduler}else e=new f;return e}},function(l,r,p){var f=p(23),q=p(12);p.n(q);var k=p(16);l=function(e){if(!e.manifest)throw Error("invalid file object");this.id=
e.id;this.url=e.url;this.name=e.name;this.size=e.size;this.manifest=e.manifest;this.time=e.time;this.speed=e.speed;this.createdAt=e.createdAt;this.expiresAt=e.expiresAt;this.ownerToken=e.ownerToken;this.dlimit=e.dlimit||1;this.dtotal=e.dtotal||0;this.keychain=new f.a(e.secretKey,e.nonce);this._hasPassword=!!e.hasPassword;this.timeLimit=e.timeLimit;this.mnounce=e.mnounce};l.prototype.setPassword=function(e){var a=this,b,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.setCatchFinallyBlocks(2),
a.password=e,a._hasPassword=!0,a.keychain.setPassword(e,a.url),h.yield(Object(k.h)(a.id,a.ownerToken,a.keychain),4);if(2!=h.nextAddress)return b=h.yieldResult,h.return(b);f=h.enterCatchBlock();a.password=null;a._hasPassword=!1;throw f;})};l.prototype.del=function(){return Object(k.a)(this.id,this.ownerToken)};l.prototype.changeLimit=function(e,a){a=void 0===a?{}:a;return this.dlimit!==e?(this.dlimit=e,Object(k.g)(this.id,this.ownerToken,a.bearerToken,{dlimit:e})):Promise.resolve(!0)};l.prototype.updateDownloadCount=
function(){var e=this,a,b,f,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:return a=e.dtotal,b=e.dlimit,d.setCatchFinallyBlocks(2),d.yield(Object(k.c)(e.id,e.ownerToken),4);case 4:f=d.yieldResult;e.dtotal=f.dtotal;e.dlimit=f.dlimit;d.leaveTryBlock(3);break;case 2:l=d.enterCatchBlock(),"404"===l.message&&(e.dtotal=e.dlimit);case 3:return d.return(a!==e.dtotal||b!==e.dlimit)}})};l.prototype.toJSON=function(){return{id:this.id,url:this.url,name:this.name,
size:this.size,manifest:this.manifest,time:this.time,speed:this.speed,createdAt:this.createdAt,expiresAt:this.expiresAt,secretKey:Object(q.arrayToB64)(this.keychain.rawSecret),ownerToken:this.ownerToken,dlimit:this.dlimit,dtotal:this.dtotal,hasPassword:this.hasPassword,timeLimit:this.timeLimit,mnounce:this.mnounce}};$jscomp.global.Object.defineProperties(l.prototype,{hasPassword:{configurable:!0,enumerable:!0,get:function(){return!!this._hasPassword}},expired:{configurable:!0,enumerable:!0,get:function(){return this.dlimit===
this.dtotal||Date.now()>this.expiresAt}}});r.a=l},function(l,r,p){var f=p(21);l=function(f,k,e){f=void 0===f?[]:f;k=void 0===k?86400:k;e=void 0===e?{}:e;this.files=Array.from(f);this.timeLimit=this.defaultTimeLimit=k;this.dlimit=10;this.password=null;this.roomMeta=e};l.prototype.addFiles=function(f,k,e){var a=this;if(this.files.length+f.length>e)throw Error("tooManyFiles");f=f.filter(function(b){var e;if(e=0<b.size){a:{e=$jscomp.makeIterator(a.files);for(var f=e.next();!f.done;f=e.next())if(f=f.value,
b.name===f.name&&b.size===f.size&&b.lastModified===f.lastModified){b=!0;break a}b=!1}e=!b}return e});e=f.reduce(function(a,e){return a+e.size},0);if(this.size+e>k)throw Error("fileTooBig");this.files=this.files.concat(f);return!0};l.prototype.remove=function(f){f=this.files.indexOf(f);-1<f&&this.files.splice(f,1)};l.prototype.clear=function(){this.files=[];this.dlimit=1;this.timeLimit=this.defaultTimeLimit;this.password=null;this.roomMeta={}};$jscomp.global.Object.defineProperties(l.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return 1<this.files.length?"Send-Archive.zip":this.files[0].name}},type:{configurable:!0,enumerable:!0,get:function(){return 1<this.files.length?"send-archive":this.files[0].type}},size:{configurable:!0,enumerable:!0,get:function(){return this.files.reduce(function(f,k){return f+k.size},0)}},numFiles:{configurable:!0,enumerable:!0,get:function(){return this.files.length}},manifest:{configurable:!0,enumerable:!0,get:function(){return{files:this.files.map(function(f){return{name:f.name,
size:f.size,type:f.type}})}}},stream:{configurable:!0,enumerable:!0,get:function(){return Object(f.b)(this.files.map(function(l){return Object(f.a)(l)}))}}});r.a=l},function(l,r,p){function f(a,b){b=void 0===b?!1:b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){return d.return(new Promise(function(d,e){var f={};f=new DataView(a.plaintext);f=new Blob([f],{type:a.type});if(!0===b)return x.a.info(" download file mobile device",b),f={messageType:"download-success",result:0,description:"download-success",
response:{downloadStatus:"success",name:a.name,type:a.type,size:a.size,blob:f}},d(f);if(navigator.msSaveBlob)return console.log("nagivator service worker is present"),navigator.msSaveBlob(f,a.name),d();if(/iPhone|fxios/i.test(navigator.userAgent)){var h=new FileReader;h.addEventListener("loadend",function(){if(h.error)return e(h.error);if(h.result){var b=document.createElement("a");b.href=h.result;b.download=a.name;document.body.appendChild(b);b.click()}d()});h.readAsDataURL(f)}else{f=URL.createObjectURL(f);
var k=document.createElement("a");k.href=f;k.download=a.name;document.body.appendChild(k);k.click();URL.revokeObjectURL(f);f={messageType:"download-success",result:0,description:"download-success",response:{downloadStatus:"success",name:a.name,type:a.type,size:a.size}};setTimeout(d(f),100)}}))})}l=p(32);var q=p.n(l),k=p(23),e=p(12);p.n(e);var a=p(16),b=p(21),h=p(63),x=p(0);p=function(a){var b=q.a.call(this,"FileReceiver")||this;b.keychain=new k.a(a.secretKey,a.nonce);a.requiresPassword&&b.keychain.setPassword(a.password,
a.url);b.fileInfo=a;b.reset();return b};$jscomp.inherits(p,q.a);p.prototype.cancel=function(){this.downloadRequest&&this.downloadRequest.cancel()};p.prototype.reset=function(){this.msg="fileSizeProgress";this.state="initialized";this.progress=[0,1]};p.prototype.getMetadata=function(){var b=this,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(Object(a.e)(b.fileInfo.id,b.keychain),2);e=d.yieldResult;b.fileInfo.name=e.name;b.fileInfo.type=e.type;b.fileInfo.iv=
e.iv;b.fileInfo.size=+e.size;b.fileInfo.manifest=e.manifest;b.state="ready";d.jumpToEnd()})};p.prototype.sendMessageToSw=function(a){return new Promise(function(b,d){var e=new MessageChannel;e.port1.onmessage=function(a){void 0===a.data?d("bad response from serviceWorker"):void 0!==a.data.error?d(a.data.error):b(a.data)};navigator.serviceWorker.controller.postMessage(a,[e.port2])})};p.prototype.downloadBlob=function(d,k){d=void 0===d?!1:d;k=void 0===k?!1:k;var n=this,l,u,t,q,p,x,A,r;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){switch(c.nextAddress){case 1:return n.state=
"downloading",l=n,c.yield(Object(a.b)(n.fileInfo.id,n.keychain,function(a){n.progress=[a,n.fileInfo.size];n.emit("progress")}),2);case 2:return l.downloadRequest=c.yieldResult,c.setCatchFinallyBlocks(3),c.yield(n.downloadRequest.result,5);case 5:return u=c.yieldResult,n.downloadRequest=null,n.msg="decryptingFile",n.state="decrypting",n.emit("decrypting"),t=n.fileInfo.size,q=n.keychain.decryptStream(Object(b.a)(u)),"send-archive"===n.fileInfo.type&&(p=new h.a(n.fileInfo.manifest,q),q=p.stream,t=p.size),
c.yield(Object(e.streamToArrayBuffer)(q,t),6);case 6:x=c.yieldResult;A={};if(d){c.jumpTo(7);break}return c.yield(f({plaintext:x,name:decodeURIComponent(n.fileInfo.name),type:n.fileInfo.type},k),8);case 8:A=c.yieldResult;case 7:return n.msg="downloadFinish",n.emit("complete"),n.state="complete",c.return(A);case 3:throw r=c.enterCatchBlock(),n.downloadRequest=null,r;}})};p.prototype.downloadStream=function(b){b=void 0===b?!1:b;var d=this,f,h,k,l,q,p,x,A,r,c,Q,z;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){switch(n.nextAddress){case 1:return f=
Date.now(),h=function(a){d.progress=[a,d.fileInfo.size];d.emit("progress")},d.downloadRequest={cancel:function(){d.sendMessageToSw({request:"cancel",id:d.fileInfo.id})}},n.setCatchFinallyBlocks(2),d.state="downloading",k={request:"init",id:d.fileInfo.id,filename:d.fileInfo.name,type:d.fileInfo.type,manifest:d.fileInfo.manifest,key:d.fileInfo.secretKey,requiresPassword:d.fileInfo.requiresPassword,password:d.fileInfo.password,url:d.fileInfo.url,size:d.fileInfo.size,nonce:d.keychain.nonce,noSave:b},
n.yield(d.sendMessageToSw(k),4);case 4:h(0);if(!b){l="/api/download/"+d.fileInfo.id;q=Object(a.d)(l);q===l&&(q=location.protocol+"//"+location.host+l);p=document.createElement("a");p.href=q;document.body.appendChild(p);p.click();n.jumpTo(5);break}return n.yield(fetch(Object(a.d)("/api/download/"+d.fileInfo.id)),6);case 6:if(x=n.yieldResult,200!==x.status)throw Error(x.status);case 5:r=A=0;case 7:if(!(A<d.fileInfo.size)){d.downloadRequest=null;d.msg="downloadFinish";d.emit("complete");d.state="complete";
n.leaveTryBlock(0);break}return n.yield(d.sendMessageToSw({request:"progress",id:d.fileInfo.id}),9);case 9:c=n.yieldResult;c.progress===A?r++:r=0;if(30<r)throw Q=Error("hung download"),Q.duration=Date.now()-f,Q.size=d.fileInfo.size,Q.progress=A,Q;A=c.progress;h(A);return n.yield(Object(e.delay)(1E3),7);case 2:z=n.enterCatchBlock();d.downloadRequest=null;if("cancelled"===z||"400"===z.message)throw Error(0);throw z;}})};p.prototype.download=function(a){return a.stream?this.downloadStream(a.noSave):
this.downloadBlob(a.noSave,a.isMobile)};$jscomp.global.Object.defineProperties(p.prototype,{progressRatio:{configurable:!0,enumerable:!0,get:function(){return this.progress[0]/this.progress[1]}},progressIndefinite:{configurable:!0,enumerable:!0,get:function(){return"downloading"!==this.state}},sizes:{configurable:!0,enumerable:!0,get:function(){return{partialSize:Object(e.bytes)(this.progress[0]),totalSize:Object(e.bytes)(this.progress[1])}}}});r.a=p},function(l,r,p){function f(a,e,f){var b=new ArrayBuffer(22),
h=new DataView(b);h.setUint32(0,101010256,!0);h.setUint16(4,0,!0);h.setUint16(6,0,!0);h.setUint16(8,a,!0);h.setUint16(10,a,!0);h.setUint32(12,e,!0);h.setUint32(16,f,!0);h.setUint16(20,0,!0);return new Uint8Array(b)}var q=p(64),k=new TextEncoder,e=function(a){this.name=k.encode(a.name);this.size=a.size;this.bytesRead=0;this.crc=null;a=void 0;a=void 0===a?new Date:a;var b=a.getFullYear()-1980<<9,e=a.getMonth()+1<<5,d=a.getDate();b=b|e|d;e=a.getHours()<<11;d=a.getMinutes()<<5;a=Math.floor(a.getSeconds()/
2);this.dateTime={date:b,time:e|d|a}};e.prototype.directoryRecord=function(a){var b=new ArrayBuffer(46+this.name.byteLength),e=new DataView(b);e.setUint32(0,33639248,!0);e.setUint16(4,20,!0);e.setUint16(6,20,!0);e.setUint16(8,8,!0);e.setUint16(10,0,!0);e.setUint16(12,this.dateTime.time,!0);e.setUint16(14,this.dateTime.date,!0);e.setUint32(16,this.crc,!0);e.setUint32(20,this.size,!0);e.setUint32(24,this.size,!0);e.setUint16(28,this.name.byteLength,!0);e.setUint16(30,0,!0);e.setUint16(32,0,!0);e.setUint16(34,
0,!0);e.setUint16(36,0,!0);e.setUint32(38,0,!0);e.setUint32(42,a,!0);for(a=0;a<this.name.byteLength;a++)e.setUint8(46+a,this.name[a]);return new Uint8Array(b)};e.prototype.append=function(a,e){this.bytesRead+=a.byteLength;var b=a.byteLength-Math.max(this.bytesRead-this.size,0),d=a.slice(0,b);this.crc=Object(q.a)(d,this.crc);e.enqueue(d);if(b<a.byteLength)return a.slice(b,a.byteLength)};$jscomp.global.Object.defineProperties(e.prototype,{header:{configurable:!0,enumerable:!0,get:function(){var a=new ArrayBuffer(30+
this.name.byteLength),e=new DataView(a);e.setUint32(0,67324752,!0);e.setUint16(4,20,!0);e.setUint16(6,8,!0);e.setUint16(8,0,!0);e.setUint16(10,this.dateTime.time,!0);e.setUint16(12,this.dateTime.date,!0);e.setUint32(14,0,!0);e.setUint32(18,0,!0);e.setUint32(22,0,!0);e.setUint16(26,this.name.byteLength,!0);e.setUint16(28,0,!0);for(var f=0;f<this.name.byteLength;f++)e.setUint8(30+f,this.name[f]);return new Uint8Array(a)}},dataDescriptor:{configurable:!0,enumerable:!0,get:function(){var a=new ArrayBuffer(16),
e=new DataView(a);e.setUint32(0,134695760,!0);e.setUint32(4,this.crc,!0);e.setUint32(8,this.size,!0);e.setUint32(12,this.size,!0);return new Uint8Array(a)}},byteLength:{configurable:!0,enumerable:!0,get:function(){return this.size+this.name.byteLength+30+16}}});var a=function(a,e){this.files=a;this.fileIndex=0;this.file=null;this.reader=e.getReader();this.nextFile();this.extra=null};a.prototype.nextFile=function(){this.file=this.files[this.fileIndex++]};a.prototype.pull=function(a){var b=this,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==
d.nextAddress){if(!b.file){for(var h=b.files,k=0,l=0,q=0;q<h.length;q++){var t=h[q],p=t.directoryRecord(k);k+=t.byteLength;a.enqueue(p);l+=p.byteLength}a.enqueue(f(h.length,l,k));return d.return(a.close())}0===b.file.bytesRead&&(a.enqueue(b.file.header),b.extra&&(b.extra=b.file.append(b.extra,a)));return b.file.bytesRead>=b.file.size?(a.enqueue(b.file.dataDescriptor),b.nextFile(),d.return(b.pull(a))):d.yield(b.reader.read(),2)}e=d.yieldResult;if(e.done)return b.nextFile(),d.return(b.pull(a));b.extra=
b.file.append(e.value,a);d.jumpToEnd()})};l=function(a,f){this.files=a.files.map(function(a){return new e(a)});this.source=f};$jscomp.global.Object.defineProperties(l.prototype,{stream:{configurable:!0,enumerable:!0,get:function(){return new ReadableStream(new a(this.files,this.source))}},size:{configurable:!0,enumerable:!0,get:function(){return this.files.reduce(function(a,e){return a+2*e.byteLength-e.size},0)+22}}});r.a=l},function(l,r,p){var f=p(17);p.n(f);var q=p(65);l=p(66);var k=[0,1996959894,
3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,
1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,
1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,
2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,
752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,
3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!==typeof Int32Array&&(k=new Int32Array(k));l=Object(l.a)("crc-32",function(e,a){f.Buffer.isBuffer(e)||(e=Object(q.a)(e));a=0===a?0:~~a^-1;for(var b=0;b<e.length;b++)a=k[(a^e[b])&255]^a>>>8;return a^-1});r.a=l},function(l,r,p){var f=p(17);p.n(f);r.a=f.Buffer.from&&f.Buffer.alloc&&f.Buffer.allocUnsafe&&
f.Buffer.allocUnsafeSlow?f.Buffer.from:function(l){return new f.Buffer(l)}},function(l,r,p){r.a=function(f,l){var k=function(e,a){return l(e,a)>>>0};k.signed=l;k.unsigned=k;k.model=f;return k}},function(l,r,p){r.a={isAnnotationStarted:!1,canvasOptions:{width:0,height:0},frameStyle:"display:block; user-select: none;z-index:0; position:absolute;top:0%",annotateStyle:"display:block; user-select: none;z-index:2; position:absolute;top:0%",annotationConfig:{toolType:"draw",isErase:!1,drawMethod:"pencil",
strokeColor:"#ff0000",lineWidth:3,hasInput:!1,lastMouseX:0,lastMouseY:0,canvasX:0,canvasY:0,mouseX:0,mouseY:0,mouseDown:!1,drawElement:null,drawCtx:null,canvasDomID:null,canvasVideoPlayerID:null,customCanvasID:"draw_veneer2",customframeID:"draw_frame",pausePlayTime:0,videoPlaying:!1,streamid:0,setTimeLoop:.3},setupAnnotationToolbar:function(){var f=document.createElement("div");f.setAttribute("id","annotationToolbarContainer");f.style="position: absolute;bottom: 0; z-index: 98;";var l=document.createElement("div");
l.setAttribute("id","toolbar");l.innerHTML='<div class="atn-btns">\n      <button id="annotate-draw">Draw</button>\n      <select id="selDrawMethod">\n        <option value="pencil" selected="selected">Pencil</option>\n        <option value="text">Text</option>\n      </select>\n      <input\n      type="color"\n      id="favcolor"\n      name="favcolor"\n      value="#ff0000"\n      \n    />\n    <select id="selWidth" >\n      <option value="1">1</option>\n      <option value="3" selected="selected">3</option>\n      <option value="5">5</option>\n      <option value="7">7</option>\n      <option value="9">9</option>\n      <option value="11">11</option>\n    </select>\n    <input type="button" id="eraseBtn" value="Erase" />\n    <input type="button" id="clearBtn" value="Clear" />\n    <input type="button" id="play" value="Play-Pause" />\n    \n      </div>';
f.append(l);return{toolbarCont:f,toolbar:l}},_QS:function(f,l){return(void 0===l?0:l)?document.querySelectorAll(""+f)?document.querySelectorAll(""+f):!1:document.querySelector(""+f)?document.querySelector(""+f):!1},bindEventListernersForTools:function(){var f=this;f._QS("#annotate-draw")&&f._QS("#annotate-draw").addEventListener("click",function(l){f.annotateToolAction("tool","draw")});f._QS("#selDrawMethod")&&f._QS("#selDrawMethod").addEventListener("change",function(l){f.annotateToolAction("drawMethod",
l.target.value)});f._QS("#selWidth")&&f._QS("#selWidth").addEventListener("change",function(l){f.annotateToolAction("lineWidth",l.target.value)});f._QS("#favcolor")&&f._QS("#favcolor").addEventListener("change",function(l){f.annotateToolAction("strokeColor",l.target.value)});f._QS("#eraseBtn")&&f._QS("#eraseBtn").addEventListener("click",function(l){f.annotateToolAction("erase")});f._QS("#clearBtn")&&f._QS("#clearBtn").addEventListener("click",function(l){f.annotateToolAction("clear")});f._QS("#play")&&
f._QS("#play").addEventListener("click",function(l){f.pause_play()})},annotateAddInput:function(f,l){var k=this,e=document.createElement("input");e.className="annotate-text";e.type="text";e.style.position="fixed";e.style.zIndex=50;e.style.left=f-4+"px";e.style.top=l-4+"px";e.onkeydown=function(a){var b=a.keyCode;13===b?(k.annotateDrawText(a.target.value),document.body.removeChild(a.target),k.annotationConfig.hasInput=!1):27===b&&(document.body.removeChild(a.target),k.annotationConfig.hasInput=!1)};
document.body.appendChild(e);e.focus();this.annotationConfig.hasInput=!0},pause_play:function(){var f=this;if(f.annotationConfig.videoPlaying)clearInterval(f.annotationConfig.pausePlayTime),f.annotationConfig.videoPlaying=!1;else{var l=document.getElementById("stream"+f.annotationConfig.streamid);if(l){var k=document.getElementById(f.annotationConfig.customframeID);if(k){var e=k.getContext("2d");f.annotationConfig.pausePlayTime=setInterval(function(){0<f.canvasOptions.width&&0<f.canvasOptions.height&&
e.drawImage(l,0,0,f.canvasOptions.width,f.canvasOptions.height)},f.annotationConfig.setTimeLoop);f.annotationConfig.videoPlaying=!0}}}},handleEnter:function(f){var l=f.keyCode;13===l?(this.annotateDrawText(f.target.value),document.body.removeChild(f.target),this.annotationConfig.hasInput=!1):27===l&&(document.body.removeChild(f.target),this.annotationConfig.hasInput=!1)},annotateDrawText:function(f){this.annotationConfig.drawCtx.textBaseline="top";this.annotationConfig.drawCtx.textAlign="left";this.annotationConfig.drawCtx.fillStyle=
this.annotationConfig.strokeColor;this.annotationConfig.drawCtx.font="14px sans-serif";this.annotationConfig.drawCtx.fillText(f,this.annotationConfig.lastMouseX-4,this.annotationConfig.lastMouseY-4)},reOffset:function(f){f=f.getBoundingClientRect();this.annotationConfig.canvasX=f.left;this.annotationConfig.canvasY=f.top},startFrame:function(){this.annotationConfig.videoPlaying=!1},getCanvasId:function(){return this.annotationConfig.customCanvasID},getVideoFrameId:function(){return this.annotationConfig.customframeID},
getCanvasWidth:function(){return this.canvasOptions.width},getCanvasHeight:function(){return this.canvasOptions.height},toolBarAction:function(f,l){if("tool"===f)this.annotationConfig.toolType=l,this.annotationConfig.isErase=!1;else if("erase"===f)this.annotationConfig.toolType=f,this.annotationConfig.isErase=!0;else if("strokeColor"===f)this.annotationConfig.strokeColor=l;else if("lineWidth"===f)this.annotationConfig.lineWidth=l;else if("drawMethod"===f)this.annotationConfig.drawMethod=l;else if("clear"===
f){for(f=document.getElementsByClassName("annotate-text");0<f.length;)f[0].remove();this.annotationConfig.drawCtx.clearRect(0,0,this.canvasOptions.width,this.canvasOptions.height)}},appendCustomCanvas:function(f,l,k,e){this.canvasOptions.width=k;this.canvasOptions.height=e;var a=document.createElement("canvas");a.id=this.annotationConfig.customCanvasID;a.width=k;a.height=e;a.className=l;a.setAttribute("style",this.annotateStyle);f&&(f.append(a),l=this.setupAnnotationToolbar(),f.append(l.toolbarCont))},
appendCanvasFrame:function(f,l,k,e,a){this.canvasOptions.width=k;this.canvasOptions.height=e;var b=document.createElement("canvas");b.getContext("2d");b.id=this.annotationConfig.customframeID;b.width=k;b.height=e;a&&(k=a.getID(),this.annotationConfig.streamid=k,document.getElementById("stream"+k)&&(b.className=l,b.setAttribute("style",this.frameStyle),f&&f.append(b)))},onDown:function(f,l){f.preventDefault();if("touchstart"==f.type||"touchmove"==f.type||"touchend"==f.type||"touchcancel"==f.type){f=
"undefined"===typeof f.originalEvent?f:f.originalEvent;l=f.touches[0]||f.changedTouches[0];var k=l.pageX;var e=l.pageY}else if("mousedown"==f.type||"mouseup"==f.type||"mousemove"==f.type||"mouseover"==f.type||"mouseout"==f.type||"mouseenter"==f.type||"mouseleave"==f.type)k=f.clientX,e=f.clientY;this.reOffset(this.annotationConfig.drawElement);this.annotationConfig.lastMouseX=this.annotationConfig.mouseX=parseInt(k-this.annotationConfig.canvasX);this.annotationConfig.lastMouseY=this.annotationConfig.mouseY=
parseInt(e-this.annotationConfig.canvasY);this.annotationConfig.mouseDown=!0;"text"===this.annotationConfig.drawMethod&&"draw"===this.annotationConfig.toolType&&this.annotateAddInput(k,e)},onMove:function(f,l,k){f.preventDefault();if("touchstart"==f.type||"touchmove"==f.type||"touchend"==f.type||"touchcancel"==f.type){f="undefined"===typeof f.originalEvent?f:f.originalEvent;k=f.touches[0]||f.changedTouches[0];var e=k.pageX;var a=k.pageY}else if("mousedown"==f.type||"mouseup"==f.type||"mousemove"==
f.type||"mouseover"==f.type||"mouseout"==f.type||"mouseenter"==f.type||"mouseleave"==f.type)e=f.clientX,a=f.clientY;this.annotationConfig.mouseX=parseInt(e-this.annotationConfig.canvasX);this.annotationConfig.mouseY=parseInt(a-this.annotationConfig.canvasY);this.annotationConfig.mouseDown&&"pencil"===this.annotationConfig.drawMethod&&(this.annotationConfig.drawCtx.beginPath(),"draw"===this.annotationConfig.toolType?(this.annotationConfig.drawCtx.globalCompositeOperation="source-over",this.annotationConfig.drawCtx.strokeStyle=
this.annotationConfig.strokeColor,this.annotationConfig.drawCtx.lineWidth=this.annotationConfig.lineWidth):(this.annotationConfig.drawCtx.globalCompositeOperation="destination-out",this.annotationConfig.drawCtx.lineWidth=10),this.annotationConfig.drawCtx.moveTo(this.annotationConfig.lastMouseX,this.annotationConfig.lastMouseY),this.annotationConfig.drawCtx.lineTo(this.annotationConfig.mouseX,this.annotationConfig.mouseY),this.annotationConfig.drawCtx.lineJoin=l.lineCap="round",this.annotationConfig.drawCtx.stroke());
this.annotationConfig.lastMouseX=this.annotationConfig.mouseX;this.annotationConfig.lastMouseY=this.annotationConfig.mouseY},onUp:function(f){f.preventDefault();this.annotationConfig.mouseDown=!1},annotateToolAction:function(f,l){this.toolBarAction(f,l)},mouseAnnotate:function(f,l,k,e){e=void 0===e?null:e;var a=this;e&&(a.stream=e);a.isAnnotationStarted=!0;a.annotationConfig.drawElement=document.getElementById(a.annotationConfig.customCanvasID);a.annotationConfig.drawCtx=a.annotationConfig.drawElement.getContext("2d");
a.annotationConfig.canvasDomID=f;a.annotationConfig.canvasVideoPlayerID=k;a.annotationConfig.drawElement.addEventListener("mousedown",function(b){a.onDown(b,!1)});a.annotationConfig.drawElement.addEventListener("touchstart",function(b){a.onDown(b,!0)});a.annotationConfig.drawElement.addEventListener("mousemove",function(b){a.onMove(b,l,!1)});a.annotationConfig.drawElement.addEventListener("touchmove",function(b){a.onMove(b,l,!0)});a.annotationConfig.drawElement.addEventListener("mouseup",function(b){a.onUp(b)});
a.annotationConfig.drawElement.addEventListener("touchcancel",function(b){a.onUp(b)});return a.annotationConfig.drawElement},stopAnnotation:function(){this.isAnnotationStarted=!1;var f=document.getElementById("canvas-wrapper");f&&f.remove();for(f=document.getElementsByClassName("annotate-text");0<f.length;)f[0].remove();f=document.querySelector(".annotate-div");var l=f.parentElement;l.prepend(f.firstElementChild);l.firstChild.style.height="100%";l.firstChild.style.width="100%";f.remove();this.annotationConfig.toolType=
"draw";this.annotationConfig.isErase=!1;this.annotationConfig.drawMethod="pencil";this.annotationConfig.strokeColor="#ff0000";this.annotationConfig.lineWidth=3},resize:function(){var f=this;f.isAnnotationStarted&&setTimeout(function(){var l=f.stream;if(l){var k=l.getID(),e=document.getElementById("stream"+k+"_veneer"),a=document.getElementById("draw_veneer2"),b=document.getElementById("draw_frame"),h=document.getElementById("canvas-wrapper");if(a&&b&&h){var p=a.getContext("2d"),d=p.getImageData(0,
0,a.width,a.height);l=l.stream.getVideoTracks()[0];l=l.getSettings()?l.getSettings():l.getConstraints();var u=l.height,n=l.width,r=document.querySelector(".annotate-div");k=document.querySelector("#player_"+k);l=r.clientHeight;r=r.clientWidth;if(l<r){var w=l/u,t=u*w;w*=n;w>r?(w=r/n,u*=w,n*=w):(u=t,n=w)}else w=r/n,t=u*w,w*=n,t>l?(w=l/u,u*=w,n*=w):(u=t,n=w);k.style.height=u+"px";k.style.width=n+"px";e.width=n;e.height=u;a.width=n;a.height=u;b.width=n;b.height=u;h.style.width=n+"px";h.style.height=u+
"px";createImageBitmap(d).then(function(a){p.drawImage(a,0,0,n,u)});f.canvasOptions.width=n;f.canvasOptions.height=u;f.reOffset(f.annotationConfig.drawElement)}}},100)}}},function(l,r,p){var f=p(0),q=p(7),k=p(11),e=p(19);p(14);l=p(1);var a=p.n(l),b=p(4),h=p(6);l=p(5);var x=p(9),d=p(8),u=l.a.constant,n=void 0,B={default:{minVideoBW:80,maxVideoBW:1500,scheme:"notify-break-recover"},disconnectRoom:function(a){n=void 0;a&&a.disconnect()},getDevice:function(b,d){if(void 0!=b&&null!=b)if("function"===typeof b){var e=
b;var k={mic:!0,cam:!0,speaker:!1}}else"object"===typeof b&&(void 0!=b.mic&&"boolean"!==typeof b.mic||void 0!=b.cam&&"boolean"!==typeof b.cam||void 0!=b.speaker&&"boolean"!==typeof b.speaker||(k=b));else k={mic:!0,cam:!0,speaker:!1};e||void 0==d||null==d||"function"!==typeof d||(e=d);a.a.is_supported()&&k&&e?q.a.getDeviceList(k,e):a.a.is_supported()?(f.a.error("Failed invalid param - callback or options"),e&&e(h.a.error_1155)):(f.a.error("Failed Webrtc support is missing "),e&&e(h.a.error_1000))},
notifyDeviceUpdate:function(b){a.a.is_supported()?b.notifyDeviceUpdate():f.a.info("Failed Webrtc support is missing ")},switchMediaDevice:function(b,d,e,k){k=void 0===k?function(){}:k;"function"===typeof k?a.a.is_supported()?d&&"string"===typeof d&&e&&"string"===typeof e?b.switchMediaDevices(b,d,e,k):(f.a.info("Invalid Device Id"),k(!1)):(f.a.info("Failed Webrtc support is missing "),k(h.a.error_1000)):f.a.error("switchMediaDevice() invalid param - callback")},joinRoom:function(l,t,p,r){var w=function(){},
v={},F={allow_reconnect:!0,number_of_attempts:3,timeout_interval:45E3};if(void 0==p&&void 0==r)f.a.error("joinRoom() failed, callback is missing. invalid parameters");else{if(void 0!=p&&"function"===typeof p)w=p,void 0!=r&&(F=r);else if(void 0!=r&&"function"===typeof r)if(w=r,void 0!=p)v=p;else{f.a.error("joinRoom() failed, callback is missing. invalid parameters");return}if(a.a.is_supported())if(void 0==l||void 0==t)f.a.error("joinRoom() failed, token/streamInfo is missing. invalid parameters"),
w(null,h.a.error_1155);else{var c=null,D=null;f.a.info("SDK version: "+a.a.product.version+" browser name: "+a.a.browser_type+" browser version: "+a.a.browser_info.version+" device type: "+a.a.browser_info.device_type);if(null!=l){l=JSON.parse(e.a.decodeBase64(l));x.a.init(l);l.version=a.a.product.version;v.reconnectInfo=F;v.token=e.a.encodeBase64(JSON.stringify(l));var z=Object(k.a)(void 0,void 0,v);v=function(){"IE"!==q.a.browserEngineCheck()&&(z.addEventListener("room-connected",function(c){D=
{streams:c.streams,room:z,roomData:c.room,localStream:J};n=z;if(void 0!==c.me&&null!==c.me&&("lecture"!==z.mode||"participant"!==c.me.role||z.floorGranted)&&(t.audio||t.video)){var e={scheme:t.scheme?t.scheme:B.default.scheme,maxVideoLayers:z.maxVideoLayers,forceTurn:t.forceTurn};t.maxVideoBW&&(e.maxVideoBW=t.maxVideoBW);t.minVideoBW&&(e.minVideoBW=t.minVideoBW);t.maxVideoFps&&(e.maxVideoFps=t.maxVideoFps);t.maxVideoFps&&(e.maxVideoFps=t.maxVideoFps);t.audioMuted&&(e.audioMuted=t.audioMuted);t.videoMuted&&
(e.videoMuted=t.videoMuted)}if("audience"===z.me.role&&z.subscription&&!z.subscription.hls)f.a.error("Licence error :  HLS not supported !!");else if(!1===z.reconnectionState){t.video&&z.subscription&&!z.subscription.audio_video&&(f.a.error("Licence error : video not supported, ignoring video option"),t.video=!1);t.audio&&z.subscription&&!z.subscription.audio_only&&!z.subscription.audio_video&&(f.a.error("Licence error : audio not supported, ignoring audio option"),t.audio=!1);var k=function(d,e){z.publish(J,
d,function(d){0===d.result?(D.publishId=d.id,z.mediaConfiguration!==u.H264_CODEC&&"safari"===a.a.browser_info.name&&a.a.browser_info.version<=u.SAFARI_VERSION_NOT_SUPPORTING_VP8?e(D,h.a.error_1152):e(D,null),c.mediaRecord&&z.dispatchEvent(Object(b.e)({type:"room-record-on",message:{}})),z.muteInfo.room.audio&&z.dispatchEvent(Object(b.e)({type:"room-muted",message:{}}))):d.result===h.a.error_1130.result?e(D,d):e(null,d)})};void 0!=e&&!1===z.waitRoom&&"viewer"!=z.me.role&&"audience"!=z.me.role?k(e,
w):"viewer"!=z.me.role&&"audience"!=z.me.role&&z.waitRoom?(w(D,null),z.addEventListener("wait-room-disabled",function(a){z.dispatchEvent(Object(b.e)({type:"room-allowed",message:a.message}));"lecture"!==z.mode&&k(e,w)})):(f.a.info("no audio&video"),J&&(t.audioMuted&&J.muteAudio(function(a){a.result==h.a.error_000.result&&z.dispatchEvent(Object(b.g)({type:"user-audio-muted",clientId:z.clientId}));f.a.info("audioSelfMuteCallback: "+JSON.stringify(a))},!1,0,!0),t.videoMuted&&J.muteVideo(function(a){a.result!==
h.a.error_000.result&&z.dispatchEvent(Object(b.g)({type:"user-video-muted",clientId:z.clientId}));f.a.info("videoSelfMuteCallback: "+JSON.stringify(a))},!1,0,!0)),w(D,null))}else{f.a.info("handle reconnection: for room-connected ");D={streams:c.streams,room:z,roomData:c.room,localStream:J};for(var l=0;l<D.streams.length;l++)z.subscribe(D.streams[l],{},function(a){!0===a||"object"===typeof a&&0==a.result?f.a.info("reconnect subscriber callback success"):(f.a.info("reconnect subscriber callback failed, could not reconnect",
a),z.reconPubSubFailed(a),z.dispatchEvent(Object(b.e)({type:"room-error",message:a})),x.a.error("api-event",d.a.event_reconnect_subscribe_failed,{error:"reconnect subscriber callback failed, couldnt reconnect",message:a}))});f.a.info("MANAGE LIVE TRANSCRIPTION-> RECONNECTING");z.manageLiveTranscription();var g=function(a){z.localStreamsBeforeReconnect.forEach(function(a,g){void 0===a.canvas&&void 0===a.screen&&(f.a.info(" reconnect publish, audio video data stream"),z.localStreamsBeforeReconnect.remove(g),
z.publish(a,e,function(e){0===e.result?(D.publishId=e.id,f.a.info("reconnected and stream published successfully"),z.manageStatsSubscription(a),z.manageRecordingStatus(),c.mediaRecord&&z.dispatchEvent(Object(b.e)({type:"room-record-on",message:{}})),z.muteInfo.room.audio&&z.dispatchEvent({type:"room-muted",message:{}}),!0===a.selfMuteAudio&&a.sendEvent("user-audio-muted"),1==a.selfMuteVideo&&a.sendEvent("user-video-muted"),z.localStreamsBeforeReconnect.forEach(function(a,c){!0===a.canvas?(f.a.info(" reconnect publish, canvas stream"),
z.localStreamsBeforeReconnect.remove(c),z.publish(a,{maxVideoBW:4096,minVideoBW:1024},function(a){0===a.result?D.publishId=a.id:(f.a.info(" reconnect publish failed forcanvas stream failed",a),z.reconPubSubFailed(a),z.dispatchEvent(Object(b.e)({type:"room-error",message:a})),x.a.error("api-event",d.a.event_reconnect_publish_failed,{error:"reconnect publish for canvas stream failed",message:a}))})):!0===a.screen?(f.a.info(" reconnect publish, share stream"),z.localStreamsBeforeReconnect.remove(c),
z.publish(a,{share:!0},function(a){f.a.info(" reconnect publish response for share stream",a);0===a.result?(f.a.info(" reconnect publish share successful",a),z.localStreams.forEach(function(a,c){a&&a.ifVideo()&&a.setQualityLayers(2)})):(f.a.info(" reconnect publish share failed with reason",a),z.reconPubSubFailed(a),z.dispatchEvent(Object(b.e)({type:"room-error",message:a})),x.a.error("api-event",d.a.event_reconnect_publish_failed,{error:"reconnect publish share failed with reason",message:a}))})):
f.a.info(" unknown stream type ????????????")})):(f.a.info(" reconnect publishing failed, response for publish",e),z.reconPubSubFailed(e),z.dispatchEvent(Object(b.e)({type:"room-error",message:e})),x.a.error("api-event",d.a.event_reconnect_publish_failed,{error:"reconnect publishing failed, response for publish",message:e}))}))})};void 0==e||!1!==z.waitRoom||"viewer"==z.me.role||"audience"==z.me.role||"lecture"===z.mode&&"moderator"!==z.me.role?"viewer"!=z.me.role&&"audience"!=z.me.role&&z.waitRoom?
(f.a.info("Reconnect WaitRoom on no publish"),z.addEventListener("wait-room-disabled",function(a){"lecture"!==z.mode&&g(e)})):"viewer"!=z.me.role&&"audience"!=z.me.role||"lecture"===z.mode&&"moderator"!==z.me.role?("viewer"!=z.me.role&&"audience"!=z.me.role?f.a.info(" No publish - participant is viewer/audience"):f.a.info(" reconnection:: No publish - participant in lecture mode"),z.floorGranted&&(z.floorGranted=!1,z.dispatchEvent(Object(b.e)({type:"release-floor",users:{clientId:z.clientId}})))):
f.a.info("no audio&video"):g(e);f.a.debug(" setting reconnection state as false ");z.reconnectionState=!1;z.manageNumTalker();f.a.info("send network reconnected event");l=Object(b.e)({type:"network-reconnected",error:h.a.error_1164.result,message:h.a.error_1164.error});z.dispatchEvent(l)}}),z.addEventListener("room-error",function(a){null==D&&w(D,a)}),z.addEventListener("stream-added",function(a){z.subscribe(a.stream)}),z.addEventListener("active-talkers-updated",function(a){a=a.message.activeList;
var c=a.length;if(0<c)for(var d=0;d<c;d++)if("audio"===a[d].mediatype&&!0===a[d].muteDueToBw){z.remoteStreams.getAll()[a[d].streamId].audioOnly=!0;var e=Object(b.e)({type:"user-muted-due-to-bw-crunch",message:{streamId:a[d].streamId,clientId:a[d].clientId,name:a[d].name}});z.dispatchEvent(e)}}));!1===z.reconnectionState&&0==z.reconnectAttempt?z.connect(F,function(a){f.a.debug("room.connect callback resp: "+JSON.stringify(a));a.result!=h.a.error_000.result&&w(null,a)}):f.a.debug(" Reconnection case in join room public api")};
l=function(a){c=a;w(D,c)};if(void 0!=t.stream||t.audio||t.video)var J=z.initPublishStream(t.div,t,v,l);else f.a.info(" No publish stream. audio and video are disabled.."),v()}return J}else f.a.info("Failed Webrtc support is missing "),w(null,h.a.error_1000)}},listParticipants:function(b){if(a.a.is_supported()){var d=[];b&&(d=b.userList);return d}console.log("Failed Webrtc support is missing ")},ReceiveMessage:function(a,b){a&&a.addEventListener("stream-data",function(a){})},sendMessage:function(a,
b){a&&a.sendData(b)},getRoom:function(){return n}};r.a=B},function(l,r,p){function f(){z=0;J.splice(0,J.length);M={};I={};U={};ca={};g={};ea={};P={};la=ba="";K=F.a.default_region;y=F.a.proxy_api_url;W=F.a.proxy_api_port;R=ia=!1;X=F.a.data_throughput_duration;E=F.a.video_bandwidth_duration;da=F.a.audio_bandwidth_duration}function q(){if(!1===V)u();else if(z<J.length){var a=J[z];c.setActiveTest(a);var b={test_group:a.test_group,test_case:a.test_title,status:"started"};if("network"===a.test_group||"connectivity"===
a.test_group||"throughput"===a.test_group||"bandwidth"===a.test_group||"signalling"===a.test_group)b.test_region=a.region,b.test_server=a.server;a.start_time=new Date;b=Object(A.a)({type:"client-diagnosis-status",message:b});!0===ha?window.webkit.messageHandlers.callbackHandler.postMessage(b):O.dispatchEvent(b);switch(a.test_title){case "audio_capture":Object(n.a)(a,la);break;case "check_resolution_240":case "check_resolution_480":case "check_resolution_720":case "check_supported_resolutions":Object(B.a)(a,
ba);break;case "udp_enabled":case "tcp_enabled":case "ipv6_enabled":Object(w.a)(a);break;case "relay_connectivity":case "reflexive_connectivity":case "host_connectivity":Object(t.a)(a);break;case "data_throughput":Object(v.a)(a,null,X);break;case "audio_bandwidth":Object(v.a)(a,la,da);break;case "video_bandwidth":Object(v.a)(a,ba,E);break;case "signalling_connectivity":Object(D.a)(a,y,W)}z+=1}else a={},Object.keys(M).length&&(a.microphone=M),Object.keys(I).length&&(a.camera=I),Object.keys(U).length&&
(a.network=U),Object.keys(ca).length&&(a.connectivity=ca),Object.keys(g).length&&(a.throughput=g),Object.keys(ea).length&&(a.bandwidth=ea),Object.keys(P).length&&(a.signalling=P),V=!1,G.a.info("All test case executed"),a=Object(A.a)({type:"client-diagnosis-finished",message:a}),!0===ha?window.webkit.messageHandlers.callbackHandler.postMessage(a):O.dispatchEvent(a),f()}function k(a,c,b,d,e){b=void 0===b?null:b;d=void 0===d?null:d;e=void 0===e?!1:e;a=new aa(a,c,q);a.region=b;a.server=d;a.bitrate_only=
e;J.push(a)}function e(){for(var a in K)Q.includes(K[a])&&(k("udp_enabled","network",K[a],"TURN"),k("tcp_enabled","network",K[a],"TURN"),k("ipv6_enabled","network",K[a],"TURN"))}function a(){for(var a in K)Q.includes(K[a])&&(k("relay_connectivity","connectivity",K[a],"TURN"),k("reflexive_connectivity","connectivity",K[a],"TURN"),k("host_connectivity","connectivity",K[a],"TURN"))}function b(){for(var a in K)Q.includes(K[a])&&k("data_throughput","throughput",K[a],"TURN")}function h(){for(var a in K)Q.includes(K[a])&&
(k("video_bandwidth","bandwidth",K[a],"TURN",R),k("audio_bandwidth","bandwidth",K[a],"TURN",R))}function x(){for(var a in K)Q.includes(K[a])&&k("signalling_connectivity","signalling",K[a],"TURN")}function d(){var a=Object(A.a)({type:"client-diagnosis-failed",message:{msg:"Invalid arguments"}});!0===ha?window.webkit.messageHandlers.callbackHandler.postMessage(a):O.dispatchEvent(a);f();G.a.error("Invalid argument")}function u(){var a=Object(A.a)({type:"client-diagnosis-stopped",message:{msg:"Diagnosis stopped."}});
!0===ha?window.webkit.messageHandlers.callbackHandler.postMessage(a):O.dispatchEvent(a);f();G.a.error("diagnosis stopped")}var n=p(70),B=p(71),w=p(73),t=p(74),v=p(75),D=p(76),G=p(0),A=p(4);l=p(1);var F=p.n(l),c=p(13),Q=["IN","US","SG","DE"];p={};var z=0,J=[],M={},I={},U={},ca={},g={},ea={},P={},la="",ba="",K=[],V=!1,R=!1,O=null,y="",W="",ia=!1,X=0,E=0,da=0,ha=!1,aa=function(a,c,b){this.test_title=a;this.test_group=c;this.started=!1;this.success_count=this.warning_count=this.error_count=0;this.finished_cb=
b;this.region="IN";this.server="TURN";this.uri="";this.progress_value=0;this.state="not_tested";this.start_time=0;this.bitrate_only=!1;this.json_response={result:this.state,execution_time:"not_set",success:[],error:[],warning:[],info:[]};this.done=function(){this.state=0===this.error_count+this.warning_count&&0<this.success_count?"success":0<this.warning_count&&0===this.error_count?"warning":this.isDisabled?"disabled":"failure";this.json_response.result=this.state;this.json_response.execution_time=
new Date-this.start_time+" ms";var a={};switch(this.test_group){case "microphone":M[this.test_title]=this.json_response;a[this.test_title]=M[this.test_title];break;case "camera":I[this.test_title]=this.json_response;a[this.test_title]=I[this.test_title];break;case "network":this.setServer();a=this.fillResponse(U);break;case "connectivity":this.setServer();a=this.fillResponse(ca);break;case "throughput":this.setServer();a=this.fillResponse(g);break;case "bandwidth":this.setServer();a=this.fillResponse(ea);
break;case "signalling":this.setServer(),a=this.fillResponse(P)}a={test_group:this.test_group,test_case:this.test_title,status:"finished",output:a};if("network"===this.test_group||"connectivity"===this.test_group||"throughput"===this.test_group||"bandwidth"===this.test_group||"signalling"===this.test_group)a.test_region=this.region,a.test_server=this.server;a=Object(A.a)({type:"client-diagnosis-status",message:a});!0===ha?window.webkit.messageHandlers.callbackHandler.postMessage(a):O.dispatchEvent(a);
this.finished_cb()};this.fillResponse=function(a){var c={};a.hasOwnProperty(this.test_title)||(a[this.test_title]={});a[this.test_title].hasOwnProperty(this.region)||(a[this.test_title][this.region]={});a[this.test_title][this.region].hasOwnProperty(this.server)||(a[this.test_title][this.region][this.server]={});a[this.test_title][this.region][this.server]=this.json_response;c[this.test_title]=this.json_response;return c};this.reportFatal=function(a){this.reportError(a);this.done()};this.reportSuccess=
function(a){this.success_count+=1;G.a.info("[ OK ]"+a);this.json_response.success.push({message:a})};this.setServer=function(){this.json_response.server={};this.json_response.server.region=this.region;this.json_response.server.url="TURN"===this.server?F.a.ice_servers[this.region].turnURI:F.a.ice_servers[this.region].stunURI};this.reportError=function(a){this.error_count+=1;G.a.error("[ FAILED ]"+a);this.json_response.error.push({message:a})};this.reportWarning=function(a){this.warning_count+=1;G.a.warning("[ WARN ]"+
a);this.json_response.warning.push({message:a})};this.reportInfo=function(a){G.a.info("[ INFO ]"+a);this.json_response.info.push({message:a})};this.fillBandwidth=function(a){this.json_response.bandwidth_bps=a};this.fillPacketsLost=function(a){this.json_response.packets_lost_percentage=a};this.setProgress=function(a){this.progress_value=a};this.fillData=function(a,c){};this.reportByState=function(a,c){switch(c){case "poor":this.error_count+=1;G.a.error("[ POOR ]"+a);this.json_response.error.push({message:a+
" [BAD]"});break;case "moderate":this.warning_count+=1;G.a.warning("[ MODERATE ]"+a);this.json_response.warning.push({message:a+" [ACCEPTABLE]"});break;case "good":this.success_count+=1,G.a.info("[ GOOD ]"+a),this.json_response.success.push({message:a+" [GOOD]"})}}};p.clientDiagnostics=function(c){ha=!1;c.hasOwnProperty("forIosVersion13")&&!0===c.forIosVersion13&&(ha=!0);if(c.hasOwnProperty("stop")&&!0===c.stop&&null!==O)return!1===V&&0===J.length&&u(),V=!1,O;if(V||J.length)return G.a.error("Diagnosis is already in progress. Few resources are in use and may not be accessible."),
O;O=Object(A.c)();if(!c.hasOwnProperty("testNames")||!Array.isArray(c.testNames))return setTimeout(d,1),O;V=!0;f();c.hasOwnProperty("audioDeviceId")&&(la=c.audioDeviceId);c.hasOwnProperty("videoDeviceId")&&(ba=c.videoDeviceId);c.hasOwnProperty("testServerApiHost")&&(y=c.testServerApiHost);c.hasOwnProperty("testServerApiPort")&&(W=c.testServerApiPort);if(c.hasOwnProperty("regionId"))if(Array.isArray(c.regionId))K=c.regionId||F.a.default_region;else return V=!1,setTimeout(d,1),O;c.hasOwnProperty("forMobile")&&
!0===c.forMobile&&(ia=!0);c.hasOwnProperty("bitrateOnly")&&!0===c.bitrateOnly&&(R=!0);c.hasOwnProperty("testDurationDataThroughput")&&0<c.testDurationDataThroughput&&(X=c.testDurationDataThroughput);60<X&&(X=60);c.hasOwnProperty("testDurationVideoBandwidth")&&0<c.testDurationVideoBandwidth&&(E=c.testDurationVideoBandwidth);60<E&&(E=60);c.hasOwnProperty("testDurationAudioBandwidth")&&0<c.testDurationAudioBandwidth&&(da=c.testDurationAudioBandwidth);60<da&&(da=60);var g=c.testNames.map(function(a){a=
a.toString();return a.toLowerCase()}),n=new Set;if(g.includes("all"))n.add("microphone"),n.add("camera"),n.add("network"),n.add("connectivity"),n.add("throughput"),n.add("bandwidth"),n.add("signalling");else for(var l in c.testNames)n.add(g[l]);c=$jscomp.makeIterator(n);for(g=c.next();!g.done;g=c.next())switch(g.value){case "microphone":k("audio_capture","microphone");break;case "camera":!0!==ia&&(k("check_resolution_240","camera"),k("check_resolution_480","camera"),k("check_resolution_720","camera"));
k("check_supported_resolutions","camera");break;case "network":e();break;case "connectivity":a();break;case "throughput":b();break;case "bandwidth":h();break;case "signalling":x()}0<J.length?setTimeout(q,1):(V=!1,setTimeout(d,1));return O};p.clientBitrate=function(a){var c=Object(A.c)(),b="DE";void 0!==a&&a.hasOwnProperty("region")&&(a=a.region,Q.includes(a)&&(b=a));b=EnxRtc.clientDiagnostics({testNames:["bandwidth"],regionId:[b],testDurationVideoBandwidth:40,testDurationAudioBandwidth:20,bitrateOnly:!0,
stop:!1});var d={video:{bitrate_bps:"NA",connection:"NA"},audio:{bitrate_bps:"NA",connection:"NA"}};b.addEventListener("client-diagnosis-status",function(a){var b=Object(A.a)({type:"client-bitrate-status",message:a.message});a.message.hasOwnProperty("output")&&(a.message.output.hasOwnProperty("video_bandwidth")&&(a.message.output.video_bandwidth.hasOwnProperty("bandwidth_bps")&&(d.video.bitrate_bps=a.message.output.video_bandwidth.bandwidth_bps),a.message.output.video_bandwidth.hasOwnProperty("packets_lost_percentage")&&
(d.video.connection=5<a.message.output.video_bandwidth.packets_lost_percentage?"unstable":"stable")),a.message.output.hasOwnProperty("audio_bandwidth")&&(a.message.output.audio_bandwidth.hasOwnProperty("bandwidth_bps")&&(d.audio.bitrate_bps=a.message.output.audio_bandwidth.bandwidth_bps),a.message.output.audio_bandwidth.hasOwnProperty("packets_lost_percentage")&&(d.audio.connection=5<a.message.output.audio_bandwidth.packets_lost_percentage?"unstable":"stable")));!0===ha?window.webkit.messageHandlers.callbackHandler.postMessage(b):
c.dispatchEvent(b)});b.addEventListener("client-diagnosis-finished",function(a){a=Object(A.a)({type:"client-bitrate-finished",message:d});!0===ha?window.webkit.messageHandlers.callbackHandler.postMessage(a):c.dispatchEvent(a)});return c};r.a=p},function(l,r,p){function f(f,e){this.test=f;this.inputChannelCount=6;this.outputChannelCount=2;this.bufferSize=0;this.deviceId=e;this.constraints={audio:{optional:[{echoCancellation:!1}]}};this.collectSeconds=2;this.silentThreshold=1/32767;this.lowVolumeThreshold=
-60;this.monoDetectThreshold=1/65536;this.clipCountThreshold=6;this.clipThreshold=1;this.collectedAudio=[];for(f=this.collectedSampleCount=0;f<this.inputChannelCount;++f)this.collectedAudio[f]=[];this.audioContext=new (window.AudioContext||window.webkitAudioContext)}r.a=function(k,e){(new f(k,e)).run()};var q=p(13);f.prototype={run:function(){var f=this;this.audioContext.resume().then(function(){q.appendSourceId(f.deviceId,"audio",f.constraints);q.doGetUserMedia(f.constraints,f.gotStream.bind(f),
f.onFail.bind(f))}).catch(function(e){f.test.reportError("WebAudio run failure: "+e);f.test.done()})},onFail:function(f){this.test.reportError("getUserMedia failed with error: "+f);this.test.done()},gotStream:function(f){this.checkAudioTracks(f)?this.createAudioBuffer(f):this.test.done()},checkAudioTracks:function(f){this.stream=f;f=f.getAudioTracks();if(1>f.length)return this.test.reportError("No audio track in returned stream."),!1;this.test.reportSuccess("Audio track created using device="+f[0].label);
return!0},createAudioBuffer:function(){this.audioSource=this.audioContext.createMediaStreamSource(this.stream);this.scriptNode=this.audioContext.createScriptProcessor(this.bufferSize,this.inputChannelCount,this.outputChannelCount);this.audioSource.connect(this.scriptNode);this.scriptNode.connect(this.audioContext.destination);this.scriptNode.onaudioprocess=this.collectAudio.bind(this);this.stopCollectingAudio=q.setTimeoutWithProgressBar(this.onStopCollectingAudio.bind(this),5E3)},collectAudio:function(f){for(var e=
f.inputBuffer.length,a=!0,b=0;b<f.inputBuffer.numberOfChannels;b++){var h=f.inputBuffer.getChannelData(b),k=Math.abs(h[e-1]);Math.abs(h[0])>this.silentThreshold||k>this.silentThreshold?(k=new Float32Array(e),k.set(h),a=!1):k=new Float32Array;this.collectedAudio[b].push(k)}a||(this.collectedSampleCount+=e,this.collectedSampleCount/f.inputBuffer.sampleRate>=this.collectSeconds&&this.stopCollectingAudio())},onStopCollectingAudio:function(){this.stream.getAudioTracks()[0].stop();this.audioSource.disconnect(this.scriptNode);
this.scriptNode.disconnect(this.audioContext.destination);this.analyzeAudio(this.collectedAudio);this.test.done()},analyzeAudio:function(f){for(var e=[],a=0;a<f.length;a++)this.channelStats(a,f[a])&&e.push(a);0===e.length?this.test.reportError("No active input channels detected. Microphone is most likely muted or broken, please check if muted in the sound settings or physically on the device. Then rerun the test."):this.test.reportSuccess("Active audio input channels: "+e.length);2===e.length&&this.detectMono(f[e[0]],
f[e[1]])},channelStats:function(f,e){for(var a=0,b=0,h=0,k=0,d=0;d<e.length;d++){var l=e[d];if(0<l.length){for(var n,q=0,w=0;w<l.length;w++)n=Math.abs(l[w]),a=Math.max(a,n),q+=n*n,a>=this.clipThreshold?(h+=1,k=Math.max(k,h)):h=0;q=Math.sqrt(q/l.length);b=Math.max(b,q)}}return a>this.silentThreshold?(e=this.dBFS(a),b=this.dBFS(b),this.test.reportInfo("Channel "+f+" levels: "+e.toFixed(1)+" dB (peak), "+b.toFixed(1)+" dB (RMS)"),b<this.lowVolumeThreshold&&this.test.reportError("Microphone input level is low, increase input volume or move closer to the microphone."),
k>this.clipCountThreshold&&this.test.reportWarning("Clipping detected! Microphone input level is high. Decrease input volume or move away from the microphone."),!0):!1},detectMono:function(f,e){for(var a=0,b=0;b<f.length;b++){var h=f[b],k=e[b];if(h.length===k.length)for(var d,l=0;l<h.length;l++)d=Math.abs(h[l]-k[l]),d>this.monoDetectThreshold&&(a+=1);else a+=1}0<a?this.test.reportInfo("Stereo microphone detected."):this.test.reportInfo("Mono microphone detected.")},dBFS:function(f){return Math.round(Math.log(f)/
Math.log(10)*200)/10}}},function(l,r,p){function f(a,b,e){this.test=a;this.resolutions=b;this.currentResolution=0;this.isShuttingDown=this.isMuted=!1;this.deviceId=e}r.a=function(a,b){switch(a.test_title){case "check_resolution_240":(new f(a,[[320,240]],b)).run();break;case "check_resolution_480":(new f(a,[[640,480]],b)).run();break;case "check_resolution_720":(new f(a,[[1280,720]],b)).run();break;case "check_supported_resolutions":(new f(a,[[160,120],[320,180],[320,240],[640,360],[640,480],[768,
576],[1024,576],[1280,720],[1280,768],[1280,800],[1920,1080],[1920,1200],[3840,2160],[4096,2160]],b)).run()}};l=p(72);var q=p.n(l);l=p(18);var k=p.n(l),e=p(13);f.prototype={run:function(){this.startGetUserMedia(this.resolutions[this.currentResolution],this.deviceId);this.currentResolution+=1},startGetUserMedia:function(a,b){var e=this;navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{exact:a[0]},height:{exact:a[1]},deviceId:b}}).then(function(b){1<e.resolutions.length?(e.test.reportSuccess("Supported resolution: "+
a[0]+"x"+a[1]),b.getTracks().forEach(function(a){a.stop()}),e.maybeContinueGetUserMedia()):e.collectAndAnalyzeStats(b,a)}).catch(function(b){1<e.resolutions.length?e.test.reportInfo(a[0]+"x"+a[1]+" not supported"):e.test.reportError("getUserMedia failed with error: "+b.name);e.maybeContinueGetUserMedia()})},maybeContinueGetUserMedia:function(){this.currentResolution===this.resolutions.length?this.test.done():(this.startGetUserMedia(this.resolutions[this.currentResolution]),this.currentResolution+=
1)},collectAndAnalyzeStats:function(a,b){var f=this,l=a.getVideoTracks();if(1>l.length)this.test.reportError("No video track in returned stream."),this.maybeContinueGetUserMedia();else{l=l[0];"function"===typeof l.addEventListener&&(l.addEventListener("ended",function(){f.isShuttingDown||f.test.reportError("Video track ended, camera stopped working")}),l.addEventListener("mute",function(){f.isShuttingDown||(f.test.reportWarning("Your camera reported itself as muted."),f.isMuted=!0)}),l.addEventListener("unmute",
function(){f.isShuttingDown||(f.test.reportInfo("Your camera reported itself as unmuted."),f.isMuted=!1)}));l=document.createElement("video");l.setAttribute("autoplay","");l.setAttribute("muted","");l.width=b[0];l.height=b[1];l.srcObject=a;var d=new q.a(l),u=new k.a(null,this.test);u.pc1.addStream(a);u.establishConnection();u.gatherStats(u.pc1,null,a,this.onCallEnded.bind(this,b,l,a,d),100);e.setTimeoutWithProgressBar(this.endCall.bind(this,u,a),8E3)}},onCallEnded:function(a,b,e,f,d,k){this.analyzeStats(a,
b,e,f,d,k);f.stop();this.test.done()},analyzeStats:function(a,b,f,k,d,l){var h=[],u=[],w=[],t={};k=k.frameStats;for(var q in d)"ssrc"===d[q].type&&0<parseInt(d[q].googFrameRateInput)&&(h.push(parseInt(d[q].googAvgEncodeMs)),u.push(parseInt(d[q].googFrameRateInput)),w.push(parseInt(d[q].googFrameRateSent)));t.cameraName=f.getVideoTracks()[0].label||NaN;t.actualVideoWidth=b.videoWidth;t.actualVideoHeight=b.videoHeight;t.mandatoryWidth=a[0];t.mandatoryHeight=a[1];t.encodeSetupTimeMs=this.extractEncoderSetupTime(d,
l);t.avgEncodeTimeMs=e.arrayAverage(h);t.minEncodeTimeMs=e.arrayMin(h);t.maxEncodeTimeMs=e.arrayMax(h);t.avgInputFps=e.arrayAverage(u);t.minInputFps=e.arrayMin(u);t.maxInputFps=e.arrayMax(u);t.avgSentFps=e.arrayAverage(w);t.minSentFps=e.arrayMin(w);t.maxSentFps=e.arrayMax(w);t.isMuted=this.isMuted;t.testedFrames=k.numFrames;t.blackFrames=k.numBlackFrames;t.frozenFrames=k.numFrozenFrames;this.testExpectations(t)},endCall:function(a,b){this.isShuttingDown=!0;b.getTracks().forEach(function(a){a.stop()});
a.close()},extractEncoderSetupTime:function(a,b){for(var e=0;e!==a.length;e++)if("ssrc"===a[e].type&&0<parseInt(a[e].googFrameRateInput))return JSON.stringify(b[e]-b[0]);return NaN},resolutionMatchesIndependentOfRotationOrCrop:function(a,b,e,f){var d=Math.min(e,f);return a===e&&b===f||a===f&&b===e||a===d&&f===d},testExpectations:function(a){var b=[],e;for(e in a)a.hasOwnProperty(e)&&("number"===typeof a[e]&&isNaN(a[e])?b.push(e):this.test.reportInfo(e+": "+a[e]));0!==b.length&&this.test.reportInfo("Not available: "+
b.join(", "));isNaN(a.avgSentFps)?this.test.reportInfo("Cannot verify sent FPS."):5>a.avgSentFps?this.test.reportError("Low average sent FPS: "+a.avgSentFps):this.test.reportSuccess("Average FPS above threshold");this.resolutionMatchesIndependentOfRotationOrCrop(a.actualVideoWidth,a.actualVideoHeight,a.mandatoryWidth,a.mandatoryHeight)?this.test.reportSuccess("Captured video using expected resolution."):this.test.reportError("Incorrect captured resolution.");0===a.testedFrames?this.test.reportError("Could not analyze any video frame."):
(a.blackFrames>a.testedFrames/3&&this.test.reportError("Camera delivering lots of black frames."),a.frozenFrames>a.testedFrames/3&&this.test.reportError("Camera delivering lots of frozen frames."))}}},function(l,r,p){function f(f){this.frameStats={numFrozenFrames:0,numBlackFrames:0,numFrames:0};this.running_=!0;this.nonBlackPixelLumaThreshold=20;this.previousFrame_=[];this.identicalFrameSsimThreshold=.985;this.frameComparator=new q;this.canvas_=document.createElement("canvas");this.videoElement_=
f;this.listener_=this.checkVideoFrame_.bind(this);this.videoElement_.addEventListener("play",this.listener_,!1)}function q(){}f.prototype={stop:function(){this.videoElement_.removeEventListener("play",this.listener_);this.running_=!1},getCurrentImageData_:function(){this.canvas_.width=this.videoElement_.width;this.canvas_.height=this.videoElement_.height;var f=this.canvas_.getContext("2d");f.drawImage(this.videoElement_,0,0,this.canvas_.width,this.canvas_.height);return f.getImageData(0,0,this.canvas_.width,
this.canvas_.height)},checkVideoFrame_:function(){if(this.running_&&!this.videoElement_.ended){var f=this.getCurrentImageData_();this.isBlackFrame_(f.data,f.data.length)&&(this.frameStats.numBlackFrames+=1);this.frameComparator.calculate(this.previousFrame_,f.data)>this.identicalFrameSsimThreshold&&(this.frameStats.numFrozenFrames+=1);this.previousFrame_=f.data;this.frameStats.numFrames+=1;setTimeout(this.checkVideoFrame_.bind(this),20)}},isBlackFrame_:function(f,e){for(var a=this.nonBlackPixelLumaThreshold,
b=0,h=4;h<e;h+=4)if(b+=.21*f[h]+.72*f[h+1]+.07*f[h+2],b>a*h/4)return!1;return!0}};q.prototype={statistics:function(f){var e=0,a;for(a=0;a<f.length;++a)e+=f[a];var b=e/(f.length-1);for(a=1;a<f.length;++a){var h=f[a-1]-b;e+=f[a]+h*h}return{mean:b,variance:e/f.length}},covariance:function(f,e,a,b){for(var h=0,k=0;k<f.length;k+=1)h+=(f[k]-a)*(e[k]-b);return h/f.length},calculate:function(f,e){if(f.length!==e.length)return 0;var a=6.5025,b=58.5225,h=b/2,k=this.statistics(f),d=k.mean;k=k.variance;var l=
Math.sqrt(k),n=this.statistics(e),q=n.mean;n=n.variance;var w=Math.sqrt(n);f=this.covariance(f,e,d,q);return(2*d*q+a)/(d*d+q*q+a)*((2*l*w+b)/(k+n+b))*((f+h)/(l*w+h))}};l.exports=f},function(l,r,p){function f(f,e,a,b){this.test=f;this.protocol=e;this.params=a;this.iceCandidateFilter=b}r.a=function(k){switch(k.test_title){case "udp_enabled":(new f(k,"udp",null,q.a.isRelay)).run();break;case "tcp_enabled":(new f(k,"tcp",null,q.a.isRelay)).run();break;case "ipv6_enabled":(new f(k,null,{optional:[{googIPv6:!0}]},
q.a.isIpv6)).run()}};l=p(18);var q=p.n(l);f.prototype={run:function(){this.iceCandidateFilter.toString()===q.a.isIpv6.toString()?this.gatherCandidates(null,this.params,this.iceCandidateFilter):"TURN"===this.test.server?q.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):q.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(f){this.filterConfig(f,this.protocol);this.gatherCandidates(f,
this.params,this.iceCandidateFilter)},filterConfig:function(f,e){var a=[],b=f.iceServers[0],h=[];e="transport="+e;e=b.urls.startsWith("turns")?b.urls+"?"+e:b.urls;h.push(e);b.urls=h;a.push(b);f.iceServers=a},gatherCandidates:function(f,e,a){var b=this;try{var h=new RTCPeerConnection(f,e)}catch(x){null!==e&&e.optional[0].googIPv6?this.test.reportError("Failed to create peer connection, IPv6 might not be setup/supported on the network."):this.test.reportError("Failed to create peer connection: "+x);
this.test.done();return}h.addEventListener("icecandidate",function(f){"closed"!==f.currentTarget.signalingState&&(f.candidate?(f=q.a.parseCandidate(f.candidate.candidate),a(f)&&(b.test.reportSuccess("Gathered candidate of Type: "+f.type+" Protocol: "+f.protocol+" Address: "+f.address),h.close(),h=null,b.test.done())):(h.close(),h=null,null!==e&&e.optional[0].googIPv6?b.test.reportError("Failed to gather IPv6 candidates, it might not be setup/supported on the network."):b.test.reportError("Failed to gather specified candidates"),
b.test.done()))});this.createAudioOnlyReceiveOffer(h)},createAudioOnlyReceiveOffer:function(f){function e(){}f.createOffer({offerToReceiveAudio:1}).then(function(a){f.setLocalDescription(a).then(e,e)},e)}}},function(l,r,p){function f(f,e){this.test=f;this.iceCandidateFilter=e;this.timeout=null;this.parsedCandidates=[];this.call=null}r.a=function(k){switch(k.test_title){case "relay_connectivity":(new f(k,q.a.isRelay)).run();break;case "reflexive_connectivity":(new f(k,q.a.isReflexive)).run();break;
case "host_connectivity":(new f(k,q.a.isHost)).start()}};l=p(18);var q=p.n(l);f.prototype={run:function(){"TURN"===this.test.server?q.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):q.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(f){var e=this;this.call=new q.a(f,this.test);this.call.setIceCandidateFilter(this.iceCandidateFilter);this.call.pc1.addEventListener("icecandidate",
function(a){a.candidate&&(a=q.a.parseCandidate(a.candidate.candidate),e.parsedCandidates.push(a),e.iceCandidateFilter(a)&&e.test.reportInfo("Gathered candidate of Type: "+a.type+" Protocol: "+a.protocol+" Address: "+a.address))});var a=this.call.pc1.createDataChannel(null);a.addEventListener("open",function(){a.send("hello")});a.addEventListener("message",function(a){"world"!==a.data?e.test.reportError("Invalid data transmitted."):e.test.reportSuccess("Data successfully transmitted between peers.");
e.hangup()});this.call.pc2.addEventListener("datachannel",function(a){var b=a.channel;b.addEventListener("message",function(a){"hello"!==a.data?e.hangup("Invalid data transmitted."):b.send("world")})});this.call.establishConnection();this.timeout=setTimeout(this.hangup.bind(this,"Timed out"),5E3)},filterConfig:function(f){var e=[],a=f.iceServers[0],b=[],h=a.urls.startsWith("turns")?a.urls+"?transport=tcp":a.urls;b.push(h);a.urls=b;e.push(a);f.iceServers=e},findParsedCandidateOfSpecifiedType:function(f){for(var e in this.parsedCandidates)if(f(this.parsedCandidates[e]))return f(this.parsedCandidates[e])},
hangup:function(f){f&&("Timed out"===f&&this.iceCandidateFilter.toString()===q.a.isReflexive.toString()&&this.findParsedCandidateOfSpecifiedType(q.a.isReflexive)?this.test.reportWarning("Could not connect using reflexive candidates, likely due to the network environment/configuration."):this.test.reportError(f));clearTimeout(this.timeout);this.call.close();this.test.done()}}},function(l,r,p){function f(a,b){this.test=a;this.testDurationSeconds=1*b;this.startTime=null;this.receivedPayloadBytes=this.sentPayloadBytes=
0;this.stopSending=!1;this.samplePacket="";for(a=0;1024!==a;++a)this.samplePacket+="h";this.maxNumberOfPacketsToSend=1;this.bytesToKeepBuffered=1024*this.maxNumberOfPacketsToSend;this.lastBitrateMeasureTime=null;this.lastReceivedPayloadBytes=0;this.receiveChannel=this.senderChannel=this.call=null}function q(a,d,e){this.test=a;this.maxVideoBitrateKbps=2E3;this.durationMs=1E3*e;this.statStepMs=100;this.bweStats=new b.StatisticsAggregate(750*this.maxVideoBitrateKbps);this.rttStats=new b.StatisticsAggregate;
this.qpSum=this.pliCount=this.nackCount=this.packetsLost=-1;this.packetsReceived=this.packetsSent=0;this.bitrateMean=this.framesSent=this.videoBytesRecieved=this.videoBytesSent=this.framesDecoded=this.framesEncoded=-1;this.videoStats=[];this.call=this.startTime=null;this.deviceId=d;this.bytesSent=0;this.constraints={audio:!1,video:{optional:[{minWidth:320},{minHeight:240}]}}}function k(a,b){this.test=a;this.candidateFilter=b;this.testDurationMs=3E5;this.sendIntervalMs=100;this.delays=[];this.recvTimeStamps=
[];this.running=!1;this.receiveChannel=this.senderChannel=this.call=null}function e(a,d,e){this.test=a;this.maxAudioBitrateKbps=2E3;this.durationMs=1E3*e;this.statStepMs=100;this.bweStats=new b.StatisticsAggregate(750*this.maxAudioBitrateKbps);this.rttStats=new b.StatisticsAggregate;this.audioBytesRecieved=this.audioBytesSent=this.packetsReceived=this.packetsSent=this.packetsLost=-1;this.startTime=null;this.jitter=0;this.call=null;this.bytesSent=0;this.deviceId=d;this.constraints={audio:!0}}r.a=function(b,
d,h){switch(b.test_title){case "data_throughput":(new f(b,h)).run();break;case "video_bandwidth":(new q(b,d,h)).run();break;case "audio_bandwidth":(new e(b,d,h)).run();break;case "network_latency":(new k(b,a.a.isNotHostCandidate)).run()}};l=p(18);var a=p.n(l),b=p(13),h=[2,6],x=[200,500],d=[200,500],u=[10,30],n=[250,500,800],B=[0,30];f.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),
this.test.reportFatal.bind(this.test),this.test.region)},start:function(b){this.call=new a.a(b,this.test);this.call.setIceCandidateFilter(a.a.isRelay);this.senderChannel=this.call.pc1.createDataChannel(null);this.senderChannel.addEventListener("open",this.sendingStep.bind(this));this.call.pc2.addEventListener("datachannel",this.onReceiverChannel.bind(this));this.call.establishConnection();this.timeout=setTimeout(this.hangup.bind(this,"Timed out"),3E4)},hangup:function(a){a&&("Timed out"===a?this.test.reportError("maximum timeout"):
this.test.reportError(a));clearTimeout(this.timeout);this.call.close();this.test.done()},onReceiverChannel:function(a){this.receiveChannel=a.channel;this.receiveChannel.addEventListener("message",this.onMessageReceived.bind(this))},sendingStep:function(){clearTimeout(this.timeout);var a=new Date;this.startTime||(this.lastBitrateMeasureTime=this.startTime=a);for(var b=0;b!==this.maxNumberOfPacketsToSend&&!(this.senderChannel.bufferedAmount>=this.bytesToKeepBuffered);++b)this.sentPayloadBytes+=this.samplePacket.length,
this.senderChannel.send(this.samplePacket);a-this.startTime>=1E3*this.testDurationSeconds?(this.test.setProgress(100),this.stopSending=!0):(this.test.setProgress((a-this.startTime)/(10*this.testDurationSeconds)),setTimeout(this.sendingStep.bind(this),1))},onMessageReceived:function(a){this.receivedPayloadBytes+=a.data.length;a=new Date;if(1E3<=a-this.lastBitrateMeasureTime){var b=(this.receivedPayloadBytes-this.lastReceivedPayloadBytes)/(a-this.lastBitrateMeasureTime);b=Math.round(8E3*b)/1E3;this.test.reportSuccess("Transmitting at "+
b+" kbps.");this.lastReceivedPayloadBytes=this.receivedPayloadBytes;this.lastBitrateMeasureTime=a}this.stopSending&&this.sentPayloadBytes===this.receivedPayloadBytes&&(this.call.close(),this.call=null,this.test.reportSuccess("Total transmitted: "+8*this.receivedPayloadBytes/1E3+" kilo-bits in "+Math.round(10*(a-this.startTime))/1E4+" seconds."),this.test.done())}};q.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),
this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(d){this.call=new a.a(d,this.test);this.call.setIceCandidateFilter(a.a.isRelay);this.call.disableVideoFec();this.call.constrainVideoBitrate(this.maxVideoBitrateKbps);b.appendSourceId(this.deviceId,"video",this.constraints);b.doGetUserMedia(this.constraints,this.gotStream.bind(this),this.onFail.bind(this))},onFail:function(a){this.test.reportError("getUserMedia failed with error: "+
a);this.test.done()},gotStream:function(a){this.call.pc1.addStream(a);this.call.establishConnection();this.startTime=new Date;this.localStream=a.getVideoTracks()[0];setTimeout(this.gatherStats.bind(this),this.statStepMs)},gatherStats:function(){var a=new Date;a-this.startTime>this.durationMs?(this.test.setProgress(100),this.hangup()):(this.call.statsGatheringRunning||this.call.gatherStats(this.call.pc1,this.call.pc2,this.localStream,this.gotStats.bind(this)),this.test.setProgress(100*(a-this.startTime)/
this.durationMs),setTimeout(this.gatherStats.bind(this),this.statStepMs))},gotStats:function(a,b,d,e){if("chrome"===adapter.browserDetails.browser)for(var f in a)"undefined"!==typeof a[f].connection&&(this.bweStats.add(a[f].connection.timestamp,parseInt(a[f].connection.availableOutgoingBitrate)),this.rttStats.add(a[f].connection.timestamp,parseInt(1E3*a[f].connection.currentRoundTripTime)),this.videoStats[0]=a[f].video.local.frameWidth,this.videoStats[1]=a[f].video.local.frameHeight,this.nackCount=
a[f].video.local.nackCount,this.packetsLost=d[f].video.remote.packetsLost,this.qpSum=d[f].video.remote.qpSum,this.pliCount=a[f].video.local.pliCount,this.packetsSent=a[f].video.local.packetsSent,this.packetsReceived=d[f].video.remote.packetsReceived,this.framesEncoded=a[f].video.local.framesEncoded,this.videoBytesSent=a[f].video.local.bytesSent,this.videoBytesRecieved=d[f].video.remote.bytesReceived,this.framesDecoded=d[f].video.remote.framesDecoded);else if("firefox"===adapter.browserDetails.browser)for(var h in a)(b=
1E3*a[h].video.remote.roundTripTime)&&this.rttStats.add(a[h].video.remote.timestamp,parseInt(b)),this.bytesSent+=a[h].connection.bytesSent,this.packetsSent=a[h].video.local.packetsSent,this.packetsLost=d[h].video.remote.packetsLost,this.packetsReceived=d[h].video.remote.packetsReceived,this.qpSum=d[h].video.remote.qpSum,this.bitrateMean=a[h].video.local.bitrateMean,this.videoBytesSent=a[h].video.local.bytesSent,this.videoBytesRecieved=d[h].video.remote.bytesReceived;else this.test.reportError("Only Firefox and Chrome getStats implementations are supported.");
this.completed()},hangup:function(){this.call.pc1.getLocalStreams()[0].getTracks().forEach(function(a){a.stop()});this.call.close();this.call=null},completed:function(){if("chrome"===adapter.browserDetails.browser){var a=(new Date-this.startTime)/1E3;if(2>this.videoStats[0]&&2>this.videoStats[1])this.test.reportError("Camera failure: "+this.videoStats[0]+"x"+this.videoStats[1]+". Cannot test bandwidth without a working  camera.");else{this.test.reportSuccess("Video resolution: "+this.videoStats[0]+
"x"+this.videoStats[1]);var b=Math.round(this.bweStats.getAverage()/1E3);var e=b<d[0]?"poor":b<d[1]?"moderate":"good";var f=b<n[0]?1:b<n[1]?2:b<n[2]?4:5;this.test.reportByState("Average Video bandwidth (Send): "+b+" kbps",e);!0===this.test.bitrate_only&&this.test.fillBandwidth(this.bweStats.getAverage());!1===this.test.bitrate_only&&(this.test.reportInfo("Recommended no. of incoming videos :"+f),this.test.reportInfo("Send bandwidth estimate max: "+this.bweStats.getMax()/1E3+" kbps"),this.test.reportInfo("Send bandwidth ramp-up time: "+
this.bweStats.getRampUpTime()+" ms"),this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived),this.test.reportInfo("NACK count: "+this.nackCount),this.test.reportInfo("Picture loss indications: "+this.pliCount),this.test.reportInfo("Quality predictor sum: "+this.qpSum),this.test.reportInfo("Frames encoded: "+this.framesEncoded),this.test.reportInfo("Frames decoded: "+this.framesDecoded));0<this.packetsSent&&(e=(this.packetsSent-this.packetsReceived)/
this.packetsSent*100,b=e<h[0]?"good":e<h[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+e.toFixed(2)+"%",b),!0===this.test.bitrate_only&&this.test.fillPacketsLost(e.toFixed(2)));b=(8*this.videoBytesSent/(1E3*a)).toFixed(2);a=(8*this.videoBytesRecieved/(1E3*a)).toFixed(2);this.test.reportInfo("Video Bitrate (Send) :"+b+" kbps");this.test.reportInfo("Video Bitrate (Receive) :"+a+" kbps")}}else"firefox"===adapter.browserDetails.browser&&(this.test.reportInfo("Bitrate Mean (Send): "+parseInt(this.bitrateMean)/
1E3+" kbps"),a=(new Date-this.startTime)/1E3,b=(8*this.bytesSent/(1E3*a)).toFixed(2),this.test.reportByState("Average Video bandwidth (Send): "+b+" kbps",b<d[0]?"poor":b<d[1]?"moderate":"good"),!0===this.test.bitrate_only&&this.test.fillBandwidth(1E3*b),!1===this.test.bitrate_only&&(this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived)),0<this.packetsSent&&(e=(this.packetsSent-this.packetsReceived)/this.packetsSent*100,b=e<h[0]?"good":
e<h[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+e.toFixed(2)+"%",b),!0===this.test.bitrate_only&&this.test.fillPacketsLost(e.toFixed(2))),b=(8*this.videoBytesSent/(1E3*a)).toFixed(2),a=(8*this.videoBytesRecieved/(1E3*a)).toFixed(2),this.test.reportInfo("Video Bitrate (Send) :"+b+" kbps"),this.test.reportInfo("Video Bitrate (Receive) :"+a+" kbps"));a=this.rttStats.getAverage();this.test.reportByState("RTT average: "+a+" ms",a<x[0]?"good":a<x[1]?"moderate":"poor");!1===this.test.bitrate_only&&
this.test.reportInfo("RTT max: "+this.rttStats.getMax()+" ms");this.test.done()}};k.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(d){this.filterConfig(d);this.running=!0;this.call=new a.a(d,this.test);this.call.setIceCandidateFilter(this.candidateFilter);this.senderChannel=
this.call.pc1.createDataChannel({ordered:!1,maxRetransmits:0});this.senderChannel.addEventListener("open",this.send.bind(this));this.call.pc2.addEventListener("datachannel",this.onReceiverChannel.bind(this));this.call.establishConnection();b.setTimeoutWithProgressBar(this.finishTest.bind(this),this.testDurationMs)},filterConfig:function(a){var b=[],d=a.iceServers[0],e=[],f=d.urls.startsWith("turns")?d.urls+"?transport=tcp":d.urls;e.push(f);d.urls=e;b.push(d);a.iceServers=b},onReceiverChannel:function(a){this.receiveChannel=
a.channel;this.receiveChannel.addEventListener("message",this.receive.bind(this))},send:function(){this.running&&(this.senderChannel.send(""+Date.now()),setTimeout(this.send.bind(this),this.sendIntervalMs))},receive:function(a){if(this.running){a=parseInt(a.data);var b=Date.now()-a;this.recvTimeStamps.push(a);this.delays.push(b);this.test.fillData(a+b,b)}},finishTest:function(){this.running=!1;this.call.close();this.call=null;var a=b.arrayMax(this.delays),d=b.arrayMin(this.delays);this.delays.length<
.8*this.testDurationMs/this.sendIntervalMs?this.test.reportError("Not enough samples gathered. Keep the page on  the foreground while the test is running."):this.test.reportSuccess("Collected "+this.delays.length+" delay samples.");a>2*(d+100)&&this.test.reportError("There is a big difference between the min and max delay of packets. Your network appears unstable.min="+d+"max="+a);this.test.done()}};e.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),
this.test.reportFatal.bind(this.test),this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(d){this.call=new a.a(d,this.test);this.call.setIceCandidateFilter(a.a.isRelay);b.appendSourceId(this.deviceId,"audio",this.constraints);b.doGetUserMedia(this.constraints,this.gotStream.bind(this),this.onFail.bind(this))},onFail:function(a){this.test.reportError("getUserMedia failed with error: "+a);this.test.done()},gotStream:function(a){this.call.pc1.addStream(a);
this.call.establishConnection();this.startTime=new Date;this.localStream=a.getAudioTracks()[0];setTimeout(this.gatherStats.bind(this),this.statStepMs)},gatherStats:function(){var a=new Date;a-this.startTime>this.durationMs?(this.test.setProgress(100),this.hangup()):(this.call.statsGatheringRunning||this.call.gatherStats(this.call.pc1,this.call.pc2,this.localStream,this.gotStats.bind(this)),this.test.setProgress(100*(a-this.startTime)/this.durationMs),setTimeout(this.gatherStats.bind(this),this.statStepMs))},
gotStats:function(a,b,d,e){if("chrome"===adapter.browserDetails.browser)for(var f in a)"undefined"!==typeof a[f].connection&&(this.bweStats.add(a[f].connection.timestamp,parseInt(a[f].connection.availableOutgoingBitrate)),this.rttStats.add(a[f].connection.timestamp,parseInt(1E3*a[f].connection.currentRoundTripTime)),this.packetsLost=d[f].audio.remote.packetsLost,this.packetsSent=a[f].audio.local.packetsSent,this.packetsReceived=d[f].audio.remote.packetsReceived,this.audioBytesSent=a[f].audio.local.bytesSent,
this.audioBytesRecieved=d[f].audio.remote.bytesReceived,this.jitter=d[f].audio.remote.jitter);else if("firefox"===adapter.browserDetails.browser)for(var h in a)(b=1E3*a[h].audio.remote.roundTripTime)&&this.rttStats.add(a[h].audio.remote.timestamp,parseInt(b)),this.bytesSent+=a[h].connection.bytesSent,this.packetsSent=a[h].audio.local.packetsSent,this.packetsLost=d[h].audio.remote.packetsLost,this.packetsReceived=d[h].audio.remote.packetsReceived,this.jitter=d[h].audio.remote.jitter,this.audioBytesSent=
a[h].audio.local.bytesSent,this.audioBytesRecieved=d[h].audio.remote.bytesReceived;else this.test.reportError("Only Firefox and Chrome getStats implementations are supported.");this.completed()},hangup:function(){this.call.pc1.getLocalStreams()[0].getTracks().forEach(function(a){a.stop()});this.call.close();this.call=null},completed:function(){if("chrome"===adapter.browserDetails.browser){var a=(new Date-this.startTime)/1E3,b=Math.round(this.bweStats.getAverage()/1E3);this.test.reportByState("Average Audio bandwidth (Send): "+
b+" kbps",b<u[0]?"poor":b<u[1]?"moderate":"good");!0===this.test.bitrate_only&&this.test.fillBandwidth(this.bweStats.getAverage());0==this.test.bitrate_only&&(this.test.reportInfo("Send bandwidth estimate max: "+this.bweStats.getMax()/1E3+" kbps"),this.test.reportInfo("Send bandwidth ramp-up time: "+this.bweStats.getRampUpTime()+" ms"),this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived));if(0<this.packetsSent){var d=(this.packetsSent-
this.packetsReceived)/this.packetsSent*100;b=d<h[0]?"good":d<h[1]?"moderate":"poor";this.test.reportByState("Packets lost: "+d.toFixed(2)+"%",b);!0===this.test.bitrate_only&&this.test.fillPacketsLost(d.toFixed(2))}b=(8*this.audioBytesSent/(1E3*a)).toFixed(2);a=(8*this.audioBytesRecieved/(1E3*a)).toFixed(2);this.test.reportInfo("Audio Bitrate (Send) :"+b+" kbps");this.test.reportInfo("Audio Bitrate (Receive) :'"+a+" 'kbps");a=1E3*this.jitter;a>B[1]||a<=B[0]||this.test.reportByState("Jitter: "+a,"good")}else"firefox"===
adapter.browserDetails.browser&&(a=(new Date-this.startTime)/1E3,!1===this.test.bitrate_only&&(this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived)),0<this.packetsSent&&(d=(this.packetsSent-this.packetsReceived)/this.packetsSent*100,b=d<h[0]?"good":d<h[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+d.toFixed(2)+"%",b),!0===this.test.bitrate_only&&this.test.fillPacketsLost(d.toFixed(2))),b=1E3*this.jitter,b>B[1]||b<=
B[0]||this.test.reportByState("Jitter: "+b,"good"),b=(8*this.audioBytesSent/(1E3*a)).toFixed(2),a=(8*this.audioBytesRecieved/(1E3*a)).toFixed(2),this.test.reportInfo("Audio Bitrate (Send) :"+b+" kbps"),this.test.reportInfo("Audio Bitrate (Receive) :'"+a+" 'kbps"));a=this.rttStats.getAverage();this.test.reportByState("RTT average: "+a+" ms",a<x[0]?"good":a<x[1]?"moderate":"poor");!1===this.test.bitrate_only&&this.test.reportInfo("RTT max: "+this.rttStats.getMax()+" ms");this.test.done()}}},function(l,
r,p){function f(f,e,a){this.test=f;this.host=e;this.port=a}r.a=function(k,e,a){(new f(k,e,a)).run()};var q=p(77);f.prototype={run:function(){var f=this;q("https://"+this.host+":"+this.port+"/proxy-token",{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"No"}}).then(function(e){return e.json()}).then(function(e){f.test.reportSuccess("Token created successfully.");if(!1===Object.prototype.hasOwnProperty.call(e,"token"))f.test.reportError("Token creation failed due to error: "+
e.error),f.test.done();else{var a={video:!0,audio:!0,data:!0,videoSize:{LD:[80,45,640,360]}.SD,attributes:{name:"Test connectivity"}},b=EnxRtc.Logger.getLogLevel();EnxRtc.Logger.setLogLevel(EnxRtc.Logger.NONE);EnxRtc.joinRoom(e.token,a,function(a,e){EnxRtc.Logger.setLogLevel(b);e&&null!=e?(f.test.reportError("Room not joined due to error: "+e.type),f.test.done()):a&&null!=a&&(a.room.disconnect(),f.test.reportSuccess("Room joined successfully."),f.test.done())})}}).catch(function(e){f.test.reportError("Token creation failed due to error: "+
e);f.test.done()})}}},function(l,r,p){(function(f){var q=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof f)return f;throw Error("unable to locate global object");}();if(l.exports=r=q.fetch)r.default=q.fetch.bind(q);r.Headers=q.Headers;r.Request=q.Request;r.Response=q.Response}).call(r,p(20))},function(l,r,p){function f(f){return void 0==f||"app"==f?!1:!0}p(11);r.a={setCustomData:function(f,k,e){console.log("setCustomData")},
getCustomData:function(l,k){console.log("getCustomData");var e={result:0};0==f(l.scope)&&(e.result=1,e.error="Invalid scope parameter "+l.scope,k(e))},saveCustomData:function(l,k,e){console.log("saveCustomData");var a={result:0};if(0==f(l))a.result=1,a.error="Invalid scope parameter: "+l;else if(void 0==k||"object"!=typeof k)a.result=1,a.error="Invalid  data";e(a)}}},function(l,r){},function(l,r,p){r=p(20);l.exports=r.adapter=p(81)},function(l,r,p){l.exports=function(){return function(){function f(l,
k,e){function a(h,d){if(!k[h]){if(!l[h]){if(b)return b(h,!0);d=Error("Cannot find module '"+h+"'");throw d.code="MODULE_NOT_FOUND",d;}d=k[h]={exports:{}};l[h][0].call(d.exports,function(b){return a(l[h][1][b]||b)},d,d.exports,f,l,k,e)}return k[h].exports}for(var b=!1,h=0;h<e.length;h++)a(e[h]);return a}return f}()({1:[function(f,l,k){f=f("./adapter_factory.js");f=(0,f.adapterFactory)({window:window});l.exports=f},{"./adapter_factory.js":2}],2:[function(f,l,k){function e(a){if(a&&a.__esModule)return a;
var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}Object.defineProperty(k,"__esModule",{value:!0});k.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},k=a.log,l=a.detectBrowser(e),q={browserDetails:l,commonShim:u,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings};
switch(l.browser){case "chrome":if(!b||!b.shimPeerConnection||!f.shimChrome){k("Chrome shim is not included in this adapter release.");break}k("adapter.js shimming chrome.");q.browserShim=b;b.shimGetUserMedia(e);b.shimMediaStream(e);b.shimPeerConnection(e);b.shimOnTrack(e);b.shimAddTrackRemoveTrack(e);b.shimGetSendersWithDtmf(e);b.shimGetStats(e);b.shimSenderReceiverGetStats(e);b.fixNegotiationNeeded(e);u.shimRTCIceCandidate(e);u.shimConnectionState(e);u.shimMaxMessageSize(e);u.shimSendThrowTypeError(e);
u.removeAllowExtmapMixed(e);break;case "firefox":if(!p||!p.shimPeerConnection||!f.shimFirefox){k("Firefox shim is not included in this adapter release.");break}k("adapter.js shimming firefox.");q.browserShim=p;p.shimGetUserMedia(e);p.shimPeerConnection(e);p.shimOnTrack(e);p.shimRemoveStream(e);p.shimSenderGetStats(e);p.shimReceiverGetStats(e);p.shimRTCDataChannel(e);u.shimRTCIceCandidate(e);u.shimConnectionState(e);u.shimMaxMessageSize(e);u.shimSendThrowTypeError(e);break;case "edge":if(!h||!h.shimPeerConnection||
!f.shimEdge){k("MS edge shim is not included in this adapter release.");break}k("adapter.js shimming edge.");q.browserShim=h;h.shimGetUserMedia(e);h.shimGetDisplayMedia(e);h.shimPeerConnection(e);h.shimReplaceTrack(e);u.shimMaxMessageSize(e);u.shimSendThrowTypeError(e);break;case "safari":if(!d||!f.shimSafari){k("Safari shim is not included in this adapter release.");break}k("adapter.js shimming safari.");q.browserShim=d;d.shimRTCIceServerUrls(e);d.shimCreateOfferLegacy(e);d.shimCallbacksAPI(e);d.shimLocalStreamsAPI(e);
d.shimRemoteStreamsAPI(e);d.shimTrackEventTransceiver(e);d.shimGetUserMedia(e);u.shimRTCIceCandidate(e);u.shimMaxMessageSize(e);u.shimSendThrowTypeError(e);u.removeAllowExtmapMixed(e);break;default:k("Unsupported browser!")}return q};l=f("./utils");var a=e(l);l=f("./chrome/chrome_shim");var b=e(l);l=f("./edge/edge_shim");var h=e(l);l=f("./firefox/firefox_shim");var p=e(l);l=f("./safari/safari_shim");var d=e(l);f=f("./common_shim");var u=e(f)},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,
"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(f,l,k){function e(a,b,d){b in a?Object.defineProperty(a,b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d;return a}function a(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(b){return a._shimmedLocalStreams[b][0]})};var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=
function(a,d){if(!d)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var e=b.apply(this,arguments);this._shimmedLocalStreams[d.id]?-1===this._shimmedLocalStreams[d.id].indexOf(e)&&this._shimmedLocalStreams[d.id].push(e):this._shimmedLocalStreams[d.id]=[d,e];return e};var d=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(c){return c.track===
a}))throw new DOMException("Track already exists.","InvalidAccessError");});var e=this.getSenders();d.apply(this,arguments);var f=this.getSenders().filter(function(a){return-1===e.indexOf(a)});this._shimmedLocalStreams[a.id]=[a].concat(f)};var e=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[a.id];return e.apply(this,arguments)};var f=a.RTCPeerConnection.prototype.removeTrack;
a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a&&Object.keys(this._shimmedLocalStreams).forEach(function(d){var e=b._shimmedLocalStreams[d].indexOf(a);-1!==e&&b._shimmedLocalStreams[d].splice(e,1);1===b._shimmedLocalStreams[d].length&&delete b._shimmedLocalStreams[d]});return f.apply(this,arguments)}}Object.defineProperty(k,"__esModule",{value:!0});k.shimGetDisplayMedia=k.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbolIterator();var b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},h=f("./getusermedia");Object.defineProperty(k,"shimGetUserMedia",{enumerable:!0,get:function(){return h.shimGetUserMedia}});var p=f("./getdisplaymedia");Object.defineProperty(k,"shimGetDisplayMedia",
{enumerable:!0,get:function(){return p.shimGetDisplayMedia}});k.shimMediaStream=function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream};k.shimOnTrack=function(a){if("object"!==("undefined"===typeof a?"undefined":b(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)d.wrapPeerConnectionEvent(a,"track",function(a){a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}});return a});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},
set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});var e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var b=this;this._ontrackpoly||(this._ontrackpoly=function(d){d.stream.addEventListener("addtrack",function(e){var f=void 0;f=a.RTCPeerConnection.prototype.getReceivers?b.getReceivers().find(function(a){return a.track&&a.track.id===
e.track.id}):{track:e.track};var h=new Event("track");h.track=e.track;h.receiver=f;h.transceiver={receiver:f};h.streams=[d.stream];b.dispatchEvent(h)});d.stream.getTracks().forEach(function(e){var f=void 0;f=a.RTCPeerConnection.prototype.getReceivers?b.getReceivers().find(function(a){return a.track&&a.track.id===e.id}):{track:e};var h=new Event("track");h.track=e;h.receiver=f;h.transceiver={receiver:f};h.streams=[d.stream];b.dispatchEvent(h)})},this.addEventListener("addstream",this._ontrackpoly));
return e.apply(this,arguments)}}};k.shimGetSendersWithDtmf=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var d=function(a,b){return{track:b,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===b.kind?a.createDTMFSender(b):null);return this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){this._senders=
this._senders||[];return this._senders.slice()};var e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,b){var f=e.apply(this,arguments);f||(f=d(this,a),this._senders.push(f));return f};var f=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){f.apply(this,arguments);var b=this._senders.indexOf(a);-1!==b&&this._senders.splice(b,1)}}var h=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=
function(a){var b=this;this._senders=this._senders||[];h.apply(this,[a]);a.getTracks().forEach(function(a){b._senders.push(d(b,a))})};var k=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._senders=this._senders||[];k.apply(this,[a]);a.getTracks().forEach(function(a){var c=b._senders.find(function(c){return c.track===a});c&&b._senders.splice(b._senders.indexOf(c),1)})}}else if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&
"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var l=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=l.apply(this,[]);b.forEach(function(b){return b._pc=a});return b};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);
return this._dtmf}})}};k.shimGetStats=function(a){if(a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){var a=this,d=Array.prototype.slice.call(arguments),e=d[0],f=d[1];d=d[2];if(0<arguments.length&&"function"===typeof e)return b.apply(this,arguments);if(0===b.length&&(0===arguments.length||"function"!==typeof e))return b.apply(this,[]);var h=function(a){var b={};a.result().forEach(function(a){var c={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",
remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(b){c[b]=a.stat(b)});b[c.id]=c});return b},k=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};return 2<=arguments.length?b.apply(this,[function(a){f(k(h(a)))},e]):(new Promise(function(d,e){b.apply(a,[function(a){d(k(h(a)))},e])})).then(f,d)}}};k.shimSenderReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver){if(!("getStats"in
a.RTCRtpSender.prototype)){var e=a.RTCPeerConnection.prototype.getSenders;e&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=e.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});var f=a.RTCPeerConnection.prototype.addTrack;f&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=f.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return d.filterStats(b,a.track,!0)})}}if(!("getStats"in
a.RTCRtpReceiver.prototype)){var h=a.RTCPeerConnection.prototype.getReceivers;h&&(a.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=h.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});d.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return d.filterStats(b,a.track,!1)})}}if("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype){var k=
a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof a.MediaStreamTrack){var b=arguments[0],d=void 0,e=void 0,f=void 0;this.getSenders().forEach(function(a){a.track===b&&(d?f=!0:d=a)});this.getReceivers().forEach(function(a){a.track===b&&(e?f=!0:e=a);return a.track===b});return f||d&&e?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):d?d.getStats():e?
e.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return k.apply(this,arguments)}}}};k.shimAddTrackRemoveTrackWithNative=a;k.shimAddTrackRemoveTrack=function(b){function f(a,c){var b=c.sdp;Object.keys(a._reverseStreams||[]).forEach(function(c){c=a._reverseStreams[c];b=b.replace(new RegExp(a._streams[c.id].id,"g"),c.id)});return new RTCSessionDescription({type:c.type,sdp:b})}function h(a,c){var b=c.sdp;Object.keys(a._reverseStreams||
[]).forEach(function(c){c=a._reverseStreams[c];b=b.replace(new RegExp(c.id,"g"),a._streams[c.id].id)});return new RTCSessionDescription({type:c.type,sdp:b})}if(b.RTCPeerConnection){var k=d.detectBrowser(b);if(b.RTCPeerConnection.prototype.addTrack&&65<=k.version)return a(b);var l=b.RTCPeerConnection.prototype.getLocalStreams;b.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,c=l.apply(this);this._reverseStreams=this._reverseStreams||{};return c.map(function(c){return a._reverseStreams[c.id]})};
var p=b.RTCPeerConnection.prototype.addStream;b.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};a.getTracks().forEach(function(a){if(c.getSenders().find(function(c){return c.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!this._reverseStreams[a.id]){var d=new b.MediaStream(a.getTracks());this._streams[a.id]=d;this._reverseStreams[d.id]=a;a=d}p.apply(this,[a])};var q=b.RTCPeerConnection.prototype.removeStream;
b.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};q.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};b.RTCPeerConnection.prototype.addTrack=function(a,c){var d=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var e=[].slice.call(arguments,
1);if(1!==e.length||!e[0].getTracks().find(function(c){return c===a}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(c){return c.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(e=this._streams[c.id])?(e.addTrack(a),Promise.resolve().then(function(){d.dispatchEvent(new Event("negotiationneeded"))})):
(e=new b.MediaStream([a]),this._streams[c.id]=e,this._reverseStreams[e.id]=c,this.addStream(e));return this.getSenders().find(function(c){return c.track===a})};["createOffer","createAnswer"].forEach(function(a){var c=b.RTCPeerConnection.prototype[a],d=e({},a,function(){var a=this,b=arguments;return arguments.length&&"function"===typeof arguments[0]?c.apply(this,[function(c){c=f(a,c);b[0].apply(null,[c])},function(a){b[1]&&b[1].apply(null,a)},arguments[2]]):c.apply(this,arguments).then(function(c){return f(a,
c)})});b.RTCPeerConnection.prototype[a]=d[a]});var u=b.RTCPeerConnection.prototype.setLocalDescription;b.RTCPeerConnection.prototype.setLocalDescription=function(){if(!arguments.length||!arguments[0].type)return u.apply(this,arguments);arguments[0]=h(this,arguments[0]);return u.apply(this,arguments)};var r=Object.getOwnPropertyDescriptor(b.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(b.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=r.get.apply(this);
return""===a.type?a:f(this,a)}});b.RTCPeerConnection.prototype.removeTrack=function(a){var c=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};
var b=void 0;Object.keys(this._streams).forEach(function(d){c._streams[d].getTracks().find(function(c){return a.track===c})&&(b=c._streams[d])});b&&(1===b.getTracks().length?this.removeStream(this._reverseStreams[b.id]):b.removeTrack(a.track),this.dispatchEvent(new Event("negotiationneeded")))}}};k.shimPeerConnection=function(a){var b=d.detectBrowser(a);!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection);if(a.RTCPeerConnection){53>b.version&&["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(b){var d=a.RTCPeerConnection.prototype[b],f=e({},b,function(){arguments[0]=new ("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]);return d.apply(this,arguments)});a.RTCPeerConnection.prototype[b]=f[b]});var f=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>b.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():f.apply(this,
arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};k.fixNegotiationNeeded=function(a){d.wrapPeerConnectionEvent(a,"negotiationneeded",function(a){if("stable"===a.target.signalingState)return a})};var d=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(f("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(f,l,k){Object.defineProperty(k,"__esModule",
{value:!0});k.shimGetDisplayMedia=function(e,a){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||("function"!==typeof a?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):e.navigator.mediaDevices.getDisplayMedia=function(b){return a(b).then(function(a){var f=b.video&&b.video.width,d=b.video&&b.video.height;b.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,maxFrameRate:b.video&&b.video.frameRate||3}};f&&
(b.video.mandatory.maxWidth=f);d&&(b.video.mandatory.maxHeight=d);return e.navigator.mediaDevices.getUserMedia(b)})})}},{}],5:[function(f,l,k){Object.defineProperty(k,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==
Symbol.prototype?"symbol":typeof a};k.shimGetUserMedia=function(f){var h=f&&f.navigator;if(h.mediaDevices){var d=a.detectBrowser(f),k=function(a){if("object"!==("undefined"===typeof a?"undefined":e(a))||a.mandatory||a.optional)return a;var b={};Object.keys(a).forEach(function(d){if("require"!==d&&"advanced"!==d&&"mediaSource"!==d){var f="object"===e(a[d])?a[d]:{ideal:a[d]};void 0!==f.exact&&"number"===typeof f.exact&&(f.min=f.max=f.exact);var h=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):
"deviceId"===b?"sourceId":b};if(void 0!==f.ideal){b.optional=b.optional||[];var k={};"number"===typeof f.ideal?(k[h("min",d)]=f.ideal,b.optional.push(k),k={},k[h("max",d)]=f.ideal):k[h("",d)]=f.ideal;b.optional.push(k)}void 0!==f.exact&&"number"!==typeof f.exact?(b.mandatory=b.mandatory||{},b.mandatory[h("",d)]=f.exact):["min","max"].forEach(function(a){void 0!==f[a]&&(b.mandatory=b.mandatory||{},b.mandatory[h(a,d)]=f[a])})}});a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced));return b},
l=function(a,f){if(61<=d.version)return f(a);if((a=JSON.parse(JSON.stringify(a)))&&"object"===e(a.audio)){var l=function(a,c,b){c in a&&!(b in a)&&(a[b]=a[c],delete a[c])};a=JSON.parse(JSON.stringify(a));l(a.audio,"autoGainControl","googAutoGainControl");l(a.audio,"noiseSuppression","googNoiseSuppression");a.audio=k(a.audio)}if(a&&"object"===e(a.video)){var n=a.video.facingMode;n=n&&("object"===("undefined"===typeof n?"undefined":e(n))?n:{ideal:n});l=66>d.version;if(!(!n||"user"!==n.exact&&"environment"!==
n.exact&&"user"!==n.ideal&&"environment"!==n.ideal||h.mediaDevices.getSupportedConstraints&&h.mediaDevices.getSupportedConstraints().facingMode&&!l)){delete a.video.facingMode;var p=void 0;if("environment"===n.exact||"environment"===n.ideal)p=["back","rear"];else if("user"===n.exact||"user"===n.ideal)p=["front"];if(p)return h.mediaDevices.enumerateDevices().then(function(d){d=d.filter(function(a){return"videoinput"===a.kind});var c=d.find(function(a){return p.some(function(c){return a.label.toLowerCase().includes(c)})});
!c&&d.length&&p.includes("back")&&(c=d[d.length-1]);c&&(a.video.deviceId=n.exact?{exact:c.deviceId}:{ideal:c.deviceId});a.video=k(a.video);b("chrome: "+JSON.stringify(a));return f(a)})}a.video=k(a.video)}b("chrome: "+JSON.stringify(a));return f(a)},p=function(a){return 64<=d.version?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",
MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};h.getUserMedia=function(a,b,d){l(a,function(a){h.webkitGetUserMedia(a,b,function(a){d&&d(p(a))})})}.bind(h);if(h.mediaDevices.getUserMedia){var q=h.mediaDevices.getUserMedia.bind(h.mediaDevices);
h.mediaDevices.getUserMedia=function(a){return l(a,function(a){return q(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");return b},function(a){return Promise.reject(p(a))})})}}}};var a=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(f("../utils.js")),b=a.log},{"../utils.js":15}],
6:[function(f,l,k){Object.defineProperty(k,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};k.shimRTCIceCandidate=function(f){if(f.RTCIceCandidate&&!(f.RTCIceCandidate&&"foundation"in
f.RTCIceCandidate.prototype)){var h=f.RTCIceCandidate;f.RTCIceCandidate=function(b){"object"===("undefined"===typeof b?"undefined":e(b))&&b.candidate&&0===b.candidate.indexOf("a=")&&(b=JSON.parse(JSON.stringify(b)),b.candidate=b.candidate.substr(2));if(b.candidate&&b.candidate.length){var d=new h(b);b=a.default.parseCandidate(b.candidate);var f=Object.assign(d,b);f.toJSON=function(){return{candidate:f.candidate,sdpMid:f.sdpMid,sdpMLineIndex:f.sdpMLineIndex,usernameFragment:f.usernameFragment}};return f}return new h(b)};
f.RTCIceCandidate.prototype=h.prototype;b.wrapPeerConnectionEvent(f,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,"candidate",{value:new f.RTCIceCandidate(a.candidate),writable:"false"});return a})}};k.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var f=b.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var d=function(b){if(!b||!b.sdp)return!1;
b=a.default.splitSections(b.sdp);b.shift();return b.some(function(b){return(b=a.default.parseMLine(b))&&"application"===b.kind&&-1!==b.protocol.indexOf("SCTP")})},h=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===a||2>a.length)return-1;a=parseInt(a[1],10);return a!==a?-1:a},k=function(a){var b=65536;"firefox"===f.browser&&(b=57>f.version?-1===a?16384:2147483637:60>f.version?57===f.version?65535:65536:2147483637);return b},l=function(b,d){var e=65536;"firefox"===f.browser&&57===
f.version&&(e=65535);b=a.default.matchPrefix(b.sdp,"a=max-message-size:");0<b.length?e=parseInt(b[0].substr(19),10):"firefox"===f.browser&&-1!==d&&(e=2147483637);return e},p=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){this._sctp=null;"chrome"===f.browser&&76<=f.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,
configurable:!0});if(d(arguments[0])){var a=h(arguments[0]),b=k(a);a=l(arguments[0],a);var e=void 0;e=0===b&&0===a?Number.POSITIVE_INFINITY:0===b||0===a?Math.max(b,a):Math.min(b,a);b={};Object.defineProperty(b,"maxMessageSize",{get:function(){return e}});this._sctp=b}return p.apply(this,arguments)}}};k.shimSendThrowTypeError=function(a){function e(a,b){var d=a.send;a.send=function(){var e=arguments[0];e=e.length||e.size||e.byteLength;if("open"===a.readyState&&b.sctp&&e>b.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+
b.sctp.maxMessageSize+" bytes)");return d.apply(a,arguments)}}if(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype){var d=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){var a=d.apply(this,arguments);e(a,this);return a};b.wrapPeerConnectionEvent(a,"datachannel",function(a){e(a.channel,a.target);return a})}};k.shimConnectionState=function(a){if(a.RTCPeerConnection&&!("connectionState"in a.RTCPeerConnection.prototype)){var b=
a.RTCPeerConnection.prototype;Object.defineProperty(b,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0});Object.defineProperty(b,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange);a&&
this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(a){var d=b[a];b[a]=function(){this._connectionstatechangepoly||(this._connectionstatechangepoly=function(a){var b=a.target;if(b._lastConnectionState!==b.connectionState){b._lastConnectionState=b.connectionState;var d=new Event("connectionstatechange",a);b.dispatchEvent(d)}return a},this.addEventListener("iceconnectionstatechange",
this._connectionstatechangepoly));return d.apply(this,arguments)}})}};k.removeAllowExtmapMixed=function(a){if(a.RTCPeerConnection){var e=b.detectBrowser(a);if(!("chrome"===e.browser&&71<=e.version)){var d=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(a){a&&a.sdp&&-1!==a.sdp.indexOf("\na=extmap-allow-mixed")&&(a.sdp=a.sdp.split("\n").filter(function(a){return"a=extmap-allow-mixed"!==a.trim()}).join("\n"));return d.apply(this,arguments)}}}};
var a=(l=f("sdp"))&&l.__esModule?l:{default:l},b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(f("./utils"))},{"./utils":15,sdp:17}],7:[function(f,l,k){Object.defineProperty(k,"__esModule",{value:!0});k.shimGetDisplayMedia=k.shimGetUserMedia=void 0;var e=f("./getusermedia");Object.defineProperty(k,"shimGetUserMedia",{enumerable:!0,get:function(){return e.shimGetUserMedia}});var a=f("./getdisplaymedia");
Object.defineProperty(k,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}});k.shimPeerConnection=function(a){var d=b.detectBrowser(a);if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=function(a){return a}),15025>d.version)){var e=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){e.set.call(this,
a);var b=new Event("enabled");b.enabled=a;this.dispatchEvent(b)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null));return this._dtmf}});a.RTCDtmfSender&&!a.RTCDTMFSender&&(a.RTCDTMFSender=a.RTCDtmfSender);var f=(0,p.default)(a,d.version);a.RTCPeerConnection=function(a){a&&a.iceServers&&(a.iceServers=
(0,h.filterIceServers)(a.iceServers,d.version),b.log("ICE servers after filtering:",a.iceServers));return new f(a)};a.RTCPeerConnection.prototype=f.prototype};k.shimReplaceTrack=function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)};var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(f("../utils")),h=f("./filtericeservers"),
p=(f=f("rtcpeerconnection-shim"))&&f.__esModule?f:{default:f}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(f,l,k){Object.defineProperty(k,"__esModule",{value:!0});k.filterIceServers=function(a,b){var f=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var b=a.urls||a.url;a.url&&!a.urls&&e.deprecated("RTCIceServer.url","RTCIceServer.urls");var h="string"===typeof b;h&&(b=[b]);b=b.filter(function(a){return 0===
a.indexOf("stun:")?!1:(a=a.startsWith("turn")&&!a.startsWith("turn:[")&&a.includes("transport=udp"))&&!f?f=!0:a&&!f});delete a.url;a.urls=h?b[0]:b;return!!b.length}})};var e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b.default=a;return b}(f("../utils"))},{"../utils":15}],9:[function(f,l,k){Object.defineProperty(k,"__esModule",{value:!0});k.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&
!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator))}},{}],10:[function(f,l,k){Object.defineProperty(k,"__esModule",{value:!0});k.shimGetUserMedia=function(e){e=e&&e.navigator;var a=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},b=e.mediaDevices.getUserMedia.bind(e.mediaDevices);
e.mediaDevices.getUserMedia=function(e){return b(e).catch(function(b){return Promise.reject(a(b))})}}},{}],11:[function(f,l,k){function e(a,b,e){b in a?Object.defineProperty(a,b,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[b]=e;return a}Object.defineProperty(k,"__esModule",{value:!0});k.shimGetDisplayMedia=k.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},b=f("./getusermedia");Object.defineProperty(k,"shimGetUserMedia",{enumerable:!0,get:function(){return b.shimGetUserMedia}});var h=f("./getdisplaymedia");Object.defineProperty(k,"shimGetDisplayMedia",{enumerable:!0,get:function(){return h.shimGetDisplayMedia}});k.shimOnTrack=function(b){"object"===("undefined"===typeof b?"undefined":
a(b))&&b.RTCTrackEvent&&"receiver"in b.RTCTrackEvent.prototype&&!("transceiver"in b.RTCTrackEvent.prototype)&&Object.defineProperty(b.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};k.shimPeerConnection=function(b){var d=p.detectBrowser(b);if("object"===("undefined"===typeof b?"undefined":a(b))&&(b.RTCPeerConnection||b.mozRTCPeerConnection)){!b.RTCPeerConnection&&b.mozRTCPeerConnection&&(b.RTCPeerConnection=b.mozRTCPeerConnection);53>d.version&&["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(a){var d=b.RTCPeerConnection.prototype[a],f=e({},a,function(){arguments[0]=new ("addIceCandidate"===a?b.RTCIceCandidate:b.RTCSessionDescription)(arguments[0]);return d.apply(this,arguments)});b.RTCPeerConnection.prototype[a]=f[a]});if(68>d.version){var f=b.RTCPeerConnection.prototype.addIceCandidate;b.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():f.apply(this,
arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var h={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},k=b.RTCPeerConnection.prototype.getStats;b.RTCPeerConnection.prototype.getStats=function(){var a=Array.prototype.slice.call(arguments),b=a[1],e=a[2];return k.apply(this,[a[0]||null]).then(function(a){if(53>d.version&&!b)try{a.forEach(function(a){a.type=h[a.type]||a.type})}catch(A){if("TypeError"!==
A.name)throw A;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:h[b.type]||b.type}))})}return a}).then(b,e)}}};k.shimSenderGetStats=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection&&b.RTCRtpSender&&!(b.RTCRtpSender&&"getStats"in b.RTCRtpSender.prototype)){var d=b.RTCPeerConnection.prototype.getSenders;d&&(b.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=d.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});var e=b.RTCPeerConnection.prototype.addTrack;
e&&(b.RTCPeerConnection.prototype.addTrack=function(){var a=e.apply(this,arguments);a._pc=this;return a});b.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};k.shimReceiverGetStats=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection&&b.RTCRtpSender&&!(b.RTCRtpSender&&"getStats"in b.RTCRtpReceiver.prototype)){var d=b.RTCPeerConnection.prototype.getReceivers;d&&(b.RTCPeerConnection.prototype.getReceivers=
function(){var a=this,b=d.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});p.wrapPeerConnectionEvent(b,"track",function(a){a.receiver._pc=a.srcElement;return a});b.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}};k.shimRemoveStream=function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;p.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(d){d.track&&
a.getTracks().includes(d.track)&&b.removeTrack(d)})})};k.shimRTCDataChannel=function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)};var p=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(f("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(f,l,k){Object.defineProperty(k,"__esModule",{value:!0});k.shimGetDisplayMedia=function(e,a){e.navigator.mediaDevices&&
"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(b){if(!b||!b.video)return b=new DOMException("getDisplayMedia without video constraints is undefined"),b.name="NotFoundError",b.code=8,Promise.reject(b);!0===b.video?b.video={mediaSource:a}:b.video.mediaSource=a;return e.navigator.mediaDevices.getUserMedia(b)})}},{}],13:[function(f,l,k){Object.defineProperty(k,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbolIterator();var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};k.shimGetUserMedia=function(b){var f=a.detectBrowser(b),k=b&&b.navigator;b=b&&b.MediaStreamTrack;k.getUserMedia=function(b,d,e){a.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");
k.mediaDevices.getUserMedia(b).then(d,e)};if(!(55<f.version&&"autoGainControl"in k.mediaDevices.getSupportedConstraints())){var d=function(a,b,d){b in a&&!(d in a)&&(a[d]=a[b],delete a[b])},l=k.mediaDevices.getUserMedia.bind(k.mediaDevices);k.mediaDevices.getUserMedia=function(a){"object"===("undefined"===typeof a?"undefined":e(a))&&"object"===e(a.audio)&&(a=JSON.parse(JSON.stringify(a)),d(a.audio,"autoGainControl","mozAutoGainControl"),d(a.audio,"noiseSuppression","mozNoiseSuppression"));return l(a)};
if(b&&b.prototype.getSettings){var n=b.prototype.getSettings;b.prototype.getSettings=function(){var a=n.apply(this,arguments);d(a,"mozAutoGainControl","autoGainControl");d(a,"mozNoiseSuppression","noiseSuppression");return a}}if(b&&b.prototype.applyConstraints){var p=b.prototype.applyConstraints;b.prototype.applyConstraints=function(a){"audio"===this.kind&&"object"===("undefined"===typeof a?"undefined":e(a))&&(a=JSON.parse(JSON.stringify(a)),d(a,"autoGainControl","mozAutoGainControl"),d(a,"noiseSuppression",
"mozNoiseSuppression"));return p.apply(this,[a])}}}};var a=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b.default=a;return b}(f("../utils"))},{"../utils":15}],14:[function(f,l,k){function e(a){return a&&void 0!==a.video?Object.assign({},a,{video:b.compactObject(a.video)}):a}Object.defineProperty(k,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&
"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};k.shimLocalStreamsAPI=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection){"getLocalStreams"in b.RTCPeerConnection.prototype||(b.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||(this._localStreams=
[]);return this._localStreams});if(!("addStream"in b.RTCPeerConnection.prototype)){var e=b.RTCPeerConnection.prototype.addTrack;b.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);this._localStreams.includes(a)||this._localStreams.push(a);a.getAudioTracks().forEach(function(d){return e.call(b,d,a)});a.getVideoTracks().forEach(function(d){return e.call(b,d,a)})};b.RTCPeerConnection.prototype.addTrack=function(a){var b=arguments[1];b&&(this._localStreams?
this._localStreams.includes(b)||this._localStreams.push(b):this._localStreams=[b]);return e.apply(this,arguments)}}"removeStream"in b.RTCPeerConnection.prototype||(b.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);var d=this._localStreams.indexOf(a);if(-1!==d){this._localStreams.splice(d,1);var e=a.getTracks();this.getSenders().forEach(function(a){e.includes(a.track)&&b.removeTrack(a)})}})}};k.shimRemoteStreamsAPI=function(b){if("object"===
("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection&&("getRemoteStreams"in b.RTCPeerConnection.prototype||(b.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in b.RTCPeerConnection.prototype))){Object.defineProperty(b.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){var b=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",
this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(function(a){b._remoteStreams||(b._remoteStreams=[]);if(!b._remoteStreams.includes(a)){b._remoteStreams.push(a);var d=new Event("addstream");d.stream=a;b.dispatchEvent(d)}})})}});var e=b.RTCPeerConnection.prototype.setRemoteDescription;b.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;this._onaddstreampoly||this.addEventListener("track",
this._onaddstreampoly=function(b){b.streams.forEach(function(b){a._remoteStreams||(a._remoteStreams=[]);if(!(0<=a._remoteStreams.indexOf(b))){a._remoteStreams.push(b);var d=new Event("addstream");d.stream=b;a.dispatchEvent(d)}})});return e.apply(a,arguments)}}};k.shimCallbacksAPI=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection){b=b.RTCPeerConnection.prototype;var e=b.createOffer,d=b.createAnswer,f=b.setLocalDescription,h=b.setRemoteDescription,k=b.addIceCandidate;
b.createOffer=function(a,b){var d=e.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return d;d.then(a,b);return Promise.resolve()};b.createAnswer=function(a,b){var e=d.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return e;e.then(a,b);return Promise.resolve()};var l=function(a,b,d){a=f.apply(this,[a]);if(!d)return a;a.then(b,d);return Promise.resolve()};b.setLocalDescription=l;l=function(a,b,d){a=h.apply(this,[a]);if(!d)return a;a.then(b,d);return Promise.resolve()};
b.setRemoteDescription=l;l=function(a,b,d){a=k.apply(this,[a]);if(!d)return a;a.then(b,d);return Promise.resolve()};b.addIceCandidate=l}};k.shimGetUserMedia=function(a){var b=a&&a.navigator;if(b.mediaDevices&&b.mediaDevices.getUserMedia){a=b.mediaDevices;var d=a.getUserMedia.bind(a);b.mediaDevices.getUserMedia=function(a){return d(e(a))}}!b.getUserMedia&&b.mediaDevices&&b.mediaDevices.getUserMedia&&(b.getUserMedia=function(a,d,e){b.mediaDevices.getUserMedia(a).then(d,e)})};k.shimConstraints=e;k.shimRTCIceServerUrls=
function(a){var e=a.RTCPeerConnection;a.RTCPeerConnection=function(a,f){if(a&&a.iceServers){for(var d=[],h=0;h<a.iceServers.length;h++){var k=a.iceServers[h];!k.hasOwnProperty("urls")&&k.hasOwnProperty("url")?(b.deprecated("RTCIceServer.url","RTCIceServer.urls"),k=JSON.parse(JSON.stringify(k)),k.urls=k.url,delete k.url,d.push(k)):d.push(a.iceServers[h])}a.iceServers=d}return new e(a,f)};a.RTCPeerConnection.prototype=e.prototype;"generateCertificate"in a.RTCPeerConnection&&Object.defineProperty(a.RTCPeerConnection,
"generateCertificate",{get:function(){return e.generateCertificate}})};k.shimTrackEventTransceiver=function(b){"object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCTrackEvent&&"receiver"in b.RTCTrackEvent.prototype&&!("transceiver"in b.RTCTrackEvent.prototype)&&Object.defineProperty(b.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};k.shimCreateOfferLegacy=function(a){var b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=
function(a){if(a){"undefined"!==typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var d=this.getTransceivers().find(function(a){return"audio"===a.receiver.track.kind});!1===a.offerToReceiveAudio&&d?"sendrecv"===d.direction?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":"recvonly"===d.direction&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive"):!0!==a.offerToReceiveAudio||d||this.addTransceiver("audio");"undefined"!==typeof a.offerToReceiveVideo&&
(a.offerToReceiveVideo=!!a.offerToReceiveVideo);d=this.getTransceivers().find(function(a){return"video"===a.receiver.track.kind});!1===a.offerToReceiveVideo&&d?"sendrecv"===d.direction?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":"recvonly"===d.direction&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive"):!0!==a.offerToReceiveVideo||d||this.addTransceiver("video")}return b.apply(this,arguments)}};var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,
d)&&(b[d]=a[d]);b.default=a;return b}(f("../utils"))},{"../utils":15}],15:[function(f,l,k){function e(a,b,d){b in a?Object.defineProperty(a,b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d;return a}function a(a,b,d){return(a=a.match(b))&&a.length>=d&&parseInt(a[d],10)}function b(a){return"[object Object]"!==Object.prototype.toString.call(a)?a:Object.keys(a).reduce(function(d,f){var h="[object Object]"===Object.prototype.toString.call(a[f]),k=h?b(a[f]):a[f];h=h&&!Object.keys(k).length;
return void 0===k||h?d:Object.assign(d,e({},f,k))},{})}function h(a,b,d){b&&!d.has(b.id)&&(d.set(b.id,b),Object.keys(b).forEach(function(e){e.endsWith("Id")?h(a,a.get(b[e]),d):e.endsWith("Ids")&&b[e].forEach(function(b){h(a,a.get(b),d)})}))}Object.defineProperty(k,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};k.extractVersion=a;k.wrapPeerConnectionEvent=function(a,b,d){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var e=a.addEventListener;a.addEventListener=function(a,f){if(a!==b)return e.apply(this,arguments);var h=function(a){(a=d(a))&&f(a)};this._eventMap=this._eventMap||{};this._eventMap[f]=h;return e.apply(this,[a,h])};var f=a.removeEventListener;a.removeEventListener=
function(a,d){if(a!==b||!this._eventMap||!this._eventMap[d])return f.apply(this,arguments);var e=this._eventMap[d];delete this._eventMap[d];return f.apply(this,[a,e])};Object.defineProperty(a,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]);a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}};k.disableLog=function(a){return"boolean"!==typeof a?Error("Argument type: "+("undefined"===
typeof a?"undefined":p(a))+". Please use a boolean."):(d=a)?"adapter.js logging disabled":"adapter.js logging enabled"};k.disableWarnings=function(a){if("boolean"!==typeof a)return Error("Argument type: "+("undefined"===typeof a?"undefined":p(a))+". Please use a boolean.");q=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")};k.log=function(){"object"!==("undefined"===typeof window?"undefined":p(window))||d||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,
arguments)};k.deprecated=function(a,b){q&&console.warn(a+" is deprecated, please use "+b+" instead.")};k.detectBrowser=function(b){var d=b.navigator,e={browser:null,version:null};if("undefined"===typeof b||!b.navigator)return e.browser="Not a browser.",e;d.mozGetUserMedia?(e.browser="firefox",e.version=a(d.userAgent,/Firefox\/(\d+)\./,1)):d.webkitGetUserMedia||!1===b.isSecureContext&&b.webkitRTCPeerConnection&&!b.RTCIceGatherer?(e.browser="chrome",e.version=a(d.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):
d.mediaDevices&&d.userAgent.match(/Edge\/(\d+).(\d+)$/)?(e.browser="edge",e.version=a(d.userAgent,/Edge\/(\d+).(\d+)$/,2)):b.RTCPeerConnection&&d.userAgent.match(/AppleWebKit\/(\d+)\./)?(e.browser="safari",e.version=a(d.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=b.RTCRtpTransceiver&&"currentDirection"in b.RTCRtpTransceiver.prototype):e.browser="Not a supported browser.";return e};k.compactObject=b;k.walkStats=h;k.filterStats=function(a,b,d){var e=d?"outbound-rtp":"inbound-rtp",f=new Map;
if(null===b)return f;var k=[];a.forEach(function(a){"track"===a.type&&a.trackIdentifier===b.id&&k.push(a)});k.forEach(function(b){a.forEach(function(d){d.type===e&&d.trackId===b.id&&h(a,d,f)})});return f};var d=!0,q=!0},{}],16:[function(f,l,k){function e(a,b,d,e,f){b=q.writeRtpDescription(a.kind,b);b+=q.writeIceParameters(a.iceGatherer.getLocalParameters());b+=q.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===d?"actpass":f||"active");b+="a=mid:"+a.mid+"\r\n";b=a.rtpSender&&a.rtpReceiver?
b+"a=sendrecv\r\n":a.rtpSender?b+"a=sendonly\r\n":a.rtpReceiver?b+"a=recvonly\r\n":b+"a=inactive\r\n";a.rtpSender&&(d=a.rtpSender._initialTrackId||a.rtpSender.track.id,a.rtpSender._initialTrackId=d,e="msid:"+(e?e.id:"-")+" "+d+"\r\n",b=b+("a="+e)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+e),a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+e,b+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a=ssrc:"+
a.sendEncodingParameters[0].ssrc+" cname:"+q.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+q.localCName+"\r\n");return b}function a(a,b){var d=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var e=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var f="string"===typeof e;f&&(e=[e]);e=e.filter(function(a){return 0!==a.indexOf("turn:")||
-1===a.indexOf("transport=udp")||-1!==a.indexOf("turn:[")||d?0===a.indexOf("stun:")&&14393<=b&&-1===a.indexOf("?transport=udp"):d=!0});delete a.url;a.urls=f?e[0]:e;return!!e.length}})}function b(a,b){var d={codecs:[],headerExtensions:[],fecMechanisms:[]},e=function(a,b){a=parseInt(a,10);for(var d=0;d<b.length;d++)if(b[d].payloadType===a||b[d].preferredPayloadType===a)return b[d]},f=function(a,b,d,f){a=e(a.parameters.apt,d);b=e(b.parameters.apt,f);return a&&b&&a.name.toLowerCase()===b.name.toLowerCase()};
a.codecs.forEach(function(e){for(var h=0;h<b.codecs.length;h++){var k=b.codecs[h];if(e.name.toLowerCase()===k.name.toLowerCase()&&e.clockRate===k.clockRate&&("rtx"!==e.name.toLowerCase()||!e.parameters||!k.parameters.apt||f(e,k,a.codecs,b.codecs))){k=JSON.parse(JSON.stringify(k));k.numChannels=Math.min(e.numChannels,k.numChannels);d.codecs.push(k);k.rtcpFeedback=k.rtcpFeedback.filter(function(a){for(var b=0;b<e.rtcpFeedback.length;b++)if(e.rtcpFeedback[b].type===a.type&&e.rtcpFeedback[b].parameter===
a.parameter)return!0;return!1});break}}});a.headerExtensions.forEach(function(a){for(var e=0;e<b.headerExtensions.length;e++){var f=b.headerExtensions[e];if(a.uri===f.uri){d.headerExtensions.push(f);break}}});return d}function h(a,b,d){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(d)}
function p(a,b){var d=a.getRemoteCandidates().find(function(a){return b.foundation===a.foundation&&b.ip===a.ip&&b.port===a.port&&b.priority===a.priority&&b.protocol===a.protocol&&b.type===a.type});d||a.addRemoteCandidate(b);return!d}function d(a,b){b=Error(b);b.name=a;b.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a];return b}var q=f("sdp");l.exports=function(f,k){function l(a,b){b.addTrack(a);b.dispatchEvent(new f.MediaStreamTrackEvent("addtrack",
{track:a}))}function n(a,b){b.removeTrack(a);b.dispatchEvent(new f.MediaStreamTrackEvent("removetrack",{track:a}))}function r(a,b,c,d){var e=new Event("track");e.track=b;e.receiver=c;e.transceiver={receiver:c};e.streams=d;f.setTimeout(function(){a._dispatchEvent("track",e)})}var u=function(b){var e=this,c=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){e[a]=c[a].bind(c)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=
[];this.remoteStreams=[];this._remoteDescription=this._localDescription=null;this.signalingState="stable";this.iceGatheringState=this.connectionState=this.iceConnectionState="new";b=JSON.parse(JSON.stringify(b||{}));this.usingBundle="max-bundle"===b.bundlePolicy;if("negotiate"===b.rtcpMuxPolicy)throw d("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");b.rtcpMuxPolicy||(b.rtcpMuxPolicy="require");switch(b.iceTransportPolicy){case "all":case "relay":break;default:b.iceTransportPolicy=
"all"}switch(b.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:b.bundlePolicy="balanced"}b.iceServers=a(b.iceServers||[],k);this._iceGatherers=[];if(b.iceCandidatePoolSize)for(var h=b.iceCandidatePoolSize;0<h;h--)this._iceGatherers.push(new f.RTCIceGatherer({iceServers:b.iceServers,gatherPolicy:b.iceTransportPolicy}));else b.iceCandidatePoolSize=0;this._config=b;this.transceivers=[];this._sdpSessionId=q.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;
this._isClosed=!1};Object.defineProperty(u.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(u.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});u.prototype.onicecandidate=null;u.prototype.onaddstream=null;u.prototype.ontrack=null;u.prototype.onremovestream=null;u.prototype.onsignalingstatechange=null;u.prototype.oniceconnectionstatechange=null;u.prototype.onconnectionstatechange=null;u.prototype.onicegatheringstatechange=
null;u.prototype.onnegotiationneeded=null;u.prototype.ondatachannel=null;u.prototype._dispatchEvent=function(a,b){if(!this._isClosed&&(this.dispatchEvent(b),"function"===typeof this["on"+a]))this["on"+a](b)};u.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",a)};u.prototype.getConfiguration=function(){return this._config};u.prototype.getLocalStreams=function(){return this.localStreams};u.prototype.getRemoteStreams=
function(){return this.remoteStreams};u.prototype._createTransceiver=function(a,b){var c=0<this.transceivers.length;a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&c?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):
(c=this._createIceAndDtlsTransports(),a.iceTransport=c.iceTransport,a.dtlsTransport=c.dtlsTransport);b||this.transceivers.push(a);return a};u.prototype.addTrack=function(a,b){if(this._isClosed)throw d("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(b){return b.track===a}))throw d("InvalidAccessError","Track already exists.");for(var c,e=0;e<this.transceivers.length;e++)this.transceivers[e].track||this.transceivers[e].kind!==a.kind||
(c=this.transceivers[e]);c||(c=this._createTransceiver(a.kind));this._maybeFireNegotiationNeeded();-1===this.localStreams.indexOf(b)&&this.localStreams.push(b);c.track=a;c.stream=b;c.rtpSender=new f.RTCRtpSender(a,c.dtlsTransport);return c.rtpSender};u.prototype.addStream=function(a){var b=this;if(15025<=k)a.getTracks().forEach(function(c){b.addTrack(c,a)});else{var c=a.clone();a.getTracks().forEach(function(a,b){var d=c.getTracks()[b];a.addEventListener("enabled",function(a){d.enabled=a.enabled})});
c.getTracks().forEach(function(a){b.addTrack(a,c)})}};u.prototype.removeTrack=function(a){if(this._isClosed)throw d("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof f.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var b=this.transceivers.find(function(b){return b.rtpSender===a});if(!b)throw d("InvalidAccessError","Sender was not created by this connection.");var c=b.stream;
b.rtpSender.stop();b.rtpSender=null;b.track=null;b.stream=null;-1===this.transceivers.map(function(a){return a.stream}).indexOf(c)&&-1<this.localStreams.indexOf(c)&&this.localStreams.splice(this.localStreams.indexOf(c),1);this._maybeFireNegotiationNeeded()};u.prototype.removeStream=function(a){var b=this;a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});c&&b.removeTrack(c)})};u.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};
u.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};u.prototype._createIceGatherer=function(a,b){var c=this;if(b&&0<a)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var d=new f.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(d,"state",{value:"new",writable:!0});this.transceivers[a].bufferedCandidateEvents=
[];this.transceivers[a].bufferCandidates=function(b){var e=!b.candidate||0===Object.keys(b.candidate).length;d.state=e?"completed":"gathering";null!==c.transceivers[a].bufferedCandidateEvents&&c.transceivers[a].bufferedCandidateEvents.push(b)};d.addEventListener("localcandidate",this.transceivers[a].bufferCandidates);return d};u.prototype._gather=function(a,b){var c=this,d=this.transceivers[b].iceGatherer;if(!d.onlocalcandidate){var e=this.transceivers[b].bufferedCandidateEvents;this.transceivers[b].bufferedCandidateEvents=
null;d.removeEventListener("localcandidate",this.transceivers[b].bufferCandidates);d.onlocalcandidate=function(e){if(!(c.usingBundle&&0<b)){var f=new Event("icecandidate");f.candidate={sdpMid:a,sdpMLineIndex:b};var h=e.candidate;if(e=!h||0===Object.keys(h).length){if("new"===d.state||"gathering"===d.state)d.state="completed"}else"new"===d.state&&(d.state="gathering"),h.component=1,h.ufrag=d.getLocalParameters().usernameFragment,h=q.writeCandidate(h),f.candidate=Object.assign(f.candidate,q.parseCandidate(h)),
f.candidate.candidate=h,f.candidate.toJSON=function(){return{candidate:f.candidate.candidate,sdpMid:f.candidate.sdpMid,sdpMLineIndex:f.candidate.sdpMLineIndex,usernameFragment:f.candidate.usernameFragment}};h=q.getMediaSections(c._localDescription.sdp);h[f.candidate.sdpMLineIndex]=e?h[f.candidate.sdpMLineIndex]+"a=end-of-candidates\r\n":h[f.candidate.sdpMLineIndex]+("a="+f.candidate.candidate+"\r\n");c._localDescription.sdp=q.getDescription(c._localDescription.sdp)+h.join("");h=c.transceivers.every(function(a){return a.iceGatherer&&
"completed"===a.iceGatherer.state});"gathering"!==c.iceGatheringState&&(c.iceGatheringState="gathering",c._emitGatheringStateChange());e||c._dispatchEvent("icecandidate",f);h&&(c._dispatchEvent("icecandidate",new Event("icecandidate")),c.iceGatheringState="complete",c._emitGatheringStateChange())}};f.setTimeout(function(){e.forEach(function(a){d.onlocalcandidate(a)})},0)}};u.prototype._createIceAndDtlsTransports=function(){var a=this,b=new f.RTCIceTransport(null);b.onicestatechange=function(){a._updateIceConnectionState();
a._updateConnectionState()};var c=new f.RTCDtlsTransport(b);c.ondtlsstatechange=function(){a._updateConnectionState()};c.onerror=function(){Object.defineProperty(c,"state",{value:"failed",writable:!0});a._updateConnectionState()};return{iceTransport:b,dtlsTransport:c}};u.prototype._disposeIceAndDtlsTransports=function(a){var b=this.transceivers[a].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);if(b=this.transceivers[a].iceTransport)delete b.onicestatechange,delete this.transceivers[a].iceTransport;
if(b=this.transceivers[a].dtlsTransport)delete b.ondtlsstatechange,delete b.onerror,delete this.transceivers[a].dtlsTransport};u.prototype._transceive=function(a,d,c){var e=b(a.localCapabilities,a.remoteCapabilities);d&&a.rtpSender&&(e.encodings=a.sendEncodingParameters,e.rtcp={cname:q.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(e.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(e));c&&a.rtpReceiver&&0<e.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&
15019>k&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),e.encodings=a.recvEncodingParameters.length?a.recvEncodingParameters:[{}],e.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(e.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&(e.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(e))};u.prototype.setLocalDescription=function(a){var e=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(d("TypeError",'Unsupported type "'+
a.type+'"'));if(!h("setLocalDescription",a.type,e.signalingState)||e._isClosed)return Promise.reject(d("InvalidStateError","Can not set local "+a.type+" in state "+e.signalingState));if("offer"===a.type){var c=q.splitSections(a.sdp);var f=c.shift();c.forEach(function(a,b){a=q.parseRtpParameters(a);e.transceivers[b].localCapabilities=a});e.transceivers.forEach(function(a,b){e._gather(a.mid,b)})}else if("answer"===a.type){c=q.splitSections(e._remoteDescription.sdp);f=c.shift();var k=0<q.matchPrefix(f,
"a=ice-lite").length;c.forEach(function(a,c){var d=e.transceivers[c],h=d.iceGatherer,l=d.iceTransport,g=d.dtlsTransport,n=d.localCapabilities,p=d.remoteCapabilities;if(!(q.isRejected(a)&&0===q.matchPrefix(a,"a=bundle-only").length||d.rejected)){var u=q.getIceParameters(a,f);a=q.getDtlsParameters(a,f);k&&(a.role="server");e.usingBundle&&0!==c||(e._gather(d.mid,c),"new"===l.state&&l.start(h,u,k?"controlling":"controlled"),"new"===g.state&&g.start(a));c=b(n,p);e._transceive(d,0<c.codecs.length,!1)}})}e._localDescription=
{type:a.type,sdp:a.sdp};"offer"===a.type?e._updateSignalingState("have-local-offer"):e._updateSignalingState("stable");return Promise.resolve()};u.prototype.setRemoteDescription=function(a){var e=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(d("TypeError",'Unsupported type "'+a.type+'"'));if(!h("setRemoteDescription",a.type,e.signalingState)||e._isClosed)return Promise.reject(d("InvalidStateError","Can not set remote "+a.type+" in state "+e.signalingState));var c={};e.remoteStreams.forEach(function(a){c[a.id]=
a});var u=[],t=q.splitSections(a.sdp),v=t.shift(),w=0<q.matchPrefix(v,"a=ice-lite").length,x=0<q.matchPrefix(v,"a=group:BUNDLE ").length;e.usingBundle=x;var A=q.matchPrefix(v,"a=ice-options:")[0];e.canTrickleIceCandidates=A?0<=A.substr(14).split(" ").indexOf("trickle"):!1;t.forEach(function(d,g){var h=q.splitLines(d),t=q.getKind(d),r=q.isRejected(d)&&0===q.matchPrefix(d,"a=bundle-only").length,A=h[0].substr(2).split(" ")[2];h=q.getDirection(d,v);var z=q.parseMsid(d),F=q.getMid(d)||q.generateIdentifier();
if(r||"application"===t&&("DTLS/SCTP"===A||"UDP/DTLS/SCTP"===A))e.transceivers[g]={mid:F,kind:t,protocol:A,rejected:!0};else{!r&&e.transceivers[g]&&e.transceivers[g].rejected&&(e.transceivers[g]=e._createTransceiver(t,!0));var B=q.parseRtpParameters(d);if(!r){var J=q.getIceParameters(d,v);var y=q.getDtlsParameters(d,v);y.role="client"}A=q.parseRtpEncodingParameters(d);var M=q.parseRtcpParameters(d),D=0<q.matchPrefix(d,"a=end-of-candidates",v).length,Q=q.matchPrefix(d,"a=candidate:").map(function(a){return q.parseCandidate(a)}).filter(function(a){return 1===
a.component});("offer"===a.type||"answer"===a.type)&&!r&&x&&0<g&&e.transceivers[g]&&(e._disposeIceAndDtlsTransports(g),e.transceivers[g].iceGatherer=e.transceivers[0].iceGatherer,e.transceivers[g].iceTransport=e.transceivers[0].iceTransport,e.transceivers[g].dtlsTransport=e.transceivers[0].dtlsTransport,e.transceivers[g].rtpSender&&e.transceivers[g].rtpSender.setTransport(e.transceivers[0].dtlsTransport),e.transceivers[g].rtpReceiver&&e.transceivers[g].rtpReceiver.setTransport(e.transceivers[0].dtlsTransport));
if("offer"!==a.type||r)"answer"!==a.type||r||(E=e.transceivers[g],G=E.iceGatherer,t=E.iceTransport,F=E.dtlsTransport,I=E.rtpReceiver,r=E.sendEncodingParameters,d=E.localCapabilities,e.transceivers[g].recvEncodingParameters=A,e.transceivers[g].remoteCapabilities=B,e.transceivers[g].rtcpParameters=M,Q.length&&"new"===t.state&&(!w&&!D||x&&0!==g?Q.forEach(function(a){p(E.iceTransport,a)}):t.setRemoteCandidates(Q)),x&&0!==g||("new"===t.state&&t.start(G,J,"controlling"),"new"===F.state&&F.start(y)),!b(E.localCapabilities,
E.remoteCapabilities).codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&E.sendEncodingParameters[0].rtx&&delete E.sendEncodingParameters[0].rtx,e._transceive(E,"sendrecv"===h||"recvonly"===h,"sendrecv"===h||"sendonly"===h),!I||"sendrecv"!==h&&"sendonly"!==h?delete E.rtpReceiver:(h=I.track,z?(c[z.stream]||(c[z.stream]=new f.MediaStream),l(h,c[z.stream]),u.push([h,I,c[z.stream]])):(c.default||(c.default=new f.MediaStream),l(h,c.default),u.push([h,I,c.default]))));else{var E=e.transceivers[g]||
e._createTransceiver(t);E.mid=F;E.iceGatherer||(E.iceGatherer=e._createIceGatherer(g,x));Q.length&&"new"===E.iceTransport.state&&(!D||x&&0!==g?Q.forEach(function(a){p(E.iceTransport,a)}):E.iceTransport.setRemoteCandidates(Q));d=f.RTCRtpReceiver.getCapabilities(t);15019>k&&(d.codecs=d.codecs.filter(function(a){return"rtx"!==a.name}));r=E.sendEncodingParameters||[{ssrc:1001*(2*g+2)}];J=!1;if("sendrecv"===h||"sendonly"===h){J=!E.rtpReceiver;var I=E.rtpReceiver||new f.RTCRtpReceiver(E.dtlsTransport,t);
if(J){h=I.track;if(!z||"-"!==z.stream)if(z){c[z.stream]||(c[z.stream]=new f.MediaStream,Object.defineProperty(c[z.stream],"id",{get:function(){return z.stream}}));Object.defineProperty(h,"id",{get:function(){return z.track}});var G=c[z.stream]}else c.default||(c.default=new f.MediaStream),G=c.default;G&&(l(h,G),E.associatedRemoteMediaStreams.push(G));u.push([h,I,G])}}else E.rtpReceiver&&E.rtpReceiver.track&&(E.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===
E.rtpReceiver.track.id});b&&n(b,a)}),E.associatedRemoteMediaStreams=[]);E.localCapabilities=d;E.remoteCapabilities=B;E.rtpReceiver=I;E.rtcpParameters=M;E.sendEncodingParameters=r;E.recvEncodingParameters=A;e._transceive(e.transceivers[g],!1,J)}}});void 0===e._dtlsRole&&(e._dtlsRole="offer"===a.type?"active":"passive");e._remoteDescription={type:a.type,sdp:a.sdp};"offer"===a.type?e._updateSignalingState("have-remote-offer"):e._updateSignalingState("stable");Object.keys(c).forEach(function(a){var b=
c[a];if(b.getTracks().length){if(-1===e.remoteStreams.indexOf(b)){e.remoteStreams.push(b);var d=new Event("addstream");d.stream=b;f.setTimeout(function(){e._dispatchEvent("addstream",d)})}u.forEach(function(a){b.id===a[2].id&&r(e,a[0],a[1],[b])})}});u.forEach(function(a){a[2]||r(e,a[0],a[1],[])});f.setTimeout(function(){e&&e.transceivers&&e.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),
a.iceTransport.addRemoteCandidate({}))})},4E3);return Promise.resolve()};u.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};u.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)};u.prototype._maybeFireNegotiationNeeded=
function(){var a=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,f.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=!1;var b=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",b)}},0))};u.prototype._updateIceConnectionState=function(){var a={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&!b.rejected&&a[b.iceTransport.state]++});var b="new";0<a.failed?
b="failed":0<a.checking?b="checking":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected?b="connected":0<a.completed&&(b="completed");b!==this.iceConnectionState&&(this.iceConnectionState=b,b=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",b))};u.prototype._updateConnectionState=function(){var a={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&b.dtlsTransport&&!b.rejected&&
(a[b.iceTransport.state]++,a[b.dtlsTransport.state]++)});a.connected+=a.completed;var b="new";0<a.failed?b="failed":0<a.connecting?b="connecting":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected&&(b="connected");b!==this.connectionState&&(this.connectionState=b,b=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",b))};u.prototype.createOffer=function(a){var b=this;if(b._isClosed)return Promise.reject(d("InvalidStateError","Can not call createOffer after close"));
var c=b.transceivers.filter(function(a){return"audio"===a.kind}).length,h=b.transceivers.filter(function(a){return"video"===a.kind}).length;if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(c=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio);void 0!==a.offerToReceiveVideo&&(h=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(b.transceivers.forEach(function(a){"audio"===
a.kind?(c--,0>c&&(a.wantReceive=!1)):"video"===a.kind&&(h--,0>h&&(a.wantReceive=!1))});0<c||0<h;)0<c&&(b._createTransceiver("audio"),c--),0<h&&(b._createTransceiver("video"),h--);var l=q.writeSessionBoilerplate(b._sdpSessionId,b._sdpSessionVersion++);b.transceivers.forEach(function(a,c){var d=a.track,e=a.kind,h=a.mid||q.generateIdentifier();a.mid=h;a.iceGatherer||(a.iceGatherer=b._createIceGatherer(c,b.usingBundle));h=f.RTCRtpSender.getCapabilities(e);15019>k&&(h.codecs=h.codecs.filter(function(a){return"rtx"!==
a.name}));h.codecs.forEach(function(b){"H264"===b.name&&void 0===b.parameters["level-asymmetry-allowed"]&&(b.parameters["level-asymmetry-allowed"]="1");a.remoteCapabilities&&a.remoteCapabilities.codecs&&a.remoteCapabilities.codecs.forEach(function(a){b.name.toLowerCase()===a.name.toLowerCase()&&b.clockRate===a.clockRate&&(b.preferredPayloadType=a.payloadType)})});h.headerExtensions.forEach(function(b){(a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[]).forEach(function(a){b.uri===a.uri&&
(b.id=a.id)})});c=a.sendEncodingParameters||[{ssrc:1001*(2*c+1)}];d&&15019<=k&&"video"===e&&!c[0].rtx&&(c[0].rtx={ssrc:c[0].ssrc+1});a.wantReceive&&(a.rtpReceiver=new f.RTCRtpReceiver(a.dtlsTransport,e));a.localCapabilities=h;a.sendEncodingParameters=c});"max-compat"!==b._config.bundlePolicy&&(l+="a=group:BUNDLE "+b.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");l+="a=ice-options:trickle\r\n";b.transceivers.forEach(function(a,c){l+=e(a,a.localCapabilities,"offer",a.stream,b._dtlsRole);
l+="a=rtcp-rsize\r\n";!a.iceGatherer||"new"===b.iceGatheringState||0!==c&&b.usingBundle||(a.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;l+="a="+q.writeCandidate(a)+"\r\n"}),"completed"===a.iceGatherer.state&&(l+="a=end-of-candidates\r\n"))});a=new f.RTCSessionDescription({type:"offer",sdp:l});return Promise.resolve(a)};u.prototype.createAnswer=function(){var a=this;if(a._isClosed)return Promise.reject(d("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==
a.signalingState&&"have-local-pranswer"!==a.signalingState)return Promise.reject(d("InvalidStateError","Can not call createAnswer in signalingState "+a.signalingState));var h=q.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.usingBundle&&(h+="a=group:BUNDLE "+a.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");h+="a=ice-options:trickle\r\n";var c=q.getMediaSections(a._remoteDescription.sdp).length;a.transceivers.forEach(function(d,f){if(!(f+1>c))if(d.rejected)"application"===
d.kind?h="DTLS/SCTP"===d.protocol?h+"m=application 0 DTLS/SCTP 5000\r\n":h+("m=application 0 "+d.protocol+" webrtc-datachannel\r\n"):"audio"===d.kind?h+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===d.kind&&(h+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),h+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+d.mid+"\r\n";else{if(d.stream){var l;"audio"===d.kind?l=d.stream.getAudioTracks()[0]:"video"===d.kind&&(l=d.stream.getVideoTracks()[0]);l&&15019<=k&&"video"===
d.kind&&!d.sendEncodingParameters[0].rtx&&(d.sendEncodingParameters[0].rtx={ssrc:d.sendEncodingParameters[0].ssrc+1})}f=b(d.localCapabilities,d.remoteCapabilities);!f.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&d.sendEncodingParameters[0].rtx&&delete d.sendEncodingParameters[0].rtx;h+=e(d,f,"answer",d.stream,a._dtlsRole);d.rtcpParameters&&d.rtcpParameters.reducedSize&&(h+="a=rtcp-rsize\r\n")}});var l=new f.RTCSessionDescription({type:"answer",sdp:h});return Promise.resolve(l)};
u.prototype.addIceCandidate=function(a){var b=this,c;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(e,f){if(b._remoteDescription)if(a&&""!==a.candidate){var h=a.sdpMLineIndex;if(a.sdpMid)for(var k=0;k<b.transceivers.length;k++)if(b.transceivers[k].mid===a.sdpMid){h=k;break}var l=b.transceivers[h];if(l){if(l.rejected)return e();k=0<Object.keys(a.candidate).length?q.parseCandidate(a.candidate):{};if("tcp"===k.protocol&&
(0===k.port||9===k.port)||k.component&&1!==k.component)return e();if((0===h||0<h&&l.iceTransport!==b.transceivers[0].iceTransport)&&!p(l.iceTransport,k))return f(d("OperationError","Can not add ICE candidate"));f=a.candidate.trim();0===f.indexOf("a=")&&(f=f.substr(2));c=q.getMediaSections(b._remoteDescription.sdp);c[h]+="a="+(k.type?f:"end-of-candidates")+"\r\n";b._remoteDescription.sdp=q.getDescription(b._remoteDescription.sdp)+c.join("")}else return f(d("OperationError","Can not add ICE candidate"))}else for(h=
0;h<b.transceivers.length&&(b.transceivers[h].rejected||(b.transceivers[h].iceTransport.addRemoteCandidate({}),c=q.getMediaSections(b._remoteDescription.sdp),c[h]+="a=end-of-candidates\r\n",b._remoteDescription.sdp=q.getDescription(b._remoteDescription.sdp)+c.join(""),!b.usingBundle));h++);else return f(d("InvalidStateError","Can not add ICE candidate without a remote description"));e()})};u.prototype.getStats=function(a){if(a&&a instanceof f.MediaStreamTrack){var b=null;this.transceivers.forEach(function(c){c.rtpSender&&
c.rtpSender.track===a?b=c.rtpSender:c.rtpReceiver&&c.rtpReceiver.track===a&&(b=c.rtpReceiver)});if(!b)throw d("InvalidAccessError","Invalid selector.");return b.getStats()}var c=[];this.transceivers.forEach(function(a){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){a[b]&&c.push(a[b].getStats())})});return Promise.all(c).then(function(a){var b=new Map;a.forEach(function(a){a.forEach(function(a){b.set(a.id,a)})});return b})};["RTCRtpSender","RTCRtpReceiver",
"RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(a){if((a=f[a])&&a.prototype&&a.prototype.getStats){var b=a.prototype.getStats;a.prototype.getStats=function(){return b.apply(this).then(function(a){var b=new Map;Object.keys(a).forEach(function(c){var d=a[c];a[c].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type;b.set(c,a[c])});return b})}}});var x=["createOffer",
"createAnswer"];x.forEach(function(a){var b=u.prototype[a];u.prototype[a]=function(){var a=arguments;return"function"===typeof a[0]||"function"===typeof a[1]?b.apply(this,[arguments[2]]).then(function(b){"function"===typeof a[0]&&a[0].apply(null,[b])},function(b){"function"===typeof a[1]&&a[1].apply(null,[b])}):b.apply(this,arguments)}});x=["setLocalDescription","setRemoteDescription","addIceCandidate"];x.forEach(function(a){var b=u.prototype[a];u.prototype[a]=function(){var a=arguments;return"function"===
typeof a[1]||"function"===typeof a[2]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)},function(b){"function"===typeof a[2]&&a[2].apply(null,[b])}):b.apply(this,arguments)}});["getStats"].forEach(function(a){var b=u.prototype[a];u.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)}):b.apply(this,arguments)}});return u}},{sdp:17}],17:[function(f,l,k){var e={generateIdentifier:function(){return Math.random().toString(36).substr(2,
10)}};e.localCName=e.generateIdentifier();e.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};e.splitSections=function(a){return a.split("\nm=").map(function(a,e){return(0<e?"m="+a:a).trim()+"\r\n"})};e.getDescription=function(a){return(a=e.splitSections(a))&&a[0]};e.getMediaSections=function(a){a=e.splitSections(a);a.shift();return a};e.matchPrefix=function(a,b){return e.splitLines(a).filter(function(a){return 0===a.indexOf(b)})};e.parseCandidate=function(a){a=
0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var b={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]},e=8;e<a.length;e+=2)switch(a[e]){case "raddr":b.relatedAddress=a[e+1];break;case "rport":b.relatedPort=parseInt(a[e+1],10);break;case "tcptype":b.tcpType=a[e+1];break;case "ufrag":b.ufrag=a[e+1];b.usernameFragment=a[e+1];break;default:b[a[e]]=a[e+1]}return b};
e.writeCandidate=function(a){var b=[];b.push(a.foundation);b.push(a.component);b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.address||a.ip);b.push(a.port);var e=a.type;b.push("typ");b.push(e);"host"!==e&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType));if(a.usernameFragment||a.ufrag)b.push("ufrag"),b.push(a.usernameFragment||a.ufrag);return"candidate:"+
b.join(" ")};e.parseIceOptions=function(a){return a.substr(14).split(" ")};e.parseRtpMap=function(a){a=a.substr(9).split(" ");var b={payloadType:parseInt(a.shift(),10)};a=a[0].split("/");b.name=a[0];b.clockRate=parseInt(a[1],10);b.channels=3===a.length?parseInt(a[2],10):1;b.numChannels=b.channels;return b};e.writeRtpMap=function(a){var b=a.payloadType;void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType);var e=a.channels||a.numChannels||1;return"a=rtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==
e?"/"+e:"")+"\r\n"};e.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};e.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};e.parseFmtp=function(a){for(var b={},e=a.substr(a.indexOf(" ")+1).split(";"),f=0;f<e.length;f++)a=e[f].trim().split("="),b[a[0].trim()]=a[1];return b};e.writeFmtp=function(a){var b="",e=a.payloadType;
void 0!==a.preferredPayloadType&&(e=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var f=[];Object.keys(a.parameters).forEach(function(b){a.parameters[b]?f.push(b+"="+a.parameters[b]):f.push(b)});b+="a=fmtp:"+e+" "+f.join(";")+"\r\n"}return b};e.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};e.writeRtcpFb=function(a){var b="",e=a.payloadType;void 0!==a.preferredPayloadType&&(e=a.preferredPayloadType);a.rtcpFeedback&&
a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a=rtcp-fb:"+e+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return b};e.parseSsrcMedia=function(a){var b=a.indexOf(" "),e={ssrc:parseInt(a.substr(7,b-7),10)},f=a.indexOf(":",b);-1<f?(e.attribute=a.substr(b+1,f-b-1),e.value=a.substr(f+1)):e.attribute=a.substr(b+1);return e};e.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};e.getMid=
function(a){if(a=e.matchPrefix(a,"a=mid:")[0])return a.substr(6)};e.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};e.getDtlsParameters=function(a,b){return{role:"auto",fingerprints:e.matchPrefix(a+b,"a=fingerprint:").map(e.parseFingerprint)}};e.writeDtlsParameters=function(a,b){var e="a=setup:"+b+"\r\n";a.fingerprints.forEach(function(a){e+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"});return e};e.getIceParameters=function(a,b){a=e.splitLines(a);
a=a.concat(e.splitLines(b));return{usernameFragment:a.filter(function(a){return 0===a.indexOf("a=ice-ufrag:")})[0].substr(12),password:a.filter(function(a){return 0===a.indexOf("a=ice-pwd:")})[0].substr(10)}};e.writeIceParameters=function(a){return"a=ice-ufrag:"+a.usernameFragment+"\r\na=ice-pwd:"+(a.password+"\r\n")};e.parseRtpParameters=function(a){for(var b={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},f=e.splitLines(a)[0].split(" "),k=3;k<f.length;k++){var d=f[k],l=e.matchPrefix(a,
"a=rtpmap:"+d+" ")[0];if(l){l=e.parseRtpMap(l);var n=e.matchPrefix(a,"a=fmtp:"+d+" ");l.parameters=n.length?e.parseFmtp(n[0]):{};l.rtcpFeedback=e.matchPrefix(a,"a=rtcp-fb:"+d+" ").map(e.parseRtcpFb);b.codecs.push(l);switch(l.name.toUpperCase()){case "RED":case "ULPFEC":b.fecMechanisms.push(l.name.toUpperCase())}}}e.matchPrefix(a,"a=extmap:").forEach(function(a){b.headerExtensions.push(e.parseExtmap(a))});return b};e.writeRtpDescription=function(a,b){var f="";f+="m="+a+" ";f+=0<b.codecs.length?"9":
"0";f+=" UDP/TLS/RTP/SAVPF ";f+=b.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n";f+="c=IN IP4 0.0.0.0\r\n";f+="a=rtcp:9 IN IP4 0.0.0.0\r\n";b.codecs.forEach(function(a){f+=e.writeRtpMap(a);f+=e.writeFmtp(a);f+=e.writeRtcpFb(a)});var k=0;b.codecs.forEach(function(a){a.maxptime>k&&(k=a.maxptime)});0<k&&(f+="a=maxptime:"+k+"\r\n");f+="a=rtcp-mux\r\n";b.headerExtensions&&b.headerExtensions.forEach(function(a){f+=e.writeExtmap(a)});
return f};e.parseRtpEncodingParameters=function(a){var b=[],f=e.parseRtpParameters(a),k=-1!==f.fecMechanisms.indexOf("RED"),d=-1!==f.fecMechanisms.indexOf("ULPFEC"),l=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute}),n=0<l.length&&l[0].ssrc,p;l=e.matchPrefix(a,"a=ssrc-group:FID").map(function(a){return a.substr(17).split(" ").map(function(a){return parseInt(a,10)})});0<l.length&&1<l[0].length&&l[0][0]===n&&(p=l[0][1]);f.codecs.forEach(function(a){"RTX"===
a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:n,codecPayloadType:parseInt(a.parameters.apt,10)},n&&p&&(a.rtx={ssrc:p}),b.push(a),k&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:n,mechanism:d?"red+ulpfec":"red"},b.push(a)))});0===b.length&&n&&b.push({ssrc:n});var q=e.matchPrefix(a,"b=");q.length&&(q=0===q[0].indexOf("b=TIAS:")?parseInt(q[0].substr(7),10):0===q[0].indexOf("b=AS:")?950*parseInt(q[0].substr(5),10)-16E3:void 0,b.forEach(function(a){a.maxBitrate=q}));return b};e.parseRtcpParameters=
function(a){var b={},f=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];f&&(b.cname=f.value,b.ssrc=f.ssrc);f=e.matchPrefix(a,"a=rtcp-rsize");b.reducedSize=0<f.length;b.compound=0===f.length;a=e.matchPrefix(a,"a=rtcp-mux");b.mux=0<a.length;return b};e.parseMsid=function(a){var b=e.matchPrefix(a,"a=msid:");if(1===b.length)return a=b[0].substr(7).split(" "),{stream:a[0],track:a[1]};a=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"msid"===
a.attribute});if(0<a.length)return a=a[0].value.split(" "),{stream:a[0],track:a[1]}};e.generateSessionId=function(){return Math.random().toString().substr(2,21)};e.writeSessionBoilerplate=function(a,b,f){b=void 0!==b?b:2;a=a?a:e.generateSessionId();return"v=0\r\no="+(f||"thisisadapterortc")+" "+a+" "+b+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};e.writeMediaSection=function(a,b,f,k){b=e.writeRtpDescription(a.kind,b);b+=e.writeIceParameters(a.iceGatherer.getLocalParameters());b+=e.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),
"offer"===f?"actpass":"active");b+="a=mid:"+a.mid+"\r\n";b=a.direction?b+("a="+a.direction+"\r\n"):a.rtpSender&&a.rtpReceiver?b+"a=sendrecv\r\n":a.rtpSender?b+"a=sendonly\r\n":a.rtpReceiver?b+"a=recvonly\r\n":b+"a=inactive\r\n";a.rtpSender&&(f="msid:"+k.id+" "+a.rtpSender.track.id+"\r\n",b=b+("a="+f)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+f),a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+f,b+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+
a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+e.localCName+"\r\n");return b};e.getDirection=function(a,b){a=e.splitLines(a);for(var f=0;f<a.length;f++)switch(a[f]){case "a=sendrecv":case "a=sendonly":case "a=recvonly":case "a=inactive":return a[f].substr(2)}return b?e.getDirection(b):"sendrecv"};e.getKind=function(a){return e.splitLines(a)[0].split(" ")[0].substr(2)};
e.isRejected=function(a){return"0"===a.split(" ",2)[1]};e.parseMLine=function(a){a=e.splitLines(a)[0].substr(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}};e.parseOLine=function(a){a=e.matchPrefix(a,"o=")[0].substr(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}};e.isValidSDP=function(a){if("string"!==typeof a||0===a.length)return!1;a=e.splitLines(a);for(var b=0;b<a.length;b++)if(2>
a[b].length||"="!==a[b].charAt(1))return!1;return!0};"object"===typeof l&&(l.exports=e)},{}]},{},[1])(1)}()},function(l,r,p){p(83)(p(84))},function(l,r){l.exports=function(l){function f(f){"undefined"!==typeof console&&(console.error||console.log)("[Script Loader]",f)}try{"undefined"!==typeof execScript&&"undefined"!==typeof attachEvent&&"undefined"===typeof addEventListener?execScript(l):"undefined"!==typeof eval?eval.call(null,l):f("EvalError: No eval function available")}catch(q){f(q)}}},function(l,
r){l.exports="/* globals $$, jQuery, Elements, document, window, L */\n\n/**\n* Copyright 2013 Marc J. Schmidt. See the LICENSE file at the top-level\n* directory of this distribution and at\n* https://github.com/marcj/css-element-queries/blob/master/LICENSE.\n*/\nthis.L = this.L || {};\n\n/**\n * @param {HTMLElement} element\n * @param {String}      prop\n * @returns {String|Number}\n */\nL.GetComputedStyle = (computedElement, prop) => {\n  if (computedElement.currentStyle) {\n    return computedElement.currentStyle[prop];\n  } else if (window.getComputedStyle) {\n    return window.getComputedStyle(computedElement, null).getPropertyValue(prop);\n  }\n  return computedElement.style[prop];\n};\n\n/**\n *\n * @type {Function}\n * @constructor\n */\nL.ElementQueries = function ElementQueries() {\n  /**\n   *\n   * @param element\n   * @returns {Number}\n   */\n  function getEmSize(element = document.documentElement) {\n    const fontSize = L.GetComputedStyle(element, 'fontSize');\n    return parseFloat(fontSize) || 16;\n  }\n\n  /**\n   *\n   * @copyright https://github.com/Mr0grog/element-query/blob/master/LICENSE\n   *\n   * @param element\n   * @param value\n   * @param units\n   * @returns {*}\n   */\n  function convertToPx(element, originalValue) {\n    let vh;\n    let vw;\n    let chooser;\n    const units = originalValue.replace(/[0-9]*/, '');\n    const value = parseFloat(originalValue);\n    switch (units) {\n      case 'px':\n        return value;\n      case 'em':\n        return value * getEmSize(element);\n      case 'rem':\n        return value * getEmSize();\n      // Viewport units!\n      // According to http://quirksmode.org/mobile/tableViewport.html\n      // documentElement.clientWidth/Height gets us the most reliable info\n      case 'vw':\n        return (value * document.documentElement.clientWidth) / 100;\n      case 'vh':\n        return (value * document.documentElement.clientHeight) / 100;\n      case 'vmin':\n      case 'vmax':\n        vw = document.documentElement.clientWidth / 100;\n        vh = document.documentElement.clientHeight / 100;\n        chooser = Math[units === 'vmin' ? 'min' : 'max'];\n        return value * chooser(vw, vh);\n      default:\n        return value;\n      // for now, not supporting physical units (since they are just a set number of px)\n      // or ex/ch (getting accurate measurements is hard)\n    }\n  }\n\n  /**\n   *\n   * @param {HTMLElement} element\n   * @constructor\n   */\n  function SetupInformation(element) {\n    this.element = element;\n    this.options = [];\n    let i;\n    let j;\n    let option;\n    let width = 0;\n    let height = 0;\n    let value;\n    let actualValue;\n    let attrValues;\n    let attrValue;\n    let attrName;\n\n    /**\n     * @param option {mode: 'min|max', property: 'width|height', value: '123px'}\n     */\n    this.addOption = (newOption) => {\n      this.options.push(newOption);\n    };\n\n    const attributes = ['min-width', 'min-height', 'max-width', 'max-height'];\n\n    /**\n     * Extracts the computed width/height and sets to min/max- attribute.\n     */\n    this.call = () => {\n      // extract current dimensions\n      width = this.element.offsetWidth;\n      height = this.element.offsetHeight;\n\n      attrValues = {};\n\n      for (i = 0, j = this.options.length; i < j; i += 1) {\n        option = this.options[i];\n        value = convertToPx(this.element, option.value);\n\n        actualValue = option.property === 'width' ? width : height;\n        attrName = `${option.mode}-${option.property}`;\n        attrValue = '';\n\n        if (option.mode === 'min' && actualValue >= value) {\n          attrValue += option.value;\n        }\n\n        if (option.mode === 'max' && actualValue <= value) {\n          attrValue += option.value;\n        }\n\n        if (!attrValues[attrName]) attrValues[attrName] = '';\n        if (attrValue && (` ${attrValues[attrName]} `)\n          .indexOf(` ${attrValue} `) === -1) {\n          attrValues[attrName] += ` ${attrValue}`;\n        }\n      }\n\n      for (let k = 0; k < attributes.length; k += 1) {\n        if (attrValues[attributes[k]]) {\n          this.element.setAttribute(\n            attributes[k],\n            attrValues[attributes[k]].substr(1),\n          );\n        } else {\n          this.element.removeAttribute(attributes[k]);\n        }\n      }\n    };\n  }\n\n  /**\n   * @param {HTMLElement} element\n   * @param {Object}      options\n   */\n  function setupElement(originalElement, options) {\n    const element = originalElement;\n    if (element.elementQueriesSetupInformation) {\n      element.elementQueriesSetupInformation.addOption(options);\n    } else {\n      element.elementQueriesSetupInformation = new SetupInformation(element);\n      element.elementQueriesSetupInformation.addOption(options);\n      element.sensor = new L.ResizeSensor(element, () => {\n        element.elementQueriesSetupInformation.call();\n      });\n    }\n    element.elementQueriesSetupInformation.call();\n    return element;\n  }\n\n  /**\n   * @param {String} selector\n   * @param {String} mode min|max\n   * @param {String} property width|height\n   * @param {String} value\n   */\n  function queueQuery(selector, mode, property, value) {\n    let query;\n    if (document.querySelectorAll) query = document.querySelectorAll.bind(document);\n    if (!query && typeof $$ !== 'undefined') query = $$;\n    if (!query && typeof jQuery !== 'undefined') query = jQuery;\n\n    if (!query) {\n      throw new Error('No document.querySelectorAll, jQuery or Mootools\\'s $$ found.');\n    }\n\n    const elements = query(selector) || [];\n    for (let i = 0, j = elements.length; i < j; i += 1) {\n      elements[i] = setupElement(elements[i], {\n        mode,\n        property,\n        value,\n      });\n    }\n  }\n\n  const regex = /,?([^,\\n]*)\\[[\\s\\t]*(min|max)-(width|height)[\\s\\t]*[~$^]?=[\\s\\t]*\"([^\"]*)\"[\\s\\t]*]([^\\n\\s{]*)/mgi; // jshint ignore:line\n\n  /**\n   * @param {String} css\n   */\n  function extractQuery(originalCss) {\n    let match;\n    const css = originalCss.replace(/'/g, '\"');\n    while ((match = regex.exec(css)) !== null) {\n      if (match.length > 5) {\n        queueQuery(match[1] || match[5], match[2], match[3], match[4]);\n      }\n    }\n  }\n\n  /**\n   * @param {CssRule[]|String} rules\n   */\n  function readRules(originalRules) {\n    if (!originalRules) {\n      return;\n    }\n    let selector = '';\n    let rules = originalRules;\n    if (typeof originalRules === 'string') {\n      rules = originalRules.toLowerCase();\n      if (rules.indexOf('min-width') !== -1 || rules.indexOf('max-width') !== -1) {\n        extractQuery(rules);\n      }\n    } else {\n      for (let i = 0, j = rules.length; i < j; i += 1) {\n        if (rules[i].type === 1) {\n          selector = rules[i].selectorText || rules[i].cssText;\n          if (selector.indexOf('min-height') !== -1 ||\n            selector.indexOf('max-height') !== -1) {\n            extractQuery(selector);\n          } else if (selector.indexOf('min-width') !== -1 ||\n            selector.indexOf('max-width') !== -1) {\n            extractQuery(selector);\n          }\n        } else if (rules[i].type === 4) {\n          readRules(rules[i].cssRules || rules[i].rules);\n        }\n      }\n    }\n  }\n\n  /**\n   * Searches all css rules and setups the event listener\n   * to all elements with element query rules..\n   */\n  this.init = () => {\n    const styleSheets = document.styleSheets || [];\n    for (let i = 0, j = styleSheets.length; i < j; i += 1) {\n      readRules(styleSheets[i].cssText ||\n        styleSheets[i].cssRules ||\n        styleSheets[i].rules);\n    }\n  };\n};\n\nfunction init() {\n  (new L.ElementQueries()).init();\n}\n\nif (window.addEventListener) {\n  window.addEventListener('load', init, false);\n} else {\n  window.attachEvent('onload', init);\n}\n\n/**\n * Iterate over each of the provided element(s).\n *\n * @param {HTMLElement|HTMLElement[]} elements\n * @param {Function}                  callback\n */\nfunction forEachElement(elements, callback = () => { }) {\n  const elementsType = Object.prototype.toString.call(elements);\n  const isCollectionTyped = (elementsType === '[object Array]' ||\n    (elementsType === '[object NodeList]') ||\n    (elementsType === '[object HTMLCollection]') ||\n    (typeof jQuery !== 'undefined' && elements instanceof jQuery) || // jquery\n    (typeof Elements !== 'undefined' && elements instanceof Elements) // mootools\n  );\n  let i = 0;\n  const j = elements.length;\n  if (isCollectionTyped) {\n    for (; i < j; i += 1) {\n      callback(elements[i]);\n    }\n  } else {\n    callback(elements);\n  }\n}\n/**\n * Class for dimension change detection.\n *\n * @param {Element|Element[]|Elements|jQuery} element\n * @param {Function} callback\n *\n * @constructor\n */\nL.ResizeSensor = function ResizeSensor(element, callback = () => { }) {\n  /**\n   *\n   * @constructor\n   */\n  function EventQueue() {\n    let q = [];\n    this.add = (ev) => {\n      q.push(ev);\n    };\n\n    let i;\n    let j;\n    this.call = () => {\n      for (i = 0, j = q.length; i < j; i += 1) {\n        q[i].call();\n      }\n    };\n\n    this.remove = (ev) => {\n      const newQueue = [];\n      for (i = 0, j = q.length; i < j; i += 1) {\n        if (q[i] !== ev) newQueue.push(q[i]);\n      }\n      q = newQueue;\n    };\n\n    this.length = () => q.length;\n  }\n\n  /**\n   *\n   * @param {HTMLElement} element\n   * @param {Function}    resized\n   */\n  function attachResizeEvent(htmlElement, resized) {\n    // Only used for the dirty checking, so the event callback count is limted\n    //  to max 1 call per fps per sensor.\n    // In combination with the event based resize sensor this saves cpu time,\n    // because the sensor is too fast and\n    // would generate too many unnecessary events.\n    const customRequestAnimationFrame = window.requestAnimationFrame ||\n      window.mozRequestAnimationFrame ||\n      window.webkitRequestAnimationFrame ||\n      function delay(fn) {\n        return window.setTimeout(fn, 20);\n      };\n\n    const newElement = htmlElement;\n    if (!newElement.resizedAttached) {\n      newElement.resizedAttached = new EventQueue();\n      newElement.resizedAttached.add(resized);\n    } else if (newElement.resizedAttached) {\n      newElement.resizedAttached.add(resized);\n      return;\n    }\n\n    newElement.resizeSensor = document.createElement('div');\n    newElement.resizeSensor.className = 'resize-sensor';\n    const style = 'position: absolute; left: 0; top: 0; right: 0; bottom: 0; ' +\n      'overflow: hidden; z-index: -1; visibility: hidden;';\n    const styleChild = 'position: absolute; left: 0; top: 0; transition: 0s;';\n\n    newElement.resizeSensor.style.cssText = style;\n    newElement.resizeSensor.innerHTML =\n      `<div class=\"resize-sensor-expand\" style=\"${style}\">` +\n      `<div style=\"${styleChild}\"></div>` +\n      '</div>' +\n      `<div class=\"resize-sensor-shrink\" style=\"${style}\">` +\n      `<div style=\"${styleChild} width: 200%; height: 200%\"></div>` +\n      '</div>';\n    newElement.appendChild(newElement.resizeSensor);\n\n    if (L.GetComputedStyle(newElement, 'position') === 'static') {\n      newElement.style.position = 'relative';\n    }\n\n    const expand = newElement.resizeSensor.childNodes[0];\n    const expandChild = expand.childNodes[0];\n    const shrink = newElement.resizeSensor.childNodes[1];\n\n    const reset = () => {\n      expandChild.style.width = `${100000}px`;\n      expandChild.style.height = `${100000}px`;\n\n      expand.scrollLeft = 100000;\n      expand.scrollTop = 100000;\n\n      shrink.scrollLeft = 100000;\n      shrink.scrollTop = 100000;\n    };\n\n    reset();\n    let dirty = false;\n\n    const dirtyChecking = () => {\n      if (!newElement.resizedAttached) return;\n\n      if (dirty) {\n        newElement.resizedAttached.call();\n        dirty = false;\n      }\n\n      customRequestAnimationFrame(dirtyChecking);\n    };\n\n    customRequestAnimationFrame(dirtyChecking);\n    let lastWidth;\n    let lastHeight;\n    let cachedWidth;\n    let cachedHeight; // useful to not query offsetWidth twice\n\n    const onScroll = () => {\n      if ((cachedWidth = newElement.offsetWidth) !== lastWidth ||\n        (cachedHeight = newElement.offsetHeight) !== lastHeight) {\n        dirty = true;\n\n        lastWidth = cachedWidth;\n        lastHeight = cachedHeight;\n      }\n      reset();\n    };\n\n    const addEvent = (el, name, cb) => {\n      if (el.attachEvent) {\n        el.attachEvent(`on${name}`, cb);\n      } else {\n        el.addEventListener(name, cb);\n      }\n    };\n\n    addEvent(expand, 'scroll', onScroll);\n    addEvent(shrink, 'scroll', onScroll);\n  }\n\n  forEachElement(element, (elem) => {\n    attachResizeEvent(elem, callback);\n  });\n\n  this.detach = (ev) => {\n    L.ResizeSensor.detach(element, ev);\n  };\n};\n\nL.ResizeSensor.detach = (element, ev) => {\n  forEachElement(element, (elem) => {\n    const elementItem = elem;\n    if (elementItem.resizedAttached && typeof ev === 'function') {\n      elementItem.resizedAttached.remove(ev);\n      if (elementItem.resizedAttached.length()) return;\n    }\n    if (elementItem.resizeSensor) {\n      if (elementItem.contains(elementItem.resizeSensor)) {\n        elementItem.removeChild(elementItem.resizeSensor);\n      }\n      delete elementItem.resizeSensor;\n      delete elementItem.resizedAttached;\n    }\n  });\n};\n"}])["default"];

//# sourceMappingURL=EnxRtc.js.map
